!function(){"use strict";var e,t=tinymce.util.Tools.resolve("tinymce.PluginManager");let o=(e,t,o)=>{var l;return!!o(e,t.prototype)||(null===(l=e.constructor)||void 0===l?void 0:l.name)===t.name},l=e=>{let t=typeof e;return null===e?"null":"object"===t&&Array.isArray(e)?"array":"object"===t&&o(e,String,(e,t)=>t.isPrototypeOf(e))?"string":t},r=e=>t=>l(t)===e,n=e=>t=>typeof t===e,a=r("string"),s=r("array"),i=n("boolean"),c=(e=void 0,t=>e===t),m=e=>null==e,d=e=>!m(e),u=n("function"),p=n("number"),b=()=>{},g=(e,t)=>o=>e(t(o)),h=e=>()=>e,f=e=>e,y=(e,t)=>e===t;function w(e,...t){return(...o)=>{let l=t.concat(o);return e.apply(null,l)}}let S=e=>{e()},C=h(!1),v=h(!0);class T{constructor(e,t){this.tag=e,this.value=t}static some(e){return new T(!0,e)}static none(){return T.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?T.some(e(this.value)):T.none()}bind(e){return this.tag?e(this.value):T.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:T.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw Error(null!=e?e:"Called getOrDie on None")}static from(e){return d(e)?T.some(e):T.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}T.singletonNone=new T(!1);let x=Object.keys,A=Object.hasOwnProperty,R=(e,t)=>{let o=x(e);for(let l=0,r=o.length;l<r;l++){let n=o[l],a=e[n];t(a,n)}},_=e=>(t,o)=>{e[o]=t},O=(e,t,o,l)=>{R(e,(e,r)=>{(t(e,r)?o:l)(e,r)})},D=(e,t)=>{let o={};return O(e,t,_(o),b),o},I=(e,t)=>{let o=[];return R(e,(e,l)=>{o.push(t(e,l))}),o},M=e=>I(e,f),N=e=>x(e).length,P=(e,t)=>k(e,t)?T.from(e[t]):T.none(),k=(e,t)=>A.call(e,t),B=(e,t)=>k(e,t)&&void 0!==e[t]&&null!==e[t],E=Array.prototype.indexOf,F=Array.prototype.push,q=(e,t)=>E.call(e,t),j=(e,t)=>q(e,t)>-1,L=(e,t)=>{for(let o=0,l=e.length;o<l;o++){let r=e[o];if(t(r,o))return!0}return!1},H=(e,t)=>{let o=[];for(let l=0;l<e;l++)o.push(t(l));return o},V=(e,t)=>{let o=e.length,l=Array(o);for(let r=0;r<o;r++){let n=e[r];l[r]=t(n,r)}return l},$=(e,t)=>{for(let o=0,l=e.length;o<l;o++){let r=e[o];t(r,o)}},z=(e,t)=>{for(let o=e.length-1;o>=0;o--){let l=e[o];t(l,o)}},W=(e,t)=>{let o=[],l=[];for(let r=0,n=e.length;r<n;r++){let a=e[r],s=t(a,r)?o:l;s.push(a)}return{pass:o,fail:l}},U=(e,t)=>{let o=[];for(let l=0,r=e.length;l<r;l++){let n=e[l];t(n,l)&&o.push(n)}return o},G=(e,t,o)=>(z(e,(e,l)=>{o=t(o,e,l)}),o),K=(e,t,o)=>($(e,(e,l)=>{o=t(o,e,l)}),o),J=(e,t,o)=>{for(let l=0,r=e.length;l<r;l++){let n=e[l];if(t(n,l))return T.some(n);if(o(n,l))break}return T.none()},Q=(e,t)=>J(e,t,C),X=e=>{let t=[];for(let o=0,l=e.length;o<l;++o){if(!s(e[o]))throw Error("Arr.flatten item "+o+" was not an array, input: "+e);F.apply(t,e[o])}return t},Y=(e,t)=>X(V(e,t)),Z=(e,t)=>{for(let o=0,l=e.length;o<l;++o){let r=e[o];if(!0!==t(r,o))return!1}return!0},ee=(e,t)=>{let o={};for(let l=0,r=e.length;l<r;l++){let n=e[l];o[String(n)]=t(n,l)}return o},et=(e,t)=>t>=0&&t<e.length?T.some(e[t]):T.none(),eo=e=>et(e,0),el=e=>et(e,e.length-1),er=(e,t)=>{for(let o=0;o<e.length;o++){let l=t(e[o],o);if(l.isSome())return l}return T.none()},en=(e,t)=>{let o=(t||document).createElement("div");if(o.innerHTML=e,!o.hasChildNodes()||o.childNodes.length>1){let l="HTML does not have a single root node";throw console.error(l,e),Error(l)}return ei(o.childNodes[0])},ea=(e,t)=>{let o=(t||document).createElement(e);return ei(o)},es=(e,t)=>{let o=(t||document).createTextNode(e);return ei(o)},ei=e=>{if(null==e)throw Error("Node cannot be null or undefined");return{dom:e}},ec=(e,t,o)=>T.from(e.dom.elementFromPoint(t,o)).map(ei),em={fromHtml:en,fromTag:ea,fromText:es,fromDom:ei,fromPoint:ec};"undefined"!=typeof window?window:Function("return this;")();let ed=e=>{let t=e.dom.nodeName;return t.toLowerCase()},eu=e=>e.dom.nodeType,ep=e=>t=>eu(t)===e,eb=e=>8===eu(e)||"#comment"===ed(e),eg=ep(1),eh=ep(3),ef=ep(9),ey=ep(11),ew=e=>t=>eg(t)&&ed(t)===e,eS=(e,t)=>{let o=e.dom;if(1!==o.nodeType)return!1;if(void 0!==o.matches)return o.matches(t);if(void 0!==o.msMatchesSelector)return o.msMatchesSelector(t);if(void 0!==o.webkitMatchesSelector)return o.webkitMatchesSelector(t);if(void 0!==o.mozMatchesSelector)return o.mozMatchesSelector(t);throw Error("Browser lacks native selectors")},eC=e=>1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount,ev=(e,t)=>{let o=void 0===t?document:t.dom;return eC(o)?[]:V(o.querySelectorAll(e),em.fromDom)},eT=(e,t)=>{let o=void 0===t?document:t.dom;return eC(o)?T.none():T.from(o.querySelector(e)).map(em.fromDom)},ex=(e,t)=>e.dom===t.dom,eA=e=>em.fromDom(e.dom.ownerDocument),eR=e=>ef(e)?e:eA(e),e_=e=>T.from(e.dom.parentNode).map(em.fromDom),eO=(e,t)=>{let o=u(t)?t:C,l=e.dom,r=[];for(;null!==l.parentNode&&void 0!==l.parentNode;){let n=l.parentNode,a=em.fromDom(n);if(r.push(a),!0===o(a))break;l=n}return r},eD=e=>T.from(e.dom.previousSibling).map(em.fromDom),eI=e=>T.from(e.dom.nextSibling).map(em.fromDom),eM=e=>V(e.dom.childNodes,em.fromDom),eN=(e,t)=>{let o=e.dom.childNodes;return T.from(o[t]).map(em.fromDom)},eP=e=>eN(e,0),ek=e=>ey(e)&&d(e.dom.host),eB=u(Element.prototype.attachShadow)&&u(Node.prototype.getRootNode),eE=eB?e=>em.fromDom(e.dom.getRootNode()):eR,eF=e=>{let t=eE(e);return ek(t)?T.some(t):T.none()},eq=e=>em.fromDom(e.dom.host),ej=e=>{let t=eh(e)?e.dom.parentNode:e.dom;if(null==t||null===t.ownerDocument)return!1;let o=t.ownerDocument;return eF(em.fromDom(t)).fold(()=>o.body.contains(t),g(ej,eq))},eL=(e,t)=>U(eM(e),t),eH=(e,t)=>{let o=[];return $(eM(e),e=>{t(e)&&(o=o.concat([e])),o=o.concat(eH(e,t))}),o},eV=(e,t)=>eL(e,e=>eS(e,t)),e$=(e,t)=>ev(t,e);var ez=(e,t,o,l,r)=>e(o,l)?T.some(o):u(r)&&r(o)?T.none():t(o,l,r);let eW=(e,t,o)=>{let l=e.dom,r=u(o)?o:C;for(;l.parentNode;){l=l.parentNode;let n=em.fromDom(l);if(t(n))return T.some(n);if(r(n))break}return T.none()},eU=(e,t)=>{let o=e=>t(em.fromDom(e)),l=Q(e.dom.childNodes,o);return l.map(em.fromDom)},eG=(e,t,o)=>eW(e,e=>eS(e,t),o),eK=(e,t)=>eU(e,e=>eS(e,t)),eJ=(e,t)=>eT(t,e),eQ=(e,t,o)=>{let l=(e,t)=>eS(e,t);return ez(l,eG,e,t,o)},eX=(e,t,o)=>{if(a(o)||i(o)||p(o))e.setAttribute(t,o+"");else throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",o,":: Element ",e),Error("Attribute value was not simple")},eY=(e,t,o)=>{eX(e.dom,t,o)},eZ=(e,t)=>{let o=e.dom;R(t,(e,t)=>{eX(o,t,e)})},e0=(e,t)=>{let o=e.dom.getAttribute(t);return null===o?void 0:o},e1=(e,t)=>T.from(e0(e,t)),e2=(e,t)=>{e.dom.removeAttribute(t)},e3=e=>K(e.dom.attributes,(e,t)=>(e[t.name]=t.value,e),{}),e4=(e,t,o=y)=>e.exists(e=>o(e,t)),e5=e=>{let t=[],o=e=>{t.push(e)};for(let l=0;l<e.length;l++)e[l].each(o);return t},e6=(e,t,o)=>e.isSome()&&t.isSome()?T.some(o(e.getOrDie(),t.getOrDie())):T.none(),e9=e=>e.bind(f),e8=(e,t)=>e?T.some(t):T.none(),e7=(e,t)=>e.substring(t),te=(e,t,o)=>""===t||e.length>=t.length&&e.substr(o,o+t.length)===t,tt=(e,t)=>to(e,t)?e7(e,t.length):e,to=(e,t)=>te(e,t,0),tl=e=>e.replace(/^\s+|\s+$/g,""),tr=e=>e.length>0,tn=e=>!tr(e),ta=(e,t=10)=>{let o=parseInt(e,t);return isNaN(o)?T.none():T.some(o)},ts=e=>{let t=parseFloat(e);return isNaN(t)?T.none():T.some(t)},ti=e=>void 0!==e.style&&u(e.style.getPropertyValue),tc=(e,t,o)=>{if(!a(o))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",o,":: Element ",e),Error("CSS value must be a string: "+o);ti(e)&&e.style.setProperty(t,o)},tm=(e,t)=>{ti(e)&&e.style.removeProperty(t)},td=(e,t,o)=>{let l=e.dom;tc(l,t,o)},tu=(e,t)=>{let o=e.dom,l=window.getComputedStyle(o),r=l.getPropertyValue(t);return""!==r||ej(e)?r:tp(o,t)},tp=(e,t)=>ti(e)?e.style.getPropertyValue(t):"",tb=(e,t)=>{let o=e.dom,l=tp(o,t);return T.from(l).filter(e=>e.length>0)},tg=(e,t)=>{let o=e.dom;tm(o,t),e4(e1(e,"style").map(tl),"")&&e2(e,"style")},th=(e,t,o=0)=>e1(e,t).map(e=>parseInt(e,10)).getOr(o),tf=(e,t)=>ty(e,t,v),ty=(e,t,o)=>Y(eM(e),e=>eS(e,t)?o(e)?[e]:[]:ty(e,t,o)),tw=["tfoot","thead","tbody","colgroup"],tS=e=>j(tw,e),tC=(e,t)=>({rows:e,columns:t}),tv=(e,t,o)=>({element:e,rowspan:t,colspan:o}),tT=(e,t,o,l,r,n)=>({element:e,rowspan:t,colspan:o,row:l,column:r,isLocked:n}),tx=(e,t,o)=>({element:e,cells:t,section:o}),tA=(e,t,o,l)=>({startRow:e,startCol:t,finishRow:o,finishCol:l}),tR=(e,t,o)=>({element:e,colspan:t,column:o}),t_=(e,t)=>({element:e,columns:t}),tO=(e,t,o=C)=>{if(o(t))return T.none();if(j(e,ed(t)))return T.some(t);let l=e=>eS(e,"table")||o(e);return eG(t,e.join(","),l)},tD=(e,t)=>tO(["td","th"],e,t),tI=e=>tf(e,"th,td"),tM=e=>eS(e,"colgroup")?eV(e,"col"):Y(tk(e),e=>eV(e,"col")),tN=(e,t)=>eQ(e,"table",t),tP=e=>tf(e,"tr"),tk=e=>tN(e).fold(h([]),e=>eV(e,"colgroup")),tB=(e,t)=>V(e,e=>{if("colgroup"===ed(e)){let o=V(tM(e),e=>{let t=th(e,"span",1);return tv(e,1,t)});return tx(e,o,"colgroup")}{let l=V(tI(e),e=>{let t=th(e,"rowspan",1),o=th(e,"colspan",1);return tv(e,t,o)});return tx(e,l,t(e))}}),tE=e=>e_(e).map(e=>{let t=ed(e);return tS(t)?t:"tbody"}).getOr("tbody"),tF=e=>{let t=tP(e),o=tk(e),l=[...o,...t];return tB(l,tE)},tq=e=>e1(e,"data-snooker-locked-cols").bind(e=>T.from(e.match(/\d+/g))).map(e=>ee(e,v)),tj=(e,t)=>e+","+t,tL=(e,t,o)=>T.from(e.access[tj(t,o)]),tH=(e,t,o)=>{let l=tV(e,e=>o(t,e.element));return l.length>0?T.some(l[0]):T.none()},tV=(e,t)=>{let o=Y(e.all,e=>e.cells);return U(o,t)},t$=e=>{let t={},o=0;return $(e.cells,e=>{let l=e.colspan;H(l,r=>{let n=o+r;t[n]=tR(e.element,l,n)}),o+=l}),t},tz=e=>{let t={},o=[],l=eo(e).map(e=>e.element).bind(tN),r=l.bind(tq).getOr({}),n=0,a=0,s=0,{pass:i,fail:c}=W(e,e=>"colgroup"===e.section);$(c,e=>{let l=[];$(e.cells,e=>{let o=0;for(;void 0!==t[tj(s,o)];)o++;let n=B(r,o.toString()),i=tT(e.element,e.rowspan,e.colspan,s,o,n);for(let c=0;c<e.colspan;c++)for(let m=0;m<e.rowspan;m++){let d=s+m,u=o+c,p=tj(d,u);t[p]=i,a=Math.max(a,u+1)}l.push(i)}),n++,o.push(tx(e.element,l,e.section)),s++});let{columns:m,colgroups:d}=el(i).map(e=>{let t=t$(e),o=t_(e.element,M(t));return{colgroups:[o],columns:t}}).getOrThunk(()=>({colgroups:[],columns:{}})),u=tC(n,a);return{grid:u,access:t,all:o,columns:m,colgroups:d}},tW=e=>{let t=tF(e);return tz(t)},tU=e=>Y(e.all,e=>e.cells),tG=e=>M(e.columns),tK=(e,t)=>T.from(e.columns[t]),tJ={fromTable:tW,generate:tz,getAt:tL,findItem:tH,filterItems:tV,justCells:tU,justColumns:tG,hasColumns:e=>x(e.columns).length>0,getColumnAt:tK};var tQ=tinymce.util.Tools.resolve("tinymce.util.Tools");let tX=(e,t,o)=>{let l;let r=e.select("td,th",t);for(let n=0;n<r.length;n++){let a=e.getStyle(r[n],o);if(c(l)&&(l=a),l!==a)return""}return l},tY=(e,t,o)=>{tQ.each("left center right".split(" "),l=>{l!==o&&e.formatter.remove("align"+l,{},t)}),o&&e.formatter.apply("align"+o,{},t)},tZ=(e,t,o)=>{tQ.each("top middle bottom".split(" "),l=>{l!==o&&e.formatter.remove("valign"+l,{},t)}),o&&e.formatter.apply("valign"+o,{},t)},t0=(e,t,o)=>{e.dispatch("TableModified",{...o,table:t})},t1=(e,t)=>ts(e).getOr(t),t2=(e,t,o)=>t1(tu(e,t),o),t3=(e,t,o,l)=>{let r=t2(e,`padding-${o}`,0),n=t2(e,`padding-${l}`,0),a=t2(e,`border-${o}-width`,0),s=t2(e,`border-${l}-width`,0);return t-r-n-a-s},t4=(e,t)=>{let o=e.dom,l=o.getBoundingClientRect().width||o.offsetWidth;return"border-box"===t?l:t3(e,l,"left","right")},t5=e=>t4(e,"content-box");var t6=tinymce.util.Tools.resolve("tinymce.Env");let t9=H(5,e=>{let t=`${e+1}px`;return{title:t,value:t}}),t8=V(["Solid","Dotted","Dashed","Double","Groove","Ridge","Inset","Outset","None","Hidden"],e=>({title:e,value:e.toLowerCase()})),t7="100%",oe=e=>{var t;let o=e.dom,l=null!==(t=o.getParent(e.selection.getStart(),o.isBlock))&&void 0!==t?t:e.getBody();return t5(em.fromDom(l))+"px"},ot=(e,t)=>oC(e)||!op(e)?t:oS(e)?{...t,width:oe(e)}:{...t,width:t7},oo=(e,t)=>oC(e)||op(e)?t:oS(e)?{...t,width:oe(e)}:{...t,width:t7},ol=e=>t=>t.options.get(e),or=e=>{let t=e.options.register;t("table_border_widths",{processor:"object[]",default:t9}),t("table_border_styles",{processor:"object[]",default:t8}),t("table_cell_advtab",{processor:"boolean",default:!0}),t("table_row_advtab",{processor:"boolean",default:!0}),t("table_advtab",{processor:"boolean",default:!0}),t("table_appearance_options",{processor:"boolean",default:!0}),t("table_grid",{processor:"boolean",default:!t6.deviceType.isTouch()}),t("table_cell_class_list",{processor:"object[]",default:[]}),t("table_row_class_list",{processor:"object[]",default:[]}),t("table_class_list",{processor:"object[]",default:[]}),t("table_toolbar",{processor:"string",default:"tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol"}),t("table_background_color_map",{processor:"object[]",default:[]}),t("table_border_color_map",{processor:"object[]",default:[]})},on=ol("table_sizing_mode"),oa=ol("table_border_widths"),os=ol("table_border_styles"),oi=ol("table_cell_advtab"),oc=ol("table_row_advtab"),om=ol("table_advtab"),od=ol("table_appearance_options"),ou=ol("table_grid"),op=ol("table_style_by_css"),ob=ol("table_cell_class_list"),og=ol("table_row_class_list"),oh=ol("table_class_list"),of=ol("table_toolbar"),oy=ol("table_background_color_map"),ow=ol("table_border_color_map"),oS=e=>"fixed"===on(e),oC=e=>"responsive"===on(e),ov=e=>{let t=e.options,o=t.get("table_default_styles");return t.isSet("table_default_styles")?o:ot(e,o)},oT=e=>{let t=e.options,o=t.get("table_default_attributes");return t.isSet("table_default_attributes")?o:oo(e,o)},ox=e=>e.nodeName.toLowerCase(),oA=e=>em.fromDom(e.getBody()),oR=e=>t=>ex(t,oA(e)),o_=e=>e?e.replace(/px$/,""):"",oO=e=>/^\d+(\.\d+)?$/.test(e)?e+"px":e,oD=e=>em.fromDom(e.selection.getStart()),oI=e=>em.fromDom(e.selection.getEnd()),oM=(e,t)=>t.column>=e.startCol&&t.column+t.colspan-1<=e.finishCol&&t.row>=e.startRow&&t.row+t.rowspan-1<=e.finishRow,oN=(e,t)=>{let o=!0,l=w(oM,t);for(let r=t.startRow;r<=t.finishRow;r++)for(let n=t.startCol;n<=t.finishCol;n++)o=o&&tJ.getAt(e,r,n).exists(l);return o?T.some(t):T.none()},oP=(e,t)=>tA(Math.min(e.row,t.row),Math.min(e.column,t.column),Math.max(e.row+e.rowspan-1,t.row+t.rowspan-1),Math.max(e.column+e.colspan-1,t.column+t.colspan-1)),ok=(e,t,o)=>{let l=tJ.findItem(e,t,ex),r=tJ.findItem(e,o,ex);return l.bind(e=>r.map(t=>oP(e,t)))},oB=(e,t,o)=>ok(e,t,o).bind(t=>oN(e,t)),oE=(e,t,o)=>{let l=oF(e);return oB(l,t,o)},oF=tJ.fromTable,oq=(e,t)=>{let o=e_(e);o.each(o=>{o.dom.insertBefore(t.dom,e.dom)})},oj=(e,t)=>{let o=eI(e);o.fold(()=>{let o=e_(e);o.each(e=>{oH(e,t)})},e=>{oq(e,t)})},oL=(e,t)=>{let o=eP(e);o.fold(()=>{oH(e,t)},o=>{e.dom.insertBefore(t.dom,o.dom)})},oH=(e,t)=>{e.dom.appendChild(t.dom)},oV=(e,t)=>{oq(e,t),oH(t,e)},o$=(e,t)=>{$(t,(o,l)=>{let r=0===l?e:t[l-1];oj(r,o)})},oz=(e,t)=>{$(t,t=>{oH(e,t)})},oW=e=>{let t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},oU=e=>{let t=eM(e);t.length>0&&o$(e,t),oW(e)},oG=((e,t)=>{let o=o=>{if(!e(o))throw Error("Can only get "+t+" value of a "+t+" node");return l(o).getOr("")},l=t=>e(t)?T.from(t.dom.nodeValue):T.none(),r=(o,l)=>{if(!e(o))throw Error("Can only set raw "+t+" value of a "+t+" node");o.dom.nodeValue=l};return{get:o,getOption:l,set:r}})(eh,"text"),oK=e=>oG.get(e),oJ=(e,t)=>oG.set(e,t);var oQ=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];let oX=(e,t,o,l)=>{let r=o[0],n=o.slice(1);return l(e,t,r,n)},oY=(e,t,o)=>o.length>0?oX(e,t,o,oZ):T.none(),oZ=(e,t,o,l)=>{let r=t(e,o);return G(l,(o,l)=>{let r=t(e,l);return o0(e,o,r)},r)},o0=(e,t,o)=>t.bind(t=>o.filter(w(e.eq,t))),o1=(()=>{let e=e=>em.fromDom(e.dom.cloneNode(!1)),t=e=>!!eg(e)&&("body"===ed(e)||j(oQ,ed(e))),o=e=>!!eg(e)&&j(["br","img","hr","input"],ed(e)),l=e=>eg(e)&&"false"===e0(e,"contenteditable"),r=(e,t)=>e.dom.compareDocumentPosition(t.dom),n=(e,t)=>{let o=e3(e);eZ(t,o)},a=e=>{let t=ed(e);return j(["script","noscript","iframe","noframes","noembed","title","style","textarea","xmp"],t)},s=e=>eg(e)?e1(e,"lang"):T.none();return{up:h({selector:eG,closest:eQ,predicate:eW,all:eO}),down:h({selector:e$,predicate:eH}),styles:h({get:tu,getRaw:tb,set:td,remove:tg}),attrs:h({get:e0,set:eY,remove:e2,copyTo:n}),insert:h({before:oq,after:oj,afterAll:o$,append:oH,appendAll:oz,prepend:oL,wrap:oV}),remove:h({unwrap:oU,remove:oW}),create:h({nu:em.fromTag,clone:e,text:em.fromText}),query:h({comparePosition:r,prevSibling:eD,nextSibling:eI}),property:h({children:eM,name:ed,parent:e_,document:e=>eR(e).dom,isText:eh,isComment:eb,isElement:eg,isSpecial:a,getLanguage:s,getText:oK,setText:oJ,isBoundary:t,isEmptyTag:o,isNonEditable:l}),eq:ex,is:eS}})(),o2=(e,t)=>oY(o1,(t,o)=>e(o),t),o3=e=>eG(e,"table"),o4=(e,t)=>{let o=e$(e,t);return o.length>0?T.some(o):T.none()},o5=(e,t,o)=>eJ(e,t).bind(t=>eJ(e,o).bind(e=>o2(o3,[t,e]).map(o=>({first:t,last:e,table:o})))),o6=(e,t)=>o4(e,t),o9=(e,t,o)=>o5(e,t,o).bind(t=>{let o=t=>ex(e,t),l="thead,tfoot,tbody,table",r=eG(t.first,l,o),n=eG(t.last,l,o);return r.bind(e=>n.bind(o=>ex(e,o)?oE(t.table,t.first,t.last):T.none()))}),o8=e=>V(e,em.fromDom),o7="data-mce-selected",le="data-mce-first-selected",lt="data-mce-last-selected",lo={selected:o7,selectedSelector:"td["+o7+"],th["+o7+"]",firstSelected:le,firstSelectedSelector:"td["+le+"],th["+le+"]",lastSelected:lt,lastSelectedSelector:"td["+lt+"],th["+lt+"]"},ll=e=>tN(e).bind(e=>o6(e,lo.firstSelectedSelector)).fold(h(e),e=>e[0]),lr=e=>(t,o)=>{let l=ed(t),r="col"===l||"colgroup"===l?ll(t):t;return eQ(r,e,o)},ln=lr("th,td,caption"),la=lr("th,td"),ls=e=>o8(e.model.table.getSelectedCells()),li=(e,t)=>{let o=la(e),l=o.bind(e=>tN(e)).map(e=>tP(e));return e6(o,l,(e,o)=>U(o,o=>L(o8(o.dom.cells),o=>"1"===e0(o,t)||ex(o,e)))).getOr([])},lc=[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}],lm=e=>({value:e}),ld=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,lu=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,lp=e=>ld.test(e)||lu.test(e),lb=e=>tt(e,"#").toUpperCase(),lg=e=>lp(e)?T.some({value:lb(e)}):T.none(),lh=e=>{let t=e.toString(16);return(1===t.length?"0"+t:t).toUpperCase()},lf=e=>{let t=lh(e.red)+lh(e.green)+lh(e.blue);return lm(t)},ly=/^\s*rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/i,lw=/^\s*rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?(?:\.\d+)?)\s*\)\s*$/i,lS=(e,t,o,l)=>({red:e,green:t,blue:o,alpha:l}),lC=(e,t,o,l)=>{let r=parseInt(e,10),n=parseInt(t,10),a=parseInt(o,10),s=parseFloat(l);return lS(r,n,a,s)},lv=e=>{if("transparent"===e)return T.some(lS(0,0,0,0));let t=ly.exec(e);if(null!==t)return T.some(lC(t[1],t[2],t[3],"1"));let o=lw.exec(e);return null!==o?T.some(lC(o[1],o[2],o[3],o[4])):T.none()},lT=e=>lg(e).orThunk(()=>lv(e).map(lf)).getOrThunk(()=>{let t=document.createElement("canvas");t.height=1,t.width=1;let o=t.getContext("2d");o.clearRect(0,0,t.width,t.height),o.fillStyle="#FFFFFF",o.fillStyle=e,o.fillRect(0,0,1,1);let l=o.getImageData(0,0,1,1).data,r=l[0],n=l[1],a=l[2],s=l[3];return lf(lS(r,n,a,s))}),lx=e=>lv(e).map(lf).map(e=>"#"+e.value).getOr(e),lA=e=>{let t=e,o=e=>{t=e};return{get:()=>t,set:o}},lR=e=>{let t=lA(T.none()),o=()=>t.get().each(e),l=()=>{o(),t.set(T.none())},r=()=>t.get().isSome(),n=()=>t.get(),a=e=>{o(),t.set(T.some(e))};return{clear:l,isSet:r,get:n,set:a}},l_=()=>lR(e=>e.unbind()),lO=(e,t,o)=>l=>{let r=l_(),n=tn(o),a=()=>{let a=ls(e),s=l=>e.formatter.match(t,{value:o},l.dom,n);n?(l.setActive(!L(a,s)),r.set(e.formatter.formatChanged(t,e=>l.setActive(!e),!0))):(l.setActive(Z(a,s)),r.set(e.formatter.formatChanged(t,l.setActive,!1,{value:o})))};return e.initialized?a():e.on("init",a),r.clear},lD=e=>B(e,"menu"),lI=e=>V(e,e=>{let t=e.text||e.title||"";return lD(e)?{text:t,items:lI(e.menu)}:{text:t,value:e.value}}),lM=(e,t,o,l)=>V(t,t=>{let r=t.text||t.title;return lD(t)?{type:"nestedmenuitem",text:r,getSubmenuItems:()=>lM(e,t.menu,o,l)}:{text:r,type:"togglemenuitem",onAction:()=>l(t.value),onSetup:lO(e,o,t.value)}}),lN=(e,t)=>o=>{e.execCommand("mceTableApplyCellStyle",!1,{[t]:o})},lP=e=>Y(e,e=>lD(e)?[{...e,menu:lP(e.menu)}]:tr(e.value)?[e]:[]),lk=(e,t,o,l)=>r=>r(lM(e,t,o,l)),lB=(e,t,o)=>{let l=V(t,e=>({text:e.title,value:"#"+lT(e.value).value,type:"choiceitem"}));return[{type:"fancymenuitem",fancytype:"colorswatch",initData:{colors:l.length>0?l:void 0,allowCustomColors:!1},onAction:t=>{let l="remove"===t.value?"":t.value;e.execCommand("mceTableApplyCellStyle",!1,{[o]:l})}}]},lE=e=>()=>{let t=e.queryCommandValue("mceTableRowType");e.execCommand("mceTableRowType",!1,{type:"header"===t?"body":"header"})},lF=e=>()=>{let t=e.queryCommandValue("mceTableColType");e.execCommand("mceTableColType",!1,{type:"th"===t?"td":"th"})},lq=e=>{let t=lI(ob(e));return t.length>0?T.some({name:"class",type:"listbox",label:"Class",items:t}):T.none()},lj=[{name:"width",type:"input",label:"Width"},{name:"height",type:"input",label:"Height"},{name:"celltype",type:"listbox",label:"Cell type",items:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{name:"scope",type:"listbox",label:"Scope",items:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{name:"halign",type:"listbox",label:"Horizontal align",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{name:"valign",type:"listbox",label:"Vertical align",items:lc}],lL=e=>lj.concat(lq(e).toArray()),lH=(e,t)=>{let o=[{name:"borderstyle",type:"listbox",label:"Border style",items:[{text:"Select...",value:""}].concat(lI(os(e)))},{name:"bordercolor",type:"colorinput",label:"Border color"},{name:"backgroundcolor",type:"colorinput",label:"Background color"}],l="cell"===t?[{name:"borderwidth",type:"input",label:"Border width"}].concat(o):o;return{title:"Advanced",name:"advanced",items:l}},lV=(e,t)=>{let o=e.dom,l=(e,l)=>{o.setAttrib(t,e,l)},r=(e,l)=>{o.setStyle(t,e,l)},n=(o,l)=>{""===l?e.formatter.remove(o,{value:null},t,!0):e.formatter.apply(o,{value:l},t)};return{setAttrib:l,setStyle:r,setFormat:n}},l$={normal:lV},lz=ew("th"),lW=(e,t)=>e&&t?"sectionCells":e?"section":"cells",lU=e=>{let t="thead"===e.section,o=e4(lG(e.cells),"th");return"tfoot"===e.section?{type:"footer"}:t||o?{type:"header",subType:lW(t,o)}:{type:"body"}},lG=e=>{let t=U(e,e=>lz(e.element));return 0===t.length?T.some("td"):t.length===e.length?T.some("th"):T.none()},lK=e=>{let t=V(e,e=>lU(e).type),o=j(t,"header"),l=j(t,"footer");if(!o&&!l)return T.some("body");{let r=j(t,"body");return!o||r||l?o||r||!l?T.none():T.some("footer"):T.some("header")}},lJ=e=>{let t,o=!1;return(...l)=>(o||(o=!0,t=e.apply(null,l)),t)},lQ=(e,t)=>er(e.all,e=>Q(e.cells,e=>ex(t,e.element))),lX=(e,t,o)=>{let l=V(t.selection,t=>tD(t).bind(t=>lQ(e,t)).filter(o)),r=e5(l);return e8(r.length>0,r)},lY=(e,t)=>t.mergable,lZ=(e,t)=>t.unmergable,l0=(e,t)=>lX(e,t,v),l1=(e,t)=>lQ(e,t).exists(e=>!e.isLocked),l2=(e,t)=>Z(t,t=>l1(e,t)),l3=(e,t)=>lY(e,t).filter(t=>l2(e,t.cells)),l4=(e,t)=>lZ(e,t).filter(t=>l2(e,t)),l5=e=>{if(!s(e))throw Error("cases must be an array");if(0===e.length)throw Error("there must be at least one case");let t=[],o={};return $(e,(l,r)=>{let n=x(l);if(1!==n.length)throw Error("one and only one name per case");let a=n[0],i=l[a];if(void 0!==o[a])throw Error("duplicate key detected:"+a);if("cata"===a)throw Error("cannot have a case named cata (sorry)");if(!s(i))throw Error("case arguments must be an array");t.push(a),o[a]=(...o)=>{let l=o.length;if(l!==i.length)throw Error("Wrong number of arguments to case "+a+". Expected "+i.length+" ("+i+"), got "+l);let n=e=>{let l=x(e);if(t.length!==l.length)throw Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+l.join(","));let r=Z(t,e=>j(l,e));if(!r)throw Error("Not all branches were specified when using match. Specified: "+l.join(", ")+"\nRequired: "+t.join(", "));return e[a].apply(null,o)};return{fold:(...t)=>{if(t.length!==e.length)throw Error("Wrong number of arguments to fold. Expected "+e.length+", got "+t.length);let l=t[r];return l.apply(null,o)},match:n,log:e=>{console.log(e,{constructors:t,constructor:a,params:o})}}}}),o},l6=({generate:l5}).generate([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]);({...l6});let l9=(e,t)=>{let o=tJ.fromTable(e),l=l0(o,t);return l.bind(e=>{let t=e[e.length-1],l=e[0].row,r=t.row+t.rowspan,n=o.all.slice(l,r);return lK(n)}).getOr("")},l8=e=>to(e,"rgb")?lx(e):e,l7=e=>{let t=em.fromDom(e);return{borderwidth:tb(t,"border-width").getOr(""),borderstyle:tb(t,"border-style").getOr(""),bordercolor:tb(t,"border-color").map(l8).getOr(""),backgroundcolor:tb(t,"background-color").map(l8).getOr("")}},re=e=>{let t=e[0],o=e.slice(1);return $(o,e=>{$(x(t),o=>{R(e,(e,l)=>{let r=t[o];""!==r&&o===l&&r!==e&&(t[o]="")})})}),t},rt=(e,t,o,l)=>Q(e,e=>!c(o.formatter.matchNode(l,t+e))).getOr(""),ro=w(rt,["left","center","right"],"align"),rl=w(rt,["top","middle","bottom"],"valign"),rr=(e,t)=>{let o=ov(e),l=oT(e),r=t?{borderstyle:P(o,"border-style").getOr(""),bordercolor:l8(P(o,"border-color").getOr("")),backgroundcolor:l8(P(o,"background-color").getOr(""))}:{},n={height:"",width:"100%",cellspacing:"",cellpadding:"",caption:!1,class:"",align:"",border:"",...o,...l,...r,...(()=>{let t=o["border-width"];return op(e)&&t?{border:t}:P(l,"border").fold(()=>({}),e=>({border:e}))})(),...(()=>{let e=P(o,"border-spacing").or(P(l,"cellspacing")).fold(()=>({}),e=>({cellspacing:e})),t=P(o,"border-padding").or(P(l,"cellpadding")).fold(()=>({}),e=>({cellpadding:e}));return{...e,...t}})()};return n},rn=e=>tN(em.fromDom(e)).map(t=>{let o={selection:o8(e.cells)};return l9(t,o)}).getOr(""),ra=(e,t,o)=>{let l=e.dom,r=op(e)?l.getStyle(t,"border-spacing")||l.getAttrib(t,"cellspacing"):l.getAttrib(t,"cellspacing")||l.getStyle(t,"border-spacing"),n=op(e)?tX(l,t,"padding")||l.getAttrib(t,"cellpadding"):l.getAttrib(t,"cellpadding")||tX(l,t,"padding");return{width:l.getStyle(t,"width")||l.getAttrib(t,"width"),height:l.getStyle(t,"height")||l.getAttrib(t,"height"),cellspacing:null!=r?r:"",cellpadding:null!=n?n:"",border:((t,o)=>{let l=tb(em.fromDom(o),"border-width");return op(e)&&l.isSome()?l.getOr(""):t.getAttrib(o,"border")||tX(e.dom,o,"border-width")||tX(e.dom,o,"border")||""})(l,t),caption:!!l.select("caption",t)[0],class:l.getAttrib(t,"class",""),align:ro(e,t),...o?l7(t):{}}},rs=(e,t,o)=>{let l=e.dom;return{height:l.getStyle(t,"height")||l.getAttrib(t,"height"),class:l.getAttrib(t,"class",""),type:rn(t),align:ro(e,t),...o?l7(t):{}}},ri=(e,t,o,l)=>{let r=e.dom,n=l.getOr(t),a=(e,t)=>r.getStyle(e,t)||r.getAttrib(e,t);return{width:a(n,"width"),height:a(t,"height"),scope:r.getAttrib(t,"scope"),celltype:ox(t),class:r.getAttrib(t,"class",""),halign:ro(e,t),valign:rl(e,t),...o?l7(t):{}}},rc=(e,t)=>{let o=tJ.fromTable(e),l=tJ.justCells(o),r=U(l,e=>L(t,t=>ex(e.element,t)));return V(r,e=>({element:e.element.dom,column:tJ.getColumnAt(o,e.column).map(e=>e.element.dom)}))},rm=(e,t,o,l)=>{l("scope")&&e.setAttrib("scope",o.scope),l("class")&&e.setAttrib("class",o.class),l("height")&&e.setStyle("height",oO(o.height)),l("width")&&t.setStyle("width",oO(o.width))},rd=(e,t,o)=>{o("backgroundcolor")&&e.setFormat("tablecellbackgroundcolor",t.backgroundcolor),o("bordercolor")&&e.setFormat("tablecellbordercolor",t.bordercolor),o("borderstyle")&&e.setFormat("tablecellborderstyle",t.borderstyle),o("borderwidth")&&e.setFormat("tablecellborderwidth",oO(t.borderwidth))},ru=(e,t,o,l)=>{let r=1===t.length;$(t,t=>{let n=t.element,a=r?v:l,s=l$.normal(e,n),i=t.column.map(t=>l$.normal(e,t)).getOr(s);rm(s,i,o,a),oi(e)&&rd(s,o,a),l("halign")&&tY(e,n,o.halign),l("valign")&&tZ(e,n,o.valign)})},rp=(e,t)=>{e.execCommand("mceTableCellType",!1,{type:t.celltype,no_events:!0})},rb=(e,t,o,l)=>{let r=D(l,(e,t)=>o[t]!==e);N(r)>0&&t.length>=1&&tN(t[0]).each(o=>{let n=rc(o,t),a=N(D(r,(e,t)=>"scope"!==t&&"celltype"!==t))>0,s=k(r,"celltype");(a||k(r,"scope"))&&ru(e,n,l,w(k,r)),s&&rp(e,l),t0(e,o.dom,{structure:s,style:a})})},rg=(e,t,o,l)=>{let r=l.getData();l.close(),e.undoManager.transact(()=>{rb(e,t,o,r),e.focus()})},rh=(e,t)=>{let o=tN(t[0]).map(o=>V(rc(o,t),t=>ri(e,t.element,oi(e),t.column)));return re(o.getOrDie())},rf=e=>{let t=ls(e);if(0===t.length)return;let o=rh(e,t),l={type:"tabpanel",tabs:[{title:"General",name:"general",items:lL(e)},lH(e,"cell")]},r={type:"panel",items:[{type:"grid",columns:2,items:lL(e)}]};e.windowManager.open({title:"Cell Properties",size:"normal",body:oi(e)?l:r,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:o,onSubmit:w(rg,e,t,o)})},ry=e=>{let t=lI(og(e));return t.length>0?T.some({name:"class",type:"listbox",label:"Class",items:t}):T.none()},rw=[{type:"listbox",name:"type",label:"Row type",items:[{text:"Header",value:"header"},{text:"Body",value:"body"},{text:"Footer",value:"footer"}]},{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height",type:"input"}],rS=e=>rw.concat(ry(e).toArray()),rC=(e,t,o)=>{o("class")&&e.setAttrib("class",t.class),o("height")&&e.setStyle("height",oO(t.height))},rv=(e,t,o)=>{o("backgroundcolor")&&e.setStyle("background-color",t.backgroundcolor),o("bordercolor")&&e.setStyle("border-color",t.bordercolor),o("borderstyle")&&e.setStyle("border-style",t.borderstyle)},rT=(e,t,o,l)=>{let r=1===t.length,n=r?v:l;$(t,t=>{let r=l$.normal(e,t);rC(r,o,n),oc(e)&&rv(r,o,n),l("align")&&tY(e,t,o.align)})},rx=(e,t)=>{e.execCommand("mceTableRowType",!1,{type:t.type,no_events:!0})},rA=(e,t,o,l)=>{let r=D(l,(e,t)=>o[t]!==e);if(N(r)>0){let n=k(r,"type"),a=!n||N(r)>1;a&&rT(e,t,l,w(k,r)),n&&rx(e,l),tN(em.fromDom(t[0])).each(t=>t0(e,t.dom,{structure:n,style:a}))}},rR=(e,t,o,l)=>{let r=l.getData();l.close(),e.undoManager.transact(()=>{rA(e,t,o,r),e.focus()})},r_=e=>{let t=li(oD(e),lo.selected);if(0===t.length)return;let o=V(t,t=>rs(e,t.dom,oc(e))),l=re(o),r={type:"tabpanel",tabs:[{title:"General",name:"general",items:rS(e)},lH(e,"row")]},n={type:"panel",items:[{type:"grid",columns:2,items:rS(e)}]};e.windowManager.open({title:"Row Properties",size:"normal",body:oc(e)?r:n,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:l,onSubmit:w(rR,e,V(t,e=>e.dom),l)})},rO=(e,t,o)=>{let l=od(e)?[{type:"input",name:"cellspacing",label:"Cell spacing",inputMode:"numeric"},{type:"input",name:"cellpadding",label:"Cell padding",inputMode:"numeric"},{type:"input",name:"border",label:"Border width"},{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[],r=t.length>0?[{type:"listbox",name:"class",label:"Class",items:t}]:[];return(o?[{type:"input",name:"cols",label:"Cols",inputMode:"numeric"},{type:"input",name:"rows",label:"Rows",inputMode:"numeric"}]:[]).concat([{type:"input",name:"width",label:"Width"},{type:"input",name:"height",label:"Height"}]).concat(l).concat([{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}]).concat(r)},rD=(e,t,o,l)=>{if("TD"===t.tagName||"TH"===t.tagName)a(o)&&d(l)?e.setStyle(t,o,l):e.setStyles(t,o);else if(t.children)for(let r=0;r<t.children.length;r++)rD(e,t.children[r],o,l)},rI=(e,t,o)=>{let l=e.dom,r={},n={};if(c(o.class)||(r.class=o.class),n.height=oO(o.height),op(e)?n.width=oO(o.width):l.getAttrib(t,"width")&&(r.width=o_(o.width)),op(e)?(n["border-width"]=oO(o.border),n["border-spacing"]=oO(o.cellspacing)):(r.border=o.border,r.cellpadding=o.cellpadding,r.cellspacing=o.cellspacing),op(e)&&t.children)for(let a=0;a<t.children.length;a++)rD(l,t.children[a],{"border-width":oO(o.border),padding:oO(o.cellpadding)}),om(e)&&rD(l,t.children[a],{"border-color":o.bordercolor});om(e)&&(n["background-color"]=o.backgroundcolor,n["border-color"]=o.bordercolor,n["border-style"]=o.borderstyle),r.style=l.serializeStyle({...ov(e),...n}),l.setAttribs(t,{...oT(e),...r})},rM=(e,t,o,l)=>{let r=e.dom,n=l.getData(),a=D(n,(e,t)=>o[t]!==e);l.close(),""===n.class&&delete n.class,e.undoManager.transact(()=>{if(!t){let o=ta(n.cols).getOr(1),l=ta(n.rows).getOr(1);e.execCommand("mceInsertTable",!1,{rows:l,columns:o}),t=la(oD(e),oR(e)).bind(t=>tN(t,oR(e))).map(e=>e.dom).getOrDie()}if(N(a)>0){rI(e,t,n);let s=r.select("caption",t)[0];(s&&!n.caption||!s&&n.caption)&&e.execCommand("mceTableToggleCaption"),tY(e,t,n.align)}if(e.focus(),e.addVisual(),N(a)>0){let i=k(a,"caption"),c=!i||N(a)>1;t0(e,t,{structure:i,style:c})}})},rN=(e,t)=>{let o;let l=e.dom,r=rr(e,om(e));t?(r.cols="1",r.rows="1",om(e)&&(r.borderstyle="",r.bordercolor="",r.backgroundcolor="")):(o=l.getParent(e.selection.getStart(),"table",e.getBody()))?r=ra(e,o,om(e)):om(e)&&(r.borderstyle="",r.bordercolor="",r.backgroundcolor="");let n=lI(oh(e));n.length>0&&r.class&&(r.class=r.class.replace(/\s*mce\-item\-table\s*/g,""));let a={type:"grid",columns:2,items:rO(e,n,t)},s=om(e)?{type:"tabpanel",tabs:[{title:"General",name:"general",items:[a]},lH(e,"table")]}:{type:"panel",items:[a]};e.windowManager.open({title:"Table Properties",size:"normal",body:s,onSubmit:w(rM,e,o,r),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:r})},rP=e=>{R({mceTableProps:w(rN,e,!1),mceTableRowProps:w(r_,e),mceTableCellProps:w(rf,e)},(t,o)=>e.addCommand(o,()=>t())),e.addCommand("mceInsertTableDialog",t=>{rN(e,!0)})},rk=(e,t)=>eK(e,t).isSome(),rB=e=>{let t=(e,t)=>e1(e,t).exists(e=>parseInt(e,10)>1),o=e=>t(e,"rowspan")||t(e,"colspan");return e.length>0&&Z(e,o)?T.some(e):T.none()},rE=(e,t,o)=>t.length<=1?T.none():o9(e,o.firstSelectedSelector,o.lastSelectedSelector).map(e=>({bounds:e,cells:t})),rF=e=>({element:e,mergable:T.none(),unmergable:T.none(),selection:[e]}),rq=(e,t,o)=>({element:o,mergable:rE(t,e,lo),unmergable:rB(e),selection:f(e)}),rj=e=>{let t=lA(T.none()),o=lA([]),l=T.none(),r=ew("caption"),n=e=>l.forall(t=>!t[e]),a=()=>ln(oD(e),oR(e)),s=()=>ln(oI(e),oR(e)),i=()=>a().bind(t=>e9(e6(tN(t),s().bind(tN),(o,l)=>ex(o,l)?r(t)?T.some(rF(t)):T.some(rq(ls(e),o,t)):T.none()))),c=e=>{let t=tN(e.element);return t.map(t=>{let o=tJ.fromTable(t),l=l0(o,e).getOr([]),r=K(l,(e,t)=>(t.isLocked&&(e.onAny=!0,0===t.column?e.onFirst=!0:t.column+t.colspan>=o.grid.columns&&(e.onLast=!0)),e),{onAny:!1,onFirst:!1,onLast:!1});return{mergeable:l3(o,e).isSome(),unmergeable:l4(o,e).isSome(),locked:r}})},m=()=>{t.set(lJ(i)()),l=t.get().bind(c),$(o.get(),S)},d=e=>(e(),o.set(o.get().concat([e])),()=>{o.set(U(o.get(),t=>t!==e))}),u=(e,o)=>d(()=>t.get().fold(()=>{e.setEnabled(!1)},t=>{e.setEnabled(!o(t))})),p=(e,o,l)=>d(()=>t.get().fold(()=>{e.setEnabled(!1),e.setActive(!1)},t=>{e.setEnabled(!o(t)),e.setActive(l(t))})),b=e=>l.exists(t=>t.locked[e]),g=e=>u(e,e=>!1),h=e=>u(e,e=>r(e.element)),f=e=>t=>u(t,t=>r(t.element)||b(e)),y=e=>t=>u(t,t=>r(t.element)||e().isNone()),w=(e,t)=>o=>u(o,o=>r(o.element)||e().isNone()||b(t)),v=e=>u(e,e=>n("mergeable")),x=e=>u(e,e=>n("unmergeable")),A=t=>p(t,C,t=>{let o=tN(t.element,oR(e));return o.exists(e=>rk(e,"caption"))}),R=(t,o)=>l=>p(l,e=>r(e.element),()=>e.queryCommandValue(t)===o),_=R("mceTableRowType","header"),O=R("mceTableColType","th");return e.on("NodeChange ExecCommand TableSelectorChange",m),{onSetupTable:g,onSetupCellOrRow:h,onSetupColumn:f,onSetupPasteable:y,onSetupPasteableColumn:w,onSetupMergeable:v,onSetupUnmergeable:x,resetTargets:m,onSetupTableWithCaption:A,onSetupTableRowHeaders:_,onSetupTableColumnHeaders:O,targets:t.get}};var rL=tinymce.util.Tools.resolve("tinymce.FakeClipboard");let rH="x-tinymce/dom-table-",rV=rH+"rows",r$=rH+"columns",rz=e=>{var t;let o=null!==(t=rL.read())&&void 0!==t?t:[];return er(o,t=>T.from(t.getType(e)))},rW=()=>rz(rV),rU=()=>rz(r$),rG=(e,t)=>{e.ui.registry.addMenuButton("table",{tooltip:"Table",icon:"table",fetch:e=>e("inserttable | cell row column | advtablesort | tableprops deletetable")});let o=t=>()=>e.execCommand(t),l=(t,l)=>{e.queryCommandSupported(l.command)&&e.ui.registry.addButton(t,{...l,onAction:u(l.onAction)?l.onAction:o(l.command)})},r=(t,l)=>{e.queryCommandSupported(l.command)&&e.ui.registry.addToggleButton(t,{...l,onAction:u(l.onAction)?l.onAction:o(l.command)})};l("tableprops",{tooltip:"Table properties",command:"mceTableProps",icon:"table",onSetup:t.onSetupTable}),l("tabledelete",{tooltip:"Delete table",command:"mceTableDelete",icon:"table-delete-table",onSetup:t.onSetupTable}),l("tablecellprops",{tooltip:"Cell properties",command:"mceTableCellProps",icon:"table-cell-properties",onSetup:t.onSetupCellOrRow}),l("tablemergecells",{tooltip:"Merge cells",command:"mceTableMergeCells",icon:"table-merge-cells",onSetup:t.onSetupMergeable}),l("tablesplitcells",{tooltip:"Split cell",command:"mceTableSplitCells",icon:"table-split-cells",onSetup:t.onSetupUnmergeable}),l("tableinsertrowbefore",{tooltip:"Insert row before",command:"mceTableInsertRowBefore",icon:"table-insert-row-above",onSetup:t.onSetupCellOrRow}),l("tableinsertrowafter",{tooltip:"Insert row after",command:"mceTableInsertRowAfter",icon:"table-insert-row-after",onSetup:t.onSetupCellOrRow}),l("tabledeleterow",{tooltip:"Delete row",command:"mceTableDeleteRow",icon:"table-delete-row",onSetup:t.onSetupCellOrRow}),l("tablerowprops",{tooltip:"Row properties",command:"mceTableRowProps",icon:"table-row-properties",onSetup:t.onSetupCellOrRow}),l("tableinsertcolbefore",{tooltip:"Insert column before",command:"mceTableInsertColBefore",icon:"table-insert-column-before",onSetup:t.onSetupColumn("onFirst")}),l("tableinsertcolafter",{tooltip:"Insert column after",command:"mceTableInsertColAfter",icon:"table-insert-column-after",onSetup:t.onSetupColumn("onLast")}),l("tabledeletecol",{tooltip:"Delete column",command:"mceTableDeleteCol",icon:"table-delete-column",onSetup:t.onSetupColumn("onAny")}),l("tablecutrow",{tooltip:"Cut row",command:"mceTableCutRow",icon:"cut-row",onSetup:t.onSetupCellOrRow}),l("tablecopyrow",{tooltip:"Copy row",command:"mceTableCopyRow",icon:"duplicate-row",onSetup:t.onSetupCellOrRow}),l("tablepasterowbefore",{tooltip:"Paste row before",command:"mceTablePasteRowBefore",icon:"paste-row-before",onSetup:t.onSetupPasteable(rW)}),l("tablepasterowafter",{tooltip:"Paste row after",command:"mceTablePasteRowAfter",icon:"paste-row-after",onSetup:t.onSetupPasteable(rW)}),l("tablecutcol",{tooltip:"Cut column",command:"mceTableCutCol",icon:"cut-column",onSetup:t.onSetupColumn("onAny")}),l("tablecopycol",{tooltip:"Copy column",command:"mceTableCopyCol",icon:"duplicate-column",onSetup:t.onSetupColumn("onAny")}),l("tablepastecolbefore",{tooltip:"Paste column before",command:"mceTablePasteColBefore",icon:"paste-column-before",onSetup:t.onSetupPasteableColumn(rU,"onFirst")}),l("tablepastecolafter",{tooltip:"Paste column after",command:"mceTablePasteColAfter",icon:"paste-column-after",onSetup:t.onSetupPasteableColumn(rU,"onLast")}),l("tableinsertdialog",{tooltip:"Insert table",command:"mceInsertTableDialog",icon:"table"});let n=lP(oh(e));0!==n.length&&e.queryCommandSupported("mceTableToggleClass")&&e.ui.registry.addMenuButton("tableclass",{icon:"table-classes",tooltip:"Table styles",fetch:lk(e,n,"tableclass",t=>e.execCommand("mceTableToggleClass",!1,t)),onSetup:t.onSetupTable});let a=lP(ob(e));0!==a.length&&e.queryCommandSupported("mceTableCellToggleClass")&&e.ui.registry.addMenuButton("tablecellclass",{icon:"table-cell-classes",tooltip:"Cell styles",fetch:lk(e,a,"tablecellclass",t=>e.execCommand("mceTableCellToggleClass",!1,t)),onSetup:t.onSetupCellOrRow}),e.queryCommandSupported("mceTableApplyCellStyle")&&(e.ui.registry.addMenuButton("tablecellvalign",{icon:"vertical-align",tooltip:"Vertical align",fetch:lk(e,lc,"tablecellverticalalign",lN(e,"vertical-align")),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellborderwidth",{icon:"border-width",tooltip:"Border width",fetch:lk(e,oa(e),"tablecellborderwidth",lN(e,"border-width")),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellborderstyle",{icon:"border-style",tooltip:"Border style",fetch:lk(e,os(e),"tablecellborderstyle",lN(e,"border-style")),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellbackgroundcolor",{icon:"cell-background-color",tooltip:"Background color",fetch:t=>t(lB(e,oy(e),"background-color")),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellbordercolor",{icon:"cell-border-color",tooltip:"Border color",fetch:t=>t(lB(e,ow(e),"border-color")),onSetup:t.onSetupCellOrRow})),r("tablecaption",{tooltip:"Table caption",icon:"table-caption",command:"mceTableToggleCaption",onSetup:t.onSetupTableWithCaption}),r("tablerowheader",{tooltip:"Row header",icon:"table-top-header",command:"mceTableRowType",onAction:lE(e),onSetup:t.onSetupTableRowHeaders}),r("tablecolheader",{tooltip:"Column header",icon:"table-left-header",command:"mceTableColType",onAction:lF(e),onSetup:t.onSetupTableColumnHeaders})},rK=e=>{let t=t=>e.dom.is(t,"table")&&e.getBody().contains(t),o=of(e);o.length>0&&e.ui.registry.addContextToolbar("table",{predicate:t,items:o,scope:"node",position:"node"})},rJ=(e,t)=>{let o=t=>()=>e.execCommand(t),l=(t,l)=>!!e.queryCommandSupported(l.command)&&(e.ui.registry.addMenuItem(t,{...l,onAction:u(l.onAction)?l.onAction:o(l.command)}),!0),r=(t,l)=>{e.queryCommandSupported(l.command)&&e.ui.registry.addToggleMenuItem(t,{...l,onAction:u(l.onAction)?l.onAction:o(l.command)})},n=t=>{e.execCommand("mceInsertTable",!1,{rows:t.numRows,columns:t.numColumns})},a=[l("tableinsertrowbefore",{text:"Insert row before",icon:"table-insert-row-above",command:"mceTableInsertRowBefore",onSetup:t.onSetupCellOrRow}),l("tableinsertrowafter",{text:"Insert row after",icon:"table-insert-row-after",command:"mceTableInsertRowAfter",onSetup:t.onSetupCellOrRow}),l("tabledeleterow",{text:"Delete row",icon:"table-delete-row",command:"mceTableDeleteRow",onSetup:t.onSetupCellOrRow}),l("tablerowprops",{text:"Row properties",icon:"table-row-properties",command:"mceTableRowProps",onSetup:t.onSetupCellOrRow}),l("tablecutrow",{text:"Cut row",icon:"cut-row",command:"mceTableCutRow",onSetup:t.onSetupCellOrRow}),l("tablecopyrow",{text:"Copy row",icon:"duplicate-row",command:"mceTableCopyRow",onSetup:t.onSetupCellOrRow}),l("tablepasterowbefore",{text:"Paste row before",icon:"paste-row-before",command:"mceTablePasteRowBefore",onSetup:t.onSetupPasteable(rW)}),l("tablepasterowafter",{text:"Paste row after",icon:"paste-row-after",command:"mceTablePasteRowAfter",onSetup:t.onSetupPasteable(rW)})],s=[l("tableinsertcolumnbefore",{text:"Insert column before",icon:"table-insert-column-before",command:"mceTableInsertColBefore",onSetup:t.onSetupColumn("onFirst")}),l("tableinsertcolumnafter",{text:"Insert column after",icon:"table-insert-column-after",command:"mceTableInsertColAfter",onSetup:t.onSetupColumn("onLast")}),l("tabledeletecolumn",{text:"Delete column",icon:"table-delete-column",command:"mceTableDeleteCol",onSetup:t.onSetupColumn("onAny")}),l("tablecutcolumn",{text:"Cut column",icon:"cut-column",command:"mceTableCutCol",onSetup:t.onSetupColumn("onAny")}),l("tablecopycolumn",{text:"Copy column",icon:"duplicate-column",command:"mceTableCopyCol",onSetup:t.onSetupColumn("onAny")}),l("tablepastecolumnbefore",{text:"Paste column before",icon:"paste-column-before",command:"mceTablePasteColBefore",onSetup:t.onSetupPasteableColumn(rU,"onFirst")}),l("tablepastecolumnafter",{text:"Paste column after",icon:"paste-column-after",command:"mceTablePasteColAfter",onSetup:t.onSetupPasteableColumn(rU,"onLast")})],i=[l("tablecellprops",{text:"Cell properties",icon:"table-cell-properties",command:"mceTableCellProps",onSetup:t.onSetupCellOrRow}),l("tablemergecells",{text:"Merge cells",icon:"table-merge-cells",command:"mceTableMergeCells",onSetup:t.onSetupMergeable}),l("tablesplitcells",{text:"Split cell",icon:"table-split-cells",command:"mceTableSplitCells",onSetup:t.onSetupUnmergeable})];ou(e)?e.ui.registry.addNestedMenuItem("inserttable",{text:"Table",icon:"table",getSubmenuItems:()=>[{type:"fancymenuitem",fancytype:"inserttable",onAction:n}]}):e.ui.registry.addMenuItem("inserttable",{text:"Table",icon:"table",onAction:o("mceInsertTableDialog")}),e.ui.registry.addMenuItem("inserttabledialog",{text:"Insert table",icon:"table",onAction:o("mceInsertTableDialog")}),l("tableprops",{text:"Table properties",onSetup:t.onSetupTable,command:"mceTableProps"}),l("deletetable",{text:"Delete table",icon:"table-delete-table",onSetup:t.onSetupTable,command:"mceTableDelete"}),j(a,!0)&&e.ui.registry.addNestedMenuItem("row",{type:"nestedmenuitem",text:"Row",getSubmenuItems:h("tableinsertrowbefore tableinsertrowafter tabledeleterow tablerowprops | tablecutrow tablecopyrow tablepasterowbefore tablepasterowafter")}),j(s,!0)&&e.ui.registry.addNestedMenuItem("column",{type:"nestedmenuitem",text:"Column",getSubmenuItems:h("tableinsertcolumnbefore tableinsertcolumnafter tabledeletecolumn | tablecutcolumn tablecopycolumn tablepastecolumnbefore tablepastecolumnafter")}),j(i,!0)&&e.ui.registry.addNestedMenuItem("cell",{type:"nestedmenuitem",text:"Cell",getSubmenuItems:h("tablecellprops tablemergecells tablesplitcells")}),e.ui.registry.addContextMenu("table",{update:()=>(t.resetTargets(),t.targets().fold(h(""),e=>"caption"===ed(e.element)?"tableprops deletetable":"cell row column | advtablesort | tableprops deletetable"))});let c=lP(oh(e));0!==c.length&&e.queryCommandSupported("mceTableToggleClass")&&e.ui.registry.addNestedMenuItem("tableclass",{icon:"table-classes",text:"Table styles",getSubmenuItems:()=>lM(e,c,"tableclass",t=>e.execCommand("mceTableToggleClass",!1,t)),onSetup:t.onSetupTable});let m=lP(ob(e));0!==m.length&&e.queryCommandSupported("mceTableCellToggleClass")&&e.ui.registry.addNestedMenuItem("tablecellclass",{icon:"table-cell-classes",text:"Cell styles",getSubmenuItems:()=>lM(e,m,"tablecellclass",t=>e.execCommand("mceTableCellToggleClass",!1,t)),onSetup:t.onSetupCellOrRow}),e.queryCommandSupported("mceTableApplyCellStyle")&&(e.ui.registry.addNestedMenuItem("tablecellvalign",{icon:"vertical-align",text:"Vertical align",getSubmenuItems:()=>lM(e,lc,"tablecellverticalalign",lN(e,"vertical-align")),onSetup:t.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellborderwidth",{icon:"border-width",text:"Border width",getSubmenuItems:()=>lM(e,oa(e),"tablecellborderwidth",lN(e,"border-width")),onSetup:t.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellborderstyle",{icon:"border-style",text:"Border style",getSubmenuItems:()=>lM(e,os(e),"tablecellborderstyle",lN(e,"border-style")),onSetup:t.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellbackgroundcolor",{icon:"cell-background-color",text:"Background color",getSubmenuItems:()=>lB(e,oy(e),"background-color"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellbordercolor",{icon:"cell-border-color",text:"Border color",getSubmenuItems:()=>lB(e,ow(e),"border-color"),onSetup:t.onSetupCellOrRow})),r("tablecaption",{icon:"table-caption",text:"Table caption",command:"mceTableToggleCaption",onSetup:t.onSetupTableWithCaption}),r("tablerowheader",{text:"Row header",icon:"table-top-header",command:"mceTableRowType",onAction:lE(e),onSetup:t.onSetupTableRowHeaders}),r("tablecolheader",{text:"Column header",icon:"table-left-header",command:"mceTableColType",onAction:lF(e),onSetup:t.onSetupTableRowHeaders})},rQ=e=>{let t=rj(e);or(e),rP(e),rJ(e,t),rG(e,t),rK(e)};t.add("table",rQ)}();