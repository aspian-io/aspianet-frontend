!function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager");let t=e=>t=>t.options.get(e),n=t("autolink_pattern"),r=t("link_default_target"),o=t("link_default_protocol"),l=t("allow_unsafe_link_target"),a=e=>"string"===(e=>{var t,n;let r=typeof e;return null===e?"null":"object"===r&&Array.isArray(e)?"array":"object"===r&&((t=String).prototype.isPrototypeOf(e)||(null===(n=e.constructor)||void 0===n?void 0:n.name)===t.name)?"string":r})(e),i=e=>void 0===e,s=e=>null!=e,d=Object.hasOwnProperty,u=e=>"\uFEFF"===e;var c=tinymce.util.Tools.resolve("tinymce.dom.TextSeeker");let g=e=>/^[(\[{ \u00a0]$/.test(e),f=(e,t,n)=>{for(let r=t-1;r>=0;r--){let t=e.charAt(r);if(!u(t)&&n(t))return r}return -1},m=(e,t)=>{var r,l,a,s;let u=e.schema.getVoidElements(),m=n(e),{dom:k,selection:p}=e;if(null!==k.getParent(p.getNode(),"a[href]"))return null;let y=p.getRng(),h=c(k,e=>{var t;return k.isBlock(e)||(t=e.nodeName.toLowerCase(),d.call(u,t))||"false"===k.getContentEditable(e)}),{container:w,offset:v}=((e,t)=>{let n=e,r=t;for(;1===n.nodeType&&n.childNodes[r];)r=3===(n=n.childNodes[r]).nodeType?n.data.length:n.childNodes.length;return{container:n,offset:r}})(y.endContainer,y.endOffset),_=null!==(r=k.getParent(w,k.isBlock))&&void 0!==r?r:k.getRoot(),A=h.backwards(w,v+t,(e,t)=>{var n;let r=e.data,o=f(r,t,e=>!g(e));return -1===o||(n=r[o],/[?!,.;:]/.test(n))?o:o+1},_);if(!A)return null;let C=A.container,b=h.backwards(A.container,A.offset,(e,t)=>{C=e;let n=f(e.data,t,g);return -1===n?n:n+1},_),E=k.createRng();b?E.setStart(b.container,b.offset):E.setStart(C,0),E.setEnd(A.container,A.offset);let $=E.toString().replace(/\uFEFF/g,"").match(m);if($){let t=$[0];return a="www.",(l=t).length>=a.length&&l.substr(0,0+a.length)===a?t=o(e)+"://"+t:((e,t,n=0,r)=>{let o=e.indexOf(t,n);return -1!==o&&(!!i(r)||o+t.length<=r)})(t,"@")&&(s=t,!/^([A-Za-z][A-Za-z\d.+-]*:\/\/)|mailto:/.test(s))&&(t="mailto:"+t),{rng:E,url:t}}return null},k=(e,t)=>{let{dom:n,selection:o}=e,{rng:i,url:s}=t,d=o.getBookmark();o.setRng(i);let u="createlink",c={command:u,ui:!1,value:s};if(!e.dispatch("BeforeExecCommand",c).isDefaultPrevented()){e.getDoc().execCommand(u,!1,s),e.dispatch("ExecCommand",c);let t=r(e);if(a(t)){let r=o.getNode();n.setAttrib(r,"target",t),"_blank"!==t||l(e)||n.setAttrib(r,"rel","noopener")}}o.moveToBookmark(d),e.nodeChanged()},p=e=>{let t=m(e,-1);s(t)&&k(e,t)};e.add("autolink",e=>{(e=>{let t=e.options.register;t("autolink_pattern",{processor:"regexp",default:RegExp("^"+/(?:[A-Za-z][A-Za-z\d.+-]{0,14}:\/\/(?:[-.~*+=!&;:'%@?^${}(),\w]+@)?|www\.|[-;:&=+$,.\w]+@)[A-Za-z\d-]+(?:\.[A-Za-z\d-]+)*(?::\d+)?(?:\/(?:[-.~*+=!;:'%@$(),\/\w]*[-~*+=%@$()\/\w])?)?(?:\?(?:[-.~*+=!&;:'%@?^${}(),\/\w]+))?(?:#(?:[-.~*+=!&;:'%@?^${}(),\/\w]+))?/g.source+"$","i")}),t("link_default_target",{processor:"string"}),t("link_default_protocol",{processor:"string",default:"https"})})(e),e.on("keydown",t=>{13!==t.keyCode||t.isDefaultPrevented()||(e=>{let t=m(e,0);s(t)&&k(e,t)})(e)}),e.on("keyup",t=>{32===t.keyCode?p(e):(48===t.keyCode&&t.shiftKey||221===t.keyCode)&&p(e)})})}();