!function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager");let t=(e,t,r)=>{var o;return!!r(e,t.prototype)||(null===(o=e.constructor)||void 0===o?void 0:o.name)===t.name},r=e=>{let r=typeof e;return null===e?"null":"object"===r&&Array.isArray(e)?"array":"object"===r&&t(e,String,(e,t)=>t.isPrototypeOf(e))?"string":r},o=e=>t=>typeof t===e,i=e=>"string"===r(e),n=o("boolean"),l=e=>null==e,a=e=>!l(e),s=o("function"),u=e=>t=>t.options.get(e),c=e=>{let t=e.options.register,r=e=>t=>{let r=n(t)||i(t);return r?n(t)?{value:t?e:"",valid:r}:{value:t.trim(),valid:r}:{valid:!1,message:"Must be a boolean or string."}},o="bold italic | quicklink h2 h3 blockquote";t("quickbars_selection_toolbar",{processor:r(o),default:o});let l="quickimage quicktable";t("quickbars_insert_toolbar",{processor:r(l),default:l});let a="alignleft aligncenter alignright";t("quickbars_image_toolbar",{processor:r(a),default:a})},d=u("quickbars_selection_toolbar"),m=u("quickbars_insert_toolbar"),h=u("quickbars_image_toolbar"),g=0,b=e=>{let t=new Date,r=t.getTime();return e+"_"+Math.floor(1e9*Math.random())+ ++g+String(r)},f=(e,t,r)=>{e.execCommand("mceInsertTable",!1,{rows:r,columns:t})},p=(e,t,r)=>{let o=e.editorUpload.blobCache,i=o.create(b("mceu"),r,t);o.add(i),e.insertContent(e.dom.createHTML("img",{src:i.blobUri()}))},v=e=>new Promise(t=>{let r=new FileReader;r.onloadend=()=>{t(r.result.split(",")[1])},r.readAsDataURL(e)});var y=tinymce.util.Tools.resolve("tinymce.Env"),k=tinymce.util.Tools.resolve("tinymce.util.Delay");let w=e=>new Promise(t=>{let r=document.createElement("input");r.type="file",r.accept="image/*",r.style.position="fixed",r.style.left="0",r.style.top="0",r.style.opacity="0.001",document.body.appendChild(r);let o=e=>{t(Array.prototype.slice.call(e.target.files))};r.addEventListener("change",o);let i=o=>{let n=()=>{var e;t([]),null===(e=r.parentNode)||void 0===e||e.removeChild(r)};y.os.isAndroid()&&"remove"!==o.type?k.setEditorTimeout(e,n,0):n(),e.off("focusin remove",i)};e.on("focusin remove",i),r.click()}),N=e=>{e.ui.registry.addButton("quickimage",{icon:"image",tooltip:"Insert image",onAction:()=>{w(e).then(t=>{if(t.length>0){let r=t[0];v(r).then(t=>{p(e,t,r)})}})}}),e.ui.registry.addButton("quicktable",{icon:"table",tooltip:"Insert table",onAction:()=>{f(e,2,2)}})},T=()=>!1;class q{constructor(e,t){this.tag=e,this.value=t}static some(e){return new q(!0,e)}static none(){return q.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?q.some(e(this.value)):q.none()}bind(e){return this.tag?e(this.value):q.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:q.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw Error(null!=e?e:"Called getOrDie on None")}static from(e){return a(e)?q.some(e):q.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}q.singletonNone=new q(!1),"undefined"!=typeof window?window:Function("return this;")();let E=e=>{let t=e.dom.nodeName;return t.toLowerCase()},M=(e,t)=>{let r=e.dom;return!!r&&!!r.hasAttribute&&r.hasAttribute(t)};var C=(e,t,r,o,i)=>e(r,o)?q.some(r):s(i)&&i(r)?q.none():t(r,o,i);let _=(e,t)=>{let r=(t||document).createElement("div");if(r.innerHTML=e,!r.hasChildNodes()||r.childNodes.length>1){let o="HTML does not have a single root node";throw console.error(o,e),Error(o)}return x(r.childNodes[0])},S=(e,t)=>{let r=(t||document).createElement(e);return x(r)},A=(e,t)=>{let r=(t||document).createTextNode(e);return x(r)},x=e=>{if(null==e)throw Error("Node cannot be null or undefined");return{dom:e}},D=(e,t,r)=>q.from(e.dom.elementFromPoint(t,r)).map(x),O={fromHtml:_,fromTag:S,fromText:A,fromDom:x,fromPoint:D},L=(e,t)=>{let r=e.dom;if(1!==r.nodeType)return!1;if(void 0!==r.matches)return r.matches(t);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t);throw Error("Browser lacks native selectors")},P=(e,t,r)=>{let o=e.dom,i=s(r)?r:T;for(;o.parentNode;){o=o.parentNode;let n=O.fromDom(o);if(t(n))return q.some(n);if(i(n))break}return q.none()},B=(e,t,r)=>{let o=(e,t)=>t(e);return C(o,P,e,t,r)},I=(e,t,r)=>B(e,t,r).isSome(),U=(e,t,r)=>P(e,e=>L(e,t),r),F=(e,t,r)=>{let o=(e,t)=>L(e,t);return C(o,U,e,t,r)},H=e=>{let t=m(e);t.length>0&&e.ui.registry.addContextToolbar("quickblock",{predicate:t=>{let r=O.fromDom(t),o=e.schema.getTextBlockElements(),i=t=>t.dom===e.getBody();return!M(r,"data-mce-bogus")&&F(r,'table,[data-mce-bogus="all"]',i).fold(()=>I(r,t=>E(t) in o&&e.dom.isEmpty(t.dom),i),T)},items:t,position:"line",scope:"editor"})},R=e=>{let t=t=>"false"!==e.dom.getContentEditableParent(t),r=e=>"IMG"===e.nodeName||"FIGURE"===e.nodeName&&/image/i.test(e.className),o=h(e);o.length>0&&e.ui.registry.addContextToolbar("imageselection",{predicate:r,items:o,position:"node"});let i=d(e);i.length>0&&e.ui.registry.addContextToolbar("textselection",{predicate:o=>!r(o)&&!e.selection.isCollapsed()&&t(o),items:i,position:"selection",scope:"editor"})};e.add("quickbars",e=>{c(e),N(e),H(e),R(e)})}();