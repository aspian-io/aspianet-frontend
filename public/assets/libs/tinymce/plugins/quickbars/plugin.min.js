!function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager");let t=e=>t=>typeof t===e,o=e=>"string"===(e=>{var t,o;let r=typeof e;return null===e?"null":"object"===r&&Array.isArray(e)?"array":"object"===r&&((t=String).prototype.isPrototypeOf(e)||(null===(o=e.constructor)||void 0===o?void 0:o.name)===t.name)?"string":r})(e),r=t("boolean"),i=t("function"),n=e=>t=>t.options.get(e),a=n("quickbars_selection_toolbar"),l=n("quickbars_insert_toolbar"),s=n("quickbars_image_toolbar"),u=0;var c=tinymce.util.Tools.resolve("tinymce.Env"),d=tinymce.util.Tools.resolve("tinymce.util.Delay");let m=e=>{e.ui.registry.addButton("quickimage",{icon:"image",tooltip:"Insert image",onAction:()=>{new Promise(t=>{let o=document.createElement("input");o.type="file",o.accept="image/*",o.style.position="fixed",o.style.left="0",o.style.top="0",o.style.opacity="0.001",document.body.appendChild(o),o.addEventListener("change",e=>{t(Array.prototype.slice.call(e.target.files))});let r=i=>{let n=()=>{var e;t([]),null===(e=o.parentNode)||void 0===e||e.removeChild(o)};c.os.isAndroid()&&"remove"!==i.type?d.setEditorTimeout(e,n,0):n(),e.off("focusin remove",r)};e.on("focusin remove",r),o.click()}).then(t=>{if(t.length>0){let o=t[0];new Promise(e=>{let t=new FileReader;t.onloadend=()=>{e(t.result.split(",")[1])},t.readAsDataURL(o)}).then(t=>{((e,t,o)=>{let r=e.editorUpload.blobCache,i=r.create((e=>{let t=(new Date).getTime();return"mceu_"+Math.floor(1e9*Math.random())+ ++u+String(t)})(),o,t);r.add(i),e.insertContent(e.dom.createHTML("img",{src:i.blobUri()}))})(e,t,o)})}})}}),e.ui.registry.addButton("quicktable",{icon:"table",tooltip:"Insert table",onAction:()=>{((e,t,o)=>{e.execCommand("mceInsertTable",!1,{rows:2,columns:2})})(e)}})},h=()=>!1;class g{constructor(e,t){this.tag=e,this.value=t}static some(e){return new g(!0,e)}static none(){return g.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?g.some(e(this.value)):g.none()}bind(e){return this.tag?e(this.value):g.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:g.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw Error(null!=e?e:"Called getOrDie on None")}static from(e){return null==e?g.none():g.some(e)}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}g.singletonNone=new g(!1),"undefined"!=typeof window?window:Function("return this;")();var b=(e,t,o,r,n)=>e(o,r)?g.some(o):i(n)&&n(o)?g.none():t(o,r,n);let v=e=>{if(null==e)throw Error("Node cannot be null or undefined");return{dom:e}},p=(e,t)=>{let o=e.dom;if(1!==o.nodeType)return!1;if(void 0!==o.matches)return o.matches(t);if(void 0!==o.msMatchesSelector)return o.msMatchesSelector(t);if(void 0!==o.webkitMatchesSelector)return o.webkitMatchesSelector(t);if(void 0!==o.mozMatchesSelector)return o.mozMatchesSelector(t);throw Error("Browser lacks native selectors")},f=(e,t,o)=>{let r=e.dom,n=i(o)?o:h;for(;r.parentNode;){r=r.parentNode;let e=v(r);if(t(e))return g.some(e);if(n(e))break}return g.none()},y=(e,t,o)=>f(e,e=>p(e,t),o),k=e=>{let t=l(e);t.length>0&&e.ui.registry.addContextToolbar("quickblock",{predicate:t=>{let o=v(t),r=e.schema.getTextBlockElements(),i=t=>t.dom===e.getBody();return!((e,t)=>{let o=e.dom;return!(!o||!o.hasAttribute)&&o.hasAttribute("data-mce-bogus")})(o)&&b((e,t)=>p(e,t),y,o,'table,[data-mce-bogus="all"]',i).fold(()=>b((e,t)=>t(e),f,o,t=>t.dom.nodeName.toLowerCase() in r&&e.dom.isEmpty(t.dom),i).isSome(),h)},items:t,position:"line",scope:"editor"})};e.add("quickbars",e=>{(e=>{let t=e.options.register,i=e=>t=>{let i=r(t)||o(t);return i?r(t)?{value:t?e:"",valid:i}:{value:t.trim(),valid:i}:{valid:!1,message:"Must be a boolean or string."}},n="bold italic | quicklink h2 h3 blockquote";t("quickbars_selection_toolbar",{processor:i(n),default:n});let a="quickimage quicktable";t("quickbars_insert_toolbar",{processor:i(a),default:a});let l="alignleft aligncenter alignright";t("quickbars_image_toolbar",{processor:i(l),default:l})})(e),m(e),k(e),(e=>{let t=e=>"IMG"===e.nodeName||"FIGURE"===e.nodeName&&/image/i.test(e.className),o=s(e);o.length>0&&e.ui.registry.addContextToolbar("imageselection",{predicate:t,items:o,position:"node"});let r=a(e);r.length>0&&e.ui.registry.addContextToolbar("textselection",{predicate:o=>!t(o)&&!e.selection.isCollapsed()&&"false"!==e.dom.getContentEditableParent(o),items:r,position:"selection",scope:"editor"})})(e)})}();