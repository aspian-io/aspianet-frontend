!function(){"use strict";let e=e=>{let t=e,n=e=>{t=e};return{get:()=>t,set:n}};var t=tinymce.util.Tools.resolve("tinymce.PluginManager");let n=(e,t,n)=>{var r;return!!n(e,t.prototype)||(null===(r=e.constructor)||void 0===r?void 0:r.name)===t.name},r=e=>{let t=typeof e;return null===e?"null":"object"===t&&Array.isArray(e)?"array":"object"===t&&n(e,String,(e,t)=>t.isPrototypeOf(e))?"string":t},l=e=>t=>r(t)===e,o=e=>t=>typeof t===e,a=l("string"),s=l("array"),i=o("boolean"),d=e=>null==e,c=e=>!d(e),u=o("number"),m=()=>{},h=e=>()=>e,g=h(!0),f=h("[!-#%-*,-\\/:;?@\\[-\\]_{}\xa1\xab\xb7\xbb\xbf;\xb7՚-՟։֊־׀׃׆׳״؉؊،؍؛؞؟٪-٭۔܀-܍߷-߹࠰-࠾࡞।॥॰෴๏๚๛༄-༒༺-༽྅࿐-࿔࿙࿚၊-၏჻፡-፨᐀᙭᙮᚛᚜᛫-᛭᜵᜶។-៖៘-៚᠀-᠊᥄᥅᨞᨟᪠-᪦᪨-᪭᭚-᭠᯼-᯿᰻-᰿᱾᱿᳓‐-‧‰-⁃⁅-⁑⁓-⁞⁽⁾₍₎〈〉❨-❵⟅⟆⟦-⟯⦃-⦘⧘-⧛⧼⧽⳹-⳼⳾⳿⵰⸀-⸮⸰⸱、-〃〈-】〔-〟〰〽゠・꓾꓿꘍-꘏꙳꙾꛲-꛷꡴-꡷꣎꣏꣸-꣺꤮꤯꥟꧁-꧍꧞꧟꩜-꩟꫞꫟꯫﴾﴿︐-︙︰-﹒﹔-﹡﹣﹨﹪﹫！-＃％-＊，-／：；？＠［-］＿｛｝｟-･]");class p{constructor(e,t){this.tag=e,this.value=t}static some(e){return new p(!0,e)}static none(){return p.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?p.some(e(this.value)):p.none()}bind(e){return this.tag?e(this.value):p.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:p.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw Error(null!=e?e:"Called getOrDie on None")}static from(e){return c(e)?p.some(e):p.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}p.singletonNone=new p(!1);var x=tinymce.util.Tools.resolve("tinymce.Env"),y=tinymce.util.Tools.resolve("tinymce.util.Tools");let b=Array.prototype.slice,v=Array.prototype.push,w=(e,t)=>{let n=e.length,r=Array(n);for(let l=0;l<n;l++){let o=e[l];r[l]=t(o,l)}return r},C=(e,t)=>{for(let n=0,r=e.length;n<r;n++){let l=e[n];t(l,n)}},E=(e,t)=>{for(let n=e.length-1;n>=0;n--){let r=e[n];t(r,n)}},N=(e,t)=>{if(0===e.length)return[];{let n=t(e[0]),r=[],l=[];for(let o=0,a=e.length;o<a;o++){let s=e[o],i=t(s);i!==n&&(r.push(l),l=[]),n=i,l.push(s)}return 0!==l.length&&r.push(l),r}},T=(e,t,n)=>(C(e,(e,r)=>{n=t(n,e,r)}),n),O=e=>{let t=[];for(let n=0,r=e.length;n<r;++n){if(!s(e[n]))throw Error("Arr.flatten item "+n+" was not an array, input: "+e);v.apply(t,e[n])}return t},k=(e,t)=>O(w(e,t)),A=(e,t)=>{let n=b.call(e,0);return n.sort(t),n},S=Object.hasOwnProperty,D=(e,t)=>S.call(e,t);"undefined"!=typeof window?window:Function("return this;")();let M=e=>e.dom.nodeType,B=e=>3===M(e),F=(e,t,n)=>{if(a(n)||i(n)||u(n))e.setAttribute(t,n+"");else throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),Error("Attribute value was not simple")},I=(e,t,n)=>{F(e.dom,t,n)},R=(e,t)=>{let n=(t||document).createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||n.childNodes.length>1){let r="HTML does not have a single root node";throw console.error(r,e),Error(r)}return $(n.childNodes[0])},P=(e,t)=>{let n=(t||document).createElement(e);return $(n)},W=(e,t)=>{let n=(t||document).createTextNode(e);return $(n)},$=e=>{if(null==e)throw Error("Node cannot be null or undefined");return{dom:e}},V=(e,t,n)=>p.from(e.dom.elementFromPoint(t,n)).map($),j={fromHtml:R,fromTag:P,fromText:W,fromDom:$,fromPoint:V},_=e=>1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount,z=(e,t)=>{let n=void 0===t?document:t.dom;return _(n)?[]:w(n.querySelectorAll(e),j.fromDom)},H=e=>p.from(e.dom.parentNode).map(j.fromDom),L=e=>w(e.dom.childNodes,j.fromDom),U=(e,t)=>({element:e,offset:t}),q=(e,t)=>{let n=L(e);return n.length>0&&t<n.length?U(n[t],0):U(e,t)},G=(e,t)=>{let n=H(e);n.each(n=>{n.dom.insertBefore(t.dom,e.dom)})},K=(e,t)=>{e.dom.appendChild(t.dom)},J=(e,t)=>{G(e,t),K(t,e)},Q=((e,t)=>{let n=n=>{if(!e(n))throw Error("Can only get "+t+" value of a "+t+" node");return r(n).getOr("")},r=t=>e(t)?p.from(t.dom.nodeValue):p.none(),l=(n,r)=>{if(!e(n))throw Error("Can only set raw "+t+" value of a "+t+" node");n.dom.nodeValue=r};return{get:n,getOption:r,set:l}})(B,"text"),X=e=>Q.get(e),Y=(e,t,n)=>(e.compareDocumentPosition(t)&n)!=0,Z=(e,t)=>Y(e,t,Node.DOCUMENT_POSITION_PRECEDING),ee=(e,t)=>z(t,e);var et=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker");let en=(e,t)=>e.isBlock(t)||D(e.schema.getVoidElements(),t.nodeName),er=(e,t)=>"false"===e.getContentEditable(t),el=(e,t)=>"true"===e.getContentEditable(t)&&t.parentNode&&"false"===e.getContentEditableParent(t.parentNode),eo=(e,t)=>!e.isBlock(t)&&D(e.schema.getWhitespaceElements(),t.nodeName),ea=(e,t)=>en(e,t)||er(e,t)||eo(e,t)||el(e,t),es=e=>3===e.nodeType,ei=()=>({sOffset:0,fOffset:0,elements:[]}),ed=(e,t)=>q(j.fromDom(e),t),ec=(e,t,n,r,l,o=!0)=>{let a=o?t(!1):n;for(;a;){let s=er(e,a);if(s||eo(e,a)){let i=s?r.cef(a):r.boundary(a);if(i)break;a=t(!0);continue}if(en(e,a)){if(r.boundary(a))break}else es(a)&&r.text(a);if(a===l)break;a=t(!1)}},eu=(e,t,n,r,l)=>{var o;if(ea(e,n))return;let a=null!==(o=e.getParent(r,e.isBlock))&&void 0!==o?o:e.getRoot(),s=new et(n,a),i=l?s.next.bind(s):s.prev.bind(s);ec(e,i,n,{boundary:g,cef:g,text:e=>{l?t.fOffset+=e.length:t.sOffset+=e.length,t.elements.push(j.fromDom(e))}})},em=(e,t,n,r,l,o=!0)=>{let a=new et(n,t),s=[],i=ei();eu(e,i,n,t,!1);let d=()=>(i.elements.length>0&&(s.push(i),i=ei()),!1);return ec(e,a.next.bind(a),n,{boundary:d,cef:e=>(d(),l&&s.push(...l.cef(e)),!1),text:e=>{i.elements.push(j.fromDom(e)),l&&l.text(e,i)}},r,o),r&&eu(e,i,r,t,!0),d(),s},eh=(e,t)=>{let n=ed(t.startContainer,t.startOffset),r=n.element.dom,l=ed(t.endContainer,t.endOffset),o=l.element.dom;return em(e,t.commonAncestorContainer,r,o,{text:(e,t)=>{e===o?t.fOffset+=e.length-l.offset:e===r&&(t.sOffset+=n.offset)},cef:t=>{let n=k(ee(j.fromDom(t),"*[contenteditable=true]"),t=>{let n=t.dom;return em(e,n,n)});return A(n,(e,t)=>Z(e.elements[0].dom,t.elements[0].dom)?1:-1)}},!1)},eg=(e,t)=>t.collapsed?[]:eh(e,t),ef=(e,t)=>{let n=e.createRng();return n.selectNode(t),eg(e,n)},ep=(e,t)=>k(t,t=>ef(e,t)),ex=(e,t,n=0,r=e.length)=>{let l;let o=t.regex;o.lastIndex=n;let a=[];for(;l=o.exec(e);){let s=l[t.matchIndex],i=l.index+l[0].indexOf(s),d=i+s.length;if(d>r)break;a.push({start:i,finish:d}),o.lastIndex=d}return a},ey=(e,t)=>{let n=T(e,(e,n)=>{let r=X(n),l=e.last,o=l+r.length,a=k(t,(e,t)=>e.start<o&&e.finish>l?[{element:n,start:Math.max(l,e.start)-l,finish:Math.min(o,e.finish)-l,matchId:t}]:[]);return{results:e.results.concat(a),last:o}},{results:[],last:0}).results;return N(n,e=>e.matchId)},eb=(e,t)=>k(t,t=>{let n=t.elements,r=w(n,X).join(""),l=ex(r,e,t.sOffset,r.length-t.fOffset);return ey(n,l)}),ev=(e,t)=>{E(e,(e,n)=>{E(e,e=>{let r=j.fromDom(t.cloneNode(!1));I(r,"data-mce-index",n);let l=e.element.dom;if(l.length===e.finish&&0===e.start)J(e.element,r);else{l.length!==e.finish&&l.splitText(e.finish);let o=l.splitText(e.start);J(j.fromDom(o),r)}})})},ew=(e,t,n,r)=>{let l=ef(e,n),o=eb(t,l);return ev(o,r),o.length},eC=(e,t,n,r)=>{let l=n.getBookmark(),o=e.select("td[data-mce-selected],th[data-mce-selected]"),a=o.length>0?ep(e,o):eg(e,n.getRng()),s=eb(t,a);return ev(s,r),n.moveToBookmark(l),s.length},eE=e=>e.getAttribute("data-mce-index"),eN=(e,t,n,r)=>{let l=e.dom.create("span",{"data-mce-bogus":1});l.className="mce-match-marker";let o=e.getBody();return(eR(e,t,!1),r)?eC(e.dom,n,e.selection,l):ew(e.dom,n,o,l)},eT=e=>{var t;let n=e.parentNode;e.firstChild&&n.insertBefore(e.firstChild,e),null===(t=e.parentNode)||void 0===t||t.removeChild(e)},eO=(e,t)=>{let n=[],r=y.toArray(e.getBody().getElementsByTagName("span"));if(r.length)for(let l=0;l<r.length;l++){let o=eE(r[l]);null!==o&&o.length&&o===t.toString()&&n.push(r[l])}return n},ek=(e,t,n)=>{let r=t.get(),l=r.index,o=e.dom;n?l+1===r.count?l=0:l++:l-1==-1?l=r.count-1:l--,o.removeClass(eO(e,r.index),"mce-match-marker-selected");let a=eO(e,l);return a.length?(o.addClass(eO(e,l),"mce-match-marker-selected"),e.selection.scrollIntoView(a[0]),l):-1},eA=(e,t)=>{let n=t.parentNode;e.remove(t),n&&e.isEmpty(n)&&e.remove(n)},eS=(e,t)=>{let n=e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&").replace(/\s/g,"[^\\S\\r\\n\\uFEFF]"),r="("+n+")";return t?`(?:^|\\s|${f()})`+r+`(?=$|\\s|${f()})`:r},eD=(e,t,n,r,l,o)=>{let a=e.selection,s=eS(n,l),i=a.isForward(),d={regex:RegExp(s,r?"g":"gi"),matchIndex:1},c=eN(e,t,d,o);if(x.browser.isSafari()&&a.setRng(a.getRng(),i),c){let u=ek(e,t,!0);t.set({index:u,count:c,text:n,matchCase:r,wholeWord:l,inSelection:o})}return c},eM=(e,t)=>{let n=ek(e,t,!0);t.set({...t.get(),index:n})},eB=(e,t)=>{let n=ek(e,t,!1);t.set({...t.get(),index:n})},eF=e=>{let t=eE(e);return null!==t&&t.length>0},eI=(e,t,n,r,l)=>{let o=t.get(),a=o.index,s,i=a;r=!1!==r;let d=e.getBody(),c=y.grep(y.toArray(d.getElementsByTagName("span")),eF);for(let u=0;u<c.length;u++){let m=eE(c[u]),h=s=parseInt(m,10);if(l||h===o.index){for(n.length?(c[u].innerText=n,eT(c[u])):eA(e.dom,c[u]);c[++u];)if((h=parseInt(eE(c[u]),10))===s)eA(e.dom,c[u]);else{u--;break}r&&i--}else s>a&&c[u].setAttribute("data-mce-index",String(s-1))}return t.set({...o,count:l?0:o.count-1,index:i}),r?eM(e,t):eB(e,t),!l&&t.get().count>0},eR=(e,t,n)=>{let r,l;let o=t.get(),a=y.toArray(e.getBody().getElementsByTagName("span"));for(let s=0;s<a.length;s++){let i=eE(a[s]);null!==i&&i.length&&(i===o.index.toString()&&(r||(r=a[s].firstChild),l=a[s].firstChild),eT(a[s]))}if(t.set({...o,index:-1,count:0,text:""}),r&&l){let d=e.dom.createRng();return d.setStart(r,0),d.setEnd(l,l.data.length),!1!==n&&e.selection.setRng(d),d}},eP=(e,t)=>t.get().count>1,eW=(e,t)=>t.get().count>1,e$=(e,t)=>{let n=n=>eR(e,t,n),r=(n,r,l,o=!1)=>eD(e,t,n,r,l,o),l=()=>eM(e,t),o=()=>eB(e,t),a=(n,r,l)=>eI(e,t,n,r,l);return{done:n,find:r,next:l,prev:o,replace:a}},eV=t=>{let n=e(p.none()),r=()=>n.get().each(t),l=()=>{r(),n.set(p.none())},o=()=>n.get().isSome(),a=()=>n.get(),s=e=>{r(),n.set(p.some(e))};return{clear:l,isSet:o,get:a,set:s}},ej=()=>{let e=eV(m),t=t=>e.get().each(t);return{...e,on:t}},e_=(e,t)=>{let n=ej();e.undoManager.add();let r=y.trim(e.selection.getContent({format:"text"})),l=n=>{n.setEnabled("next",eP(e,t)),n.setEnabled("prev",eW(e,t))},o=e=>{let n=e.getData(),r=t.get();t.set({...r,matchCase:n.matchcase,wholeWord:n.wholewords,inSelection:n.inselection})},a=(e,t)=>{let n=n=>e.setEnabled(n,!t);C(["replace","replaceall","prev","next"],n)},s=t=>{e.windowManager.alert("Could not find the specified string.",()=>{t.focus("findtext")})},i=(e,t)=>{x.browser.isSafari()&&x.deviceType.isTouch()&&("find"===t||"replace"===t||"replaceall"===t)&&e.focus(t)},d=n=>{eR(e,t,!1),a(n,!0),l(n)},c=n=>{let r=n.getData(),o=t.get();if(!r.findtext.length){d(n);return}if(o.text===r.findtext&&o.matchCase===r.matchcase&&o.wholeWord===r.wholewords)eM(e,t);else{let i=eD(e,t,r.findtext,r.matchcase,r.wholewords,r.inselection);i<=0&&s(n),a(n,0===i)}l(n)},u=t.get(),m={findtext:r,replacetext:"",wholewords:u.wholeWord,matchcase:u.matchCase,inselection:u.inSelection};n.set(e.windowManager.open({title:"Find and Replace",size:"normal",body:{type:"panel",items:[{type:"bar",items:[{type:"input",name:"findtext",placeholder:"Find",maximized:!0,inputMode:"search"},{type:"button",name:"prev",text:"Previous",icon:"action-prev",enabled:!1,borderless:!0},{type:"button",name:"next",text:"Next",icon:"action-next",enabled:!1,borderless:!0}]},{type:"input",name:"replacetext",placeholder:"Replace with",inputMode:"search"}]},buttons:[{type:"menu",name:"options",icon:"preferences",tooltip:"Preferences",align:"start",items:[{type:"togglemenuitem",name:"matchcase",text:"Match case"},{type:"togglemenuitem",name:"wholewords",text:"Find whole words only"},{type:"togglemenuitem",name:"inselection",text:"Find in selection"}]},{type:"custom",name:"find",text:"Find",primary:!0},{type:"custom",name:"replace",text:"Replace",enabled:!1},{type:"custom",name:"replaceall",text:"Replace all",enabled:!1}],initialData:m,onChange:(e,n)=>{"findtext"===n.name&&t.get().count>0&&d(e)},onAction:(n,r)=>{let a=n.getData();switch(r.name){case"find":c(n);break;case"replace":eI(e,t,a.replacetext)?l(n):d(n);break;case"replaceall":eI(e,t,a.replacetext,!0,!0),d(n);break;case"prev":eB(e,t),l(n);break;case"next":eM(e,t),l(n);break;case"matchcase":case"wholewords":case"inselection":o(n),d(n)}i(n,r.name)},onSubmit:e=>{c(e),i(e,"find")},onClose:()=>{e.focus(),eR(e,t),e.undoManager.add()}},{inline:"toolbar"}))},ez=(e,t)=>{e.addCommand("SearchReplace",()=>{e_(e,t)})},eH=(e,t)=>()=>{e_(e,t)},eL=(e,t)=>{e.ui.registry.addMenuItem("searchreplace",{text:"Find and replace...",shortcut:"Meta+F",onAction:eH(e,t),icon:"search"}),e.ui.registry.addButton("searchreplace",{tooltip:"Find and replace",onAction:eH(e,t),icon:"search"}),e.shortcuts.add("Meta+F","",eH(e,t))};t.add("searchreplace",t=>{let n=e({index:-1,count:0,text:"",matchCase:!1,wholeWord:!1,inSelection:!1});return ez(t,n),eL(t,n),e$(t,n)})}();