!function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.ModelManager");let t=e=>t=>(e=>{var t,r;let l=typeof e;return null===e?"null":"object"===l&&Array.isArray(e)?"array":"object"===l&&((t=String).prototype.isPrototypeOf(e)||(null===(r=e.constructor)||void 0===r?void 0:r.name)===t.name)?"string":l})(t)===e,r=e=>t=>typeof t===e,l=e=>t=>e===t,o=t("string"),n=t("object"),s=t("array"),a=l(null),i=r("boolean"),m=l(void 0),d=e=>null!=e,c=r("function"),u=r("number"),f=()=>{},g=e=>()=>e,h=e=>e,p=(e,t)=>e===t;function b(e,...t){return(...r)=>{let l=t.concat(r);return e.apply(null,l)}}let w=e=>t=>!e(t),v=e=>e(),y=g(!1),x=g(!0);class C{constructor(e,t){this.tag=e,this.value=t}static some(e){return new C(!0,e)}static none(){return C.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?C.some(e(this.value)):C.none()}bind(e){return this.tag?e(this.value):C.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:C.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw Error(null!=e?e:"Called getOrDie on None")}static from(e){return d(e)?C.some(e):C.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}C.singletonNone=new C(!1);let S=Array.prototype.slice,T=Array.prototype.indexOf,R=Array.prototype.push,D=(e,t)=>T.call(e,t)>-1,O=(e,t)=>{for(let r=0,l=e.length;r<l;r++)if(t(e[r],r))return!0;return!1},k=(e,t)=>{let r=[];for(let l=0;l<e;l++)r.push(t(l));return r},E=(e,t)=>{let r=e.length,l=Array(r);for(let o=0;o<r;o++){let n=e[o];l[o]=t(n,o)}return l},N=(e,t)=>{for(let r=0,l=e.length;r<l;r++)t(e[r],r)},B=(e,t)=>{let r=[],l=[];for(let o=0,n=e.length;o<n;o++){let s=e[o];(t(s,o)?r:l).push(s)}return{pass:r,fail:l}},z=(e,t)=>{let r=[];for(let l=0,o=e.length;l<o;l++){let n=e[l];t(n,l)&&r.push(n)}return r},A=(e,t,r)=>(((e,t)=>{for(let r=e.length-1;r>=0;r--)t(e[r],r)})(e,(e,l)=>{r=t(r,e,l)}),r),W=(e,t,r)=>(N(e,(e,l)=>{r=t(r,e,l)}),r),L=(e,t)=>((e,t,r)=>{for(let l=0,o=e.length;l<o;l++){let n=e[l];if(t(n,l))return C.some(n);if(r(n,l))break}return C.none()})(e,t,y),_=(e,t)=>{for(let r=0,l=e.length;r<l;r++)if(t(e[r],r))return C.some(r);return C.none()},M=e=>{let t=[];for(let r=0,l=e.length;r<l;++r){if(!s(e[r]))throw Error("Arr.flatten item "+r+" was not an array, input: "+e);R.apply(t,e[r])}return t},j=(e,t)=>M(E(e,t)),I=(e,t)=>{for(let r=0,l=e.length;r<l;++r)if(!0!==t(e[r],r))return!1;return!0},P=(e,t)=>{let r={};for(let l=0,o=e.length;l<o;l++){let n=e[l];r[String(n)]=t(n,l)}return r},F=(e,t)=>t>=0&&t<e.length?C.some(e[t]):C.none(),H=e=>F(e,0),q=e=>F(e,e.length-1),V=(e,t)=>{for(let r=0;r<e.length;r++){let l=t(e[r],r);if(l.isSome())return l}return C.none()},$=Object.keys,U=Object.hasOwnProperty,G=(e,t)=>{let r=$(e);for(let l=0,o=r.length;l<o;l++){let n=r[l];t(e[n],n)}},K=(e,t)=>Y(e,(e,r)=>({k:r,v:t(e,r)})),Y=(e,t)=>{let r={};return G(e,(e,l)=>{let o=t(e,l);r[o.k]=o.v}),r},J=(e,t)=>{let r=[];return G(e,(e,l)=>{r.push(t(e,l))}),r},Q=e=>J(e,h),X=(e,t)=>U.call(e,t);"undefined"!=typeof window?window:Function("return this;")();let Z=e=>e.dom.nodeName.toLowerCase(),ee=e=>e.dom.nodeType,et=e=>t=>ee(t)===e,er=e=>8===ee(e)||"#comment"===Z(e),el=et(1),eo=et(3),en=et(9),es=et(11),ea=e=>t=>el(t)&&Z(t)===e,ei=(e,t,r)=>{if(!(o(r)||i(r)||u(r)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",r,":: Element ",e),Error("Attribute value was not simple");e.setAttribute(t,r+"")},em=(e,t,r)=>{ei(e.dom,t,r)},ed=(e,t)=>{let r=e.dom;G(t,(e,t)=>{ei(r,t,e)})},ec=(e,t)=>{let r=e.dom.getAttribute(t);return null===r?void 0:r},eu=(e,t)=>C.from(ec(e,t)),ef=(e,t)=>{e.dom.removeAttribute(t)},eg=e=>W(e.dom.attributes,(e,t)=>(e[t.name]=t.value,e),{}),eh=e=>{if(null==e)throw Error("Node cannot be null or undefined");return{dom:e}},ep={fromHtml:(e,t)=>{let r=(t||document).createElement("div");if(r.innerHTML=e,!r.hasChildNodes()||r.childNodes.length>1){let l="HTML does not have a single root node";throw console.error(l,e),Error(l)}return eh(r.childNodes[0])},fromTag:(e,t)=>{let r=(t||document).createElement(e);return eh(r)},fromText:(e,t)=>{let r=(t||document).createTextNode(e);return eh(r)},fromDom:eh,fromPoint:(e,t,r)=>C.from(e.dom.elementFromPoint(t,r)).map(eh)},eb=(e,t)=>{let r=e.dom;if(1!==r.nodeType)return!1;if(void 0!==r.matches)return r.matches(t);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t);throw Error("Browser lacks native selectors")},ew=e=>1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount,ev=(e,t)=>{let r=void 0===t?document:t.dom;return ew(r)?C.none():C.from(r.querySelector(e)).map(ep.fromDom)},ey=(e,t)=>e.dom===t.dom,ex=(e,t)=>{let r=e.dom,l=t.dom;return r!==l&&r.contains(l)},eC=e=>ep.fromDom(e.dom.ownerDocument),eS=e=>en(e)?e:eC(e),eT=e=>C.from(e.dom.parentNode).map(ep.fromDom),eR=(e,t)=>{let r=c(t)?t:y,l=e.dom,o=[];for(;null!==l.parentNode&&void 0!==l.parentNode;){let n=l.parentNode,s=ep.fromDom(n);if(o.push(s),!0===r(s))break;l=n}return o},eD=e=>C.from(e.dom.previousSibling).map(ep.fromDom),eO=e=>C.from(e.dom.nextSibling).map(ep.fromDom),ek=e=>E(e.dom.childNodes,ep.fromDom),eE=(e,t)=>{let r=e.dom.childNodes;return C.from(r[t]).map(ep.fromDom)},eN=(e,t)=>{eT(e).each(r=>{r.dom.insertBefore(t.dom,e.dom)})},eB=(e,t)=>{eO(e).fold(()=>{eT(e).each(e=>{eA(e,t)})},e=>{eN(e,t)})},ez=(e,t)=>{let r=eE(e,0);r.fold(()=>{eA(e,t)},r=>{e.dom.insertBefore(t.dom,r.dom)})},eA=(e,t)=>{e.dom.appendChild(t.dom)},eW=(e,t)=>{eN(e,t),eA(t,e)},eL=(e,t)=>{N(t,(r,l)=>{let o=0===l?e:t[l-1];eB(o,r)})},e_=(e,t)=>{N(t,t=>{eA(e,t)})},eM=e=>{e.dom.textContent="",N(ek(e),e=>{ej(e)})},ej=e=>{let t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},eI=e=>{let t=ek(e);t.length>0&&eL(e,t),ej(e)},eP=(e,t)=>ep.fromDom(e.dom.cloneNode(t)),eF=e=>eP(e,!1),eH=e=>eP(e,!0),eq=(e,t)=>{let r=ep.fromTag(t),l=eg(e);return ed(r,l),r},eV=["tfoot","thead","tbody","colgroup"],e$=(e,t,r)=>({element:e,rowspan:t,colspan:r}),eU=(e,t,r)=>({element:e,cells:t,section:r}),eG=(e,t,r)=>({element:e,isNew:t,isLocked:r}),eK=(e,t,r,l)=>({element:e,cells:t,section:r,isNew:l}),eY=c(Element.prototype.attachShadow)&&c(Node.prototype.getRootNode),eJ=g(eY),eQ=eY?e=>ep.fromDom(e.dom.getRootNode()):eS,eX=e=>ep.fromDom(e.dom.host),eZ=e=>{let t=eo(e)?e.dom.parentNode:e.dom;if(null==t||null===t.ownerDocument)return!1;let r=t.ownerDocument;return(e=>{let t=eQ(e);return es(t)&&d(t.dom.host)?C.some(t):C.none()})(ep.fromDom(t)).fold(()=>r.body.contains(t),e=>eZ(eX(e)))},e0=e=>{let t=e.dom.body;if(null==t)throw Error("Body is not available yet");return ep.fromDom(t)},e1=(e,t)=>{let r=[];return N(ek(e),e=>{t(e)&&(r=r.concat([e])),r=r.concat(e1(e,t))}),r},e9=(e,t,r)=>z(eR(e,r),e=>eb(e,t)),e3=(e,t)=>z(ek(e),e=>eb(e,t)),e5=(e,t)=>((e,t)=>{let r=void 0===t?document:t.dom;return ew(r)?[]:E(r.querySelectorAll(e),ep.fromDom)})(t,e);var e2=(e,t,r,l,o)=>e(r,l)?C.some(r):c(o)&&o(r)?C.none():t(r,l,o);let e7=(e,t,r)=>{let l=e.dom,o=c(r)?r:y;for(;l.parentNode;){l=l.parentNode;let n=ep.fromDom(l);if(t(n))return C.some(n);if(o(n))break}return C.none()},e4=(e,t,r)=>e7(e,e=>eb(e,t),r),e6=(e,t)=>L(e.dom.childNodes,e=>eb(ep.fromDom(e),t)).map(ep.fromDom),e8=(e,t)=>ev(t,e),te=(e,t,r)=>e2((e,t)=>eb(e,t),e4,e,t,r),tt=(e,t,r=p)=>e.exists(e=>r(e,t)),tr=e=>{let t=[],r=e=>{t.push(e)};for(let l=0;l<e.length;l++)e[l].each(r);return t},tl=(e,t)=>e?C.some(t):C.none(),to=(e,t,r)=>""===t||e.length>=t.length&&e.substr(r,r+t.length)===t,tn=(e,t,r=0,l)=>{let o=e.indexOf(t,r);return -1!==o&&(!!m(l)||o+t.length<=l)},ts=(e,t)=>to(e,t,0),ta=(e,t)=>to(e,t,e.length-t.length),ti=e=>e.replace(/^\s+|\s+$/g,""),tm=e=>e.length>0,td=e=>void 0!==e.style&&c(e.style.getPropertyValue),tc=(e,t,r)=>{if(!o(r))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",r,":: Element ",e),Error("CSS value must be a string: "+r);td(e)&&e.style.setProperty(t,r)},tu=(e,t,r)=>{let l=e.dom;tc(l,t,r)},tf=(e,t)=>{let r=e.dom;G(t,(e,t)=>{tc(r,t,e)})},tg=(e,t)=>{let r=e.dom,l=window.getComputedStyle(r).getPropertyValue(t);return""!==l||eZ(e)?l:th(r,t)},th=(e,t)=>td(e)?e.style.getPropertyValue(t):"",tp=(e,t)=>{let r=e.dom,l=th(r,t);return C.from(l).filter(e=>e.length>0)},tb=(e,t)=>{var r;td(r=e.dom)&&r.style.removeProperty(t),tt(eu(e,"style").map(ti),"")&&ef(e,"style")},tw=(e,t,r=0)=>eu(e,t).map(e=>parseInt(e,10)).getOr(r),tv=(e,t)=>tw(e,t,1),ty=e=>ea("col")(e)?tw(e,"span",1)>1:tv(e,"colspan")>1,tx=e=>tv(e,"rowspan")>1,tC=(e,t)=>parseInt(tg(e,t),10),tS=g(10),tT=g(10),tR=(e,t)=>tD(e,t,x),tD=(e,t,r)=>j(ek(e),e=>eb(e,t)?r(e)?[e]:[]:tD(e,t,r)),tO=(e,t)=>((e,t,r=y)=>r(t)?C.none():D(e,Z(t))?C.some(t):e4(t,e.join(","),e=>eb(e,"table")||r(e)))(["td","th"],e,t),tk=e=>tR(e,"th,td"),tE=e=>eb(e,"colgroup")?e3(e,"col"):j(tz(e),e=>e3(e,"col")),tN=(e,t)=>te(e,"table",t),tB=e=>tR(e,"tr"),tz=e=>tN(e).fold(g([]),e=>e3(e,"colgroup")),tA=(e,t)=>E(e,e=>{if("colgroup"===Z(e)){let r=E(tE(e),e=>{let t=tw(e,"span",1);return e$(e,1,t)});return eU(e,r,"colgroup")}{let l=E(tk(e),e=>{let t=tw(e,"rowspan",1),r=tw(e,"colspan",1);return e$(e,t,r)});return eU(e,l,t(e))}}),tW=e=>eT(e).map(e=>{let t=Z(e);return D(eV,t)?t:"tbody"}).getOr("tbody"),tL=e=>{let t=tB(e),r=[...tz(e),...t];return tA(r,tW)},t_=e=>{let t,r=!1;return(...l)=>(r||(r=!0,t=e.apply(null,l)),t)},tM=()=>tj(0,0),tj=(e,t)=>({major:e,minor:t}),tI={nu:tj,detect:(e,t)=>{let r=String(t).toLowerCase();return 0===e.length?tM():((e,t)=>{let r=((e,t)=>{for(let r=0;r<e.length;r++){let l=e[r];if(l.test(t))return l}})(e,t);if(!r)return{major:0,minor:0};let l=e=>Number(t.replace(r,"$"+e));return tj(l(1),l(2))})(e,r)},unknown:tM},tP=(e,t)=>{let r=String(t).toLowerCase();return L(e,e=>e.search(r))},tF=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,tH=e=>t=>tn(t,e),tq=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:e=>tn(e,"edge/")&&tn(e,"chrome")&&tn(e,"safari")&&tn(e,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,tF],search:e=>tn(e,"chrome")&&!tn(e,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:e=>tn(e,"msie")||tn(e,"trident")},{name:"Opera",versionRegexes:[tF,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:tH("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:tH("firefox")},{name:"Safari",versionRegexes:[tF,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:e=>(tn(e,"safari")||tn(e,"mobile/"))&&tn(e,"applewebkit")}],tV=[{name:"Windows",search:tH("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:e=>tn(e,"iphone")||tn(e,"ipad"),versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:tH("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:tH("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:tH("linux"),versionRegexes:[]},{name:"Solaris",search:tH("sunos"),versionRegexes:[]},{name:"FreeBSD",search:tH("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:tH("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],t$={browsers:g(tq),oses:g(tV)},tU="Edge",tG="Chromium",tK="Opera",tY="Firefox",tJ="Safari",tQ=e=>{let t=e.current,r=e.version,l=e=>()=>t===e;return{current:t,version:r,isEdge:l(tU),isChromium:l(tG),isIE:l("IE"),isOpera:l(tK),isFirefox:l(tY),isSafari:l(tJ)}},tX=()=>tQ({current:void 0,version:tI.unknown()}),tZ=(g(tU),g(tG),g("IE"),g(tK),g(tY),g(tJ),"Windows"),t0="Android",t1="Linux",t9="macOS",t3="Solaris",t5="FreeBSD",t2="ChromeOS",t7=e=>{let t=e.current,r=e.version,l=e=>()=>t===e;return{current:t,version:r,isWindows:l(tZ),isiOS:l("iOS"),isAndroid:l(t0),isMacOS:l(t9),isLinux:l(t1),isSolaris:l(t3),isFreeBSD:l(t5),isChromeOS:l(t2)}},t4=()=>t7({current:void 0,version:tI.unknown()}),t6=(g(tZ),g("iOS"),g(t0),g(t1),g(t9),g(t3),g(t5),g(t2),e=>window.matchMedia(e).matches),t8=t_(()=>((e,t,r)=>{let l=t$.browsers(),o=t$.oses(),n=t.bind(e=>V(e.brands,e=>{let t=e.brand.toLowerCase();return L(l,e=>{var r;return t===(null===(r=e.brand)||void 0===r?void 0:r.toLowerCase())}).map(t=>({current:t.name,version:tI.nu(parseInt(e.version,10),0)}))})).orThunk(()=>tP(l,e).map(t=>{let r=tI.detect(t.versionRegexes,e);return{current:t.name,version:r}})).fold(tX,tQ),s=tP(o,e).map(t=>{let r=tI.detect(t.versionRegexes,e);return{current:t.name,version:r}}).fold(t4,t7),a=((e,t,r,l)=>{let o=e.isiOS()&&!0===/ipad/i.test(r),n=e.isiOS()&&!o,s=e.isiOS()||e.isAndroid(),a=s||l("(pointer:coarse)"),i=o||!n&&s&&l("(min-device-width:768px)"),m=n||s&&!i,d=t.isSafari()&&e.isiOS()&&!1===/safari/i.test(r);return{isiPad:g(o),isiPhone:g(n),isTablet:g(i),isPhone:g(m),isTouch:g(a),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:g(d),isDesktop:g(!m&&!i&&!d)}})(s,n,e,r);return{browser:n,os:s,deviceType:a}})(navigator.userAgent,C.from(navigator.userAgentData),t6)),re=()=>t8(),rt=(e,t)=>{let r=r=>{let l=t(r);if(l<=0||null===l){let o=tg(r,e);return parseFloat(o)||0}return l},l=(e,t)=>W(t,(t,r)=>{let l=tg(e,r),o=void 0===l?0:parseInt(l,10);return isNaN(o)?t:t+o},0);return{set:(t,r)=>{if(!u(r)&&!r.match(/^[0-9]+$/))throw Error(e+".set accepts only positive integer values. Value was "+r);let l=t.dom;td(l)&&(l.style[e]=r+"px")},get:r,getOuter:r,aggregate:l,max:(e,t,r)=>{let o=l(e,r);return t>o?t-o:0}}},rr=(e,t,r)=>(e=>{let t=parseFloat(e);return isNaN(t)?C.none():C.some(t)})(tg(e,t)).getOr(r),rl=rt("width",e=>e.dom.offsetWidth),ro=e=>rl.get(e),rn=e=>rl.getOuter(e),rs=e=>((e,t)=>{let r=e.dom,l=r.getBoundingClientRect().width||r.offsetWidth;return"border-box"===t?l:l-rr(e,"padding-left",0)-rr(e,"padding-right",0)-rr(e,"border-left-width",0)-rr(e,"border-right-width",0)})(e,"content-box"),ra=(e,t,r)=>{let l=e.cells,o=l.slice(0,t),n=l.slice(t),s=o.concat(r).concat(n);return rd(e,s)},ri=(e,t,r)=>ra(e,t,[r]),rm=(e,t,r)=>{e.cells[t]=r},rd=(e,t)=>eK(e.element,t,e.section,e.isNew),rc=(e,t)=>e.cells[t],ru=(e,t)=>rc(e,t).element,rf=e=>e.cells.length,rg=e=>{let t=B(e,e=>"colgroup"===e.section);return{rows:t.fail,cols:t.pass}},rh=(e,t,r)=>{let l=E(e.cells,r);return eK(t(e.element),l,e.section,!0)},rp="data-snooker-locked-cols",rb=e=>eu(e,rp).bind(e=>C.from(e.match(/\d+/g))).map(e=>P(e,x)),rw=e=>{let t=W(rg(e).rows,(e,t)=>(N(t.cells,(t,r)=>{t.isLocked&&(e[r]=!0)}),e),{}),r=J(t,(e,t)=>parseInt(t,10));return((e,t)=>{let r=S.call(e,0);return r.sort(void 0),r})(r)},rv=(e,t)=>e+","+t,ry=(e,t)=>{let r=j(e.all,e=>e.cells);return z(r,t)},rx=e=>{let t={},r=[],l=H(e).map(e=>e.element).bind(tN).bind(rb).getOr({}),o=0,n=0,s=0,{pass:a,fail:i}=B(e,e=>"colgroup"===e.section);N(i,e=>{let a=[];N(e.cells,e=>{var r,o;let i=0;for(;void 0!==t[rv(s,i)];)i++;let m=X(l,r=i.toString())&&void 0!==l[r]&&null!==l[r],d=(o=e.element,{element:o,rowspan:e.rowspan,colspan:e.colspan,row:s,column:i,isLocked:m});for(let c=0;c<e.colspan;c++)for(let u=0;u<e.rowspan;u++){let f=i+c,g=rv(s+u,f);t[g]=d,n=Math.max(n,f+1)}a.push(d)}),o++,r.push(eU(e.element,a,e.section)),s++});let{columns:m,colgroups:d}=q(a).map(e=>{let t=(e=>{let t={},r=0;return N(e.cells,e=>{let l=e.colspan;k(l,o=>{let n=r+o;t[n]={element:e.element,colspan:l,column:n}}),r+=l}),t})(e),r={element:e.element,columns:Q(t)};return{colgroups:[r],columns:t}}).getOrThunk(()=>({colgroups:[],columns:{}})),c={rows:o,columns:n};return{grid:c,access:t,all:r,columns:m,colgroups:d}},rC=e=>{let t=tL(e);return rx(t)},rS=(e,t,r)=>C.from(e.access[rv(t,r)]),rT=(e,t,r)=>{let l=ry(e,e=>r(t,e.element));return l.length>0?C.some(l[0]):C.none()},rR=e=>j(e.all,e=>e.cells),rD=e=>Q(e.columns),rO=e=>$(e.columns).length>0,rk=(e,t)=>C.from(e.columns[t]),rE=(e,t=x)=>{let r=e.grid,l=k(r.columns,h),o=k(r.rows,h);return E(l,r=>rN(()=>j(o,t=>rS(e,t,r).filter(e=>e.column===r).toArray()),e=>1===e.colspan&&t(e.element),()=>rS(e,0,r)))},rN=(e,t,r)=>{let l=e();return L(l,t).orThunk(()=>C.from(l[0]).orThunk(r)).map(e=>e.element)},rB=e=>{let t=e.grid,r=k(t.rows,h),l=k(t.columns,h);return E(r,t=>rN(()=>j(l,r=>rS(e,t,r).filter(e=>e.row===t).fold(g([]),e=>[e])),e=>1===e.rowspan,()=>rS(e,t,0)))},rz=(e,t)=>r=>"rtl"===rA(r)?t:e,rA=e=>"rtl"===tg(e,"direction")?"rtl":"ltr",rW=rt("height",e=>{let t=e.dom;return eZ(e)?t.getBoundingClientRect().height:t.offsetHeight}),rL=e=>rW.get(e),r_=e=>rW.getOuter(e),rM=(e,t)=>({left:e,top:t,translate:(r,l)=>rM(e+r,t+l)}),rj=(e,t)=>void 0!==e?e:void 0!==t?t:0,rI=e=>{let t=e.dom.ownerDocument,r=t.body,l=t.defaultView,o=t.documentElement;if(r===e.dom)return rM(r.offsetLeft,r.offsetTop);let n=rj(null==l?void 0:l.pageYOffset,o.scrollTop),s=rj(null==l?void 0:l.pageXOffset,o.scrollLeft),a=rj(o.clientTop,r.clientTop),i=rj(o.clientLeft,r.clientLeft);return rP(e).translate(s-i,n-a)},rP=e=>{let t=e.dom,r=t.ownerDocument.body;return r===t?rM(r.offsetLeft,r.offsetTop):eZ(e)?(e=>{let t=e.getBoundingClientRect();return rM(t.left,t.top)})(t):rM(0,0)},rF=(e,t)=>({row:e,y:t}),rH=(e,t)=>({col:e,x:t}),rq=e=>rI(e).left+rn(e),rV=e=>rI(e).left,r$=(e,t)=>rH(e,rV(t)),rU=(e,t)=>rH(e,rq(t)),rG=e=>rI(e).top,rK=(e,t)=>rF(e,rG(t)),rY=(e,t)=>rF(e,rG(t)+r_(t)),rJ=(e,t,r)=>{if(0===r.length)return[];let l=E(r.slice(1),(t,r)=>t.map(t=>e(r,t))),o=r[r.length-1].map(e=>t(r.length-1,e));return l.concat([o])},rQ={delta:h,positions:e=>rJ(rK,rY,e),edge:rG},rX=rz({delta:h,edge:rV,positions:e=>rJ(r$,rU,e)},{delta:e=>-e,edge:rq,positions:e=>rJ(rU,r$,e)}),rZ={delta:(e,t)=>rX(t).delta(e,t),positions:(e,t)=>rX(t).positions(e,t),edge:e=>rX(e).edge(e)},r0={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},r1=(()=>{let e="[0-9]+",t="[eE][+-]?[0-9]+",r=e=>`(?:${e})?`,l=["Infinity","[0-9]+\\."+r(e)+r(t),"\\.[0-9]+"+r(t),e+r(t)].join("|");return RegExp(`^([+-]?(?:${l}))(.*)$`)})(),r9=/(\d+(\.\d+)?)%/,r3=/(\d+(\.\d+)?)px|em/,r5=ea("col"),r2=(e,t,r)=>{let l=C.from(e.dom.parentElement).map(ep.fromDom).getOrThunk(()=>e0(eC(e)));return t(e)/r(l)*100},r7=(e,t)=>{tu(e,"width",t+"px")},r4=(e,t)=>{tu(e,"width",t+"%")},r6=(e,t)=>{tu(e,"height",t+"px")},r8=e=>{let t=rr(e,"height",e.dom.offsetHeight)+"px";return t?((e,t,r,l)=>{let o=parseFloat(e);return ta(e,"%")&&"table"!==Z(t)?((e,t,r,l)=>{let o=tN(e).map(e=>{let l=r(e);return Math.floor(t/100*l)}).getOr(t);return l(e,o),o})(t,o,r,l):o})(t,e,rL,r6):rL(e)},le=(e,t)=>tp(e,t).orThunk(()=>eu(e,t).map(e=>e+"px")),lt=e=>le(e,"width"),lr=e=>r2(e,ro,rs),ll=e=>r5(e)?ro(e):rr(e,"width",e.dom.offsetWidth),lo=e=>r8(e)/tv(e,"rowspan"),ln=(e,t,r)=>{tu(e,"width",t+r)},ls=e=>r2(e,ro,rs)+"%",la=g(r9),li=ea("col"),lm=e=>lt(e).getOrThunk(()=>ll(e)+"px"),ld=e=>le(e,"height").getOrThunk(()=>lo(e)+"px"),lc=(e,t,r,l,o,n)=>e.filter(l).fold(()=>n(((e,t)=>{if(t<0||t>=e.length-1)return C.none();let r=e[t].fold(()=>{let r=(e=>{let t=S.call(e,0);return t.reverse(),t})(e.slice(0,t));return V(r,(e,t)=>e.map(e=>({value:e,delta:t+1})))},e=>C.some({value:e,delta:0})),l=e[t+1].fold(()=>{let r=e.slice(t+1);return V(r,(e,t)=>e.map(e=>({value:e,delta:t+1})))},e=>C.some({value:e,delta:1}));return r.bind(e=>l.map(t=>{let r=t.delta+e.delta;return Math.abs(t.value-e.value)/r}))})(r,t)),e=>o(e)),lu=(e,t,r,l)=>{let o=rE(e),n=rO(e)?E(rD(e),e=>C.from(e.element)):o,s=[C.some(rZ.edge(t))].concat(E(rZ.positions(o,t),e=>e.map(e=>e.x))),a=w(ty);return E(n,(e,t)=>lc(e,t,s,a,e=>{var n;if((e=>{let t=re().browser,r=t.isChromium()||t.isFirefox();return!li(e)||r})(e))return r(e);{let i=null!=(n=o[t])?h(n):C.none();return lc(i,t,s,a,e=>l(C.some(ro(e))),l)}},l))},lf=e=>e.map(e=>e+"px").getOr(""),lg=(e,t,r)=>lu(e,t,ll,e=>e.getOrThunk(r.minCellWidth)),lh=(e,t,r,l,o)=>{let n=rB(e),s=[C.some(r.edge(t))].concat(E(r.positions(n,t),e=>e.map(e=>e.y)));return E(n,(e,t)=>lc(e,t,s,w(tx),l,o))},lp=(e,t)=>()=>eZ(e)?t(e):parseFloat(tp(e,"width").getOr("0")),lb=e=>{let t=lp(e,e=>parseFloat(ls(e))),r=lp(e,ro);return{width:t,pixelWidth:r,getWidths:(t,r)=>lu(t,e,lr,e=>e.fold(()=>r.minCellWidth(),e=>e/r.pixelWidth()*100)),getCellDelta:e=>e/r()*100,singleColumnWidth:(e,t)=>[100-e],minCellWidth:()=>tS()/r()*100,setElementWidth:r4,adjustTableWidth:r=>{let l=t();r4(e,l+r/100*l)},isRelative:!0,label:"percent"}},lw=e=>{let t=lp(e,ro);return{width:t,pixelWidth:t,getWidths:(t,r)=>lg(t,e,r),getCellDelta:h,singleColumnWidth:(e,t)=>[Math.max(tS(),e+t)-e],minCellWidth:tS,setElementWidth:r7,adjustTableWidth:r=>{let l=t()+r;r7(e,l)},isRelative:!1,label:"pixel"}},lv=e=>lt(e).fold(()=>(e=>{let t=lp(e,ro),r=g(0);return{width:t,pixelWidth:t,getWidths:(t,r)=>lg(t,e,r),getCellDelta:r,singleColumnWidth:g([0]),minCellWidth:r,setElementWidth:f,adjustTableWidth:f,isRelative:!0,label:"none"}})(e),t=>null!==la().exec(t)?lb(e):lw(e)),ly=(e,t,r)=>{let l=e[r].element,o=ep.fromTag("td");eA(o,ep.fromTag("br")),(t?eA:ez)(l,o)},lx=((e,t)=>{let r=t=>e(t)?C.from(t.dom.nodeValue):C.none();return{get:t=>{if(!e(t))throw Error("Can only get text value of a text node");return r(t).getOr("")},getOption:r,set:(t,r)=>{if(!e(t))throw Error("Can only set raw text value of a text node");t.dom.nodeValue=r}}})(eo),lC=e=>lx.get(e),lS=e=>lx.getOption(e),lT=(e,t)=>lx.set(e,t),lR=e=>"img"===Z(e)?1:lS(e).fold(()=>ek(e).length,e=>e.length),lD=["img","br"],lO=e=>lS(e).filter(e=>0!==e.trim().length||e.indexOf("\xa0")>-1).isSome()||D(lD,Z(e)),lk=e=>((e,t)=>{let r=e=>{for(let l=0;l<e.childNodes.length;l++){let o=ep.fromDom(e.childNodes[l]);if(t(o))return C.some(o);let n=r(e.childNodes[l]);if(n.isSome())return n}return C.none()};return r(e.dom)})(e,lO),lE=e=>lN(e,lO),lN=(e,t)=>{let r=e=>{let l=ek(e);for(let o=l.length-1;o>=0;o--){let n=l[o];if(t(n))return C.some(n);let s=r(n);if(s.isSome())return s}return C.none()};return r(e)},lB={scope:["row","col"]},lz=e=>()=>{let t=ep.fromTag("td",e.dom);return eA(t,ep.fromTag("br",e.dom)),t},lA=e=>()=>ep.fromTag("col",e.dom),lW=e=>()=>ep.fromTag("colgroup",e.dom),lL=e=>()=>ep.fromTag("tr",e.dom),l_=(e,t,r)=>{let l=((e,t)=>{let r=eq(e,t),l=ek(eH(e));return e_(r,l),r})(e,t);return G(r,(e,t)=>{null===e?ef(l,t):em(l,t,e)}),l},lM=e=>e,lj=(e,t,r)=>{let l=(e,t)=>{((e,t)=>{let r=e.dom,l=t.dom;td(r)&&td(l)&&(l.style.cssText=r.style.cssText)})(e.element,t),tb(t,"height"),1!==e.colspan&&tb(t,"width")};return{col:r=>{let o=ep.fromTag(Z(r.element),t.dom);return l(r,o),e(r.element,o),o},colgroup:lW(t),row:lL(t),cell:o=>{var n,s;let a=ep.fromTag(Z(o.element),t.dom),i=r.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),m=i.length>0?lk(n=o.element).map(e=>{let t=i.join(","),r=e9(e,t,e=>ey(e,n));return A(r,(e,t)=>{let r=eF(t);return ef(r,"contenteditable"),eA(e,r),r},a)}).getOr(a):a;return eA(m,ep.fromTag("br")),l(o,a),s=o.element,G(lB,(e,t)=>eu(s,t).filter(t=>D(e,t)).each(e=>em(a,t,e))),e(o.element,a),a},replace:l_,colGap:lA(t),gap:lz(t)}},lI=e=>({col:lA(e),colgroup:lW(e),row:lL(e),cell:lz(e),replace:lM,colGap:lA(e),gap:lz(e)}),lP=e=>ep.fromDom(e.getBody()),lF=e=>t=>ey(t,lP(e)),lH=e=>{ef(e,"data-mce-style");let t=e=>ef(e,"data-mce-style");N(tk(e),t),N(tE(e),t),N(tB(e),t)},lq=e=>ep.fromDom(e.selection.getStart()),lV=e=>e.getBoundingClientRect().width,l$=e=>e.getBoundingClientRect().height,lU=(e,t)=>{let r=t.column,l=t.column+t.colspan-1,o=t.row,n=t.row+t.rowspan-1;return r<=e.finishCol&&l>=e.startCol&&o<=e.finishRow&&n>=e.startRow},lG=(e,t)=>t.column>=e.startCol&&t.column+t.colspan-1<=e.finishCol&&t.row>=e.startRow&&t.row+t.rowspan-1<=e.finishRow,lK=(e,t,r)=>{let l=rT(e,t,ey),o=rT(e,r,ey);return l.bind(e=>o.map(t=>({startRow:Math.min(e.row,t.row),startCol:Math.min(e.column,t.column),finishRow:Math.max(e.row+e.rowspan-1,t.row+t.rowspan-1),finishCol:Math.max(e.column+e.colspan-1,t.column+t.colspan-1)})))},lY=(e,t,r)=>lK(e,t,r).map(t=>{let r=ry(e,b(lU,t));return E(r,e=>e.element)}),lJ=(e,t)=>rT(e,t,(e,t)=>ex(t,e)).map(e=>e.element),lQ=(e,t,r)=>{let l=lZ(e);return lY(l,t,r)},lX=(e,t,r,l,o)=>{let n=lZ(e),s=ey(e,r)?C.some(t):lJ(n,t),a=ey(e,o)?C.some(l):lJ(n,l);return s.bind(e=>a.bind(t=>lY(n,e,t)))},lZ=rC;var l0=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],l1=()=>({up:g({selector:e4,closest:te,predicate:e7,all:eR}),down:g({selector:e5,predicate:e1}),styles:g({get:tg,getRaw:tp,set:tu,remove:tb}),attrs:g({get:ec,set:em,remove:ef,copyTo:(e,t)=>{let r=eg(e);ed(t,r)}}),insert:g({before:eN,after:eB,afterAll:eL,append:eA,appendAll:e_,prepend:ez,wrap:eW}),remove:g({unwrap:eI,remove:ej}),create:g({nu:ep.fromTag,clone:e=>ep.fromDom(e.dom.cloneNode(!1)),text:ep.fromText}),query:g({comparePosition:(e,t)=>e.dom.compareDocumentPosition(t.dom),prevSibling:eD,nextSibling:eO}),property:g({children:ek,name:Z,parent:eT,document:e=>eS(e).dom,isText:eo,isComment:er,isElement:el,isSpecial:e=>{let t=Z(e);return D(["script","noscript","iframe","noframes","noembed","title","style","textarea","xmp"],t)},getLanguage:e=>el(e)?eu(e,"lang"):C.none(),getText:lC,setText:lT,isBoundary:e=>!!el(e)&&("body"===Z(e)||D(l0,Z(e))),isEmptyTag:e=>!!el(e)&&D(["br","img","hr","input"],Z(e)),isNonEditable:e=>el(e)&&"false"===ec(e,"contenteditable")}),eq:ey,is:eb});let l9=(e,t,r,l)=>{let o=t(e,r);return A(l,(r,l)=>{let o=t(e,l);return l3(e,r,o)},o)},l3=(e,t,r)=>t.bind(t=>r.filter(b(e.eq,t))),l5=l1(),l2=(e,t)=>{var r;return r=(t,r)=>e(r),t.length>0?l9(l5,r,t[0],t.slice(1)):C.none()},l7=e=>e4(e,"table"),l4=(e,t,r)=>{let l=e=>t=>void 0!==r&&r(t)||ey(t,e);return ey(e,t)?C.some({boxes:C.some([e]),start:e,finish:t}):l7(e).bind(o=>l7(t).bind(n=>{if(ey(o,n))return C.some({boxes:lQ(o,e,t),start:e,finish:t});if(ex(o,n)){let s=e9(t,"td,th",l(o)),a=s.length>0?s[s.length-1]:t;return C.some({boxes:lX(o,e,o,t,n),start:e,finish:a})}if(ex(n,o)){let i=e9(e,"td,th",l(n)),m=i.length>0?i[i.length-1]:e;return C.some({boxes:lX(n,e,o,t,n),start:e,finish:m})}return((e,t,r,l=y)=>{let o=[t].concat(e.up().all(t)),n=[r].concat(e.up().all(r)),s=e=>_(e,l).fold(()=>e,t=>e.slice(0,t+1)),a=s(o),i=s(n),m=L(a,t=>O(i,b(e.eq,t)));return{firstpath:a,secondpath:i,shared:m}})(l5,e,t,void 0).shared.bind(s=>te(s,"table",r).bind(r=>{let s=e9(t,"td,th",l(r)),a=s.length>0?s[s.length-1]:t,i=e9(e,"td,th",l(r)),m=i.length>0?i[i.length-1]:e;return C.some({boxes:lX(r,e,o,t,n),start:m,finish:a})}))}))},l6=(e,t)=>{let r=e5(e,t);return r.length>0?C.some(r):C.none()},l8=(e,t,r)=>e8(e,t).bind(t=>e8(e,r).bind(e=>l2(l7,[t,e]).map(r=>({first:t,last:e,table:r})))),oe=(e,t,r,l,o)=>L(e,e=>eb(e,o)).bind(e=>tN(e).bind(l=>{var o;return rT(o=lZ(l),e,ey).bind(e=>{let l=t>0?e.row+e.rowspan-1:e.row,n=r>0?e.column+e.colspan-1:e.column;return rS(o,l+t,n+r).map(e=>e.element)})}).bind(e=>e4(e,"table").bind(t=>e8(t,l).bind(t=>l4(t,e).bind(e=>e.boxes.map(t=>({boxes:t,start:e.start,finish:e.finish}))))))),ot=(e,t)=>l6(e,t),or=(e,t,r)=>l8(e,t,r).bind(t=>{let r=t=>ey(e,t),l="thead,tfoot,tbody,table",o=e4(t.first,l,r),n=e4(t.last,l,r);return o.bind(e=>n.bind(r=>{var l,o,n,s;return ey(e,r)?(l=t.table,o=t.first,n=t.last,lK(s=lZ(l),o,n).bind(e=>((e,t)=>{let r=!0,l=b(lG,t);for(let o=t.startRow;o<=t.finishRow;o++)for(let n=t.startCol;n<=t.finishCol;n++)r=r&&rS(e,o,n).exists(l);return r?C.some(t):C.none()})(s,e))):C.none()}))}),ol=e=>{let t=(e,t)=>eu(e,t).exists(e=>parseInt(e,10)>1);return e.length>0&&I(e,e=>t(e,"rowspan")||t(e,"colspan"))?C.some(e):C.none()},oo=(e,t,r)=>t.length<=1?C.none():or(e,r.firstSelectedSelector,r.lastSelectedSelector).map(e=>({bounds:e,cells:t})),on={selected:"data-mce-selected",selectedSelector:"td[data-mce-selected],th[data-mce-selected]",firstSelected:"data-mce-first-selected",firstSelectedSelector:"td[data-mce-first-selected],th[data-mce-first-selected]",lastSelected:"data-mce-last-selected",lastSelectedSelector:"td[data-mce-last-selected],th[data-mce-last-selected]"},os=(e,t,r)=>({element:r,mergable:oo(t,e,on),unmergable:ol(e),selection:h(e)}),oa=e=>(t,r)=>{let l=Z(t),o="col"===l||"colgroup"===l?tN(t).bind(e=>ot(e,on.firstSelectedSelector)).fold(g(t),e=>e[0]):t;return te(o,e,r)},oi=oa("th,td,caption"),om=oa("th,td"),od=e=>E(e.model.table.getSelectedCells(),ep.fromDom),oc=(e,t)=>{e.on("BeforeGetContent",t=>{if(!0===t.selection){let r=z(od(e),e=>eb(e,on.selectedSelector));r.length>=1&&(t.preventDefault(),tN(r[0]).map(e=>{let t=((e,t)=>{let r=e=>eb(e.element,t),l=eH(e),o=tL(l),n=lv(e),s=rx(o),a=((e,t)=>{let r=e.grid.columns,l=e.grid.rows,o=r,n=0,s=0,a=[],i=[];return G(e.access,e=>{if(a.push(e),t(e)){i.push(e);let r=e.row,m=r+e.rowspan-1,d=e.column,c=d+e.colspan-1;r<l?l=r:m>n&&(n=m),d<o?o=d:c>s&&(s=c)}}),{minRow:l,minCol:o,maxRow:n,maxCol:s,allCells:a,selectedCells:i}})(s,r),i="th:not("+t+"),td:not("+t+")",m=tD(l,"th,td",e=>eb(e,i));N(m,ej),((e,t,r,l)=>{let o=z(e,e=>"colgroup"!==e.section),n=t.grid.columns,s=t.grid.rows;for(let a=0;a<s;a++){let i=!1;for(let m=0;m<n;m++)a<r.minRow||a>r.maxRow||m<r.minCol||m>r.maxCol||(rS(t,a,m).filter(l).isNone()?ly(o,i,a):i=!0)}})(o,s,a,r);let d=((e,t,r,l)=>{if(0===l.minCol&&t.grid.columns===l.maxCol+1)return 0;let o=lg(t,e,r),n=W(o,(e,t)=>e+t,0),s=W(o.slice(l.minCol,l.maxCol+1),(e,t)=>e+t,0),a=s/n*r.pixelWidth()-r.pixelWidth();return r.getCellDelta(a)})(e,rC(e),n,a);return((e,t,r,l)=>{G(r.columns,e=>{(e.column<t.minCol||e.column>t.maxCol)&&ej(e.element)});let o=z(tR(e,"tr"),e=>0===e.dom.childElementCount);N(o,ej),t.minCol!==t.maxCol&&t.minRow!==t.maxRow||N(tR(e,"th,td"),e=>{ef(e,"rowspan"),ef(e,"colspan")}),ef(e,rp),ef(e,"data-snooker-col-series"),lv(e).adjustTableWidth(l)})(l,a,s,d),l})(e,"[data-mce-selected]");return lH(t),[t]}).each(r=>{t.content="text"===t.format?E(r,e=>e.dom.innerText).join(""):E(r,t=>e.selection.serializer.serialize(t.dom,{})).join("")}))}}),e.on("BeforeSetContent",r=>{if(!0===r.selection&&!0===r.paste){let l=od(e);H(l).each(l=>{tN(l).each(o=>{let n=z(((e,t)=>{let r=document.createElement("div");return r.innerHTML=e,ek(ep.fromDom(r))})(r.content),e=>"meta"!==Z(e)),s=ea("table");if(1===n.length&&s(n[0])){r.preventDefault();let a=ep.fromDom(e.getDoc()),i=lI(a),m={element:l,clipboard:n[0],generators:i};t.pasteCells(o,m).each(()=>{e.focus()})}})})}})},ou=(e,t)=>({element:e,offset:t}),of=(e,t,r)=>e.property().isText(t)&&0===e.property().getText(t).trim().length||e.property().isComment(t)?r(t).bind(t=>of(e,t,r).orThunk(()=>C.some(t))):C.none(),og=(e,t)=>e.property().isText(t)?e.property().getText(t).length:e.property().children(t).length,oh=(e,t)=>{let r=of(e,t,e.query().prevSibling).getOr(t);if(e.property().isText(r))return ou(r,og(e,r));let l=e.property().children(r);return l.length>0?oh(e,l[l.length-1]):ou(r,og(e,r))},op=l1(),ob=(e,t)=>{if(!ty(e)){let r=lt(e).bind(e=>{var t;return t=["fixed","relative","empty"],C.from(r1.exec(e)).bind(e=>{let r=Number(e[1]),l=e[2];return O(t,e=>O(r0[e],e=>l===e))?C.some({value:r,unit:l}):C.none()})});r.each(r=>{let l=r.value/2;ln(e,l,r.unit),ln(t,l,r.unit)})}},ow=e=>E(e,g(0)),ov=(e,t,r,l,o)=>o(e.slice(0,t)).concat(l).concat(o(e.slice(r))),oy=e=>(t,r,l,o)=>{if(e(l)){let n=Math.max(o,t[r]-Math.abs(l)),s=Math.abs(n-t[r]);return l>=0?s:-s}return l},ox=oy(e=>e<0),oC=oy(x),oS=()=>{let e=(e,t,r,l)=>{let o=(100+r)/100,n=Math.max(l,(e[t]+r)/o);return E(e,(e,r)=>(r===t?n:e/o)-e)},t=(t,r,l,o,n,s)=>s?e(t,r,o,n):((e,t,r,l,o)=>{let n=ox(e,t,l,o);return ov(e,t,r+1,[n,0],ow)})(t,r,l,o,n);return{resizeTable:(e,t)=>e(t),clampTableDelta:ox,calcLeftEdgeDeltas:t,calcMiddleDeltas:(e,r,l,o,n,s,a)=>t(e,l,o,n,s,a),calcRightEdgeDeltas:(t,r,l,o,n,s)=>{if(s)return e(t,l,o,n);{let a=ox(t,l,o,n);return ow(t.slice(0,l)).concat([a])}},calcRedestributedWidths:(e,t,r,l)=>{if(l){let o=(t+r)/t,n=E(e,e=>e/o);return{delta:100*o-100,newSizes:n}}return{delta:r,newSizes:e}}}},oT=()=>{let e=(e,t,r,l,o)=>{let n=oC(e,l>=0?r:t,l,o);return ov(e,t,r+1,[n,-n],ow)};return{resizeTable:(e,t,r)=>{r&&e(t)},clampTableDelta:(e,t,r,l,o)=>{if(o){if(r>=0)return r;{let n=W(e,(e,t)=>e+t-l,0);return Math.max(-n,r)}}return ox(e,t,r,l)},calcLeftEdgeDeltas:e,calcMiddleDeltas:(t,r,l,o,n,s)=>e(t,l,o,n,s),calcRightEdgeDeltas:(e,t,r,l,o,n)=>{if(n)return ow(e);{let s=l/e.length;return E(e,g(s))}},calcRedestributedWidths:(e,t,r,l)=>({delta:0,newSizes:e})}},oR=e=>rC(e).grid,oD=ea("th"),oO=e=>I(e,e=>oD(e.element)),ok=(e,t)=>e&&t?"sectionCells":e?"section":"cells",oE=e=>{let t="thead"===e.section,r=tt(oN(e.cells),"th");return"tfoot"===e.section?{type:"footer"}:t||r?{type:"header",subType:ok(t,r)}:{type:"body"}},oN=e=>{let t=z(e,e=>oD(e.element));return 0===t.length?C.some("td"):t.length===e.length?C.some("th"):C.none()},oB=(e,t,r)=>eG(r(e.element,t),!0,e.isLocked),oz=(e,t)=>e.section!==t?eK(e.element,e.cells,t,e.isNew):e,oA=()=>({transformRow:oz,transformCell:(e,t,r)=>{let l=r(e.element,t),o="td"!==Z(l)?((e,t)=>{let r=eq(e,"td");eB(e,r);let l=ek(e);return e_(r,l),ej(e),r})(l):l;return eG(o,e.isNew,e.isLocked)}}),oW=()=>({transformRow:oz,transformCell:oB}),oL=()=>({transformRow:(e,t)=>oz(e,"thead"===t?"tbody":t),transformCell:oB}),o_=()=>({transformRow:h,transformCell:oB}),oM=e=>te(e,"[contenteditable]"),oj=(e,t=!1)=>eZ(e)?e.dom.isContentEditable:oM(e).fold(g(t),e=>"true"===oI(e)),oI=e=>e.dom.contentEditable,oP=(e,t,r,l)=>{r===l?ef(e,t):em(e,t,r)},oF=(e,t,r)=>{q(e3(e,t)).fold(()=>ez(e,r),e=>eB(e,r))},oH=(e,t)=>{let r=[],l=[],o=e=>E(e,e=>{e.isNew&&r.push(e.element);let t=e.element;return eM(t),N(e.cells,e=>{e.isNew&&l.push(e.element),oP(e.element,"colspan",e.colspan,1),oP(e.element,"rowspan",e.rowspan,1),eA(t,e.element)}),t}),n=e=>j(e,e=>E(e.cells,e=>(oP(e.element,"span",e.colspan,1),e.element))),s=(t,r)=>{let l=((e,t)=>{let r=e6(e,t).getOrThunk(()=>{let r=ep.fromTag(t,eC(e).dom);return"thead"===t?oF(e,"caption,colgroup",r):"colgroup"===t?oF(e,"caption",r):eA(e,r),r});return eM(r),r})(e,r),s=("colgroup"===r?n:o)(t);e_(l,s)},a=(t,r)=>{t.length>0?s(t,r):(t=>{e6(e,t).each(ej)})(r)},i=[],m=[],d=[],c=[];return N(t,e=>{switch(e.section){case"thead":i.push(e);break;case"tbody":m.push(e);break;case"tfoot":d.push(e);break;case"colgroup":c.push(e)}}),a(c,"colgroup"),a(i,"thead"),a(m,"tbody"),a(d,"tfoot"),{newRows:r,newCells:l}},oq=(e,t)=>{if(0===e.length)return 0;let r=e[0];return _(e,e=>!t(r.element,e.element)).getOr(e.length)},oV=(e,t)=>{let r=E(e,e=>E(e.cells,y));return E(e,(l,o)=>{let n=j(l.cells,(l,n)=>{var s;if(!1===r[o][n]){let a=((e,t,r,l)=>{let o=e[t],n="colgroup"===o.section,s=oq(o.cells.slice(r),l),a=n?1:oq(E(e.slice(t),e=>rc(e,r)),l);return{colspan:s,rowspan:a}})(e,o,n,t);return((e,t,l,o)=>{for(let n=e;n<e+l;n++)for(let s=t;s<t+o;s++)r[n][s]=!0})(o,n,a.rowspan,a.colspan),[(s=l.element,{element:s,rowspan:a.rowspan,colspan:a.colspan,isNew:l.isNew})]}return[]});return{element:l.element,cells:n,section:l.section,isNew:l.isNew}})},o$=(e,t,r)=>{let l=[];N(e.colgroups,o=>{let n=[];for(let s=0;s<e.grid.columns;s++){let a=rk(e,s).map(e=>eG(e.element,r,!1)).getOrThunk(()=>eG(t.colGap(),!0,!1));n.push(a)}l.push(eK(o.element,n,"colgroup",r))});for(let o=0;o<e.grid.rows;o++){let n=[];for(let s=0;s<e.grid.columns;s++){let a=rS(e,o,s).map(e=>eG(e.element,r,e.isLocked)).getOrThunk(()=>eG(t.gap(),!0,!1));n.push(a)}let i=e.all[o],m=eK(i.element,n,i.section,r);l.push(m)}return l},oU=e=>oV(e,ey),oG=(e,t)=>V(e.all,e=>L(e.cells,e=>ey(t,e.element))),oK=(e,t,r)=>{let l=E(t.selection,t=>tO(t).bind(t=>oG(e,t)).filter(r)),o=tr(l);return tl(o.length>0,o)},oY=(e,t,r,l,o)=>(n,s,a,i)=>{let m=rC(n),d=C.from(null==i?void 0:i.section).getOrThunk(o_);return t(m,s).map(t=>{let r=o$(m,a,!1),l=e(r,t,ey,o(a),d),n=rw(l.grid);return{info:t,grid:oU(l.grid),cursor:l.cursor,lockedColumns:n}}).bind(e=>{let t=oH(n,e.grid),o=C.from(null==i?void 0:i.sizing).getOrThunk(()=>lv(n)),s=C.from(null==i?void 0:i.resize).getOrThunk(oT);return r(n,e.grid,e.info,{sizing:o,resize:s,section:d}),l(n),ef(n,rp),e.lockedColumns.length>0&&em(n,rp,e.lockedColumns.join(",")),C.some({cursor:e.cursor,newRows:t.newRows,newCells:t.newCells})})},oJ=(e,t)=>oK(e,t,x).map(e=>({cells:e,generators:t.generators,clipboard:t.clipboard})),oQ=(e,t)=>oK(e,t,x),oX=(e,t)=>oK(e,t,e=>!e.isLocked),oZ=(e,t)=>I(t,t=>oG(e,t).exists(e=>!e.isLocked)),o0=(e,t,r,l)=>{let o=rg(e).rows,n=!0;for(let s=0;s<o.length;s++)for(let a=0;a<rf(o[0]);a++){let i=o[s],m=rc(i,a),d=r(m.element,t);d&&!n?rm(i,a,eG(l(),!0,m.isLocked)):d&&(n=!1)}return e},o1=e=>{let t=t=>t(e),r=g(e),l={tag:!0,inner:e,fold:(t,r)=>r(e),isValue:x,isError:y,map:t=>o3.value(t(e)),mapError:()=>l,bind:t,exists:t,forall:t,getOr:r,or:()=>l,getOrThunk:r,orThunk:()=>l,getOrDie:r,each:t=>{t(e)},toOptional:()=>C.some(e)};return l},o9=e=>{var t;let r={tag:!1,inner:e,fold:(t,r)=>t(e),isValue:y,isError:x,map:()=>r,mapError:t=>o3.error(t(e)),bind:()=>r,exists:y,forall:x,getOr:h,or:h,getOrThunk:v,orThunk:v,getOrDie:(t=String(e),()=>{throw Error(t)}),each:f,toOptional:C.none};return r},o3={value:o1,error:o9,fromOption:(e,t)=>e.fold(()=>o9(t),o1)},o5=(e,t)=>({rowDelta:0,colDelta:rf(e[0])-rf(t[0])}),o2=(e,t)=>({rowDelta:e.length-t.length,colDelta:0}),o7=(e,t,r,l)=>{let o="colgroup"===t.section?r.col:r.cell;return k(e,e=>eG(o(),!0,l(e)))},o4=(e,t,r,l)=>{let o=e[e.length-1];return e.concat(k(t,()=>{let e="colgroup"===o.section?r.colgroup:r.row,t=rh(o,e,h),n=o7(t.cells.length,t,r,e=>X(l,e.toString()));return rd(t,n)}))},o6=(e,t,r,l)=>E(e,e=>{let o=o7(t,e,r,y);return ra(e,l,o)}),o8=(e,t,r)=>{let l=t.colDelta<0?o6:h,o=t.rowDelta<0?o4:h,n=rw(e),s=rf(e[0]),a=O(n,e=>e===s-1),i=l(e,Math.abs(t.colDelta),r,a?s-1:s),m=rw(i);return o(i,Math.abs(t.rowDelta),r,P(m,x))},ne=(e,t,r,l)=>{let o=b(l,rc(e[t],r).element),n=e[t];return e.length>1&&rf(n)>1&&(r>0&&o(ru(n,r-1))||r<n.cells.length-1&&o(ru(n,r+1))||t>0&&o(ru(e[t-1],r))||t<e.length-1&&o(ru(e[t+1],r)))},nt=(e,t,r)=>z(r,r=>r>=e.column&&r<=rf(t[0])+e.column),nr=(e,t,r,l,o)=>{var n;n=l.cell,e>0&&e<t[0].cells.length&&N(t,t=>{let r=t.cells[e-1],l=0,s=n();for(;t.cells.length>e+l&&o(r.element,t.cells[e+l].element);)rm(t,e+l,eG(s,!0,t.cells[e+l].isLocked)),l++});let s=o2(r,t),a=o8(r,s,l),i=o2(t,a),m=o8(t,i,l);return E(m,(t,r)=>ra(t,e,a[r].cells))},nl=(e,t,r,l,o)=>{((e,t,r,l)=>{let o=rg(e).rows;if(t>0&&t<o.length){let n=W(o[t-1].cells,(e,t)=>O(e,e=>r(e.element,t.element))?e:e.concat([t]),[]);N(n,e=>{let n=C.none();for(let s=t;s<o.length;s++)for(let a=0;a<rf(o[0]);a++){let i=o[s],m=rc(i,a);r(m.element,e.element)&&(n.isNone()&&(n=C.some(l())),n.each(e=>{rm(i,a,eG(e,!0,m.isLocked))}))}})}})(t,e,o,l.cell);let n=rw(t),s=o5(t,r),a={...s,colDelta:s.colDelta-n.length},i=o8(t,a,l),{cols:m,rows:d}=rg(i),c=rw(i),u=o5(r,t),f={...u,colDelta:u.colDelta+c.length},g=E(r,e=>W(c,(t,r)=>{let o=o7(1,e,l,x)[0];return ri(t,r,o)},e)),h=o8(g,f,l);return[...m,...d.slice(0,e),...h,...d.slice(e,d.length)]},no=(e,t,r,l,o)=>{let{rows:n,cols:s}=rg(e),a=n.slice(0,t),i=n.slice(t);return[...s,...a,rh(n[r],e=>o(e,l),(e,r)=>t>0&&t<n.length&&l(ru(n[t-1],r),ru(n[t],r))?rc(n[t],r):eG(o(e.element,l),!0,e.isLocked)),...i]},nn=(e,t,r,l,o)=>E(e,e=>{let n=t>0&&t<rf(e)&&l(ru(e,t-1),ru(e,t)),s=((e,t,r,l,o,n,s)=>{if("colgroup"!==r&&l)return rc(e,t);{let a=rc(e,o);return eG(s(a.element,n),!0,!1)}})(e,t,e.section,n,r,l,o);return ri(e,t,s)}),ns=(e,t,r,l)=>{var o;return void 0!==ru(e[t],r)&&t>0&&l(ru(e[t-1],r),ru(e[t],r))||(o=e[t],r>0&&l(ru(o,r-1),ru(o,r)))},na=(e,t,r,l)=>{let o=e=>("row"===e?tx(t):ty(t))?`${e}group`:e;return e?oD(t)?o(r):null:l&&oD(t)?o("row"===r?"col":"row"):null},ni=(e,t,r)=>eG(r(e.element,t),!0,e.isLocked),nm=(e,t,r,l,o,n,s)=>E(e,(e,a)=>((e,i)=>{let m=e.cells,d=E(m,(e,i)=>{if(O(t,t=>r(e.element,t.element))){let m=s(e,a,i)?o(e,r,l):e;return n(m,a,i).each(e=>{var t;t=m.element,G({scope:C.from(e)},(e,r)=>{e.fold(()=>{ef(t,r)},e=>{ei(t.dom,r,e)})})}),m}return e});return eK(e.element,d,e.section,e.isNew)})(e)),nd=(e,t,r)=>j(e,(l,o)=>ns(e,o,t,r)?[]:[rc(l,t)]),nc=(e,t,r,l,o)=>{let n=rg(e).rows,s=j(t,e=>nd(n,e,l)),a=E(n,e=>oO(e.cells)),i=I(a,h)&&oO(s)?x:(e,t,r)=>!("th"===Z(e.element)&&a[t]),m=(e,t)=>C.some(na(r,e.element,"row",a[t]));return nm(e,s,l,o,ni,m,i)},nu=(e,t,r,l)=>{let o=rg(e).rows,n=E(t,e=>rc(o[e.row],e.column));return nm(e,n,r,l,ni,C.none,x)},nf=e=>{if(!s(e))throw Error("cases must be an array");if(0===e.length)throw Error("there must be at least one case");let t=[],r={};return N(e,(l,o)=>{let n=$(l);if(1!==n.length)throw Error("one and only one name per case");let a=n[0],i=l[a];if(void 0!==r[a])throw Error("duplicate key detected:"+a);if("cata"===a)throw Error("cannot have a case named cata (sorry)");if(!s(i))throw Error("case arguments must be an array");t.push(a),r[a]=(...r)=>{let l=r.length;if(l!==i.length)throw Error("Wrong number of arguments to case "+a+". Expected "+i.length+" ("+i+"), got "+l);return{fold:(...t)=>{if(t.length!==e.length)throw Error("Wrong number of arguments to fold. Expected "+e.length+", got "+t.length);return t[o].apply(null,r)},match:e=>{let l=$(e);if(t.length!==l.length)throw Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+l.join(","));if(!I(t,e=>D(l,e)))throw Error("Not all branches were specified when using match. Specified: "+l.join(", ")+"\nRequired: "+t.join(", "));return e[a].apply(null,r)},log:e=>{console.log(e,{constructors:t,constructor:a,params:r})}}}}),r},ng={...nf([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}])},nh=(e,t,r)=>{let l=0;for(let o=e;o<t;o++)l+=void 0!==r[o]?r[o]:0;return l},np=(e,t)=>{let r=rR(e);return E(r,e=>{let r=nh(e.row,e.row+e.rowspan,t);return{element:e.element,height:r,rowspan:e.rowspan}})},nb=(e,t,r)=>{let l=rO(e)?((e,t)=>{let r=rD(e);return E(r,(e,r)=>({element:e.element,width:t[r],colspan:e.colspan}))})(e,t):((e,t)=>{let r=rR(e);return E(r,e=>{let r=nh(e.column,e.column+e.colspan,t);return{element:e.element,width:r,colspan:e.colspan}})})(e,t);N(l,e=>{r.setElementWidth(e.element,e.width)})},nw=(e,t,r,l,o)=>{let n=rC(e),s=o.getCellDelta(t),a=o.getWidths(n,o),i=r===n.grid.columns-1,m=l.clampTableDelta(a,r,s,o.minCellWidth(),i),d=((e,t,r,l,o)=>{let n=e.slice(0),s=0===e.length?ng.none():1===e.length?ng.only(0):0===t?ng.left(0,1):t===e.length-1?ng.right(t-1,t):t>0&&t<e.length-1?ng.middle(t-1,t,t+1):ng.none(),a=g(E(n,g(0)));return s.fold(a,e=>l.singleColumnWidth(n[e],r),(e,t)=>o.calcLeftEdgeDeltas(n,e,t,r,l.minCellWidth(),l.isRelative),(e,t,s)=>o.calcMiddleDeltas(n,e,t,s,r,l.minCellWidth(),l.isRelative),(e,t)=>o.calcRightEdgeDeltas(n,e,t,r,l.minCellWidth(),l.isRelative))})(a,r,m,o,l),c=E(d,(e,t)=>e+a[t]);nb(n,c,o),l.resizeTable(o.adjustTableWidth,m,i)},nv=e=>W(e,(e,t)=>O(e,e=>e.column===t.column)?e:e.concat([t]),[]).sort((e,t)=>e.column-t.column),ny=ea("col"),nx=ea("colgroup"),nC=e=>"tr"===Z(e)||nx(e),nS=e=>({element:e,colspan:tw(e,"colspan",1),rowspan:tw(e,"rowspan",1)}),nT=e=>eu(e,"scope").map(e=>e.substr(0,3)),nR=(e,t=nS)=>{let r=r=>{var o,n;if(nC(r))return nx((o={element:r}).element)?e.colgroup(o):e.row(o);{let s=ny((n=t(r)).element)?e.col(n):e.cell(n);return l=C.some({item:r,replacement:s}),s}},l=C.none();return{getOrInit:(e,t)=>l.fold(()=>r(e),l=>t(e,l.item)?l.replacement:r(e))}},nD=e=>t=>{let r=[],l=l=>{let o=t.replace(l,e,"td"===e?{scope:null}:{});return r.push({item:l,sub:o}),o};return{replaceOrInit:(e,t)=>nC(e)||ny(e)?e:L(r,r=>t(r.item,e)).fold(()=>l(e),r=>t(e,r.item)?r.sub:l(e))}},nO=e=>({unmerge:t=>{let r=nT(t);return r.each(e=>em(t,"scope",e)),()=>{let l=e.cell({element:t,colspan:1,rowspan:1});return tb(l,"width"),tb(t,"width"),r.each(e=>em(l,"scope",e)),l}},merge:e=>(tb(e[0],"width"),(()=>{let t=tr(E(e,nT));if(0===t.length)return C.none();{let r=t[0],l=["row","col"];return O(t,e=>e!==r&&D(l,e))?C.none():C.from(r)}})().fold(()=>ef(e[0],"scope"),t=>em(e[0],"scope",t+"group")),g(e[0]))}),nk=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],nE=l1(),nN=e=>((e,t)=>{let r=e.property().name(t);return D(nk,r)})(nE,e),nB=e=>((e,t)=>{let r=e.property().name(t);return D(["ol","ul"],r)})(nE,e),nz=e=>{let t=ea("br"),r=e=>lE(e).bind(r=>{let l=eO(r).map(e=>!!nN(e)||!!D(["br","img","hr","input"],nE.property().name(e))&&"img"!==Z(e)).getOr(!1);return eT(r).map(o=>!0===l||"li"===Z(o)||e7(o,nB).isSome()||t(r)||nN(o)&&!ey(e,o)?[]:[ep.fromTag("br")])}).getOr([]),l=(()=>{let l=j(e,e=>{let l=ek(e);return I(l,e=>t(e)||eo(e)&&0===lC(e).trim().length)?[]:l.concat(r(e))});return 0===l.length?[ep.fromTag("br")]:l})();eM(e[0]),e_(e[0],l)},nA=e=>oj(e,!0),nW=e=>{0===tk(e).length&&ej(e)},nL=(e,t)=>({grid:e,cursor:t}),n_=(e,t,r)=>{let l=((e,t,r)=>{var l,o;let n=rg(e).rows;return C.from(null===(o=null===(l=n[t])||void 0===l?void 0:l.cells[r])||void 0===o?void 0:o.element).filter(nA).orThunk(()=>V(n,e=>V(e.cells,e=>{let t=e.element;return tl(nA(t),t)})))})(e,t,r);return nL(e,l)},nM=e=>W(e,(e,t)=>O(e,e=>e.row===t.row)?e:e.concat([t]),[]).sort((e,t)=>e.row-t.row),nj=(e,t)=>(r,l,o,n,s)=>{let a=nM(l),i=E(a,e=>e.row),m=((e,t,r,l,o,n,s)=>{let{cols:a,rows:i}=rg(e),m=i[t[0]],d=j(t,e=>((e,t,r)=>{let l=e[t];return j(l.cells,(l,o)=>ns(e,t,o,r)?[]:[l])})(i,e,o)),c=E(m.cells,(e,t)=>oO(nd(i,t,o))),u=[...i];N(t,e=>{u[e]=s.transformRow(i[e],r)});let f=[...a,...u],g=I(c,h)&&oO(m.cells)?x:(e,t,r)=>!("th"===Z(e.element)&&c[r]),p=(e,t,r)=>C.some(na(l,e.element,"col",c[r]));return nm(f,d,o,n,s.transformCell,p,g)})(r,i,e,t,o,n.replaceOrInit,s);return n_(m,l[0].row,l[0].column)},nI=nj("thead",!0),nP=nj("tbody",!1),nF=nj("tfoot",!1),nH=(e,t,r)=>{var l;let o=(l=r.section,tA(e,()=>l)),n=rx(o);return o$(n,t,!0)},nq=(e,t,r,l)=>((e,t,r,l)=>{let o=rx(t),n=l.getWidths(o,l);nb(o,n,l)})(0,t,0,l.sizing),nV=(e,t,r,l)=>((e,t,r,l,o)=>{let n=rx(t),s=l.getWidths(n,l),a=l.pixelWidth(),{newSizes:i,delta:m}=o.calcRedestributedWidths(s,a,r.pixelDelta,l.isRelative);nb(n,i,l),l.adjustTableWidth(m)})(0,t,r,l.sizing,l.resize),n$=(e,t)=>O(t,e=>0===e.column&&e.isLocked),nU=(e,t)=>O(t,t=>t.column+t.colspan>=e.grid.columns&&t.isLocked),nG=(e,t)=>{let r=rE(e),l=nv(t);return W(l,(e,t)=>e+r[t.column].map(rn).getOr(0),0)},nK=e=>(t,r)=>oQ(t,r).filter(r=>!(e?n$:nU)(t,r)).map(e=>({details:e,pixelDelta:nG(t,e)})),nY=e=>(t,r)=>oJ(t,r).filter(r=>!(e?n$:nU)(t,r.cells)),nJ=nD("th"),nQ=nD("td"),nX=oY((e,t,r,l)=>{let o=t[0].row,n=nM(t),s=A(n,(e,t)=>({grid:no(e.grid,o,t.row+e.delta,r,l.getOrInit),delta:e.delta+1}),{grid:e,delta:0}).grid;return n_(s,o,t[0].column)},oQ,f,f,nR),nZ=oY((e,t,r,l)=>{let o=nM(t),n=o[o.length-1],s=n.row+n.rowspan,a=A(o,(e,t)=>no(e,s,t.row,r,l.getOrInit),e);return n_(a,s,t[0].column)},oQ,f,f,nR),n0=oY((e,t,r,l)=>{let o=t.details,n=nv(o),s=n[0].column,a=A(n,(e,t)=>({grid:nn(e.grid,s,t.column+e.delta,r,l.getOrInit),delta:e.delta+1}),{grid:e,delta:0}).grid;return n_(a,o[0].row,s)},nK(!0),nV,f,nR),n1=oY((e,t,r,l)=>{let o=t.details,n=o[o.length-1],s=n.column+n.colspan,a=nv(o),i=A(a,(e,t)=>nn(e,s,t.column,r,l.getOrInit),e);return n_(i,o[0].row,s)},nK(!1),nV,f,nR),n9=oY((e,t,r,l)=>{var o;let n=nv(t.details),s=(o=E(n,e=>e.column),j(e,e=>{let t=e.cells,r=A(o,(e,t)=>t>=0&&t<e.length?e.slice(0,t).concat(e.slice(t+1)):e,t);return r.length>0?[eK(e.element,r,e.section,e.isNew)]:[]})),a=s.length>0?s[0].cells.length-1:0;return n_(s,n[0].row,Math.min(n[0].column,a))},(e,t)=>oX(e,t).map(t=>({details:t,pixelDelta:-nG(e,t)})),nV,nW,nR),n3=oY((e,t,r,l)=>{let o=nM(t),n=((e,t,r)=>{let{rows:l,cols:o}=rg(e);return[...o,...l.slice(0,t),...l.slice(r+1)]})(e,o[0].row,o[o.length-1].row),s=n.length>0?n.length-1:0;return n_(n,Math.min(t[0].row,s),t[0].column)},oQ,f,nW,nR),n5=oY((e,t,r,l)=>{let o=nv(t),n=E(o,e=>e.column),s=nc(e,n,!0,r,l.replaceOrInit);return n_(s,t[0].row,t[0].column)},oX,f,f,nJ),n2=oY((e,t,r,l)=>{let o=nv(t),n=E(o,e=>e.column),s=nc(e,n,!1,r,l.replaceOrInit);return n_(s,t[0].row,t[0].column)},oX,f,f,nQ),n7=oY(nI,oX,f,f,nJ),n4=oY(nP,oX,f,f,nQ),n6=oY(nF,oX,f,f,nQ),n8=oY((e,t,r,l)=>{let o=nu(e,t,r,l.replaceOrInit);return n_(o,t[0].row,t[0].column)},oX,f,f,nJ),se=oY((e,t,r,l)=>{let o=nu(e,t,r,l.replaceOrInit);return n_(o,t[0].row,t[0].column)},oX,f,f,nQ),st=oY((e,t,r,l)=>{let o=t.cells;nz(o);let n=((e,t,r,l)=>{let o=rg(e).rows;if(0===o.length)return e;for(let n=t.startRow;n<=t.finishRow;n++)for(let s=t.startCol;s<=t.finishCol;s++){let a=o[n],i=rc(a,s).isLocked;rm(a,s,eG(l(),!1,i))}return e})(e,t.bounds,0,l.merge(o));return nL(n,C.from(o[0]))},(e,t)=>(0,t.mergable).filter(t=>oZ(e,t.cells)),nq,f,nO),sr=oY((e,t,r,l)=>{let o=A(t,(e,t)=>o0(e,t,r,l.unmerge(t)),e);return nL(o,C.from(t[0]))},(e,t)=>(0,t.unmergable).filter(t=>oZ(e,t)),nq,f,nO),sl=oY((e,t,r,l)=>{let o=((e,t)=>{let r=rC(e);return o$(r,t,!0)})(t.clipboard,t.generators);return((e,t,r,l,o)=>{let n=rw(t),s=((e,t,r)=>{let l=rf(t[0]),o=rg(t).cols.length+e.row,n=k(l-e.column,t=>t+e.column);return{row:o,column:L(n,e=>I(r,t=>t!==e)).getOr(l-1)}})(e,t,n),a=rg(r).rows,i=nt(s,a,n),m=((e,t,r)=>{if(e.row>=t.length||e.column>rf(t[0]))return o3.error("invalid start address out of table bounds, row: "+e.row+", column: "+e.column);let l=t.slice(e.row),o=l[0].cells.slice(e.column),n=rf(r[0]),s=r.length;return o3.value({rowDelta:l.length-s,colDelta:o.length-n})})(s,t,a);return m.map(e=>{let r={...e,colDelta:e.colDelta-i.length},n=o8(t,r,l),m=rw(n),d=nt(s,a,m);return((e,t,r,l,o,n)=>{let s=e.row,a=e.column,i=s+r.length,m=a+rf(r[0])+n.length,d=P(n,x);for(let c=s;c<i;c++){let u=0;for(let f=a;f<m;f++){if(d[f]){u++;continue}ne(t,c,f,o)&&o0(t,ru(t[c],f),o,l.cell);let g=f-a-u,h=rc(r[c-s],g),p=h.element,b=l.replace(p);rm(t[c],f,eG(b,!0,h.isLocked))}}return t})(s,n,a,l,o,d)})})({row:t.row,column:t.column},e,o,t.generators,r).fold(()=>nL(e,C.some(t.element)),e=>n_(e,t.row,t.column))},(e,t)=>tO(t.element).bind(r=>oG(e,r).map(e=>({...e,generators:t.generators,clipboard:t.clipboard}))),nq,f,nR),so=oY((e,t,r,l)=>{let o=rg(e).rows,n=t.cells[0].column,s=o[t.cells[0].row],a=nH(t.clipboard,t.generators,s),i=nr(n,e,a,t.generators,r);return n_(i,t.cells[0].row,t.cells[0].column)},nY(!0),f,f,nR),sn=oY((e,t,r,l)=>{let o=rg(e).rows,n=t.cells[t.cells.length-1].column+t.cells[t.cells.length-1].colspan,s=o[t.cells[0].row],a=nH(t.clipboard,t.generators,s),i=nr(n,e,a,t.generators,r);return n_(i,t.cells[0].row,t.cells[0].column)},nY(!1),f,f,nR),ss=oY((e,t,r,l)=>{let o=rg(e).rows,n=t.cells[0].row,s=o[n],a=nH(t.clipboard,t.generators,s),i=nl(n,e,a,t.generators,r);return n_(i,t.cells[0].row,t.cells[0].column)},oJ,f,f,nR),sa=oY((e,t,r,l)=>{let o=rg(e).rows,n=t.cells[t.cells.length-1].row+t.cells[t.cells.length-1].rowspan,s=o[t.cells[0].row],a=nH(t.clipboard,t.generators,s),i=nl(n,e,a,t.generators,r);return n_(i,t.cells[0].row,t.cells[0].column)},oJ,f,f,nR),si=(e,t)=>{let r=rC(e);return oQ(r,t).bind(e=>{let t=e[e.length-1],l=e[0].column,o=t.column+t.colspan,n=M(E(r.all,e=>z(e.cells,e=>e.column>=l&&e.column<o)));return oN(n)}).getOr("")},sm=(e,t)=>{let r=rC(e);return oQ(r,t).bind(oN).getOr("")},sd=(e,t)=>{let r=rC(e);return oQ(r,t).bind(e=>{let t=e[e.length-1],l=e[0].row,o=t.row+t.rowspan;return(e=>{let t=E(e,e=>oE(e).type),r=D(t,"header"),l=D(t,"footer");if(r||l){let o=D(t,"body");return!r||o||l?r||o||!l?C.none():C.some("footer"):C.some("header")}return C.some("body")})(r.all.slice(l,o))}).getOr("")},sc=(e,t)=>e.dispatch("NewRow",{node:t}),su=(e,t)=>e.dispatch("NewCell",{node:t}),sf=(e,t,r)=>{e.dispatch("TableModified",{...r,table:t})},sg={structure:!1,style:!0},sh={structure:!0,style:!1},sp={structure:!0,style:!0},sb=e=>t=>t.options.get(e),sw="100%",sv=e=>{var t;let r=e.dom,l=null!==(t=r.getParent(e.selection.getStart(),r.isBlock))&&void 0!==t?t:e.getBody();return rs(ep.fromDom(l))+"px"},sy=e=>C.from(e.options.get("table_clone_elements")),sx=sb("table_header_type"),sC=sb("table_column_resizing"),sS=e=>"preservetable"===sC(e),sT=e=>"resizetable"===sC(e),sR=sb("table_sizing_mode"),sD=e=>"relative"===sR(e),sO=e=>"fixed"===sR(e),sk=e=>"responsive"===sR(e),sE=sb("table_resize_bars"),sN=sb("table_style_by_css"),sB=e=>{let t=e.options,r=t.get("table_default_attributes");return t.isSet("table_default_attributes")?r:sk(e)||sN(e)?r:sO(e)?{...r,width:sv(e)}:{...r,width:sw}},sz=sb("table_use_colgroups"),sA=(e,t)=>sD(e)?lb(t):sO(e)?lw(t):lv(t),sW=(e,t,r)=>{let l=e=>"table"===Z(lP(e)),o=sy(e),n=sT(e)?f:ob,s=t=>{switch(sx(e)){case"section":return oA();case"sectionCells":return oW();case"cells":return oL();default:return((e,t)=>{switch(V(rC(e).all,e=>{let t=oE(e);return"header"===t.type?C.from(t.subType):C.none()}).getOr(t)){case"section":return oA();case"sectionCells":return oW();case"cells":return oL()}})(t,"section")}},a=(l,n,a,i)=>(m,d,c=!1)=>{lH(m);let u=ep.fromDom(e.getDoc()),f=lj(a,u,o),g={sizing:sA(e,m),resize:sT(e)?oS():oT(),section:s(m)};return n(m)?l(m,d,f,g).bind(l=>{t.refresh(m.dom),N(l.newRows,t=>{sc(e,t.dom)}),N(l.newCells,t=>{su(e,t.dom)});let o=l.cursor.fold(()=>{let t=tk(m);return H(t).filter(eZ).map(t=>{r.clearSelectedCells(m.dom);let l=e.dom.createRng();return l.selectNode(t.dom),e.selection.setRng(l),em(t,"data-mce-selected","1"),l})},t=>{let l=oh(op,t),o=e.dom.createRng();return o.setStart(l.element.dom,l.offset),o.setEnd(l.element.dom,l.offset),e.selection.setRng(o),r.clearSelectedCells(m.dom),C.some(o)});return eZ(m)&&(lH(m),c||sf(e,m.dom,i)),o.map(e=>({rng:e,effect:i}))}):C.none()},i=a(n3,t=>!l(e)||oR(t).rows>1,f,sh),m=a(n9,t=>!l(e)||oR(t).columns>1,f,sh);return{deleteRow:i,deleteColumn:m,insertRowsBefore:a(nX,x,f,sh),insertRowsAfter:a(nZ,x,f,sh),insertColumnsBefore:a(n0,x,n,sh),insertColumnsAfter:a(n1,x,n,sh),mergeCells:a(st,x,f,sh),unmergeCells:a(sr,x,f,sh),pasteColsBefore:a(so,x,f,sh),pasteColsAfter:a(sn,x,f,sh),pasteRowsBefore:a(ss,x,f,sh),pasteRowsAfter:a(sa,x,f,sh),pasteCells:a(sl,x,f,sp),makeCellsHeader:a(n8,x,f,sh),unmakeCellsHeader:a(se,x,f,sh),makeColumnsHeader:a(n5,x,f,sh),unmakeColumnsHeader:a(n2,x,f,sh),makeRowsHeader:a(n7,x,f,sh),makeRowsBody:a(n4,x,f,sh),makeRowsFooter:a(n6,x,f,sh),getTableRowType:sd,getTableCellType:sm,getTableColType:si}},sL=(e,t,r)=>{let l=tw(e,t,1);1===r||l<=1?ef(e,t):em(e,t,Math.min(r,l))},s_=(e,t)=>r=>{let l=r.column+r.colspan-1,o=r.column;return l>=e&&o<t},sM=nf([{invalid:["raw"]},{pixels:["value"]},{percent:["value"]}]),sj=(e,t,r)=>{let l=r.substring(0,r.length-e.length),o=parseFloat(l);return l===o.toString()?t(o):sM.invalid(r)},sI={...sM,from:e=>ta(e,"%")?sj("%",sM.percent,e):ta(e,"px")?sj("px",sM.pixels,e):sM.invalid(e)},sP=(e,t,r)=>{let l=sI.from(r),o=I(e,e=>"0px"===e)?((e,t)=>{let r=e.fold(()=>g(""),e=>g(e/t+"px"),()=>g(100/t+"%"));return k(t,r)})(l,e.length):l.fold(()=>e,r=>((e,t,r)=>{let l=r/t;return E(e,e=>sI.from(e).fold(()=>e,e=>e*l+"px",e=>e/100*r+"px"))})(e,t,r),r=>E(e,e=>sI.from(e).fold(()=>e,e=>e/t*100+"%",e=>e+"%")));return sq(o)},sF=(e,t)=>0===e.length?t:A(e,(e,t)=>sI.from(t).fold(g(0),h,h)+e,0),sH=(e,t)=>sI.from(e).fold(g(e),e=>e+t+"px",e=>e+t+"%"),sq=e=>{if(0===e.length)return e;let t=A(e,(e,t)=>{let r=sI.from(t).fold(()=>({value:t,remainder:0}),e=>((e,t)=>{let r=Math.floor(e);return{value:r+"px",remainder:e-r}})(e),e=>({value:e+"%",remainder:0}));return{output:[r.value].concat(e.output),remainder:e.remainder+r.remainder}},{output:[],remainder:0}),r=t.output;return r.slice(0,r.length-1).concat([sH(r[r.length-1],Math.round(t.remainder))])},sV=sI.from,s$=e=>sV(e).fold(g("px"),g("px"),g("%")),sU=(e,t,r)=>{let l=rC(e),o=l.all,n=rR(l),s=rD(l);t.each(t=>{let r=s$(t),o=ro(e),a=lu(l,e,lm,lf),i=sP(a,o,t);rO(l)?N(s,(e,t)=>{let l=sF([i[t]],tS());tu(e.element,"width",l+r)}):N(n,e=>{let t=i.slice(e.column,e.colspan+e.column),l=sF(t,tS());tu(e.element,"width",l+r)}),tu(e,"width",t)}),r.each(t=>{var r;let s=s$(t),a=rL(e),i=lh(l,e,rQ,ld,lf);r=sP(i,a,t),N(n,e=>{let t=r.slice(e.row,e.rowspan+e.row),l=sF(t,tT());tu(e.element,"height",l+s)}),N(o,(e,t)=>{tu(e.element,"height",r[t])}),tu(e,"height",t)})},sG=e=>lt(e).exists(e=>r9.test(e)),sK=e=>lt(e).exists(e=>r3.test(e)),sY=e=>lt(e).isNone(),sJ=e=>{ef(e,"width")},sQ=e=>{let t=ls(e);sU(e,C.some(t),C.none()),sJ(e)},sX=e=>{let t=ro(e)+"px";sU(e,C.some(t),C.none()),sJ(e)},sZ=e=>{tb(e,"width");let t=tE(e),r=t.length>0?t:tk(e);N(r,e=>{tb(e,"width"),sJ(e)}),sJ(e)},s0={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},colGroups:!1},s1=(e,t,r,l)=>k(e,e=>((e,t,r,l)=>{let o=ep.fromTag("tr");for(let n=0;n<e;n++){let s=ep.fromTag(l<t||n<r?"th":"td");n<r&&em(s,"scope","row"),l<t&&em(s,"scope","col"),eA(s,ep.fromTag("br")),eA(o,s)}return o})(t,r,l,e)),s9=(e,t)=>{e.selection.select(t.dom,!0),e.selection.collapse(!0)},s3=(e,t,r,l,n)=>{let s=(e=>{let t=e.options,r=t.get("table_default_styles");return t.isSet("table_default_styles")?r:sk(e)||!sN(e)?r:sO(e)?{...r,width:sv(e)}:{...r,width:sw}})(e),a={styles:s,attributes:sB(e),colGroups:sz(e)};return e.undoManager.ignore(()=>{let o=((e,t,r,l,o,n=s0)=>{let s=ep.fromTag("table"),a="cells"!==o;tf(s,n.styles),ed(s,n.attributes),n.colGroups&&eA(s,(e=>{let t=ep.fromTag("colgroup");return k(e,()=>eA(t,ep.fromTag("col"))),t})(t));let i=Math.min(e,r);if(a&&r>0){let m=ep.fromTag("thead");eA(s,m);let d=s1(r,t,"sectionCells"===o?i:0,l);e_(m,d)}let c=ep.fromTag("tbody");eA(s,c);let u=s1(a?e-i:e,t,a?0:r,l);return e_(c,u),s})(r,t,n,l,sx(e),a);em(o,"data-mce-id","__mce");let s=(e=>{let t=ep.fromTag("div"),r=ep.fromDom(e.dom.cloneNode(!0));return eA(t,r),t.dom.innerHTML})(o);e.insertContent(s),e.addVisual()}),e8(lP(e),'table[data-mce-id="__mce"]').map(t=>{var r;return sO(e)?sX(t):sk(e)?sZ(t):(sD(e)||o(r=s.width)&&-1!==r.indexOf("%"))&&sQ(t),lH(t),ef(t,"data-mce-id"),N(e5(t,"tr"),t=>{sc(e,t.dom),N(e5(t,"th,td"),t=>{su(e,t.dom)})}),((e,t)=>{e8(t,"td,th").each(b(s9,e))})(e,t),t.dom}).getOrNull()};var s5=tinymce.util.Tools.resolve("tinymce.FakeClipboard");let s2="x-tinymce/dom-table-",s7=s2+"rows",s4=s2+"columns",s6=e=>{let t=s5.FakeClipboardItem(e);s5.write([t])},s8=e=>{var t;let r=null!==(t=s5.read())&&void 0!==t?t:[];return V(r,t=>C.from(t.getType(e)))},ae=e=>{s8(e).isSome()&&s5.clear()},at=e=>{e.fold(al,e=>s6({[s7]:e}))},ar=()=>s8(s7),al=()=>ae(s7),ao=e=>{e.fold(as,e=>s6({[s4]:e}))},an=()=>s8(s4),as=()=>ae(s4),aa=e=>oi(lq(e),lF(e)),ai=(e,t)=>{let r=lF(e),l=e=>tN(e,r),s=t=>om(lq(e),lF(e)).bind(e=>l(e).map(r=>t(r,e))),a=t=>{e.focus()},i=(t,r=!1)=>s((l,o)=>{let n=os(od(e),l,o);t(l,n,r).each(a)}),m=()=>s((t,r)=>((e,t,r)=>{let l=rC(e);return oQ(l,t).bind(e=>{let t=o$(l,r,!1),o=rg(t).rows.slice(e[0].row,e[e.length-1].row+e[e.length-1].rowspan),n=j(o,e=>{let t=z(e.cells,e=>!e.isLocked);return t.length>0?[{...e,cells:t}]:[]}),s=oU(n);return tl(s.length>0,s)}).map(e=>E(e,e=>{let t=eF(e.element);return N(e.cells,e=>{let r=eH(e.element);oP(r,"colspan",e.colspan,1),oP(r,"rowspan",e.rowspan,1),eA(t,r)}),t}))})(t,os(od(e),t,r),lj(f,ep.fromDom(e.getDoc()),C.none()))),d=()=>s((t,r)=>((e,t)=>{let r=rC(e);return oX(r,t).map(e=>{let t=e[e.length-1],l=e[0].column,o=t.column+t.colspan,n=((e,t,r)=>{if(rO(e)){let l=z(rD(e),s_(t,r)),o=E(l,e=>{let l=eH(e.element);return sL(l,"span",r-t),l}),n=ep.fromTag("colgroup");return e_(n,o),[n]}return[]})(r,l,o),s=E(r.all,e=>{let t=z(e.cells,s_(l,o)),r=E(t,e=>{let t=eH(e.element);return sL(t,"colspan",o-l),t}),n=ep.fromTag("tr");return e_(n,r),n});return[...n,...s]})})(t,os(od(e),t,r))),c=(t,r)=>r().each(r=>{let l=E(r,e=>eH(e));s((r,o)=>{let n=lI(ep.fromDom(e.getDoc())),s={selection:h(od(e)),clipboard:l,generators:n};t(r,s).each(a)})}),g=e=>(t,r)=>(X(r,"type")?C.from(r.type):C.none()).each(t=>{i(e(t),r.no_events)});G({mceTableSplitCells:()=>i(t.unmergeCells),mceTableMergeCells:()=>i(t.mergeCells),mceTableInsertRowBefore:()=>i(t.insertRowsBefore),mceTableInsertRowAfter:()=>i(t.insertRowsAfter),mceTableInsertColBefore:()=>i(t.insertColumnsBefore),mceTableInsertColAfter:()=>i(t.insertColumnsAfter),mceTableDeleteCol:()=>i(t.deleteColumn),mceTableDeleteRow:()=>i(t.deleteRow),mceTableCutCol:()=>d().each(e=>{ao(e),i(t.deleteColumn)}),mceTableCutRow:()=>m().each(e=>{at(e),i(t.deleteRow)}),mceTableCopyCol:()=>d().each(e=>ao(e)),mceTableCopyRow:()=>m().each(e=>at(e)),mceTablePasteColBefore:()=>c(t.pasteColsBefore,an),mceTablePasteColAfter:()=>c(t.pasteColsAfter,an),mceTablePasteRowBefore:()=>c(t.pasteRowsBefore,ar),mceTablePasteRowAfter:()=>c(t.pasteRowsAfter,ar),mceTableDelete:()=>aa(e).each(t=>{tN(t,r).filter(w(r)).each(t=>{let r=ep.fromText("");if(eB(t,r),ej(t),e.dom.isEmpty(e.getBody()))e.setContent(""),e.selection.setCursorLocation();else{let l=e.dom.createRng();l.setStart(r.dom,0),l.setEnd(r.dom,0),e.selection.setRng(l),e.nodeChanged()}})}),mceTableCellToggleClass:(t,r)=>{s(t=>{let l=od(e),o=I(l,t=>e.formatter.match("tablecellclass",{value:r},t.dom)),n=o?e.formatter.remove:e.formatter.apply;N(l,e=>n("tablecellclass",{value:r},e.dom)),sf(e,t.dom,sg)})},mceTableToggleClass:(t,r)=>{s(t=>{e.formatter.toggle("tableclass",{value:r},t.dom),sf(e,t.dom,sg)})},mceTableToggleCaption:()=>{aa(e).each(t=>{tN(t,r).each(r=>{e6(r,"caption").fold(()=>{let t=ep.fromTag("caption");eA(t,ep.fromText("Caption")),((e,t,r)=>{eE(e,0).fold(()=>{eA(e,t)},e=>{eN(e,t)})})(r,t),e.selection.setCursorLocation(t.dom,0)},l=>{ea("caption")(t)&&ev("td",r).each(t=>e.selection.setCursorLocation(t.dom,0)),ej(l)}),sf(e,r.dom,sh)})})},mceTableSizingMode:(t,l)=>aa(e).each(t=>{sk(e)||sO(e)||sD(e)||tN(t,r).each(t=>{"relative"!==l||sG(t)?"fixed"!==l||sK(t)?"responsive"!==l||sY(t)||sZ(t):sX(t):sQ(t),lH(t),sf(e,t.dom,sh)})}),mceTableCellType:g(e=>"th"===e?t.makeCellsHeader:t.unmakeCellsHeader),mceTableColType:g(e=>"th"===e?t.makeColumnsHeader:t.unmakeColumnsHeader),mceTableRowType:g(e=>{switch(e){case"header":return t.makeRowsHeader;case"footer":return t.makeRowsFooter;default:return t.makeRowsBody}})},(t,r)=>e.addCommand(r,t)),e.addCommand("mceInsertTable",(t,r)=>{((e,t,r,l={})=>{let o=e=>u(e)&&e>0;if(o(t)&&o(r)){let n=l.headerRows||0,s=l.headerColumns||0;return s3(e,r,t,s,n)}console.error("Invalid values for mceInsertTable - rows and columns values are required to insert a table.")})(e,r.rows,r.columns,r.options)}),e.addCommand("mceTableApplyCellStyle",(t,r)=>{let s=e=>"tablecell"+e.toLowerCase().replace("-","");if(!n(r))return;let a=od(e);if(0===a.length)return;let i=((e,t)=>{var r,l;let o={};return r=o,l=(e,t)=>{r[t]=e},G(e,(e,r)=>{(t(e,r)?l:f)(e,r)}),o})(r,(t,r)=>e.formatter.has(s(r))&&o(t));(e=>{for(let t in e)if(U.call(e,t))return!1;return!0})(i)||(G(i,(t,r)=>{let l=s(r);N(a,r=>{""===t?e.formatter.remove(l,{value:null},r.dom,!0):e.formatter.apply(l,{value:t},r.dom)})}),l(a[0]).each(t=>sf(e,t.dom,sg)))})},am=nf([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),ad={before:am.before,on:am.on,after:am.after,cata:(e,t,r,l)=>e.fold(t,r,l),getStart:e=>e.fold(h,h,h)},ac=(e,t)=>({selection:e,kill:t}),au=(e,t)=>{let r=e.document.createRange();return r.selectNode(t.dom),r},af=(e,t)=>{let r=e.document.createRange();return ag(r,t),r},ag=(e,t)=>e.selectNodeContents(t.dom),ah=(e,t,r)=>{let l=e.document.createRange();return t.fold(e=>{l.setStartBefore(e.dom)},(e,t)=>{l.setStart(e.dom,t)},e=>{l.setStartAfter(e.dom)}),((e,t)=>{t.fold(t=>{e.setEndBefore(t.dom)},(t,r)=>{e.setEnd(t.dom,r)},t=>{e.setEndAfter(t.dom)})})(l,r),l},ap=(e,t,r,l,o)=>{let n=e.document.createRange();return n.setStart(t.dom,r),n.setEnd(l.dom,o),n},ab=e=>({left:e.left,top:e.top,right:e.right,bottom:e.bottom,width:e.width,height:e.height}),aw=nf([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),av=(e,t,r)=>t(ep.fromDom(r.startContainer),r.startOffset,ep.fromDom(r.endContainer),r.endOffset),ay=(e,t)=>{let r=t.match({domRange:e=>({ltr:g(e),rtl:C.none}),relative:(t,r)=>({ltr:t_(()=>ah(e,t,r)),rtl:t_(()=>C.some(ah(e,r,t)))}),exact:(t,r,l,o)=>({ltr:t_(()=>ap(e,t,r,l,o)),rtl:t_(()=>C.some(ap(e,l,o,t,r)))})});return((e,t)=>{let r=t.ltr();return r.collapsed?t.rtl().filter(e=>!1===e.collapsed).map(e=>aw.rtl(ep.fromDom(e.endContainer),e.endOffset,ep.fromDom(e.startContainer),e.startOffset)).getOrThunk(()=>av(0,aw.ltr,r)):av(0,aw.ltr,r)})(0,r)},ax=(e,t)=>ay(e,t).match({ltr:(t,r,l,o)=>{let n=e.document.createRange();return n.setStart(t.dom,r),n.setEnd(l.dom,o),n},rtl:(t,r,l,o)=>{let n=e.document.createRange();return n.setStart(l.dom,o),n.setEnd(t.dom,r),n}});aw.ltr,aw.rtl;let aC=(e,t,r,l)=>({start:e,soffset:t,finish:r,foffset:l}),aS=(e,t,r,l)=>({start:ad.on(e,t),finish:ad.on(r,l)}),aT=(e,t)=>{let r=ax(e,t);return aC(ep.fromDom(r.startContainer),r.startOffset,ep.fromDom(r.endContainer),r.endOffset)},aR=(e,t,r,l,o)=>ey(r,l)?C.none():l4(r,l,t).bind(t=>{let l=t.boxes.getOr([]);return l.length>1?(o(e,l,t.start,t.finish),C.some(ac(C.some(aS(r,0,r,lR(r))),!0))):C.none()}),aD=(e,t)=>({item:e,mode:t}),aO=(e,t,r,l=ak)=>e.property().parent(t).map(e=>aD(e,l)),ak=(e,t,r,l=aE)=>r.sibling(e,t).map(e=>aD(e,l)),aE=(e,t,r,l=aE)=>{let o=e.property().children(t);return r.first(o).map(e=>aD(e,l))},aN=[{current:aO,next:ak,fallback:C.none()},{current:ak,next:aE,fallback:C.some(aO)},{current:aE,next:aE,fallback:C.some(ak)}],aB=(e,t,r,l,o=aN)=>L(o,e=>e.current===r).bind(r=>r.current(e,t,l,r.next).orThunk(()=>r.fallback.bind(r=>aB(e,t,r,l)))),az=(e,t,r,l,o,n)=>aB(e,t,l,o).bind(t=>n(t.item)?C.none():r(t.item)?C.some(t.item):az(e,t.item,r,t.mode,o,n)),aA=e=>t=>0===e.property().children(t).length,aW=(e,t,r,l)=>az(e,t,r,ak,{sibling:(e,t)=>e.query().prevSibling(t),first:e=>e.length>0?C.some(e[e.length-1]):C.none()},l),aL=(e,t,r,l)=>az(e,t,r,ak,{sibling:(e,t)=>e.query().nextSibling(t),first:e=>e.length>0?C.some(e[0]):C.none()},l),a_=l1(),aM=(e,t)=>aW(a_,e,aA(a_),t),aj=(e,t)=>aL(a_,e,aA(a_),t),aI=nf([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),aP=e=>te(e,"tr"),aF={...aI,verify:(e,t,r,l,o,n,s)=>te(l,"td,th",s).bind(r=>te(t,"td,th",s).map(t=>ey(r,t)?ey(l,r)&&lR(r)===o?n(t):aI.none("in same cell"):l2(aP,[r,t]).fold(()=>((e,t,r)=>{let l=e.getRect(t),o=e.getRect(r);return o.right>l.left&&o.left<l.right})(e,t,r)?aI.success():n(t),e=>n(t)))).getOr(aI.none("default")),cata:(e,t,r,l,o)=>e.fold(t,r,l,o)},aH=ea("br"),aq=(e,t,r)=>t(e,r).bind(e=>eo(e)&&0===lC(e).trim().length?aq(e,t,r):C.some(e)),aV=(e,t,r,l)=>eE(t,r).filter(aH).orThunk(()=>eE(t,r-1).filter(aH)).bind(t=>l.traverse(t).fold(()=>aq(t,l.gather,e).map(l.relative),e=>eT(e).bind(t=>{let r=ek(t);return _(r,b(ey,e)).map(l=>({parent:t,children:r,element:e,index:l}))}).map(e=>ad.on(e.parent,e.index)))),a$=(e,t)=>({left:e.left,top:e.top+t,right:e.right,bottom:e.bottom+t}),aU=(e,t)=>({left:e.left,top:e.top-t,right:e.right,bottom:e.bottom-t}),aG=(e,t,r)=>({left:e.left+t,top:e.top+r,right:e.right+t,bottom:e.bottom+r}),aK=e=>({left:e.left,top:e.top,right:e.right,bottom:e.bottom}),aY=(e,t)=>C.some(e.getRect(t)),aJ=(e,t,r)=>el(t)?aY(e,t).map(aK):eo(t)?(r>=0&&r<lR(t)?e.getRangedRect(t,r,t,r+1):r>0?e.getRangedRect(t,r-1,t,r):C.none()).map(aK):C.none(),aQ=(e,t)=>el(t)?aY(e,t).map(aK):eo(t)?e.getRangedRect(t,0,t,lR(t)).map(aK):C.none(),aX=nf([{none:[]},{retry:["caret"]}]),aZ=(e,t,r)=>e2((e,t)=>t(e),e7,t,nN,void 0).fold(y,t=>aQ(e,t).exists(e=>r.left<e.left||1>Math.abs(e.right-r.left)||r.left>e.right)),a0=(e,t,r,l,o)=>{var n,s;return 0===o?C.some(l):(n=l.left,s=t.point(l),e.elementFromPoint(n,s).filter(e=>"table"===Z(e)).isSome())?a0(e,t,r,t.move(l,5),o-1):e.situsFromPoint(l.left,t.point(l)).bind(n=>n.start.fold(C.none,n=>aQ(e,n).bind(s=>t.adjuster(e,n,s,r,l).fold(C.none,l=>a0(e,t,r,l,o-1))).orThunk(()=>C.some(l)),C.none))},a1=(e,t,r)=>{let l=e.move(r,5),o=a0(t,e,r,l,100).getOr(l);return(e.point(o)>t.getInnerHeight()?C.some(e.point(o)-t.getInnerHeight()):0>e.point(o)?C.some(-e.point(o)):C.none()).fold(()=>t.situsFromPoint(o.left,e.point(o)),r=>(t.scrollBy(0,r),t.situsFromPoint(o.left,e.point(o)-r)))},a9={tryUp:b(a1,{point:e=>e.top,adjuster:(e,t,r,l,o)=>{let n=aU(o,5);return 1>Math.abs(r.top-l.top)||r.bottom<o.top?aX.retry(n):r.bottom===o.top?aX.retry(aU(o,1)):aZ(e,t,o)?aX.retry(aG(n,5,0)):aX.none()},move:aU,gather:aM}),tryDown:b(a1,{point:e=>e.bottom,adjuster:(e,t,r,l,o)=>{let n=a$(o,5);return 1>Math.abs(r.bottom-l.bottom)||r.top>o.bottom?aX.retry(n):r.top===o.bottom?aX.retry(a$(o,1)):aZ(e,t,o)?aX.retry(aG(n,5,0)):aX.none()},move:a$,gather:aj}),getJumpSize:g(5)},a3=(e,t,r)=>e.getSelection().bind(l=>((e,t,r,l)=>{let o=aH(t)?l.traverse(t).orThunk(()=>aq(t,l.gather,e)).map(l.relative):aV(e,t,r,l);return o.map(e=>({start:e,finish:e}))})(t,l.finish,l.foffset,r).fold(()=>C.some(ou(l.finish,l.foffset)),o=>{var n;let s=e.fromSitus(o);return n=aF.verify(e,l.finish,l.foffset,s.finish,s.foffset,r.failure,t),aF.cata(n,e=>C.none(),()=>C.none(),e=>C.some(ou(e,0)),e=>C.some(ou(e,lR(e))))})),a5=(e,t,r,l,o,n)=>0===n?C.none():a4(e,t,r,l,o).bind(s=>{let a=e.fromSitus(s),i=aF.verify(e,r,l,a.finish,a.foffset,o.failure,t);return aF.cata(i,()=>C.none(),()=>C.some(s),s=>ey(r,s)&&0===l?a2(e,r,l,aU,o):a5(e,t,s,0,o,n-1),s=>ey(r,s)&&l===lR(s)?a2(e,r,l,a$,o):a5(e,t,s,lR(s),o,n-1))}),a2=(e,t,r,l,o)=>aJ(e,t,r).bind(t=>a7(e,o,l(t,a9.getJumpSize()))),a7=(e,t,r)=>{let l=re().browser;return l.isChromium()||l.isSafari()||l.isFirefox()?t.retry(e,r):C.none()},a4=(e,t,r,l,o)=>aJ(e,r,l).bind(t=>a7(e,o,t)),a6=(e,t,r,l,o)=>te(l,"td,th",t).bind(l=>te(l,"table",t).bind(n=>e7(o,e=>eT(e).exists(e=>ey(e,n)),void 0).isSome()?a3(e,t,r).bind(l=>a5(e,t,l.element,l.offset,r,20).map(e.fromSitus)).bind(e=>te(e.finish,"td,th",t).map(t=>({start:l,finish:t,range:e}))):C.none())),a8=(e,t,r,l,o,n)=>n(l,t).orThunk(()=>a6(e,t,r,l,o).map(e=>{let t=e.range;return ac(C.some(aS(t.start,t.soffset,t.finish,t.foffset)),!0)})),ie=(e,t)=>te(e,"tr",t).bind(e=>te(e,"table",t).bind(r=>{let l=e5(r,"tr");return ey(e,l[0])?aW(a_,r,e=>lE(e).isSome(),t).map(e=>{let t=lR(e);return ac(C.some(aS(e,t,e,t)),!0)}):C.none()})),it=(e,t)=>te(e,"tr",t).bind(e=>te(e,"table",t).bind(r=>{let l=e5(r,"tr");return ey(e,l[l.length-1])?aL(a_,r,e=>lk(e).isSome(),t).map(e=>ac(C.some(aS(e,0,e,0)),!0)):C.none()})),ir=(e,t,r,l,o,n,s)=>a6(e,r,l,o,n).bind(e=>aR(t,r,e.start,e.finish,s)),il=e=>{let t=e;return{get:()=>t,set:e=>{t=e}}},io=()=>{let e=(e=>{let t=il(C.none()),r=()=>t.get().each(e);return{clear:()=>{r(),t.set(C.none())},isSet:()=>t.get().isSome(),get:()=>t.get(),set:e=>{r(),t.set(C.some(e))}}})(f);return{...e,on:t=>e.get().each(t)}},is=(e,t)=>te(e,"td,th",t),ia={traverse:eO,gather:aj,relative:ad.before,retry:a9.tryDown,failure:aF.failedDown},ii={traverse:eD,gather:aM,relative:ad.before,retry:a9.tryUp,failure:aF.failedUp},im=e=>t=>t===e,id=im(38),ic=im(40),iu=e=>e>=37&&e<=40,ig={isBackward:im(37),isForward:im(39)},ih={isBackward:im(39),isForward:im(37)},ip=nf([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),ib={domRange:ip.domRange,relative:ip.relative,exact:ip.exact,exactFromRange:e=>ip.exact(e.start,e.soffset,e.finish,e.foffset),getWin:e=>{let t=e.match({domRange:e=>ep.fromDom(e.startContainer),relative:(e,t)=>ad.getStart(e),exact:(e,t,r,l)=>e});return ep.fromDom(eS(t).dom.defaultView)},range:aC},iw=document.caretPositionFromPoint?(e,t,r)=>{var l,o;return C.from(null===(o=(l=e.dom).caretPositionFromPoint)||void 0===o?void 0:o.call(l,t,r)).bind(t=>{if(null===t.offsetNode)return C.none();let r=e.dom.createRange();return r.setStart(t.offsetNode,t.offset),r.collapse(),C.some(r)})}:document.caretRangeFromPoint?(e,t,r)=>{var l,o;return C.from(null===(o=(l=e.dom).caretRangeFromPoint)||void 0===o?void 0:o.call(l,t,r))}:C.none,iv=(e,t)=>{let r=Z(e);return"input"===r?ad.after(e):D(["br","img"],r)?0===t?ad.before(e):ad.after(e):ad.on(e,t)},iy=e=>C.from(e.getSelection()),ix=(e,t)=>{iy(e).each(e=>{e.removeAllRanges(),e.addRange(t)})},iC=(e,t,r,l,o)=>{let n=ap(e,t,r,l,o);ix(e,n)},iS=(e,t)=>ay(e,t).match({ltr:(t,r,l,o)=>{iC(e,t,r,l,o)},rtl:(t,r,l,o)=>{iy(e).each(n=>{if(n.setBaseAndExtent)n.setBaseAndExtent(t.dom,r,l.dom,o);else if(n.extend)try{n.collapse(t.dom,r),n.extend(l.dom,o)}catch(s){iC(e,l,o,t,r)}else iC(e,l,o,t,r)})}}),iT=(e,t,r,l,o)=>{let n=((e,t,r,l)=>{let o=iv(e,t),n=iv(r,l);return ib.relative(o,n)})(t,r,l,o);iS(e,n)},iR=(e,t,r)=>{let l=((e,t)=>{let r=e.fold(ad.before,iv,ad.after),l=t.fold(ad.before,iv,ad.after);return ib.relative(r,l)})(t,r);iS(e,l)},iD=e=>{if(e.rangeCount>0){let t=e.getRangeAt(0),r=e.getRangeAt(e.rangeCount-1);return C.some(aC(ep.fromDom(t.startContainer),t.startOffset,ep.fromDom(r.endContainer),r.endOffset))}return C.none()},iO=e=>{if(null===e.anchorNode||null===e.focusNode)return iD(e);{let t=ep.fromDom(e.anchorNode),r=ep.fromDom(e.focusNode);return((e,t,r,l)=>{let o=((e,t,r,l)=>{let o=eC(e).dom.createRange();return o.setStart(e.dom,t),o.setEnd(r.dom,l),o})(e,t,r,l),n=ey(e,r)&&t===l;return o.collapsed&&!n})(t,e.anchorOffset,r,e.focusOffset)?C.some(aC(t,e.anchorOffset,r,e.focusOffset)):iD(e)}},ik=(e,t,r=!0)=>{let l=(r?af:au)(e,t);ix(e,l)},iE=e=>iy(e).filter(e=>e.rangeCount>0).bind(iO).map(e=>ib.exact(e.start,e.soffset,e.finish,e.foffset)),iN=e=>({elementFromPoint:(t,r)=>ep.fromPoint(ep.fromDom(e.document),t,r),getRect:e=>e.dom.getBoundingClientRect(),getRangedRect:(t,r,l,o)=>{let n=ib.exact(t,r,l,o);return(e=>{let t=e.getClientRects(),r=t.length>0?t[0]:e.getBoundingClientRect();return r.width>0||r.height>0?C.some(r).map(ab):C.none()})(ax(e,n))},getSelection:()=>iE(e).map(t=>aT(e,t)),fromSitus:t=>{let r=ib.relative(t.start,t.finish);return aT(e,r)},situsFromPoint:(t,r)=>((e,t,r)=>{let l=ep.fromDom(e.document);return iw(l,t,r).map(e=>aC(ep.fromDom(e.startContainer),e.startOffset,ep.fromDom(e.endContainer),e.endOffset))})(e,t,r).map(e=>aS(e.start,e.soffset,e.finish,e.foffset)),clearSelection:()=>{(e=>{iy(e).each(e=>e.removeAllRanges())})(e)},collapseSelection:(t=!1)=>{iE(e).each(r=>r.fold(e=>e.collapse(t),(r,l)=>{let o=t?r:l;iR(e,o,o)},(r,l,o,n)=>{let s=t?r:o,a=t?l:n;iT(e,s,a,s,a)}))},setSelection:t=>{iT(e,t.start,t.soffset,t.finish,t.foffset)},setRelativeSelection:(t,r)=>{iR(e,t,r)},selectNode:t=>{ik(e,t,!1)},selectContents:t=>{ik(e,t)},getInnerHeight:()=>e.innerHeight,getScrollY:()=>(e=>{let t=void 0!==e?e.dom:document,r=t.body.scrollLeft||t.documentElement.scrollLeft,l=t.body.scrollTop||t.documentElement.scrollTop;return rM(r,l)})(ep.fromDom(e.document)).top,scrollBy:(t,r)=>{((e,t,r)=>{let l=(void 0!==r?r.dom:document).defaultView;l&&l.scrollBy(e,t)})(t,r,ep.fromDom(e.document))}}),iB=(e,t)=>({rows:e,cols:t}),iz=e=>void 0!==e.dom.classList,iA=(e,t)=>((e,t,r)=>{let l=((e,t)=>{let r=ec(e,t);return void 0===r||""===r?[]:r.split(" ")})(e,t).concat([r]);return em(e,t,l.join(" ")),!0})(e,"class",t),iW=(e,t)=>{iz(e)?e.dom.classList.add(t):iA(e,t)},iL=(e,t)=>iz(e)&&e.dom.classList.contains(t),i_=()=>({tag:"none"}),iM=e=>({tag:"multiple",elements:e}),ij=e=>({tag:"single",element:e}),iI=e=>{let t=ep.fromDom((e=>{if(eJ()&&d(e.target)){let t=ep.fromDom(e.target);if(el(t)&&d(t.dom.shadowRoot)&&e.composed&&e.composedPath){let r=e.composedPath();if(r)return H(r)}}return C.from(e.target)})(e).getOr(e.target)),r=()=>e.stopPropagation(),l=()=>e.preventDefault(),o=(...e)=>l(r.apply(null,e));return{target:t,x:e.clientX,y:e.clientY,stop:r,prevent:l,kill:o,raw:e}},iP=(e,t,r,l)=>{e.dom.removeEventListener(t,r,l)},iF=(e,t,r)=>((e,t,r,l,o)=>{let n=e=>{r(e)&&l(iI(e))};return e.dom.addEventListener(t,n,o),{unbind:b(iP,e,t,n,o)}})(e,t,x,r,!1),iH=e=>!iL(ep.fromDom(e.target),"ephox-snooker-resizer-bar"),iq=(e,t)=>{var r;let l=(r=on.selectedSelector,{get:()=>ot(ep.fromDom(e.getBody()),r).fold(()=>om(lq(e),lF(e)).fold(i_,ij),iM)}),o=((e,t,r)=>{let l=t=>{ef(t,e.selected),ef(t,e.firstSelected),ef(t,e.lastSelected)},o=t=>{em(t,e.selected,"1")},n=e=>{s(e),r()},s=t=>{let r=e5(t,`${e.selectedSelector},${e.firstSelectedSelector},${e.lastSelectedSelector}`);N(r,l)};return{clearBeforeUpdate:s,clear:n,selectRange:(r,l,s,a)=>{n(r),N(l,o),em(s,e.firstSelected,"1"),em(a,e.lastSelected,"1"),t(l,s,a)},selectedSelector:e.selectedSelector,firstSelectedSelector:e.firstSelectedSelector,lastSelectedSelector:e.lastSelectedSelector}})(on,(t,r,l)=>{tN(r).each(o=>{let n=sy(e),s=lj(f,ep.fromDom(e.getDoc()),n),a=((e,t,r)=>{let l=rC(e);return oQ(l,t).map(e=>{let t=o$(l,r,!1),{rows:o}=rg(t),n=((e,t)=>{let r=e.slice(0,t[t.length-1].row+1),l=oU(r);return j(l,e=>{let r=e.cells.slice(0,t[t.length-1].column+1);return E(r,e=>e.element)})})(o,e),s=((e,t)=>{let r=e.slice(t[0].row+t[0].rowspan-1,e.length),l=oU(r);return j(l,e=>{let r=e.cells.slice(t[0].column+t[0].colspan-1,e.cells.length);return E(r,e=>e.element)})})(o,e);return{upOrLeftCells:n,downOrRightCells:s}})})(o,{selection:od(e)},s);((e,t,r,l,o)=>{e.dispatch("TableSelectionChange",{cells:t,start:r,finish:l,otherCells:o})})(e,t,r,l,a)})},()=>(e=>{e.dispatch("TableSelectionClear")})(e));return e.on("init",r=>{let l=e.getWin(),n=lP(e),s=lF(e),a=((e,t,r,l)=>{let o=((e,t,r,l)=>{let o=io(),n=o.clear,s=n=>{o.on(o=>{l.clearBeforeUpdate(t),is(n.target,r).each(s=>{l4(o,s,r).each(r=>{let o=r.boxes.getOr([]);if(1===o.length){let a=o[0],i="false"===oI(a),m=tt(oM(n.target),a,ey);i&&m&&(l.selectRange(t,o,a,a),e.selectContents(a))}else o.length>1&&(l.selectRange(t,o,r.start,r.finish),e.selectContents(s))})})})};return{clearstate:n,mousedown:e=>{l.clear(t),is(e.target,r).each(o.set)},mouseover:e=>{s(e)},mouseup:e=>{s(e),n()}}})(iN(e),t,r,l);return{clearstate:o.clearstate,mousedown:o.mousedown,mouseover:o.mouseover,mouseup:o.mouseup}})(l,n,s,o),i=((e,t,r,l)=>{let o=iN(e),n=()=>(l.clear(t),C.none());return{keydown:(e,s,a,i,m,d)=>{let c=e.raw,u=c.which,f=!0===c.shiftKey,g=l6(t,l.selectedSelector).fold(()=>(iu(u)&&!f&&l.clearBeforeUpdate(t),ic(u)&&f?b(ir,o,t,r,ia,i,s,l.selectRange):id(u)&&f?b(ir,o,t,r,ii,i,s,l.selectRange):ic(u)?b(a8,o,r,ia,i,s,it):id(u)?b(a8,o,r,ii,i,s,ie):C.none),e=>{let r=r=>()=>{let n=V(r,r=>oe(e,r.rows,r.cols,l.firstSelectedSelector,l.lastSelectedSelector).map(e=>(l.clearBeforeUpdate(t),l.selectRange(t,e.boxes,e.start,e.finish),e.boxes)));return n.fold(()=>l8(t,l.firstSelectedSelector,l.lastSelectedSelector).map(e=>{let r=ic(u)||d.isForward(u)?ad.after:ad.before;return o.setRelativeSelection(ad.on(e.first,0),r(e.table)),l.clear(t),ac(C.none(),!0)}),e=>C.some(ac(C.none(),!0)))};return ic(u)&&f?r([iB(1,0)]):id(u)&&f?r([iB(-1,0)]):d.isBackward(u)&&f?r([iB(0,-1),iB(-1,0)]):d.isForward(u)&&f?r([iB(0,1),iB(1,0)]):iu(u)&&!f?n:C.none});return g()},keyup:(e,o,n,s,a)=>l6(t,l.selectedSelector).fold(()=>{var i;let m=e.raw,d=m.which;return!0===m.shiftKey&&iu(d)?(i=l.selectRange,ey(o,s)&&n===a?C.none():te(o,"td,th",r).bind(e=>te(s,"td,th",r).bind(l=>aR(t,r,e,l,i)))):C.none()},C.none)}})(l,n,s,o),m=((e,t,r,l)=>{let o=iN(e);return(e,n)=>{l.clearBeforeUpdate(t),l4(e,n,r).each(e=>{let r=e.boxes.getOr([]);l.selectRange(t,r,e.start,e.finish),o.selectContents(n),o.collapseSelection()})}})(l,n,s,o);e.on("TableSelectorChange",e=>m(e.start,e.finish));let d=(t,r)=>{!0===t.raw.shiftKey&&(r.kill&&t.kill(),r.selection.each(t=>{let r=ib.relative(t.start,t.finish),o=ax(l,r);e.selection.setRng(o)}))},c=e=>0===e.button,u=(()=>{let e=il(ep.fromDom(n)),t=il(0);return{touchEnd:r=>{let l=ep.fromDom(r.target);if(ea("td")(l)||ea("th")(l)){let o=e.get(),n=t.get();ey(o,l)&&r.timeStamp-n<300&&(r.preventDefault(),m(l,l))}e.set(l),t.set(r.timeStamp)}}})();e.on("dragstart",e=>{a.clearstate()}),e.on("mousedown",e=>{c(e)&&iH(e)&&a.mousedown(iI(e))}),e.on("mouseover",e=>{(void 0===e.buttons||0!=(1&e.buttons))&&iH(e)&&a.mouseover(iI(e))}),e.on("mouseup",e=>{c(e)&&iH(e)&&a.mouseup(iI(e))}),e.on("touchend",u.touchEnd),e.on("keyup",t=>{let r=iI(t);if(r.raw.shiftKey&&iu(r.raw.which)){let l=e.selection.getRng(),o=ep.fromDom(l.startContainer),n=ep.fromDom(l.endContainer);i.keyup(r,o,l.startOffset,n,l.endOffset).each(e=>{d(r,e)})}}),e.on("keydown",r=>{let l=iI(r);t.hide();let o=e.selection.getRng(),n=ep.fromDom(o.startContainer),s=ep.fromDom(o.endContainer),a=rz(ig,ih)(ep.fromDom(e.selection.getStart()));i.keydown(l,n,o.startOffset,s,o.endOffset,a).each(e=>{d(l,e)}),t.show()}),e.on("NodeChange",()=>{let t=e.selection,r=ep.fromDom(t.getStart()),l=ep.fromDom(t.getEnd());l2(tN,[r,l]).fold(()=>o.clear(n),f)})}),e.on("PreInit",()=>{e.serializer.addTempAttr(on.firstSelected),e.serializer.addTempAttr(on.lastSelected)}),{getSelectedCells:()=>((e,t,r,l)=>{switch(e.tag){case"none":return t();case"single":return[e.element.dom];case"multiple":return E(e.elements,e=>e.dom)}})(l.get(),g([])),clearSelectedCells:e=>o.clear(ep.fromDom(e))}},iV=e=>{let t=[];return{bind:e=>{if(void 0===e)throw Error("Event bind error: undefined handler");t.push(e)},unbind:e=>{t=z(t,t=>t!==e)},trigger:(...r)=>{let l={};N(e,(e,t)=>{l[e]=r[t]}),N(t,e=>{e(l)})}}},i$=e=>({registry:K(e,e=>({bind:e.bind,unbind:e.unbind})),trigger:K(e,e=>e.trigger)}),iU=e=>e.slice(0).sort(),iG=(e,t)=>{let r=z(t,t=>!D(e,t));r.length>0&&(e=>{throw Error("Unsupported keys for object: "+iU(e).join(", "))})(r)},iK=e=>((e,t,r)=>{if(0===t.length)throw Error("You must specify at least one required field.");return((e,t)=>{if(!s(t))throw Error("The required fields must be an array. Was: "+t+".");N(t,t=>{if(!o(t))throw Error("The value "+t+" in the "+e+" fields was not a string.")})})("required",t),(e=>{let t=iU(e);L(t,(e,r)=>r<t.length-1&&e===t[r+1]).each(e=>{throw Error("The field: "+e+" occurs more than once in the combined fields: ["+t.join(", ")+"].")})})(t),l=>{let o=$(l);I(t,e=>D(o,e))||((e,t)=>{throw Error("All required keys ("+iU(e).join(", ")+") were not specified. Specified keys were: "+iU(t).join(", ")+".")})(t,o),e(t,o);let n=z(t,e=>!r.validate(l[e],e));return n.length>0&&((e,t)=>{throw Error("All values need to be of type: "+t+". Keys ("+iU(e).join(", ")+") were not.")})(n,r.label),l}})(iG,e,{validate:c,label:"function"}),iY=iK(["compare","extract","mutate","sink"]),iJ=iK(["element","start","stop","destroy"]),iQ=iK(["forceDrop","drop","move","delayDrop"]),iX=()=>{let e=(()=>{let e=i$({move:iV(["info"])});return{onEvent:f,reset:f,events:e.registry}})(),t=(()=>{let e=C.none(),t=i$({move:iV(["info"])});return{onEvent:(r,l)=>{l.extract(r).each(r=>{let o=((t,r)=>{let l=e.map(e=>t.compare(e,r));return e=C.some(r),l})(l,r);o.each(e=>{t.trigger.move(e)})})},reset:()=>{e=C.none()},events:t.registry}})(),r=e;return{on:()=>{r.reset(),r=t},off:()=>{r.reset(),r=e},isOn:()=>r===t,onEvent:(e,t)=>{r.onEvent(e,t)},events:t.events}},iZ=e=>{let t=e.replace(/\./g,"-");return{resolve:e=>t+"-"+e}},i0=iZ("ephox-dragster").resolve;var i1=iY({compare:(e,t)=>rM(t.left-e.left,t.top-e.top),extract:e=>C.some(rM(e.x,e.y)),sink:(e,t)=>{let r=(e=>{let t={layerClass:i0("blocker"),...e},r=ep.fromTag("div");return em(r,"role","presentation"),tf(r,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),iW(r,i0("blocker")),iW(r,t.layerClass),{element:g(r),destroy:()=>{ej(r)}}})(t),l=iF(r.element(),"mousedown",e.forceDrop),o=iF(r.element(),"mouseup",e.drop),n=iF(r.element(),"mousemove",e.move),s=iF(r.element(),"mouseout",e.delayDrop);return iJ({element:r.element,start:e=>{eA(e,r.element())},stop:()=>{ej(r.element())},destroy:()=>{r.destroy(),o.unbind(),n.unbind(),s.unbind(),l.unbind()}})},mutate:(e,t)=>{e.mutate(t.left,t.top)}});let i9=iZ("ephox-snooker").resolve,i3=i9("resizer-bar"),i5=i9("resizer-rows"),i2=i9("resizer-cols"),i7=e=>{let t=e5(e.parent(),"."+i3);N(t,ej)},i4=(e,t,r)=>{let l=e.origin();N(t,t=>{t.each(t=>{let o=r(l,t);iW(o,i3),eA(e.parent(),o)})})},i6=(e,t,r,l,o)=>{var n,s,a,i;let m=rI(r),d=t.isResizable,c=l.length>0?rQ.positions(l,r):[],u=c.length>0?j(e.all,(e,t)=>d(e.element)?[t]:[]):[];n=z(c,(e,t)=>O(u,e=>t===e)),s=rn(r),i4(t,n,(e,t)=>{let r=((e,t,r,l,o)=>{let n=ep.fromTag("div");return tf(n,{position:"absolute",left:t+"px",top:r-3.5+"px",height:"7px",width:l+"px"}),ed(n,{"data-row":e,role:"presentation"}),n})(t.row,m.left-e.left,t.y-e.top,s);return iW(r,i5),r});let f=o.length>0?rZ.positions(o,r):[],g=f.length>0?((e,t)=>{let r=[];return k(e.grid.columns,l=>{rk(e,l).map(e=>e.element).forall(t)&&r.push(l)}),z(r,r=>{let l=ry(e,e=>e.column===r);return I(l,e=>t(e.element))})})(e,d):[];a=z(f,(e,t)=>O(g,e=>t===e)),i=r_(r),i4(t,a,(e,t)=>{let r=((e,t,r,l,o)=>{let n=ep.fromTag("div");return tf(n,{position:"absolute",left:t-3.5+"px",top:r+"px",height:o+"px",width:"7px"}),ed(n,{"data-column":e,role:"presentation"}),n})(t.col,t.x-e.left,m.top-e.top,0,i);return iW(r,i2),r})},i8=(e,t)=>{if(i7(e),e.isResizable(t)){let r=rC(t),l=rB(r),o=rE(r);i6(r,e,t,l,o)}},me=(e,t)=>{let r=e5(e.parent(),"."+i3);N(r,t)},mt=e=>{me(e,e=>{tu(e,"display","none")})},mr=e=>{me(e,e=>{tu(e,"display","block")})},ml=i9("resizer-bar-dragging"),mo=e=>{let t=(()=>{let e=i$({drag:iV(["xDelta","yDelta","target"])}),t=C.none(),r=(()=>{let e=i$({drag:iV(["xDelta","yDelta"])});return{mutate:(t,r)=>{e.trigger.drag(t,r)},events:e.registry}})();return r.events.drag.bind(r=>{t.each(t=>{e.trigger.drag(r.xDelta,r.yDelta,t)})}),{assign:e=>{t=C.some(e)},get:()=>t,mutate:r.mutate,events:e.registry}})(),r=((e,t={})=>{var r;return((e,t,r)=>{let l=!1,o=i$({start:iV([]),stop:iV([])}),n=iX(),s=()=>{d.stop(),n.isOn()&&(n.off(),o.trigger.stop())},i=((e,t)=>{let r=null,l=()=>{a(r)||(clearTimeout(r),r=null)};return{cancel:l,throttle:(...t)=>{l(),r=setTimeout(()=>{r=null,e.apply(null,t)},200)}}})(s);n.events.move.bind(r=>{t.mutate(e,r.info)});let m=e=>(...t)=>{l&&e.apply(null,t)},d=t.sink(iQ({forceDrop:s,drop:m(s),move:m(e=>{i.cancel(),n.onEvent(e,t)}),delayDrop:m(i.throttle)}),r);return{element:d.element,go:e=>{d.start(e),n.on(),o.trigger.start()},on:()=>{l=!0},off:()=>{l=!1},destroy:()=>{d.destroy()},events:o.registry}})(e,null!==(r=t.mode)&&void 0!==r?r:i1,t)})(t,{}),l=C.none(),o=(e,t)=>C.from(ec(e,t));t.events.drag.bind(e=>{o(e.target,"data-row").each(t=>{let r=tC(e.target,"top");tu(e.target,"top",r+e.yDelta+"px")}),o(e.target,"data-column").each(t=>{let r=tC(e.target,"left");tu(e.target,"left",r+e.xDelta+"px")})});let n=(e,t)=>tC(e,t)-tw(e,"data-initial-"+t,0);r.events.stop.bind(()=>{t.get().each(t=>{l.each(r=>{o(t,"data-row").each(e=>{let l=n(t,"top");ef(t,"data-initial-top"),c.trigger.adjustHeight(r,l,parseInt(e,10))}),o(t,"data-column").each(e=>{let l=n(t,"left");ef(t,"data-initial-left"),c.trigger.adjustWidth(r,l,parseInt(e,10))}),i8(e,r)})})});let s=(l,o)=>{c.trigger.startAdjust(),t.assign(l),em(l,"data-initial-"+o,tC(l,o)),iW(l,ml),tu(l,"opacity","0.2"),r.go(e.parent())},i=iF(e.parent(),"mousedown",e=>{iL(e.target,i5)&&s(e.target,"top"),iL(e.target,i2)&&s(e.target,"left")}),m=t=>ey(t,e.view()),d=iF(e.view(),"mouseover",t=>{te(t.target,"table",m).filter(oj).fold(()=>{eZ(t.target)&&i7(e)},t=>{l=C.some(t),i8(e,t)})}),c=i$({adjustHeight:iV(["table","delta","row"]),adjustWidth:iV(["table","delta","column"]),startAdjust:iV([])});return{destroy:()=>{i.unbind(),d.unbind(),r.destroy(),i7(e)},refresh:t=>{i8(e,t)},on:r.on,off:r.off,hideBars:b(mt,e),showBars:b(mr,e),events:c.registry}},mn=(e,t,r)=>{let l=mo(e),o=i$({beforeResize:iV(["table","type"]),afterResize:iV(["table","type"]),startDrag:iV([])});return l.events.adjustHeight.bind(e=>{let t=e.table;o.trigger.beforeResize(t,"row"),((e,t,r,l)=>{let o=rC(e),n=lh(o,e,l,lo,e=>e.getOrThunk(tT)),s=E(n,(e,l)=>r===l?Math.max(t+e,tT()):e),a=np(o,s),i=E(o.all,(e,t)=>({element:e.element,height:s[t]}));N(i,e=>{r6(e.element,e.height)}),N(a,e=>{r6(e.element,e.height)});let m=A(s,(e,t)=>e+t,0);r6(e,m)})(t,rQ.delta(e.delta,t),e.row,rQ),o.trigger.afterResize(t,"row")}),l.events.startAdjust.bind(e=>{o.trigger.startDrag()}),l.events.adjustWidth.bind(e=>{let l=e.table;o.trigger.beforeResize(l,"col");let n=rZ.delta(e.delta,l),s=r(l);nw(l,n,e.column,t,s),o.trigger.afterResize(l,"col")}),{on:l.on,off:l.off,refreshBars:l.refresh,hideBars:l.hideBars,showBars:l.showBars,destroy:l.destroy,events:o.registry}},ms=e=>d(e)&&"TABLE"===e.nodeName,ma="bar-",mi=e=>"false"!==ec(e,"data-mce-resize"),mm=e=>{let t,r;let l=io(),o=io(),n=io(),s=t=>sA(e,t),a=()=>sS(e)?oT():oS();return e.on("init",()=>{var t;let r=e.inline?(t=ep.fromDom(e.getBody()),{parent:g((()=>{let e=ep.fromTag("div");return tf(e,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),eA(e0(ep.fromDom(document)),e),e})()),view:g(t),origin:g(rM(0,0)),isResizable:mi}):((e,t)=>{let r=en(e)?ep.fromDom(eS(e).dom.documentElement):e;return{parent:g(r),view:g(e),origin:g(rM(0,0)),isResizable:t}})(ep.fromDom(e.getDoc()),mi);if(n.set(r),(e=>{let t=e.options.get("object_resizing");return D(t.split(","),"table")})(e)&&sE(e)){let i=a(),m=mn(r,i,s);m.on(),m.events.startDrag.bind(t=>{l.set(e.selection.getRng())}),m.events.beforeResize.bind(t=>{let r=t.table.dom;((e,t,r,l,o)=>{e.dispatch("ObjectResizeStart",{target:t,width:r,height:l,origin:o})})(e,r,lV(r),l$(r),ma+t.type)}),m.events.afterResize.bind(t=>{let r=t.table,o=r.dom;lH(r),l.on(t=>{e.selection.setRng(t),e.focus()}),((e,t,r,l,o)=>{e.dispatch("ObjectResized",{target:t,width:r,height:l,origin:o})})(e,o,lV(o),l$(o),ma+t.type),e.undoManager.add()}),o.set(m)}}),e.on("ObjectResizeStart",l=>{let o=l.target;if(ms(o)){let n=ep.fromDom(o);N(e.dom.select(".mce-clonedresizable"),t=>{e.dom.addClass(t,"mce-"+sC(e)+"-columns")}),!sK(n)&&sO(e)?sX(n):!sG(n)&&sD(e)&&sQ(n),sY(n)&&ts(l.origin,ma)&&sQ(n),t=l.width,r=sk(e)?"":((e,t)=>{let r=e.dom.getStyle(t,"width")||e.dom.getAttrib(t,"width");return C.from(r).filter(tm)})(e,o).getOr("")}}),e.on("ObjectResized",l=>{let o=l.target;if(ms(o)){let n=ep.fromDom(o),i=l.origin;ts(i,"corner-")&&((l,o,n)=>{let i=ta(o,"e");if(""===r&&sQ(l),n!==t&&""!==r){tu(l,"width",r);let m=a(),d=s(l),c=sS(e)||i?oR(l).columns-1:0;nw(l,n-t,c,m,d)}else if(/^(\d+(\.\d+)?)%$/.test(r)){let u=parseFloat(r.replace("%",""));tu(l,"width",n*u/t+"%")}/^(\d+(\.\d+)?)px$/.test(r)&&(e=>{let t=rC(e);rO(t)||N(tk(e),e=>{let t=tg(e,"width");tu(e,"width",t),ef(e,"width")})})(l)})(n,i,l.width),lH(n),sf(e,n.dom,sg)}}),e.on("SwitchMode",()=>{o.on(t=>{e.mode.isReadOnly()?t.hideBars():t.showBars()})}),e.on("remove",()=>{o.on(e=>{e.destroy()}),n.on(t=>{e.inline&&ej(t.parent())})}),{refresh:e=>{o.on(t=>t.refreshBars(ep.fromDom(e)))},hide:()=>{o.on(e=>e.hideBars())},show:()=>{o.on(e=>e.showBars())}}},md=e=>{(e=>{let t=e.options.register;t("table_clone_elements",{processor:"string[]"}),t("table_use_colgroups",{processor:"boolean",default:!0}),t("table_header_type",{processor:e=>{let t=D(["section","cells","sectionCells","auto"],e);return t?{value:e,valid:t}:{valid:!1,message:"Must be one of: section, cells, sectionCells or auto."}},default:"section"}),t("table_sizing_mode",{processor:"string",default:"auto"}),t("table_default_attributes",{processor:"object",default:{border:"1"}}),t("table_default_styles",{processor:"object",default:{"border-collapse":"collapse"}}),t("table_column_resizing",{processor:e=>{let t=D(["preservetable","resizetable"],e);return t?{value:e,valid:t}:{valid:!1,message:"Must be preservetable, or resizetable."}},default:"preservetable"}),t("table_resize_bars",{processor:"boolean",default:!0}),t("table_style_by_css",{processor:"boolean",default:!0})})(e);let t=mm(e),r=iq(e,t),l=sW(e,t,r);return ai(e,l),((e,t)=>{let r=lF(e),l=t=>om(lq(e)).bind(l=>tN(l,r).map(r=>{let o=os(od(e),r,l);return t(r,o)})).getOr("");G({mceTableRowType:()=>l(t.getTableRowType),mceTableCellType:()=>l(t.getTableCellType),mceTableColType:()=>l(t.getTableColType)},(t,r)=>e.addQueryValueHandler(r,t))})(e,l),oc(e,l),{getSelectedCells:r.getSelectedCells,clearSelectedCells:r.clearSelectedCells}};e.add("dom",e=>({table:md(e)}))}();