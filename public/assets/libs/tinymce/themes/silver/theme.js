!function(){"use strict";let e=Object.getPrototypeOf,t=(e,t,o)=>{var n;return!!o(e,t.prototype)||(null===(n=e.constructor)||void 0===n?void 0:n.name)===t.name},o=e=>{let o=typeof e;return null===e?"null":"object"===o&&Array.isArray(e)?"array":"object"===o&&t(e,String,(e,t)=>t.isPrototypeOf(e))?"string":o},n=e=>t=>o(t)===e,r=e=>t=>typeof t===e,a=e=>t=>e===t,i=(o,n)=>s(o)&&t(o,n,(t,o)=>e(t)===o),l=n("string"),s=n("object"),c=e=>i(e,Object),d=n("array"),u=a(null),m=r("boolean"),g=a(void 0),p=e=>null==e,h=e=>!p(e),f=r("function"),b=r("number"),v=(e,t)=>{if(d(e)){for(let o=0,n=e.length;o<n;++o)if(!t(e[o]))return!1;return!0}return!1},y=()=>{},x=e=>()=>e(),w=(e,t)=>(...o)=>e(t.apply(null,o)),S=(e,t)=>o=>e(t(o)),k=e=>()=>e,C=e=>e,O=(e,t)=>e===t;function _(e,...t){return(...o)=>{let n=t.concat(o);return e.apply(null,n)}}let T=e=>t=>!e(t),E=e=>()=>{throw Error(e)},D=e=>e(),A=k(!1),M=k(!0);class B{constructor(e,t){this.tag=e,this.value=t}static some(e){return new B(!0,e)}static none(){return B.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?B.some(e(this.value)):B.none()}bind(e){return this.tag?e(this.value):B.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:B.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw Error(null!=e?e:"Called getOrDie on None")}static from(e){return h(e)?B.some(e):B.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}B.singletonNone=new B(!1);let F=Array.prototype.slice,I=Array.prototype.indexOf,R=Array.prototype.push,N=(e,t)=>I.call(e,t),V=(e,t)=>{let o=N(e,t);return -1===o?B.none():B.some(o)},z=(e,t)=>N(e,t)>-1,H=(e,t)=>{for(let o=0,n=e.length;o<n;o++){let n=e[o];if(t(n,o))return!0}return!1},L=(e,t)=>{let o=[];for(let n=0;n<e;n++)o.push(t(n));return o},P=(e,t)=>{let o=[];for(let n=0;n<e.length;n+=t){let r=F.call(e,n,n+t);o.push(r)}return o},U=(e,t)=>{let o=e.length,n=Array(o);for(let r=0;r<o;r++){let o=e[r];n[r]=t(o,r)}return n},W=(e,t)=>{for(let o=0,n=e.length;o<n;o++){let n=e[o];t(n,o)}},j=(e,t)=>{for(let o=e.length-1;o>=0;o--){let n=e[o];t(n,o)}},G=(e,t)=>{let o=[],n=[];for(let r=0,a=e.length;r<a;r++){let a=e[r],i=t(a,r)?o:n;i.push(a)}return{pass:o,fail:n}},$=(e,t)=>{let o=[];for(let n=0,r=e.length;n<r;n++){let r=e[n];t(r,n)&&o.push(r)}return o},q=(e,t,o)=>(j(e,(e,n)=>{o=t(o,e,n)}),o),X=(e,t,o)=>(W(e,(e,n)=>{o=t(o,e,n)}),o),K=(e,t,o)=>{for(let n=0,r=e.length;n<r;n++){let r=e[n];if(t(r,n))return B.some(r);if(o(r,n))break}return B.none()},Y=(e,t)=>K(e,t,A),J=(e,t)=>{for(let o=0,n=e.length;o<n;o++){let n=e[o];if(t(n,o))return B.some(o)}return B.none()},Z=e=>{let t=[];for(let o=0,n=e.length;o<n;++o){if(!d(e[o]))throw Error("Arr.flatten item "+o+" was not an array, input: "+e);R.apply(t,e[o])}return t},Q=(e,t)=>Z(U(e,t)),ee=(e,t)=>{for(let o=0,n=e.length;o<n;++o){let n=e[o];if(!0!==t(n,o))return!1}return!0},et=e=>{let t=F.call(e,0);return t.reverse(),t},eo=(e,t)=>$(e,e=>!z(t,e)),en=(e,t)=>{let o={};for(let n=0,r=e.length;n<r;n++){let r=e[n];o[String(r)]=t(r,n)}return o},er=e=>[e],ea=(e,t)=>{let o=F.call(e,0);return o.sort(t),o},ei=(e,t)=>t>=0&&t<e.length?B.some(e[t]):B.none(),el=e=>ei(e,0),es=e=>ei(e,e.length-1),ec=f(Array.from)?Array.from:e=>F.call(e),ed=(e,t)=>{for(let o=0;o<e.length;o++){let n=t(e[o],o);if(n.isSome())return n}return B.none()},eu=Object.keys,em=Object.hasOwnProperty,eg=(e,t)=>{let o=eu(e);for(let n=0,r=o.length;n<r;n++){let r=o[n],a=e[r];t(a,r)}},ep=(e,t)=>eh(e,(e,o)=>({k:o,v:t(e,o)})),eh=(e,t)=>{let o={};return eg(e,(e,n)=>{let r=t(e,n);o[r.k]=r.v}),o},ef=e=>(t,o)=>{e[o]=t},eb=(e,t,o,n)=>{eg(e,(e,r)=>{(t(e,r)?o:n)(e,r)})},ev=(e,t)=>{let o={},n={};return eb(e,t,ef(o),ef(n)),{t:o,f:n}},ey=(e,t)=>{let o={};return eb(e,t,ef(o),y),o},ex=(e,t)=>{let o=[];return eg(e,(e,n)=>{o.push(t(e,n))}),o},ew=(e,t)=>{let o=eu(e);for(let n=0,r=o.length;n<r;n++){let r=o[n],a=e[r];if(t(a,r,e))return B.some(a)}return B.none()},eS=e=>ex(e,C),ek=(e,t)=>eC(e,t)?B.from(e[t]):B.none(),eC=(e,t)=>em.call(e,t),eO=(e,t)=>eC(e,t)&&void 0!==e[t]&&null!==e[t],e_=(e,t,o=O)=>e.exists(e=>o(e,t)),eT=(e,t,o=O)=>eA(e,t,o).getOr(e.isNone()&&t.isNone()),eE=e=>{let t=[],o=e=>{t.push(e)};for(let t=0;t<e.length;t++)e[t].each(o);return t},eD=e=>{let t=[];for(let o=0;o<e.length;o++){let n=e[o];if(!n.isSome())return B.none();t.push(n.getOrDie())}return B.some(t)},eA=(e,t,o)=>e.isSome()&&t.isSome()?B.some(o(e.getOrDie(),t.getOrDie())):B.none(),eM=(e,t,o,n)=>e.isSome()&&t.isSome()&&o.isSome()?B.some(n(e.getOrDie(),t.getOrDie(),o.getOrDie())):B.none(),eB=(e,t)=>null!=e?B.some(t(e)):B.none(),eF=(e,t)=>e?B.some(t):B.none(),eI=(e,t)=>e+t,eR=(e,t)=>e.substring(t),eN=(e,t,o)=>""===t||e.length>=t.length&&e.substr(o,o+t.length)===t,eV=(e,t)=>eL(e,t)?eR(e,t.length):e,ez=(e,t)=>eP(e,t)?e:eI(e,t),eH=(e,t,o=0,n)=>{let r=e.indexOf(t,o);return -1!==r&&(!!g(n)||r+t.length<=n)},eL=(e,t)=>eN(e,t,0),eP=(e,t)=>eN(e,t,e.length-t.length),eU=e=>e.replace(/^\s+|\s+$/g,""),eW=e=>e.length>0,ej=e=>!eW(e),eG=e=>void 0!==e.style&&f(e.style.getPropertyValue),e$=(e,t)=>{let o=(t||document).createElement("div");if(o.innerHTML=e,!o.hasChildNodes()||o.childNodes.length>1){let t="HTML does not have a single root node";throw console.error(t,e),Error(t)}return eK(o.childNodes[0])},eq=(e,t)=>{let o=(t||document).createElement(e);return eK(o)},eX=(e,t)=>{let o=(t||document).createTextNode(e);return eK(o)},eK=e=>{if(null==e)throw Error("Node cannot be null or undefined");return{dom:e}},eY=(e,t,o)=>B.from(e.dom.elementFromPoint(t,o)).map(eK),eJ={fromHtml:e$,fromTag:eq,fromText:eX,fromDom:eK,fromPoint:eY},eZ="undefined"!=typeof window?window:Function("return this;")(),eQ=(e,t)=>{let o=null!=t?t:eZ;for(let t=0;t<e.length&&null!=o;++t)o=o[e[t]];return o},e0=(e,t)=>{let o=e.split(".");return eQ(o,t)},e1=(e,t)=>e0(e,t),e2=(e,t)=>{let o=e1(e,t);if(null==o)throw Error(e+" not available on this browser");return o},e3=Object.getPrototypeOf,e5=e=>e2("HTMLElement",e),e9=e=>{let t=e0("ownerDocument.defaultView",e);return s(e)&&(e5(t).prototype.isPrototypeOf(e)||/^HTML\w*Element$/.test(e3(e).constructor.name))},e4=e=>{let t=e.dom.nodeName;return t.toLowerCase()},e6=e=>e.dom.nodeType,e8=e=>t=>e6(t)===e,e7=e=>te(e)&&e9(e.dom),te=e8(1),tt=e8(3),to=e8(9),tn=e8(11),tr=e=>t=>te(t)&&e4(t)===e,ta=(e,t)=>{let o=e.dom;if(1!==o.nodeType)return!1;if(void 0!==o.matches)return o.matches(t);if(void 0!==o.msMatchesSelector)return o.msMatchesSelector(t);if(void 0!==o.webkitMatchesSelector)return o.webkitMatchesSelector(t);if(void 0!==o.mozMatchesSelector)return o.mozMatchesSelector(t);throw Error("Browser lacks native selectors")},ti=e=>1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount,tl=(e,t)=>{let o=void 0===t?document:t.dom;return ti(o)?[]:U(o.querySelectorAll(e),eJ.fromDom)},ts=(e,t)=>{let o=void 0===t?document:t.dom;return ti(o)?B.none():B.from(o.querySelector(e)).map(eJ.fromDom)},tc=(e,t)=>e.dom===t.dom,td=(e,t)=>{let o=e.dom,n=t.dom;return o!==n&&o.contains(n)},tu=e=>eJ.fromDom(e.dom.ownerDocument),tm=e=>to(e)?e:tu(e),tg=e=>eJ.fromDom(tm(e).dom.documentElement),tp=e=>eJ.fromDom(tm(e).dom.defaultView),th=e=>B.from(e.dom.parentNode).map(eJ.fromDom),tf=e=>B.from(e.dom.parentElement).map(eJ.fromDom),tb=(e,t)=>{let o=f(t)?t:A,n=e.dom,r=[];for(;null!==n.parentNode&&void 0!==n.parentNode;){let e=n.parentNode,t=eJ.fromDom(e);if(r.push(t),!0===o(t))break;n=e}return r},tv=e=>B.from(e.dom.offsetParent).map(eJ.fromDom),ty=e=>B.from(e.dom.nextSibling).map(eJ.fromDom),tx=e=>U(e.dom.childNodes,eJ.fromDom),tw=(e,t)=>{let o=e.dom.childNodes;return B.from(o[t]).map(eJ.fromDom)},tS=e=>tw(e,0),tk=(e,t)=>({element:e,offset:t}),tC=(e,t)=>{let o=tx(e);return o.length>0&&t<o.length?tk(o[t],0):tk(e,t)},tO=e=>tn(e)&&h(e.dom.host),t_=f(Element.prototype.attachShadow)&&f(Node.prototype.getRootNode),tT=k(t_),tE=t_?e=>eJ.fromDom(e.dom.getRootNode()):tm,tD=e=>tO(e)?e:eJ.fromDom(tm(e).dom.body),tA=e=>tM(e).isSome(),tM=e=>{let t=tE(e);return tO(t)?B.some(t):B.none()},tB=e=>eJ.fromDom(e.dom.host),tF=e=>{if(tT()&&h(e.target)){let t=eJ.fromDom(e.target);if(te(t)&&tI(t)&&e.composed&&e.composedPath){let t=e.composedPath();if(t)return el(t)}}return B.from(e.target)},tI=e=>h(e.dom.shadowRoot),tR=e=>{let t=tt(e)?e.dom.parentNode:e.dom;if(null==t||null===t.ownerDocument)return!1;let o=t.ownerDocument;return tM(eJ.fromDom(t)).fold(()=>o.body.contains(t),S(tR,tB))},tN=()=>tV(eJ.fromDom(document)),tV=e=>{let t=e.dom.body;if(null==t)throw Error("Body is not available yet");return eJ.fromDom(t)},tz=(e,t,o)=>{if(l(o)||m(o)||b(o))e.setAttribute(t,o+"");else throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",o,":: Element ",e),Error("Attribute value was not simple")},tH=(e,t,o)=>{tz(e.dom,t,o)},tL=(e,t)=>{let o=e.dom;eg(t,(e,t)=>{tz(o,t,e)})},tP=(e,t)=>{let o=e.dom.getAttribute(t);return null===o?void 0:o},tU=(e,t)=>B.from(tP(e,t)),tW=(e,t)=>{let o=e.dom;return!!o&&!!o.hasAttribute&&o.hasAttribute(t)},tj=(e,t)=>{e.dom.removeAttribute(t)},tG=e=>X(e.dom.attributes,(e,t)=>(e[t.name]=t.value,e),{}),t$=(e,t,o)=>{if(!l(o))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",o,":: Element ",e),Error("CSS value must be a string: "+o);eG(e)&&e.style.setProperty(t,o)},tq=(e,t)=>{eG(e)&&e.style.removeProperty(t)},tX=(e,t,o)=>{let n=e.dom;t$(n,t,o)},tK=(e,t)=>{let o=e.dom;eg(t,(e,t)=>{t$(o,t,e)})},tY=(e,t)=>{let o=e.dom;eg(t,(e,t)=>{e.fold(()=>{tq(o,t)},e=>{t$(o,t,e)})})},tJ=(e,t)=>{let o=e.dom,n=window.getComputedStyle(o),r=n.getPropertyValue(t);return""!==r||tR(e)?r:tZ(o,t)},tZ=(e,t)=>eG(e)?e.style.getPropertyValue(t):"",tQ=(e,t)=>{let o=e.dom,n=tZ(o,t);return B.from(n).filter(e=>e.length>0)},t0=e=>{let t={},o=e.dom;if(eG(o))for(let e=0;e<o.style.length;e++){let n=o.style.item(e);t[n]=o.style[n]}return t},t1=(e,t,o)=>{let n=eJ.fromTag(e);tX(n,t,o);let r=tQ(n,t);return r.isSome()},t2=(e,t)=>{let o=e.dom;tq(o,t),e_(tU(e,"style").map(eU),"")&&tj(e,"style")},t3=e=>e.dom.offsetWidth,t5=(e,t)=>{let o=(t,o)=>{if(!b(o)&&!o.match(/^[0-9]+$/))throw Error(e+".set accepts only positive integer values. Value was "+o);let n=t.dom;eG(n)&&(n.style[e]=o+"px")},n=o=>{let n=t(o);if(n<=0||null===n){let t=tJ(o,e);return parseFloat(t)||0}return n},r=(e,t)=>X(t,(t,o)=>{let n=tJ(e,o),r=void 0===n?0:parseInt(n,10);return isNaN(r)?t:t+r},0),a=(e,t,o)=>{let n=r(e,o);return t>n?t-n:0};return{set:o,get:n,getOuter:n,aggregate:r,max:a}},t9=t5("height",e=>{let t=e.dom;return tR(e)?t.getBoundingClientRect().height:t.offsetHeight}),t4=e=>t9.get(e),t6=e=>t9.getOuter(e),t8=(e,t)=>{let o=t9.max(e,t,["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"]);tX(e,"max-height",o+"px")},t7=(e,t)=>{let o=(o,n)=>t7(e+o,t+n);return{left:e,top:t,translate:o}},oe=e=>{let t=e.getBoundingClientRect();return t7(t.left,t.top)},ot=(e,t)=>void 0!==e?e:void 0!==t?t:0,oo=e=>{let t=e.dom.ownerDocument,o=t.body,n=t.defaultView,r=t.documentElement;if(o===e.dom)return t7(o.offsetLeft,o.offsetTop);let a=ot(null==n?void 0:n.pageYOffset,r.scrollTop),i=ot(null==n?void 0:n.pageXOffset,r.scrollLeft),l=ot(r.clientTop,o.clientTop),s=ot(r.clientLeft,o.clientLeft);return on(e).translate(i-s,a-l)},on=e=>{let t=e.dom,o=t.ownerDocument,n=o.body;return n===t?t7(n.offsetLeft,n.offsetTop):tR(e)?oe(t):t7(0,0)},or=t5("width",e=>e.dom.offsetWidth),oa=(e,t)=>or.set(e,t),oi=e=>or.get(e),ol=e=>or.getOuter(e),os=(e,t)=>{let o=or.max(e,t,["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"]);tX(e,"max-width",o+"px")},oc=e=>{let t,o=!1;return(...n)=>(o||(o=!0,t=e.apply(null,n)),t)},od=(e,t,o,n)=>{let r=e.isiOS()&&!0===/ipad/i.test(o),a=e.isiOS()&&!r,i=e.isiOS()||e.isAndroid(),l=i||n("(pointer:coarse)"),s=r||!a&&i&&n("(min-device-width:768px)"),c=a||i&&!s,d=t.isSafari()&&e.isiOS()&&!1===/safari/i.test(o);return{isiPad:k(r),isiPhone:k(a),isTablet:k(s),isPhone:k(c),isTouch:k(l),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:k(d),isDesktop:k(!c&&!s&&!d)}},ou=(e,t)=>{for(let o=0;o<e.length;o++){let n=e[o];if(n.test(t))return n}},om=(e,t)=>{let o=ou(e,t);if(!o)return{major:0,minor:0};let n=e=>Number(t.replace(o,"$"+e));return oh(n(1),n(2))},og=(e,t)=>{let o=String(t).toLowerCase();return 0===e.length?op():om(e,o)},op=()=>oh(0,0),oh=(e,t)=>({major:e,minor:t}),of={nu:oh,detect:og,unknown:op},ob=(e,t)=>ed(t.brands,t=>{let o=t.brand.toLowerCase();return Y(e,e=>{var t;return o===(null===(t=e.brand)||void 0===t?void 0:t.toLowerCase())}).map(e=>({current:e.name,version:of.nu(parseInt(t.version,10),0)}))}),ov=(e,t)=>{let o=String(t).toLowerCase();return Y(e,e=>e.search(o))},oy=(e,t)=>ov(e,t).map(e=>{let o=of.detect(e.versionRegexes,t);return{current:e.name,version:o}}),ox=(e,t)=>ov(e,t).map(e=>{let o=of.detect(e.versionRegexes,t);return{current:e.name,version:o}}),ow=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,oS=e=>t=>eH(t,e),ok=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:e=>eH(e,"edge/")&&eH(e,"chrome")&&eH(e,"safari")&&eH(e,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,ow],search:e=>eH(e,"chrome")&&!eH(e,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:e=>eH(e,"msie")||eH(e,"trident")},{name:"Opera",versionRegexes:[ow,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:oS("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:oS("firefox")},{name:"Safari",versionRegexes:[ow,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:e=>(eH(e,"safari")||eH(e,"mobile/"))&&eH(e,"applewebkit")}],oC=[{name:"Windows",search:oS("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:e=>eH(e,"iphone")||eH(e,"ipad"),versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:oS("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:oS("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:oS("linux"),versionRegexes:[]},{name:"Solaris",search:oS("sunos"),versionRegexes:[]},{name:"FreeBSD",search:oS("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:oS("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],oO={browsers:k(ok),oses:k(oC)},o_="Edge",oT="Chromium",oE="Opera",oD="Firefox",oA="Safari",oM=()=>oB({current:void 0,version:of.unknown()}),oB=e=>{let t=e.current,o=e.version,n=e=>()=>t===e;return{current:t,version:o,isEdge:n(o_),isChromium:n(oT),isIE:n("IE"),isOpera:n(oE),isFirefox:n(oD),isSafari:n(oA)}},oF={unknown:oM,nu:oB,edge:k(o_),chromium:k(oT),ie:k("IE"),opera:k(oE),firefox:k(oD),safari:k(oA)},oI="Windows",oR="Android",oN="Linux",oV="macOS",oz="Solaris",oH="FreeBSD",oL="ChromeOS",oP=()=>oU({current:void 0,version:of.unknown()}),oU=e=>{let t=e.current,o=e.version,n=e=>()=>t===e;return{current:t,version:o,isWindows:n(oI),isiOS:n("iOS"),isAndroid:n(oR),isMacOS:n(oV),isLinux:n(oN),isSolaris:n(oz),isFreeBSD:n(oH),isChromeOS:n(oL)}},oW={unknown:oP,nu:oU,windows:k(oI),ios:k("iOS"),android:k(oR),linux:k(oN),macos:k(oV),solaris:k(oz),freebsd:k(oH),chromeos:k(oL)},oj=(e,t,o)=>{let n=oO.browsers(),r=oO.oses(),a=t.bind(e=>ob(n,e)).orThunk(()=>oy(n,e)).fold(oF.unknown,oF.nu),i=ox(r,e).fold(oW.unknown,oW.nu),l=od(i,a,e,o);return{browser:a,os:i,deviceType:l}},oG={detect:oj},o$=e=>window.matchMedia(e).matches,oq=oc(()=>oG.detect(navigator.userAgent,B.from(navigator.userAgentData),o$)),oX=()=>oq(),oK=(e,t,o,n,r,a,i)=>({target:e,x:t,y:o,stop:n,prevent:r,kill:a,raw:i}),oY=e=>{let t=eJ.fromDom(tF(e).getOr(e.target)),o=()=>e.stopPropagation(),n=()=>e.preventDefault(),r=w(n,o);return oK(t,e.clientX,e.clientY,o,n,r,e)},oJ=(e,t)=>o=>{e(o)&&t(oY(o))},oZ=(e,t,o,n,r)=>{let a=oJ(o,n);return e.dom.addEventListener(t,a,r),{unbind:_(o1,e,t,a,r)}},oQ=(e,t,o,n)=>oZ(e,t,o,n,!1),o0=(e,t,o,n)=>oZ(e,t,o,n,!0),o1=(e,t,o,n)=>{e.dom.removeEventListener(t,o,n)},o2=(e,t)=>{let o=th(e);o.each(o=>{o.dom.insertBefore(t.dom,e.dom)})},o3=(e,t)=>{let o=ty(e);o.fold(()=>{let o=th(e);o.each(e=>{o9(e,t)})},e=>{o2(e,t)})},o5=(e,t)=>{let o=tS(e);o.fold(()=>{o9(e,t)},o=>{e.dom.insertBefore(t.dom,o.dom)})},o9=(e,t)=>{e.dom.appendChild(t.dom)},o4=(e,t,o)=>{tw(e,o).fold(()=>{o9(e,t)},e=>{o2(e,t)})},o6=(e,t)=>{W(t,t=>{o9(e,t)})},o8=e=>{e.dom.textContent="",W(tx(e),e=>{o7(e)})},o7=e=>{let t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},ne=e=>{let t=void 0!==e?e.dom:document,o=t.body.scrollLeft||t.documentElement.scrollLeft,n=t.body.scrollTop||t.documentElement.scrollTop;return t7(o,n)},nt=(e,t,o)=>{let n=void 0!==o?o.dom:document,r=n.defaultView;r&&r.scrollTo(e,t)},no=e=>{let t=void 0===e?window:e;return oX().browser.isFirefox()?B.none():B.from(t.visualViewport)},nn=(e,t,o,n)=>({x:e,y:t,width:o,height:n,right:e+o,bottom:t+n}),nr=e=>{let t=void 0===e?window:e,o=t.document,n=ne(eJ.fromDom(o));return no(t).fold(()=>{let e=t.document.documentElement,o=e.clientWidth,r=e.clientHeight;return nn(n.left,n.top,o,r)},e=>nn(Math.max(e.pageLeft,n.left),Math.max(e.pageTop,n.top),e.width,e.height))},na=()=>eJ.fromDom(document),ni=(e,t)=>{let o=e.view(t);return o.fold(k([]),t=>{let o=e.owner(t),n=ni(e,o);return[t].concat(n)})},nl=(e,t)=>{let o=t.owner(e),n=ni(t,o);return B.some(n)},ns=e=>{var t;let o=e.dom===document?B.none():B.from(null===(t=e.dom.defaultView)||void 0===t?void 0:t.frameElement);return o.map(eJ.fromDom)},nc=e=>tu(e);var nd,nu,nm,ng,np,nh,nf,nb,nv,ny,nx,nw,nS,nk,nC,nO,n_,nT,nE,nD,nA,nM,nB,nF,nI,nR,nN=Object.freeze({__proto__:null,view:ns,owner:nc});let nV=e=>{let t=na(),o=ne(t),n=nl(e,nN);return n.fold(_(oo,e),t=>{let n=on(e),r=q(t,(e,t)=>{let o=on(t);return{left:e.left+o.left,top:e.top+o.top}},{left:0,top:0});return t7(r.left+n.left+o.left,r.top+n.top+o.top)})},nz=(e,t,o)=>({point:e,width:t,height:o}),nH=(e,t,o,n)=>({x:e,y:t,width:o,height:n}),nL=(e,t,o,n)=>({x:e,y:t,width:o,height:n,right:e+o,bottom:t+n}),nP=e=>{let t=oo(e),o=ol(e),n=t6(e);return nL(t.left,t.top,o,n)},nU=e=>{let t=nV(e),o=ol(e),n=t6(e);return nL(t.left,t.top,o,n)},nW=(e,t)=>{let o=Math.max(e.x,t.x),n=Math.max(e.y,t.y),r=Math.min(e.right,t.right),a=Math.min(e.bottom,t.bottom);return nL(o,n,r-o,a-n)},nj=(e,t)=>X(t,(e,t)=>nW(e,t),e),nG=()=>nr(window);var n$=tinymce.util.Tools.resolve("tinymce.ThemeManager");let nq=e=>{let t=t=>t(e),o=k(e),n={tag:!0,inner:e,fold:(t,o)=>o(e),isValue:M,isError:A,map:t=>nY.value(t(e)),mapError:()=>n,bind:t,exists:t,forall:t,getOr:o,or:()=>n,getOrThunk:o,orThunk:()=>n,getOrDie:o,each:t=>{t(e)},toOptional:()=>B.some(e)};return n},nX=e=>{let t={tag:!1,inner:e,fold:(t,o)=>t(e),isValue:A,isError:M,map:()=>t,mapError:t=>nY.error(t(e)),bind:()=>t,exists:A,forall:M,getOr:C,or:C,getOrThunk:D,orThunk:D,getOrDie:E(String(e)),each:y,toOptional:B.none};return t},nK=(e,t)=>e.fold(()=>nX(t),nq),nY={value:nq,error:nX,fromOption:nK};(nu=nO||(nO={}))[nu.Error=0]="Error",nu[nu.Value=1]="Value";let nJ=(e,t,o)=>e.stype===nO.Error?t(e.serror):o(e.svalue),nZ=e=>{let t=[],o=[];return W(e,e=>{nJ(e,e=>o.push(e),e=>t.push(e))}),{values:t,errors:o}},nQ=(e,t)=>e.stype===nO.Error?{stype:nO.Error,serror:t(e.serror)}:e,n0=(e,t)=>e.stype===nO.Value?{stype:nO.Value,svalue:t(e.svalue)}:e,n1=(e,t)=>e.stype===nO.Value?t(e.svalue):e,n2=(e,t)=>e.stype===nO.Error?t(e.serror):e,n3=e=>({stype:nO.Value,svalue:e}),n5=e=>({stype:nO.Error,serror:e}),n9=e=>nJ(e,nY.error,nY.value),n4=e=>e.fold(n5,n3),n6={fromResult:n4,toResult:n9,svalue:n3,partition:nZ,serror:n5,bind:n1,bindError:n2,map:n0,mapError:nQ,fold:nJ},n8=(e,t,o,n)=>({tag:"field",key:e,newKey:t,presence:o,prop:n}),n7=(e,t)=>({tag:"custom",newKey:e,instantiator:t}),re=(e,t,o)=>{switch(e.tag){case"field":return t(e.key,e.newKey,e.presence,e.prop);case"custom":return o(e.newKey,e.instantiator)}},rt=(e,t)=>{let o=c(e)&&c(t);return o?rn(e,t):t},ro=e=>(...t)=>{if(0===t.length)throw Error("Can't merge zero objects");let o={};for(let n=0;n<t.length;n++){let r=t[n];for(let t in r)eC(r,t)&&(o[t]=e(o[t],r[t]))}return o},rn=ro(rt),rr=ro((e,t)=>t),ra=()=>({tag:"required",process:{}}),ri=e=>({tag:"defaultedThunk",process:e}),rl=e=>ri(k(e)),rs=()=>({tag:"option",process:{}}),rc=e=>({tag:"mergeWithThunk",process:e}),rd=(e,t)=>e.length>0?n6.svalue(rn(t,rr.apply(void 0,e))):n6.svalue(t),ru=e=>w(n6.serror,Z)(e),rm=(e,t)=>{let o=n6.partition(e);return o.errors.length>0?ru(o.errors):rd(o.values,t)},rg=e=>{let t=n6.partition(e);return t.errors.length>0?ru(t.errors):n6.svalue(t.values)},rp={consolidateObj:rm,consolidateArr:rg},rh=e=>s(e)&&eu(e).length>100?" removed due to size":JSON.stringify(e,null,2),rf=e=>{let t=e.length>10?e.slice(0,10).concat([{path:[],getErrorInfo:k("... (only showing first ten failures)")}]):e;return U(t,e=>"Failed path: ("+e.path.join(" > ")+")\n"+e.getErrorInfo())},rb=(e,t)=>n6.serror([{path:e,getErrorInfo:t}]),rv=(e,t,o)=>rb(e,()=>'Could not find valid *required* value for "'+t+'" in '+rh(o)),ry=(e,t)=>rb(e,()=>'Choice schema did not contain choice key: "'+t+'"'),rx=(e,t,o)=>rb(e,()=>'The chosen schema: "'+o+'" did not exist in branches: '+rh(t)),rw=(e,t)=>rb(e,()=>"There are unsupported fields: ["+t.join(", ")+"] specified"),rS=(e,t)=>rb(e,k(t)),rk=e=>{let t=(t,o)=>n6.bindError(e(o),e=>rS(t,e)),o=k("val");return{extract:t,toString:o}},rC=rk(n6.svalue),rO=(e,t,o,n)=>ek(t,o).fold(()=>rv(e,o,t),n),r_=(e,t,o,n)=>{let r=ek(e,t).getOrThunk(()=>o(e));return n(r)},rT=(e,t,o)=>o(ek(e,t)),rE=(e,t,o,n)=>{let r=ek(e,t).map(t=>!0===t?o(e):t);return n(r)},rD=(e,t,o,n,r)=>{let a=e=>r.extract(t.concat([n]),e),i=e=>e.fold(()=>n6.svalue(B.none()),e=>{let o=r.extract(t.concat([n]),e);return n6.map(o,B.some)});switch(e.tag){case"required":return rO(t,o,n,a);case"defaultedThunk":return r_(o,n,e.process,a);case"option":return rT(o,n,i);case"defaultedOptionThunk":return rE(o,n,e.process,i);case"mergeWithThunk":return r_(o,n,k({}),t=>{let n=rn(e.process(o),t);return a(n)})}},rA=(e,t,o)=>{let n={},r=[];for(let a of o)re(a,(o,a,i,l)=>{let s=rD(i,e,t,o,l);n6.fold(s,e=>{r.push(...e)},e=>{n[a]=e})},(e,o)=>{n[e]=o(t)});return r.length>0?n6.serror(r):n6.svalue(n)},rM=e=>{let t=(t,o)=>e().extract(t,o),o=()=>e().toString();return{extract:t,toString:o}},rB=e=>eu(ey(e,h)),rF=e=>{let t=rI(e),o=q(e,(e,t)=>re(t,t=>rn(e,{[t]:!0}),k(e)),{}),n=(e,n)=>{let r=m(n)?[]:rB(n),a=$(r,e=>!eO(o,e));return 0===a.length?t.extract(e,n):rw(e,a)};return{extract:n,toString:t.toString}},rI=e=>{let t=(t,o)=>rA(t,o,e),o=()=>{let t=U(e,e=>re(e,(e,t,o,n)=>e+" -> "+n.toString(),(e,t)=>"state("+e+")"));return"obj{\n"+t.join("\n")+"}"};return{extract:t,toString:o}},rR=e=>{let t=(t,o)=>{let n=U(o,(o,n)=>e.extract(t.concat(["["+n+"]"]),o));return rp.consolidateArr(n)},o=()=>"array("+e.toString()+")";return{extract:t,toString:o}},rN=(e,t)=>{let o=void 0!==t?t:C,n=(t,n)=>{let r=[];for(let a of e){let e=a.extract(t,n);if(e.stype===nO.Value)return{stype:nO.Value,svalue:o(e.svalue)};r.push(e)}return rp.consolidateArr(r)},r=()=>"oneOf("+U(e,e=>e.toString()).join(", ")+")";return{extract:n,toString:r}},rV=(e,t)=>{let o=(t,o)=>rR(rk(e)).extract(t,o),n=(e,n)=>{let r=eu(n),a=o(e,r);return n6.bind(a,o=>{let r=U(o,e=>n8(e,e,ra(),t));return rI(r).extract(e,n)})},r=()=>"setOf("+t.toString()+")";return{extract:n,toString:r}},rz=(e,t)=>{let o=oc(t),n=(e,t)=>o().extract(e,t),r=()=>o().toString();return{extract:n,toString:r}},rH=w(rR,rI),rL=k(rC),rP=(e,t)=>rk(o=>e(o)?n6.svalue(o):n6.serror(`Expected type: ${t} but got: ${typeof o}`)),rU=rP(b,"number"),rW=rP(l,"string"),rj=rP(m,"boolean"),rG=rP(f,"function"),r$=e=>{if(Object(e)!==e)return!0;switch(({}).toString.call(e).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(e).every(t=>r$(e[t]));default:return!1}},rq=rk(e=>r$(e)?n6.svalue(e):n6.serror("Expected value to be acceptable for sending via postMessage")),rX=(e,t,o,n)=>{let r=ek(o,n);return r.fold(()=>rx(e,o,n),o=>o.extract(e.concat(["branch: "+n]),t))},rK=(e,t)=>{let o=(o,n)=>{let r=ek(n,e);return r.fold(()=>ry(o,e),e=>rX(o,n,t,e))},n=()=>"chooseOn("+e+"). Possible values: "+eu(t);return{extract:o,toString:n}},rY=e=>rk(t=>e(t).fold(n6.serror,n6.svalue)),rJ=(e,t)=>rV(t=>n6.fromResult(e(t)),t),rZ=(e,t,o)=>{let n=t.extract([e],o);return n6.mapError(n,e=>({input:o,errors:e}))},rQ=(e,t,o)=>n6.toResult(rZ(e,t,o)),r0=e=>e.fold(e=>{throw Error(r2(e))},C),r1=(e,t,o)=>r0(rQ(e,t,o)),r2=e=>"Errors: \n"+rf(e.errors).join("\n")+"\n\nInput object: "+rh(e.input),r3=(e,t)=>rK(e,ep(t,rI)),r5=(e,t)=>rz(e,t),r9=e=>rY(t=>z(e,t)?nY.value(t):nY.error(`Unsupported value: "${t}", choose one of "${e.join(", ")}".`)),r4=e=>n8(e,e,ra(),rL()),r6=(e,t)=>n8(e,e,ra(),t),r8=e=>r6(e,rU),r7=e=>r6(e,rW),ae=(e,t)=>n8(e,e,ra(),r9(t)),at=e=>r6(e,rG),ao=(e,t)=>n8(e,e,rs(),rk(o=>n6.serror("The field: "+e+" is forbidden. "+t))),an=(e,t)=>n8(e,e,ra(),rI(t)),ar=(e,t)=>n8(e,e,ra(),rH(t)),aa=(e,t)=>n8(e,e,ra(),rR(t)),ai=e=>n8(e,e,rs(),rL()),al=(e,t)=>n8(e,e,rs(),t),as=e=>al(e,rU),ac=e=>al(e,rW),ad=(e,t)=>al(e,r9(t)),au=e=>al(e,rG),am=(e,t)=>al(e,rR(t)),ag=(e,t)=>al(e,rI(t)),ap=(e,t)=>al(e,rF(t)),ah=(e,t)=>n8(e,e,rl(t),rL()),af=(e,t,o)=>n8(e,e,rl(t),o),ab=(e,t)=>af(e,t,rU),av=(e,t)=>af(e,t,rW),ay=(e,t,o)=>af(e,t,r9(o)),ax=(e,t)=>af(e,t,rj),aw=(e,t)=>af(e,t,rG),aS=(e,t,o)=>af(e,t,rR(o)),ak=(e,t,o)=>af(e,t,rI(o)),aC=e=>{let t=e,o=e=>{t=e};return{get:()=>t,set:o}},aO=e=>{if(!d(e))throw Error("cases must be an array");if(0===e.length)throw Error("there must be at least one case");let t=[],o={};return W(e,(n,r)=>{let a=eu(n);if(1!==a.length)throw Error("one and only one name per case");let i=a[0],l=n[i];if(void 0!==o[i])throw Error("duplicate key detected:"+i);if("cata"===i)throw Error("cannot have a case named cata (sorry)");if(!d(l))throw Error("case arguments must be an array");t.push(i),o[i]=(...o)=>{let n=o.length;if(n!==l.length)throw Error("Wrong number of arguments to case "+i+". Expected "+l.length+" ("+l+"), got "+n);let a=e=>{let n=eu(e);if(t.length!==n.length)throw Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+n.join(","));let r=ee(t,e=>z(n,e));if(!r)throw Error("Not all branches were specified when using match. Specified: "+n.join(", ")+"\nRequired: "+t.join(", "));return e[i].apply(null,o)};return{fold:(...t)=>{if(t.length!==e.length)throw Error("Wrong number of arguments to fold. Expected "+e.length+", got "+t.length);let n=t[r];return n.apply(null,o)},match:a,log:e=>{console.log(e,{constructors:t,constructor:i,params:o})}}}}),o},a_={generate:aO};a_.generate([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);let aT=e=>{let t=[],o=[];return W(e,e=>{e.fold(e=>{t.push(e)},e=>{o.push(e)})}),{errors:t,values:o}},aE=(e,t)=>{let o={};return eg(e,(e,n)=>{z(t,n)||(o[n]=e)}),o},aD=(e,t)=>({[e]:t}),aA=e=>{let t={};return W(e,e=>{t[e.key]=e.value}),t},aM=(e,t)=>aE(e,t),aB=(e,t)=>aD(e,t),aF=e=>aA(e),aI=(e,t)=>0===e.length?nY.value(t):nY.value(rn(t,rr.apply(void 0,e))),aR=e=>nY.error(Z(e)),aN=(e,t)=>{let o=aT(e);return o.errors.length>0?aR(o.errors):aI(o.values,t)},aV=e=>f(e)?e:A,az=(e,t,o)=>{let n=e.dom,r=aV(o);for(;n.parentNode;){n=n.parentNode;let e=eJ.fromDom(n),o=t(e);if(o.isSome())return o;if(r(e))break}return B.none()},aH=(e,t,o)=>{let n=t(e),r=aV(o);return n.orThunk(()=>r(e)?B.none():az(e,t,r))},aL=(e,t)=>tc(e.element,t.event.target),aP={can:M,abort:A,run:y},aU=e=>{if(!eO(e,"can")&&!eO(e,"abort")&&!eO(e,"run"))throw Error("EventHandler defined by: "+JSON.stringify(e,null,2)+" does not have can, abort, or run!");return{...aP,...e}},aW=(e,t)=>(...o)=>X(e,(e,n)=>e&&t(n).apply(void 0,o),!0),aj=(e,t)=>(...o)=>X(e,(e,n)=>e||t(n).apply(void 0,o),!1),aG=e=>f(e)?{can:M,abort:A,run:e}:e,a$=e=>{let t=aW(e,e=>e.can),o=aj(e,e=>e.abort),n=(...t)=>{W(e,e=>{e.run.apply(void 0,t)})};return{can:t,abort:o,run:n}},aq=k("touchstart"),aX=k("touchmove"),aK=k("touchend"),aY=k("touchcancel"),aJ=k("mousedown"),aZ=k("mousemove"),aQ=k("mouseout"),a0=k("mouseup"),a1=k("mouseover"),a2=k("focusin"),a3=k("focusout"),a5=k("keydown"),a9=k("keyup"),a4=k("input"),a6=k("change"),a8=k("click"),a7=k("transitioncancel"),ie=k("transitionend"),it=k("transitionstart"),io=k("selectstart"),ir=e=>k("alloy."+e),ia={tap:ir("tap")},ii=ir("focus"),il=ir("blur.post"),is=ir("paste.post"),ic=ir("receive"),id=ir("execute"),iu=ir("focus.item"),im=ia.tap,ig=ir("longpress"),ip=ir("sandbox.close"),ih=ir("typeahead.cancel"),ib=ir("system.init"),iv=ir("system.touchmove"),iy=ir("system.touchend"),ix=ir("system.scroll"),iw=ir("system.resize"),iS=ir("system.attached"),ik=ir("system.detached"),iC=ir("system.dismissRequested"),iO=ir("system.repositionRequested"),i_=ir("focusmanager.shifted"),iT=ir("slotcontainer.visibility"),iE=ir("system.external.element.scroll"),iD=ir("change.tab"),iA=ir("dismiss.tab"),iM=ir("highlight"),iB=ir("dehighlight"),iF=(e,t)=>{iV(e,e.element,t,{})},iI=(e,t,o)=>{iV(e,e.element,t,o)},iR=e=>{iF(e,id())},iN=(e,t,o)=>{iV(e,t,o,{})},iV=(e,t,o,n)=>{let r={target:t,...n};e.getSystem().triggerEvent(o,t,r)},iz=(e,t,o,n)=>{let r={...n,target:t};e.getSystem().triggerEvent(o,t,r)},iH=(e,t,o,n)=>{e.getSystem().triggerEvent(o,t,n.event)},iL=e=>aF(e),iP=(e,t)=>({key:e,value:aU({abort:t})}),iU=e=>({key:e,value:aU({run:(e,t)=>{t.event.prevent()}})}),iW=(e,t)=>({key:e,value:aU({run:t})}),ij=(e,t,o)=>({key:e,value:aU({run:(e,n)=>{t.apply(void 0,[e,n].concat(o))}})}),iG=e=>t=>({key:e,value:aU({run:(e,o)=>{aL(e,o)&&t(e,o)}})}),i$=(e,t)=>iW(e,(o,n)=>{o.getSystem().getByUid(t).each(t=>{iH(t,t.element,e,n)})}),iq=(e,t,o)=>{let n=t.partUids[o];return i$(e,n)},iX=(e,t)=>iW(e,(e,o)=>{let n=o.event,r=e.getSystem().getByDom(n.target).getOrThunk(()=>{let t=aH(n.target,t=>e.getSystem().getByDom(t).toOptional(),A);return t.getOr(e)});t(e,r,o)}),iK=e=>iW(e,(e,t)=>{t.cut()}),iY=e=>iW(e,(e,t)=>{t.stop()}),iJ=(e,t)=>iG(e)(t),iZ=iG(iS()),iQ=iG(ik()),i0=iG(ib()),i1=(nm=id(),e=>iW(nm,e)),i2=(e,t)=>{let o=(t||document).createElement("div");return o.innerHTML=e,tx(eJ.fromDom(o))},i3=e=>e.dom.innerHTML,i5=(e,t)=>{let o=tu(e),n=o.dom,r=eJ.fromDom(n.createDocumentFragment()),a=i2(t,n);o6(r,a),o8(e),o9(e,r)},i9=e=>{let t=eJ.fromTag("div"),o=eJ.fromDom(e.dom.cloneNode(!0));return o9(t,o),i3(t)},i4=(e,t)=>eJ.fromDom(e.dom.cloneNode(t)),i6=e=>i4(e,!1),i8=e=>{if(tO(e))return"#shadow-root";{let t=i6(e);return i9(t)}},i7=e=>i8(e),le=(e,t,o)=>tc(t,e.element)&&!tc(t,o),lt=iL([{key:ii(),value:aU({can:(e,t)=>{let o=t.event,n=o.originator,r=o.target;return!le(e,n,r)||(console.warn(ii()+" did not get interpreted by the desired target. \nOriginator: "+i7(n)+"\nTarget: "+i7(r)+"\nCheck the "+ii()+" event handlers"),!1)}})}]);var lo=Object.freeze({__proto__:null,events:lt});let ln=0,lr=e=>{let t=new Date,o=t.getTime();return e+"_"+Math.floor(1e9*Math.random())+ ++ln+String(o)},la=k("alloy-id-"),li=k("data-alloy-id"),ll=la(),ls=li(),lc=(e,t)=>{let o=lr(ll+e);return ld(t,o),o},ld=(e,t)=>{Object.defineProperty(e.dom,ls,{value:t,writable:!0})},lu=e=>{let t=te(e)?e.dom[ls]:null;return B.from(t)},lm=e=>lr(e),lg=e=>{let t=t=>`The component must be in a context to execute: ${t}`+(e?"\n"+i7(e().element)+" is not in context.":""),o=e=>()=>{throw Error(t(e))},n=e=>()=>{console.warn(t(e))};return{debugInfo:k("fake"),triggerEvent:n("triggerEvent"),triggerFocus:n("triggerFocus"),triggerEscape:n("triggerEscape"),broadcast:n("broadcast"),broadcastOn:n("broadcastOn"),broadcastEvent:n("broadcastEvent"),build:o("build"),buildOrPatch:o("buildOrPatch"),addToWorld:o("addToWorld"),removeFromWorld:o("removeFromWorld"),addToGui:o("addToGui"),removeFromGui:o("removeFromGui"),getByUid:o("getByUid"),getByDom:o("getByDom"),isConnected:A}},lp=lg(),lh=(e,t,o)=>{let n=o.toString(),r=n.indexOf(")")+1,a=n.indexOf("("),i=n.substring(a+1,r-1).split(/,\s*/);return e.toFunctionAnnotation=()=>({name:t,parameters:lf(i.slice(0,1).concat(i.slice(3)))}),e},lf=e=>U(e,e=>eP(e,"/*")?e.substring(0,e.length-2):e),lb=(e,t)=>{let o=e.toString(),n=o.indexOf(")")+1,r=o.indexOf("("),a=o.substring(r+1,n-1).split(/,\s*/);return e.toFunctionAnnotation=()=>({name:t,parameters:lf(a)}),e},lv=(e,t)=>{let o=t.toString(),n=o.indexOf(")")+1,r=o.indexOf("("),a=o.substring(r+1,n-1).split(/,\s*/);return e.toFunctionAnnotation=()=>({name:"OVERRIDE",parameters:lf(a.slice(1))}),e},ly=lr("alloy-premade"),lx=e=>(Object.defineProperty(e.element.dom,ly,{value:e.uid,writable:!0}),aB(ly,e)),lw=e=>eC(e.dom,ly),lS=e=>ek(e,ly),lk=e=>lv((t,...o)=>e(t.getApis(),t,...o),e),lC={init:()=>lO({readState:k("No State required")})},lO=e=>e,l_=(e,t)=>{let o=U(t,e=>ag(e.name(),[r4("config"),ah("state",lC)])),n=rQ("component.behaviours",rI(o),e.behaviours).fold(t=>{throw Error(r2(t)+"\nComplete spec:\n"+JSON.stringify(e,null,2))},C);return{list:t,data:ep(n,e=>{let t=e.map(e=>({config:e.config,state:e.state.init(e.config)}));return k(t)})}},lT=e=>e.list,lE=e=>e.data,lD=(e,t)=>{let o={};return eg(e,(e,n)=>{eg(e,(e,r)=>{let a=ek(o,r).getOr([]);o[r]=a.concat([t(n,e)])})}),o},lA=e=>({classes:g(e.classes)?[]:e.classes,attributes:g(e.attributes)?{}:e.attributes,styles:g(e.styles)?{}:e.styles}),lM=(e,t)=>({...e,attributes:{...e.attributes,...t.attributes},styles:{...e.styles,...t.styles},classes:e.classes.concat(t.classes)}),lB=(e,t,o,n)=>{let r={...t};W(o,t=>{r[t.name()]=t.exhibit(e,n)});let a=lD(r,(e,t)=>({name:e,modification:t})),i=e=>q(e,(e,t)=>({...t.modification,...e}),{}),l=q(a.classes,(e,t)=>t.modification.concat(e),[]),s=i(a.attributes),c=i(a.styles);return lA({classes:l,attributes:s,styles:c})},lF=(e,t,o,n)=>{try{let r=ea(o,(o,r)=>{let a=o[t],i=r[t],l=n.indexOf(a),s=n.indexOf(i);if(-1===l)throw Error("The ordering for "+e+" does not have an entry for "+a+".\nOrder specified: "+JSON.stringify(n,null,2));if(-1===s)throw Error("The ordering for "+e+" does not have an entry for "+i+".\nOrder specified: "+JSON.stringify(n,null,2));return l<s?-1:s<l?1:0});return nY.value(r)}catch(e){return nY.error([e])}},lI=(e,t)=>({handler:e,purpose:t}),lR=(e,t)=>({cHandler:e,purpose:t}),lN=(e,t)=>lR(_.apply(void 0,[e.handler].concat(t)),e.purpose),lV=e=>e.cHandler,lz=(e,t)=>({name:e,handler:t}),lH=(e,t)=>{let o={};return W(e,e=>{o[e.name()]=e.handlers(t)}),o},lL=(e,t,o)=>{let n={...o,...lH(t,e)};return lD(n,lz)},lP=(e,t,o,n)=>{let r=lL(e,o,n);return lG(r,t)},lU=e=>{let t=aG(e);return(e,o,...n)=>{let r=[e,o].concat(n);t.abort.apply(void 0,r)?o.stop():t.can.apply(void 0,r)&&t.run.apply(void 0,r)}},lW=(e,t)=>nY.error(["The event ("+e+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(U(t,e=>e.name),null,2)]),lj=(e,t,o)=>{let n=t[o];return n?lF("Event: "+o,"name",e,n).map(e=>{let t=U(e,e=>e.handler);return a$(t)}):lW(o,e)},lG=(e,t)=>{let o=ex(e,(e,o)=>{let n=1===e.length?nY.value(e[0].handler):lj(e,t,o);return n.map(n=>{let r=lU(n),a=e.length>1?$(t[o],t=>H(e,e=>e.name===t)).join(" > "):e[0].name;return aB(o,lI(r,a))})});return aN(o,{})},l$="alloy.base.behaviour",lq=rI([n8("dom","dom",ra(),rI([r4("tag"),ah("styles",{}),ah("classes",[]),ah("attributes",{}),ai("value"),ai("innerHtml")])),r4("components"),r4("uid"),ah("events",{}),ah("apis",{}),n8("eventOrder","eventOrder",(ng={[id()]:["disabling",l$,"toggling","typeaheadevents"],[ii()]:[l$,"focusing","keying"],[ib()]:[l$,"disabling","toggling","representing"],[a4()]:[l$,"representing","streaming","invalidating"],[ik()]:[l$,"representing","item-events","tooltipping"],[aJ()]:["focusing",l$,"item-type-events"],[aq()]:["focusing",l$,"item-type-events"],[a1()]:["item-type-events","tooltipping"],[ic()]:["receiving","reflecting","tooltipping"]},rc(k(ng))),rL()),ai("domModification")]),lX=e=>rQ("custom.definition",lq,e),lK=e=>({...e.dom,uid:e.uid,domChildren:U(e.components,e=>e.element)}),lY=e=>e.domModification.fold(()=>lA({}),lA),lJ=e=>e.events,lZ=(e,t)=>{let o=tP(e,t);return void 0===o||""===o?[]:o.split(" ")},lQ=(e,t,o)=>{let n=lZ(e,t),r=n.concat([o]);return tH(e,t,r.join(" ")),!0},l0=(e,t,o)=>{let n=$(lZ(e,t),e=>e!==o);return n.length>0?tH(e,t,n.join(" ")):tj(e,t),!1},l1=e=>void 0!==e.dom.classList,l2=e=>lZ(e,"class"),l3=(e,t)=>lQ(e,"class",t),l5=(e,t)=>l0(e,"class",t),l9=(e,t)=>{l1(e)?e.dom.classList.add(t):l3(e,t)},l4=e=>{let t=l1(e)?e.dom.classList:l2(e);0===t.length&&tj(e,"class")},l6=(e,t)=>{if(l1(e)){let o=e.dom.classList;o.remove(t)}else l5(e,t);l4(e)},l8=(e,t)=>l1(e)&&e.dom.classList.contains(t),l7=(e,t)=>{W(t,t=>{l9(e,t)})},se=(e,t)=>{W(t,t=>{l6(e,t)})},st=(e,t)=>ee(t,t=>l8(e,t)),so=e=>{let t=e.dom.classList,o=Array(t.length);for(let e=0;e<t.length;e++){let n=t.item(e);null!==n&&(o[e]=n)}return o},sn=e=>l1(e)?so(e):l2(e),sr=e=>e.dom.value,sa=(e,t)=>{if(void 0===t)throw Error("Value.set was undefined");e.dom.value=t},si=(e,t,o)=>{let n=tw(e,t);return n.map(e=>{let t=o.exists(t=>!tc(t,e));if(!t)return e;{let t=o.map(e4).getOr("span"),n=eJ.fromTag(t);return o2(e,n),n}})},sl=(e,t,o)=>{o.fold(()=>o9(e,t),e=>{tc(e,t)||(o2(e,t),o7(e))})},ss=(e,t,o)=>{let n=U(t,o),r=tx(e);return W(r.slice(n.length),o7),n},sc=(e,t,o,n)=>{let r=tw(e,t),a=n(o,r),i=si(e,t,r);return sl(e,a.element,i),a},sd=(e,t,o)=>ss(e,t,(t,n)=>sc(e,n,t,o)),su=(e,t)=>ss(e,t,(t,o)=>{let n=tw(e,o);return sl(e,t,n),t}),sm=(e,t)=>{let o=eu(e),n=eu(t),r=eo(n,o),a=ev(e,(e,o)=>!eC(t,o)||e!==t[o]).t;return{toRemove:r,toSet:a}},sg=(e,t)=>{let{class:o,style:n,...r}=tG(t),{toSet:a,toRemove:i}=sm(e.attributes,r),l=t0(t),{toSet:s,toRemove:c}=sm(e.styles,l),d=sn(t),u=eo(d,e.classes),m=eo(e.classes,d),g=e=>{i5(t,e)},p=()=>{let o=e.domChildren;su(t,o)};return W(i,e=>tj(t,e)),tL(t,a),l7(t,m),se(t,u),W(c,e=>t2(t,e)),tK(t,s),e.innerHtml.fold(p,g),(()=>{let o=e.value.getOrUndefined();o!==sr(t)&&sa(t,null!=o?o:"")})(),t},sp=e=>{let t=eJ.fromTag(e.tag);tL(t,e.attributes),l7(t,e.classes),tK(t,e.styles),e.innerHtml.each(e=>i5(t,e));let o=e.domChildren;return o6(t,o),e.value.each(e=>{sa(t,e)}),t},sh=(e,t)=>{try{let o=sg(e,t);return B.some(o)}catch(e){return B.none()}},sf=e=>e.innerHtml.isSome()&&e.domChildren.length>0,sb=(e,t)=>{let o=t=>e4(t)===e.tag&&!sf(e)&&!lw(t),n=t.filter(o).bind(t=>sh(e,t)).getOrThunk(()=>sp(e));return ld(n,e.uid),n},sv=e=>{let t=ek(e,"behaviours").getOr({});return Q(eu(t),e=>{let o=t[e];return h(o)?[o.me]:[]})},sy=(e,t)=>l_(e,t),sx=e=>{let t=sv(e);return sy(e,t)},sw=(e,t,o)=>{let n=lK(e),r=lY(e),a=t.length>0?lB(o,{"alloy.base.modification":r},t,n):r;return lM(n,a)},sS=(e,t,o)=>{let n={"alloy.base.behaviour":lJ(e)};return lP(o,e.eventOrder,t,n).getOrDie()},sk=(e,t)=>{let o=()=>y,n=aC(lp),r=r0(lX(e)),a=sx(e),i=lT(a),l=lE(a),s=sw(r,i,l),c=sb(s,t),d=sS(r,i,l),u=aC(r.components),m=e=>{n.set(e)},g=()=>{n.set(lg(o))},p=()=>{let e=tx(c),t=Q(e,e=>n.get().getByDom(e).fold(()=>[],er));u.set(t)},h=t=>{let o=f(l[t.name()])?l[t.name()]:()=>{throw Error("Could not find "+t.name()+" in "+JSON.stringify(e,null,2))};return o()},b=e=>f(l[e.name()]),v=e=>l[e]().map(e=>e.state.readState()).getOr("not enabled"),y={uid:e.uid,getSystem:n.get,config:h,hasConfigured:b,spec:e,readState:v,getApis:()=>r.apis,connect:m,disconnect:g,element:c,syncComponents:p,components:u.get,events:d};return y},sC=(e,t)=>{let o=ek(e,"components").getOr([]);return t.fold(()=>U(o,sA),e=>U(o,(t,o)=>sD(t,tw(e,o))))},sO=(e,t)=>{let{events:o,...n}=C(e),r=sC(n,t),a={...n,events:{...lo,...o},components:r};return nY.value(sk(a,t))},s_=e=>{let t=eJ.fromText(e);return sT({element:t})},sT=e=>{let t=r1("external.component",rF([r4("element"),ai("uid")]),e),o=aC(lg()),n=e=>{o.set(e)},r=()=>{o.set(lg(()=>i))},a=t.uid.getOrThunk(()=>lm("external"));ld(t.element,a);let i={uid:a,getSystem:o.get,config:B.none,hasConfigured:A,connect:n,disconnect:r,getApis:()=>({}),element:t.element,spec:e,readState:k("No state"),syncComponents:y,components:k([]),events:{}};return lx(i)},sE=e=>eC(e,"uid"),sD=(e,t)=>lS(e).getOrThunk(()=>{let o=sE(e)?e:{uid:lm(""),...e};return sO(o,t).getOrDie()}),sA=e=>sD(e,B.none());var sM=(e,t,o,n,r)=>e(o,n)?B.some(o):f(r)&&r(o)?B.none():t(o,n,r);let sB=(e,t,o)=>{let n=e.dom,r=f(o)?o:A;for(;n.parentNode;){n=n.parentNode;let e=eJ.fromDom(n);if(t(e))return B.some(e);if(r(e))break}return B.none()},sF=(e,t,o)=>{let n=(e,t)=>t(e);return sM(n,sB,e,t,o)},sI=(e,t)=>{let o=e=>t(eJ.fromDom(e)),n=Y(e.dom.childNodes,o);return n.map(eJ.fromDom)},sR=(e,t)=>{let o=e=>{for(let n=0;n<e.childNodes.length;n++){let r=eJ.fromDom(e.childNodes[n]);if(t(r))return B.some(r);let a=o(e.childNodes[n]);if(a.isSome())return a}return B.none()};return o(e.dom)},sN=(e,t,o)=>sF(e,t,o).isSome(),sV=(e,t,o)=>sB(e,e=>ta(e,t),o),sz=(e,t)=>sI(e,e=>ta(e,t)),sH=(e,t)=>ts(t,e),sL=(e,t,o)=>{let n=(e,t)=>ta(e,t);return sM(n,sV,e,t,o)},sP="aria-controls",sU=e=>{let t=sF(e,e=>{if(!te(e))return!1;let t=tP(e,"id");return void 0!==t&&t.indexOf(sP)>-1});return t.bind(e=>{let t=tP(e,"id"),o=tE(e);return sH(o,`[${sP}="${t}"]`)})},sW=()=>{let e=lr(sP),t=t=>{tH(t,sP,e)},o=e=>{tj(e,sP)};return{id:e,link:t,unlink:o}},sj=(e,t)=>sU(t).exists(t=>sG(e,t)),sG=(e,t)=>sN(t,t=>tc(t,e.element),A)||sj(e,t),s$="unknown";(np=n_||(n_={}))[np.STOP=0]="STOP",np[np.NORMAL=1]="NORMAL",np[np.LOGGING=2]="LOGGING";let sq=aC({}),sX=(e,t)=>{let o=[],n=new Date().getTime();return{logEventCut:(e,t,n)=>{o.push({outcome:"cut",target:t,purpose:n})},logEventStopped:(e,t,n)=>{o.push({outcome:"stopped",target:t,purpose:n})},logNoParent:(e,t,n)=>{o.push({outcome:"no-parent",target:t,purpose:n})},logEventNoHandlers:(e,t)=>{o.push({outcome:"no-handlers-left",target:t})},logEventResponse:(e,t,n)=>{o.push({outcome:"response",purpose:n,target:t})},write:()=>{let r=new Date().getTime();z(["mousemove","mouseover","mouseout",ib()],e)||console.log(e,{event:e,time:r-n,target:t.dom,sequence:U(o,e=>z(["cut","stopped","response"],e.outcome)?"{"+e.purpose+"} "+e.outcome+" at ("+i7(e.target)+")":e.outcome)})}}},sK=(e,t,o)=>{let n=ek(sq.get(),e).orThunk(()=>{let t=eu(sq.get());return ed(t,t=>e.indexOf(t)>-1?B.some(sq.get()[t]):B.none())}).getOr(n_.NORMAL);switch(n){case n_.NORMAL:return o(sQ());case n_.LOGGING:{let n=sX(e,t),r=o(n);return n.write(),r}case n_.STOP:return!0}},sY=["alloy/data/Fields","alloy/debugging/Debugging"],sJ=()=>{let e=Error();if(void 0===e.stack)return s$;{let t=e.stack.split("\n");return Y(t,e=>e.indexOf("alloy")>0&&!H(sY,t=>e.indexOf(t)>-1)).getOr(s$)}},sZ=(e,t,o)=>sK(e,t,o),sQ=k({logEventCut:y,logEventStopped:y,logNoParent:y,logEventNoHandlers:y,logEventResponse:y,write:y}),s0=k([r4("menu"),r4("selectedMenu")]),s1=k([r4("item"),r4("selectedItem")]);k(rI(s1().concat(s0())));let s2=k(rI(s1())),s3=an("initSize",[r4("numColumns"),r4("numRows")]),s5=()=>an("markers",[r4("backgroundMenu")].concat(s0()).concat(s1())),s9=e=>an("markers",U(e,r4)),s4=(e,t,o)=>(sJ(),n8(t,t,o,rY(e=>nY.value((...t)=>e.apply(void 0,t))))),s6=e=>s4("onHandler",e,rl(y)),s8=e=>s4("onKeyboardHandler",e,rl(B.none)),s7=e=>s4("onHandler",e,ra()),ce=e=>s4("onKeyboardHandler",e,ra()),ct=(e,t)=>n7(e,k(t)),co=e=>n7(e,C),cn=k(s3),cr=(e,t,o,n,r,a,i,l=!1)=>({x:e,y:t,bubble:o,direction:n,placement:r,restriction:a,label:`${i}-${r}`,alwaysFit:l}),ca=a_.generate([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),ci=(e,t,o,n,r,a,i,l,s)=>e.fold(t,o,n,r,a,i,l,s),cl=(e,t,o,n)=>e.fold(t,t,n,n,t,n,o,o),cs=(e,t,o,n)=>e.fold(t,n,t,n,o,o,t,n),cc=ca.southeast,cd=ca.southwest,cu=ca.northeast,cm=ca.northwest,cg=ca.south,cp=ca.north,ch=ca.east,cf=ca.west,cb=(e,t,o,n)=>{let r=e+t;return r>n?o:r<o?n:r},cv=(e,t,o)=>Math.min(Math.max(e,t),o),cy=(e,t)=>{switch(t){case 1:return e.x;case 0:return e.x+e.width;case 2:return e.y;case 3:return e.y+e.height}},cx=(e,t)=>en(["left","right","top","bottom"],o=>ek(t,o).map(t=>cy(e,t))),cw=(e,t,o)=>{let n=(n,r)=>t[n].map(t=>{let a="top"===n||"bottom"===n,i=a?o.top:o.left,l=("left"===n||"top"===n?Math.max:Math.min)(t,r)+i;return a?cv(l,e.y,e.bottom):cv(l,e.x,e.right)}).getOr(r),r=n("left",e.x),a=n("top",e.y),i=n("right",e.right),l=n("bottom",e.bottom);return nL(r,a,i-r,l-a)},cS="layout",ck=e=>e.x,cC=(e,t)=>e.x+e.width/2-t.width/2,cO=(e,t)=>e.x+e.width-t.width,c_=(e,t)=>e.y-t.height,cT=e=>e.y+e.height,cE=(e,t)=>e.y+e.height/2-t.height/2,cD=e=>e.x+e.width,cA=(e,t)=>e.x-t.width,cM=(e,t,o)=>cr(ck(e),cT(e),o.southeast(),cc(),"southeast",cx(e,{left:1,top:3}),cS),cB=(e,t,o)=>cr(cO(e,t),cT(e),o.southwest(),cd(),"southwest",cx(e,{right:0,top:3}),cS),cF=(e,t,o)=>cr(ck(e),c_(e,t),o.northeast(),cu(),"northeast",cx(e,{left:1,bottom:2}),cS),cI=(e,t,o)=>cr(cO(e,t),c_(e,t),o.northwest(),cm(),"northwest",cx(e,{right:0,bottom:2}),cS),cR=(e,t,o)=>cr(cC(e,t),c_(e,t),o.north(),cp(),"north",cx(e,{bottom:2}),cS),cN=(e,t,o)=>cr(cC(e,t),cT(e),o.south(),cg(),"south",cx(e,{top:3}),cS),cV=(e,t,o)=>cr(cD(e),cE(e,t),o.east(),ch(),"east",cx(e,{left:0}),cS),cz=(e,t,o)=>cr(cA(e,t),cE(e,t),o.west(),cf(),"west",cx(e,{right:1}),cS),cH=()=>[cM,cB,cF,cI,cN,cR,cV,cz],cL=()=>[cB,cM,cI,cF,cN,cR,cV,cz],cP=()=>[cF,cI,cM,cB,cR,cN],cU=()=>[cI,cF,cB,cM,cR,cN],cW=()=>[cM,cB,cF,cI,cN,cR],cj=()=>[cB,cM,cI,cF,cN,cR],cG=(e,t)=>t.universal?e:$(e,e=>z(t.channels,e)),c$=e=>iL([iW(ic(),(t,o)=>{let n=e.channels,r=eu(n),a=cG(r,o);W(a,e=>{let r=n[e],a=r.schema,i=r1("channel["+e+"] data\nReceiver: "+i7(t.element),a,o.data);r.onReceive(t,i)})})]);var cq=Object.freeze({__proto__:null,events:c$}),cX=[r6("channels",rJ(nY.value,rF([s7("onReceive"),ah("schema",rL())])))];let cK=(e,t,o)=>i1(n=>{o(n,e,t)}),cY=(e,t,o)=>i0((n,r)=>{o(n,e,t)}),cJ=(e,t,o,n,r,a)=>{let i=rF(e),l=ag(t,[ap("config",e)]);return c1(i,l,t,o,n,r,a)},cZ=(e,t,o,n,r,a)=>{let i=ag(t,[al("config",e)]);return c1(e,i,t,o,n,r,a)},cQ=(e,t,o)=>{let n=(n,...r)=>{let a=[n].concat(r);return n.config({name:k(e)}).fold(()=>{throw Error("We could not find any behaviour configuration for: "+e+". Using API: "+o)},e=>{let o=Array.prototype.slice.call(a,1);return t.apply(void 0,[n,e.config,e.state].concat(o))})};return lh(n,o,t)},c0=e=>({key:e,value:void 0}),c1=(e,t,o,n,r,a,i)=>{let l=e=>eO(e,o)?e[o]():B.none(),s=ep(r,(e,t)=>cQ(o,e,t)),c=ep(a,(e,t)=>lb(e,t)),d={...c,...s,revoke:_(c0,o),config:t=>{let n=r1(o+"-config",e,t);return{key:o,value:{config:n,me:d,configAsRaw:oc(()=>r1(o+"-config",e,t)),initialConfig:t,state:i}}},schema:k(t),exhibit:(e,t)=>eA(l(e),ek(n,"exhibit"),(e,o)=>o(t,e.config,e.state)).getOrThunk(()=>lA({})),name:k(o),handlers:e=>l(e).map(e=>{let t=ek(n,"events").getOr(()=>({}));return t(e.config,e.state)}).getOr({})};return d},c2=e=>aF(e),c3=rF([r4("fields"),r4("name"),ah("active",{}),ah("apis",{}),ah("state",lC),ah("extra",{})]),c5=e=>{let t=r1("Creating behaviour: "+e.name,c3,e);return cJ(t.fields,t.name,t.active,t.apis,t.extra,t.state)},c9=rF([r4("branchKey"),r4("branches"),r4("name"),ah("active",{}),ah("apis",{}),ah("state",lC),ah("extra",{})]),c4=e=>{let t=r1("Creating behaviour: "+e.name,c9,e);return cZ(r3(t.branchKey,t.branches),t.name,t.active,t.apis,t.extra,t.state)},c6=k(void 0),c8=c5({fields:cX,name:"receiving",active:cq}),c7=(e,t)=>lA({classes:[],styles:t.useFixed()?{}:{position:"relative"}});var de=Object.freeze({__proto__:null,exhibit:c7});let dt=e=>e.dom.focus(),dn=e=>e.dom.blur(),dr=e=>{let t=tE(e).dom;return e.dom===t.activeElement},da=(e=na())=>B.from(e.dom.activeElement).map(eJ.fromDom),di=e=>da(tE(e)).filter(t=>e.dom.contains(t.dom)),dl=(e,t)=>{let o=tE(t),n=da(o).bind(e=>{let o=t=>tc(e,t);return o(t)?B.some(t):sR(t,o)}),r=e(t);return n.each(e=>{da(o).filter(t=>tc(t,e)).fold(()=>{dt(e)},y)}),r},ds=(e,t,o,n,r)=>{let a=e=>e+"px";return{position:e,left:t.map(a),top:o.map(a),right:n.map(a),bottom:r.map(a)}},dc=e=>({...e,position:B.some(e.position)}),dd=(e,t)=>{tY(e,dc(t))},du=a_.generate([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),dm=(e,t,o,n,r,a)=>{let i=t.rect,l=i.x-o,s=i.y-n,c=i.width,d=i.height,u=B.some(l),m=B.some(s),g=B.some(r-(l+c)),p=B.some(a-(s+d)),h=B.none();return ci(t.direction,()=>ds(e,u,m,h,h),()=>ds(e,h,m,g,h),()=>ds(e,u,h,h,p),()=>ds(e,h,h,g,p),()=>ds(e,u,m,h,h),()=>ds(e,u,h,h,p),()=>ds(e,u,m,h,h),()=>ds(e,h,m,g,h))},dg=(e,t)=>e.fold(()=>{let e=t.rect;return ds("absolute",B.some(e.x),B.some(e.y),B.none(),B.none())},(e,o,n,r)=>dm("absolute",t,e,o,n,r),(e,o,n,r)=>dm("fixed",t,e,o,n,r)),dp=(e,t)=>{let o=_(nV,t),n=e.fold(o,o,()=>{let e=ne();return nV(t).translate(-e.left,-e.top)}),r=ol(t),a=t6(t);return nL(n.left,n.top,r,a)},dh=(e,t)=>t.fold(()=>e.fold(nG,nG,nL),t=>e.fold(k(t),k(t),()=>{let o=df(e,t.x,t.y);return nL(o.left,o.top,t.width,t.height)})),df=(e,t,o)=>{let n=t7(t,o),r=()=>{let e=ne();return n.translate(-e.left,-e.top)};return e.fold(k(n),k(n),r)},db=(e,t,o,n)=>e.fold(t,o,n);du.none;let dv=du.relative,dy=du.fixed,dx=(e,t)=>({anchorBox:e,origin:t}),dw=(e,t)=>dx(e,t),dS="data-alloy-placement",dk=(e,t)=>{tH(e,dS,t)},dC=e=>tU(e,dS),dO=e=>tj(e,dS),d_=a_.generate([{fit:["reposition"]},{nofit:["reposition","visibleW","visibleH","isVisible"]}]),dT=(e,t)=>{let{x:o,y:n,right:r,bottom:a}=t,{x:i,y:l,right:s,bottom:c,width:d,height:u}=e;return{originInBounds:i>=o&&i<=r&&l>=n&&l<=a,sizeInBounds:s<=r&&s>=o&&c<=a&&c>=n,visibleW:Math.min(d,i>=o?r-i:s-o),visibleH:Math.min(u,l>=n?a-l:c-n)}},dE=(e,t)=>{let{x:o,y:n,right:r,bottom:a}=t,{x:i,y:l,width:s,height:c}=e,d=cv(i,o,Math.max(o,r-s)),u=cv(l,n,Math.max(n,a-c));return nL(d,u,Math.min(d+s,r)-d,Math.min(u+c,a)-u)},dD=(e,t,o)=>{let n=k(t.bottom-o.y),r=k(o.bottom-t.y),a=cl(e,r,r,n),i=k(t.right-o.x),l=k(o.right-t.x),s=cs(e,l,l,i);return{maxWidth:s,maxHeight:a}},dA=(e,t,o,n)=>{let r=e.bubble,a=r.offset,i=cw(n,e.restriction,a),l=e.x+a.left,s=e.y+a.top,c=nL(l,s,t,o),{originInBounds:d,sizeInBounds:u,visibleW:m,visibleH:g}=dT(c,i),p=d&&u,h=p?c:dE(c,i),f=h.width>0&&h.height>0,{maxWidth:b,maxHeight:v}=dD(e.direction,h,n),y={rect:h,maxHeight:v,maxWidth:b,direction:e.direction,placement:e.placement,classes:{on:r.classesOn,off:r.classesOff},layout:e.label,testY:s};return p||e.alwaysFit?d_.fit(y):d_.nofit(y,m,g,f)},dM=(e,t,o,n,r,a)=>{let i=n.width,l=n.height,s=(t,s,c,d,u)=>{let m=t(o,n,r,e,a),g=dA(m,i,l,a);return g.fold(k(g),(e,t,o,n)=>(u===n?o>d||t>c:!u&&n)?g:d_.nofit(s,c,d,u))},c=X(t,(e,t)=>{let o=_(s,t);return e.fold(k(e),o)},d_.nofit({rect:o,maxHeight:n.height,maxWidth:n.width,direction:cc(),placement:"southeast",classes:{on:[],off:[]},layout:"none",testY:o.y},-1,-1,!1));return c.fold(C,C)},dB=e=>{let t=aC(B.none()),o=()=>t.get().each(e),n=()=>{o(),t.set(B.none())},r=()=>t.get().isSome(),a=()=>t.get(),i=e=>{o(),t.set(B.some(e))};return{clear:n,isSet:r,get:a,set:i}},dF=()=>dB(e=>e.destroy()),dI=()=>dB(e=>e.unbind()),dR=()=>{let e=dB(y),t=t=>e.get().each(t);return{...e,on:t}},dN=(e,t,o)=>oQ(e,t,M,o),dV=(e,t,o)=>o0(e,t,M,o),dz=["top","bottom","right","left"],dH="data-alloy-transition-timer",dL=(e,t)=>st(e,t.classes),dP=(e,t,o)=>o.exists(o=>{let n=e.mode;return"all"===n||o[n]!==t[n]}),dU=(e,t)=>{let o=e=>parseFloat(e).toFixed(3);return ew(t,(t,n)=>{let r=e[n].map(o),a=t.map(o);return!eT(r,a)}).isSome()},dW=e=>{let t=t=>{let o=tJ(e,t),n=o.split(/\s*,\s*/);return $(n,eW)},o=e=>{if(!(l(e)&&/^[\d.]+/.test(e)))return 0;{let t=parseFloat(e);return eP(e,"ms")?t:1e3*t}},n=t("transition-delay"),r=t("transition-duration");return X(r,(e,t,r)=>{let a=o(n[r])+o(t);return Math.max(e,a)},0)},dj=(e,t)=>{let o;let n=dI(),r=dI(),a=t=>{var o;let n=null!==(o=t.raw.pseudoElement)&&void 0!==o?o:"";return tc(t.target,e)&&ej(n)&&z(dz,t.raw.propertyName)},i=i=>{if(p(i)||a(i)){n.clear(),r.clear();let a=null==i?void 0:i.raw.type;(p(a)||a===ie())&&(clearTimeout(o),tj(e,dH),se(e,t.classes))}},l=dN(e,it(),t=>{a(t)&&(l.unbind(),n.set(dN(e,ie(),i)),r.set(dN(e,a7(),i)))}),s=dW(e);requestAnimationFrame(()=>{o=setTimeout(i,s+17),tH(e,dH,o)})},dG=(e,t)=>{l7(e,t.classes),tU(e,dH).each(t=>{clearTimeout(parseInt(t,10)),tj(e,dH)}),dj(e,t)},d$=(e,t,o,n,r,a)=>{let i=dP(n,r,a);if(i||dL(e,n)){tX(e,"position",o.position);let a=dp(t,e),l=dg(t,{...r,rect:a}),s=en(dz,e=>l[e]);dU(o,s)&&(tY(e,s),i&&dG(e,n),t3(e))}else se(e,n.classes)},dq=e=>({width:ol(e),height:t6(e)}),dX=(e,t,o,n)=>{t2(t,"max-height"),t2(t,"max-width");let r=dq(t);return dM(t,n.preference,e,r,o,n.bounds)},dK=(e,t)=>{let o=t.classes;se(e,o.off),l7(e,o.on)},dY=(e,t,o)=>{let n=o.maxHeightFunction;n(e,t.maxHeight)},dJ=(e,t,o)=>{let n=o.maxWidthFunction;n(e,t.maxWidth)},dZ=(e,t,o)=>{let n=dg(o.origin,t);o.transition.each(r=>{d$(e,o.origin,n,r,t,o.lastPlacement)}),dd(e,n)},dQ=(e,t)=>{dk(e,t.placement)},d0=(e,t)=>{t8(e,Math.floor(t))},d1=k((e,t)=>{d0(e,t),tK(e,{"overflow-x":"hidden","overflow-y":"auto"})}),d2=k((e,t)=>{d0(e,t)}),d3=(e,t,o)=>void 0===e[t]?o:e[t],d5=(e,t,o,n,r,a,i,l)=>{let s=d3(i,"maxHeightFunction",d1()),c=d3(i,"maxWidthFunction",y),d=e.anchorBox,u=e.origin,m={bounds:dh(u,a),origin:u,preference:n,maxHeightFunction:s,maxWidthFunction:c,lastPlacement:r,transition:l};return d9(d,t,o,m)},d9=(e,t,o,n)=>{let r=dX(e,t,o,n);return dZ(t,r,n),dQ(t,r),dK(t,r),dY(t,r,n),dJ(t,r,n),{layout:r.layout,placement:r.placement}},d4=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right","inset"],d6=(e,t,o,n=1)=>{let r=e*n,a=t*n,i=e=>ek(o,e).getOr([]),l=(e,t,o)=>{let n=eo(d4,o);return{offset:t7(e,t),classesOn:Q(o,i),classesOff:Q(n,i)}};return{southeast:()=>l(-e,t,["top","alignLeft"]),southwest:()=>l(e,t,["top","alignRight"]),south:()=>l(-e/2,t,["top","alignCentre"]),northeast:()=>l(-e,-t,["bottom","alignLeft"]),northwest:()=>l(e,-t,["bottom","alignRight"]),north:()=>l(-e/2,-t,["bottom","alignCentre"]),east:()=>l(e,-t/2,["valignCentre","left"]),west:()=>l(-e,-t/2,["valignCentre","right"]),insetNortheast:()=>l(r,a,["top","alignLeft","inset"]),insetNorthwest:()=>l(-r,a,["top","alignRight","inset"]),insetNorth:()=>l(-r/2,a,["top","alignCentre","inset"]),insetSoutheast:()=>l(r,-a,["bottom","alignLeft","inset"]),insetSouthwest:()=>l(-r,-a,["bottom","alignRight","inset"]),insetSouth:()=>l(-r/2,-a,["bottom","alignCentre","inset"]),insetEast:()=>l(-r,-a/2,["valignCentre","right","inset"]),insetWest:()=>l(r,-a/2,["valignCentre","left","inset"])}},d8=()=>d6(0,0,{}),d7=(e,t)=>o=>"rtl"===ue(o)?t:e,ue=e=>"rtl"===tJ(e,"direction")?"rtl":"ltr";(nh=nT||(nT={})).TopToBottom="toptobottom",nh.BottomToTop="bottomtotop";let ut="data-alloy-vertical-dir",uo=e=>sN(e,e=>te(e)&&tP(e,"data-alloy-vertical-dir")===nT.BottomToTop),un=()=>ag("layouts",[r4("onLtr"),r4("onRtl"),ai("onBottomLtr"),ai("onBottomRtl")]),ur=(e,t,o,n,r,a,i)=>{let l=i.map(uo).getOr(!1),s=t.layouts.map(t=>t.onLtr(e)),c=t.layouts.map(t=>t.onRtl(e)),d=l?t.layouts.bind(t=>t.onBottomLtr.map(t=>t(e))).or(s).getOr(r):s.getOr(o),u=l?t.layouts.bind(t=>t.onBottomRtl.map(t=>t(e))).or(c).getOr(a):c.getOr(n),m=d7(d,u);return m(e)},ua=(e,t,o)=>{let n=t.hotspot,r=dp(o,n.element),a=ur(e.element,t,cW(),cj(),cP(),cU(),B.some(t.hotspot.element));return B.some(C({anchorBox:r,bubble:t.bubble.getOr(d8()),overrides:t.overrides,layouts:a}))};var ui=[r4("hotspot"),ai("bubble"),ah("overrides",{}),un(),ct("placement",ua)];let ul=(e,t,o)=>{let n=df(o,t.x,t.y),r=nL(n.left,n.top,t.width,t.height),a=ur(e.element,t,cH(),cL(),cH(),cL(),B.none());return B.some(C({anchorBox:r,bubble:t.bubble,overrides:t.overrides,layouts:a}))};var us=[r4("x"),r4("y"),ah("height",0),ah("width",0),ah("bubble",d8()),ah("overrides",{}),un(),ct("placement",ul)];let uc=a_.generate([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),ud=e=>e.fold(C,(e,t,o)=>e.translate(-t,-o)),uu=e=>e.fold(C,C),um=e=>X(e,(e,t)=>e.translate(t.left,t.top),t7(0,0)),ug=e=>{let t=U(e,ud);return um(t)},up=e=>{let t=U(e,uu);return um(t)},uh=uc.screen,uf=uc.absolute,ub=(e,t,o)=>{let n=tp(o.root).dom,r=t=>{let o=tu(t),n=tu(e.element);return tc(o,n)};return B.from(n.frameElement).map(eJ.fromDom).filter(r).map(oo)},uv=(e,t,o)=>{let n=tu(e.element),r=ne(n),a=ub(e,t,o).getOr(r);return uf(a,r.left,r.top)},uy=(e,t,o,n)=>{let r=uh(t7(e,t));return B.some(nz(r,o,n))},ux=(e,t,o,n,r)=>e.map(e=>{let a=[t,e.point],i=db(n,()=>up(a),()=>up(a),()=>ug(a)),l=nH(i.left,i.top,e.width,e.height),s=o.showAbove?cP():cW(),c=o.showAbove?cU():cj(),d=ur(r,o,s,c,s,c,B.none());return C({anchorBox:l,bubble:o.bubble.getOr(d8()),overrides:o.overrides,layouts:d})}),uw=(e,t,o)=>{let n=uv(e,o,t);return t.node.filter(tR).bind(r=>{let a=r.dom.getBoundingClientRect(),i=uy(a.left,a.top,a.width,a.height),l=t.node.getOr(e.element);return ux(i,n,t,o,l)})};var uS=[r4("node"),r4("root"),ai("bubble"),un(),ah("overrides",{}),ah("showAbove",!1),ct("placement",uw)];let uk=(e,t,o,n)=>({start:e,soffset:t,finish:o,foffset:n}),uC={create:uk},uO=a_.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),u_=(e,t,o,n)=>e.fold(t,o,n),uT=e=>e.fold(C,C,C),uE=uO.before,uD=uO.on,uA=uO.after,uM={before:uE,on:uD,after:uA,cata:u_,getStart:uT},uB=a_.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),uF=e=>uB.exact(e.start,e.soffset,e.finish,e.foffset),uI=e=>e.match({domRange:e=>eJ.fromDom(e.startContainer),relative:(e,t)=>uM.getStart(e),exact:(e,t,o,n)=>e}),uR=uB.domRange,uN=uB.relative,uV=uB.exact,uz=e=>{let t=uI(e);return tp(t)},uH=uC.create,uL={domRange:uR,relative:uN,exact:uV,exactFromRange:uF,getWin:uz,range:uH},uP=(e,t)=>{t.fold(t=>{e.setStartBefore(t.dom)},(t,o)=>{e.setStart(t.dom,o)},t=>{e.setStartAfter(t.dom)})},uU=(e,t)=>{t.fold(t=>{e.setEndBefore(t.dom)},(t,o)=>{e.setEnd(t.dom,o)},t=>{e.setEndAfter(t.dom)})},uW=(e,t,o)=>{let n=e.document.createRange();return uP(n,t),uU(n,o),n},uj=(e,t,o,n,r)=>{let a=e.document.createRange();return a.setStart(t.dom,o),a.setEnd(n.dom,r),a},uG=e=>({left:e.left,top:e.top,right:e.right,bottom:e.bottom,width:e.width,height:e.height}),u$=e=>{let t=e.getClientRects(),o=t.length>0?t[0]:e.getBoundingClientRect();return o.width>0||o.height>0?B.some(o).map(uG):B.none()},uq=e=>{let t=e.getBoundingClientRect();return t.width>0||t.height>0?B.some(t).map(uG):B.none()},uX=a_.generate([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),uK=(e,t,o)=>t(eJ.fromDom(o.startContainer),o.startOffset,eJ.fromDom(o.endContainer),o.endOffset),uY=(e,t)=>t.match({domRange:e=>({ltr:k(e),rtl:B.none}),relative:(t,o)=>({ltr:oc(()=>uW(e,t,o)),rtl:oc(()=>B.some(uW(e,o,t)))}),exact:(t,o,n,r)=>({ltr:oc(()=>uj(e,t,o,n,r)),rtl:oc(()=>B.some(uj(e,n,r,t,o)))})}),uJ=(e,t)=>{let o=t.ltr();if(!o.collapsed)return uK(e,uX.ltr,o);{let n=t.rtl().filter(e=>!1===e.collapsed);return n.map(e=>uX.rtl(eJ.fromDom(e.endContainer),e.endOffset,eJ.fromDom(e.startContainer),e.startOffset)).getOrThunk(()=>uK(e,uX.ltr,o))}},uZ=(e,t)=>{let o=uY(e,t);return uJ(e,o)},uQ=(e,t)=>{let o=uZ(e,t);return o.match({ltr:(t,o,n,r)=>{let a=e.document.createRange();return a.setStart(t.dom,o),a.setEnd(n.dom,r),a},rtl:(t,o,n,r)=>{let a=e.document.createRange();return a.setStart(n.dom,r),a.setEnd(t.dom,o),a}})};uX.ltr,uX.rtl;let u0=(e,t,o)=>$(tb(e,o),t),u1=(e,t)=>tl(t,e),u2=(e,t,o,n)=>{let r=tu(e),a=r.dom.createRange();return a.setStart(e.dom,t),a.setEnd(o.dom,n),a},u3=(e,t,o,n)=>{let r=u2(e,t,o,n),a=tc(e,o)&&t===n;return r.collapsed&&!a},u5=e=>B.from(e.getSelection()),u9=e=>{if(!(e.rangeCount>0))return B.none();{let t=e.getRangeAt(0),o=e.getRangeAt(e.rangeCount-1);return B.some(uC.create(eJ.fromDom(t.startContainer),t.startOffset,eJ.fromDom(o.endContainer),o.endOffset))}},u4=e=>{if(null===e.anchorNode||null===e.focusNode)return u9(e);{let t=eJ.fromDom(e.anchorNode),o=eJ.fromDom(e.focusNode);return u3(t,e.anchorOffset,o,e.focusOffset)?B.some(uC.create(t,e.anchorOffset,o,e.focusOffset)):u9(e)}},u6=e=>u5(e).filter(e=>e.rangeCount>0).bind(u4),u8=(e,t)=>{let o=uQ(e,t);return u$(o)},u7=(e,t)=>{let o=uQ(e,t);return uq(o)},me=((e,t)=>{let o=o=>{if(!e(o))throw Error("Can only get "+t+" value of a "+t+" node");return n(o).getOr("")},n=t=>e(t)?B.from(t.dom.nodeValue):B.none(),r=(o,n)=>{if(!e(o))throw Error("Can only set raw "+t+" value of a "+t+" node");o.dom.nodeValue=n};return{get:o,getOption:n,set:r}})(tt,"text"),mt=e=>me.get(e),mo=(e,t)=>({element:e,offset:t}),mn=(e,t)=>{let o=tx(e);if(0===o.length)return mo(e,t);if(t<o.length)return mo(o[t],0);{let e=o[o.length-1],t=tt(e)?mt(e).length:tx(e).length;return mo(e,t)}},mr=(e,t)=>tt(e)?mo(e,t):mn(e,t),ma=(e,t)=>{let o=t.getSelection.getOrThunk(()=>()=>u6(e));return o().map(e=>{let t=mr(e.start,e.soffset),o=mr(e.finish,e.foffset);return uL.range(t.element,t.offset,o.element,o.offset)})},mi=(e,t,o)=>{let n=tp(t.root).dom,r=uv(e,o,t),a=ma(n,t).bind(e=>{let t=u7(n,uL.exactFromRange(e)).orThunk(()=>{let t=eJ.fromText("\uFEFF");o2(e.start,t);let o=u8(n,uL.exact(t,0,t,1));return o7(t),o});return t.bind(e=>uy(e.left,e.top,e.width,e.height))}),i=ma(n,t).bind(e=>te(e.start)?B.some(e.start):tf(e.start)),l=i.getOr(e.element);return ux(a,r,t,o,l)};var ml=[ai("getSelection"),r4("root"),ai("bubble"),un(),ah("overrides",{}),ah("showAbove",!1),ct("placement",mi)];let ms="link-layout",mc=e=>e.x+e.width,md=(e,t)=>e.x-t.width,mu=(e,t)=>e.y-t.height+e.height,mm=e=>e.y,mg=(e,t,o)=>cr(mc(e),mm(e),o.southeast(),cc(),"southeast",cx(e,{left:0,top:2}),ms),mp=(e,t,o)=>cr(md(e,t),mm(e),o.southwest(),cd(),"southwest",cx(e,{right:1,top:2}),ms),mh=(e,t,o)=>cr(mc(e),mu(e,t),o.northeast(),cu(),"northeast",cx(e,{left:0,bottom:3}),ms),mf=(e,t,o)=>cr(md(e,t),mu(e,t),o.northwest(),cm(),"northwest",cx(e,{right:1,bottom:3}),ms),mb=()=>[mg,mp,mh,mf],mv=()=>[mp,mg,mf,mh],my=(e,t,o)=>{let n=dp(o,t.item.element),r=ur(e.element,t,mb(),mv(),mb(),mv(),B.none());return B.some(C({anchorBox:n,bubble:d8(),overrides:t.overrides,layouts:r}))};var mx=r3("type",{selection:ml,node:uS,hotspot:ui,submenu:[r4("item"),un(),ah("overrides",{}),ct("placement",my)],makeshift:us});let mw=[aa("classes",rW),ay("mode","all",["all","layout","placement"])],mS=[ah("useFixed",A),ai("getBounds")],mk=[r6("anchor",mx),ag("transition",mw)],mC=()=>{let e=document.documentElement;return dy(0,0,e.clientWidth,e.clientHeight)},mO=e=>{let t=oo(e.element),o=e.element.dom.getBoundingClientRect();return dv(t.left,t.top,o.width,o.height)},m_=(e,t,o,n,r,a)=>{let i=dw(t.anchorBox,e);return d5(i,n.element,t.bubble,t.layouts,r,o,t.overrides,a)},mT=(e,t,o,n,r)=>{let a=B.none();mE(e,t,o,n,r,a)},mE=(e,t,o,n,r,a)=>{let i=r1("placement.info",rI(mk),r),l=i.anchor,s=n.element,c=o.get(n.uid);dl(()=>{tX(s,"position","fixed");let r=tQ(s,"visibility");tX(s,"visibility","hidden");let d=t.useFixed()?mC():mO(e);l.placement(e,l,d).each(e=>{let r=a.orThunk(()=>t.getBounds.map(D)),l=m_(d,e,r,n,c,i.transition);o.set(n.uid,l)}),r.fold(()=>{t2(s,"visibility")},e=>{tX(s,"visibility",e)}),tQ(s,"left").isNone()&&tQ(s,"top").isNone()&&tQ(s,"right").isNone()&&tQ(s,"bottom").isNone()&&e_(tQ(s,"position"),"fixed")&&t2(s,"position")},s)},mD=(e,t,o)=>t.useFixed()?"fixed":"absolute",mA=(e,t,o,n)=>{let r=n.element;W(["position","left","right","top","bottom"],e=>t2(r,e)),dO(r),o.clear(n.uid)};var mM=Object.freeze({__proto__:null,position:mT,positionWithinBounds:mE,getMode:mD,reset:mA});let mB=()=>{let e={},t=(t,o)=>{e[t]=o},o=t=>ek(e,t),n=t=>{h(t)?delete e[t]:e={}};return lO({readState:()=>e,clear:n,set:t,get:o})};var mF=Object.freeze({__proto__:null,init:mB});let mI=c5({fields:mS,name:"positioning",active:de,apis:mM,state:mF}),mR=e=>e.getSystem().isConnected(),mN=e=>{iF(e,ik());let t=e.components();W(t,mN)},mV=e=>{let t=e.components();W(t,mV),iF(e,iS())},mz=(e,t)=>{e.getSystem().addToWorld(t),tR(e.element)&&mV(t)},mH=e=>{mN(e),e.getSystem().removeFromWorld(e)},mL=(e,t)=>{o9(e.element,t.element)},mP=e=>{W(e.components(),e=>o7(e.element)),o8(e.element),e.syncComponents()},mU=(e,t,o)=>{let n=e.components();mP(e);let r=o(t),a=eo(n,r);W(a,t=>{mN(t),e.getSystem().removeFromWorld(t)}),W(r,t=>{mR(t)?mL(e,t):(e.getSystem().addToWorld(t),mL(e,t),tR(e.element)&&mV(t))}),e.syncComponents()},mW=(e,t,o)=>{let n=e.components(),r=Q(t,e=>lS(e).toArray());W(n,e=>{z(r,e)||mH(e)});let a=o(t),i=eo(n,a);W(i,e=>{mR(e)&&mH(e)}),W(a,t=>{mR(t)||mz(e,t)}),e.syncComponents()},mj=(e,t)=>{mG(e,t,o9)},mG=(e,t,o)=>{e.getSystem().addToWorld(t),o(e.element,t.element),tR(e.element)&&mV(t),e.syncComponents()},m$=e=>{mN(e),o7(e.element),e.getSystem().removeFromWorld(e)},mq=e=>{let t=th(e.element).bind(t=>e.getSystem().getByDom(t).toOptional());m$(e),t.each(e=>{e.syncComponents()})},mX=e=>{let t=e.components();W(t,m$),o8(e.element),e.syncComponents()},mK=(e,t)=>{mJ(e,t,o9)},mY=(e,t)=>{mJ(e,t,o3)},mJ=(e,t,o)=>{o(e,t.element);let n=tx(t.element);W(n,e=>{t.getByDom(e).each(mV)})},mZ=e=>{let t=tx(e.element);W(t,t=>{e.getByDom(t).each(mN)}),o7(e.element)},mQ=(e,t,o,n)=>{o.get().each(t=>{mX(e)});let r=t.getAttachPoint(e);mj(r,e);let a=e.getSystem().build(n);return mj(e,a),o.set(a),a},m0=(e,t,o,n)=>{let r=mQ(e,t,o,n);return t.onOpen(e,r),r},m1=(e,t,o,n)=>o.get().map(()=>mQ(e,t,o,n)),m2=(e,t,o,n,r)=>{m7(e,t),m0(e,t,o,n),r(),gt(e,t)},m3=(e,t,o)=>{o.get().each(n=>{mX(e),mq(e),t.onClose(e,n),o.clear()})},m5=(e,t,o)=>o.isOpen(),m9=(e,t,o,n)=>m5(e,t,o)&&o.get().exists(o=>t.isPartOf(e,o,n)),m4=(e,t,o)=>o.get(),m6=(e,t,o,n)=>{tQ(e.element,t).fold(()=>{tj(e.element,o)},t=>{tH(e.element,o,t)}),tX(e.element,t,n)},m8=(e,t,o)=>{tU(e.element,o).fold(()=>t2(e.element,t),o=>tX(e.element,t,o))},m7=(e,t,o)=>{let n=t.getAttachPoint(e);tX(e.element,"position",mI.getMode(n)),m6(e,"visibility",t.cloakVisibilityAttr,"hidden")},ge=e=>H(["top","left","right","bottom"],t=>tQ(e,t).isSome()),gt=(e,t,o)=>{ge(e.element)||t2(e.element,"position"),m8(e,"visibility",t.cloakVisibilityAttr)};var go=Object.freeze({__proto__:null,cloak:m7,decloak:gt,open:m0,openWhileCloaked:m2,close:m3,isOpen:m5,isPartOf:m9,getState:m4,setContent:m1});let gn=(e,t)=>iL([iW(ip(),(o,n)=>{m3(o,e,t)})]);var gr=Object.freeze({__proto__:null,events:gn}),ga=[s6("onOpen"),s6("onClose"),r4("isPartOf"),r4("getAttachPoint"),ah("cloakVisibilityAttr","data-precloak-visibility")];let gi=()=>{let e=dR(),t=k("not-implemented");return lO({readState:t,isOpen:e.isSet,clear:e.clear,set:e.set,get:e.get})};var gl=Object.freeze({__proto__:null,init:gi});let gs=c5({fields:ga,name:"sandboxing",active:gr,apis:go,state:gl}),gc=k("dismiss.popups"),gd=k("reposition.popups"),gu=k("mouse.released"),gm=rF([ah("isExtraPart",A),ag("fireEventInstead",[ah("event",iC())])]),gg=e=>{let t=r1("Dismissal",gm,e);return{[gc()]:{schema:rF([r4("target")]),onReceive:(e,o)=>{if(gs.isOpen(e)){let n=gs.isPartOf(e,o.target)||t.isExtraPart(e,o.target);n||t.fireEventInstead.fold(()=>gs.close(e),t=>iF(e,t.event))}}}}},gp=rF([ag("fireEventInstead",[ah("event",iO())]),at("doReposition")]),gh=e=>{let t=r1("Reposition",gp,e);return{[gd()]:{onReceive:e=>{gs.isOpen(e)&&t.fireEventInstead.fold(()=>t.doReposition(e),t=>iF(e,t.event))}}}},gf=(e,t,o)=>{t.store.manager.onLoad(e,t,o)},gb=(e,t,o)=>{t.store.manager.onUnload(e,t,o)},gv=(e,t,o,n)=>{t.store.manager.setValue(e,t,o,n)},gy=(e,t,o)=>t.store.manager.getValue(e,t,o);var gx=Object.freeze({__proto__:null,onLoad:gf,onUnload:gb,setValue:gv,getValue:gy,getState:(e,t,o)=>o});let gw=(e,t)=>{let o=e.resetOnDom?[iZ((o,n)=>{gf(o,e,t)}),iQ((o,n)=>{gb(o,e,t)})]:[cY(e,t,gf)];return iL(o)};var gS=Object.freeze({__proto__:null,events:gw});let gk=()=>{let e=aC(null),t=()=>({mode:"memory",value:e.get()}),o=()=>null===e.get(),n=()=>{e.set(null)};return lO({set:e.set,get:e.get,isNotSet:o,clear:n,readState:t})},gC=()=>lO({readState:y}),gO=()=>{let e=aC({}),t=aC({}),o=()=>({mode:"dataset",dataByValue:e.get(),dataByText:t.get()}),n=()=>{e.set({}),t.set({})},r=o=>ek(e.get(),o).orThunk(()=>ek(t.get(),o)),a=o=>{let n=e.get(),r=t.get(),a={},i={};W(o,e=>{a[e.value]=e,ek(e,"meta").each(t=>{ek(t,"text").each(t=>{i[t]=e})})}),e.set({...n,...a}),t.set({...r,...i})};return lO({readState:o,lookup:r,update:a,clear:n})},g_=e=>e.store.manager.state(e);var gT=Object.freeze({__proto__:null,memory:gk,dataset:gO,manual:gC,init:g_});let gE=(e,t,o,n)=>{let r=t.store;o.update([n]),r.setValue(e,n),t.onSetValue(e,n)},gD=(e,t,o)=>{let n=t.store,r=n.getDataKey(e);return o.lookup(r).getOrThunk(()=>n.getFallbackEntry(r))},gA=(e,t,o)=>{let n=t.store;n.initialValue.each(n=>{gE(e,t,o,n)})},gM=(e,t,o)=>{o.clear()};var gB=[ai("initialValue"),r4("getFallbackEntry"),r4("getDataKey"),r4("setValue"),ct("manager",{setValue:gE,getValue:gD,onLoad:gA,onUnload:gM,state:gO})];let gF=(e,t,o)=>t.store.getValue(e),gI=(e,t,o,n)=>{t.store.setValue(e,n),t.onSetValue(e,n)},gR=(e,t,o)=>{t.store.initialValue.each(o=>{t.store.setValue(e,o)})};var gN=[r4("getValue"),ah("setValue",y),ai("initialValue"),ct("manager",{setValue:gI,getValue:gF,onLoad:gR,onUnload:y,state:lC.init})];let gV=(e,t,o,n)=>{o.set(n),t.onSetValue(e,n)},gz=(e,t,o)=>o.get(),gH=(e,t,o)=>{t.store.initialValue.each(e=>{o.isNotSet()&&o.set(e)})},gL=(e,t,o)=>{o.clear()};var gP=[af("store",{mode:"memory"},r3("mode",{memory:[ai("initialValue"),ct("manager",{setValue:gV,getValue:gz,onLoad:gH,onUnload:gL,state:gk})],manual:gN,dataset:gB})),s6("onSetValue"),ah("resetOnDom",!1)];let gU=c5({fields:gP,name:"representing",active:gS,apis:gx,extra:{setValueFrom:(e,t)=>{let o=gU.getValue(t);gU.setValue(e,o)}},state:gT}),gW=(e,t)=>ak(e,{},U(t,t=>ao(t.name(),"Cannot configure "+t.name()+" for "+e)).concat([n7("dump",C)])),gj=e=>e.dump,gG=(e,t)=>({...c2(t),...e.dump}),g$={field:gW,augment:gG,get:gj},gq="placeholder",gX=a_.generate([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),gK=e=>eC(e,"uiType"),gY=(e,t,o,n)=>e.exists(e=>e!==o.owner)?gX.single(!0,k(o)):ek(n,o.name).fold(()=>{throw Error("Unknown placeholder component: "+o.name+"\nKnown: ["+eu(n)+"]\nNamespace: "+e.getOr("none")+"\nSpec: "+JSON.stringify(o,null,2))},e=>e.replace()),gJ=(e,t,o,n)=>gK(o)&&o.uiType===gq?gY(e,t,o,n):gX.single(!1,k(o)),gZ=(e,t,o,n)=>{let r=gJ(e,t,o,n);return r.fold((r,a)=>{let i=gK(o)?a(t,o.config,o.validated):a(t),l=ek(i,"components").getOr([]),s=Q(l,o=>gZ(e,t,o,n));return[{...i,components:s}]},(e,n)=>{if(!gK(o))return n(t);{let e=n(t,o.config,o.validated),r=o.validated.preprocess.getOr(C);return r(e)}})},gQ=(e,t,o,n)=>Q(o,o=>gZ(e,t,o,n)),g0=(e,t)=>{let o=!1,n=()=>{if(o)throw Error("Trying to use the same placeholder more than once: "+e);return o=!0,t},r=()=>t.fold((e,t)=>e,(e,t)=>e);return{name:k(e),required:r,used:()=>o,replace:n}},g1=(e,t,o,n)=>{let r=ep(n,(e,t)=>g0(t,e)),a=gQ(e,t,o,r);return eg(r,o=>{if(!1===o.used()&&o.required())throw Error("Placeholder: "+o.name()+" was not found in components list\nNamespace: "+e.getOr("none")+"\nComponents: "+JSON.stringify(t.components,null,2))}),a},g2=gX.single,g3=gX.multiple,g5=k(gq),g9=a_.generate([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),g4=ah("factory",{sketch:C}),g6=ah("schema",[]),g8=r4("name"),g7=n8("pname","pname",ri(e=>"<alloy."+lr(e.name)+">"),rL()),pe=n7("schema",()=>[ai("preprocess")]),pt=ah("defaults",k({})),po=ah("overrides",k({})),pn=rI([g4,g6,g8,g7,pt,po]),pr=rI([g4,g6,g8,pt,po]),pa=rI([g4,g6,g8,g7,pt,po]),pi=rI([g4,pe,g8,r4("unit"),g7,pt,po]),pl=e=>e.fold(B.some,B.none,B.some,B.some),ps=e=>{let t=e=>e.name;return e.fold(t,t,t,t)},pc=e=>e.fold(C,C,C,C),pd=(e,t)=>o=>{let n=r1("Converting part type",t,o);return e(n)},pu=pd(g9.required,pn),pm=pd(g9.external,pr),pg=pd(g9.optional,pa),pp=pd(g9.group,pi),ph=k("entirety");var pf=Object.freeze({__proto__:null,required:pu,external:pm,optional:pg,group:pp,asNamedPart:pl,name:ps,asCommon:pc,original:ph});let pb=(e,t,o,n)=>rn(t.defaults(e,o,n),o,{uid:e.partUids[t.name]},t.overrides(e,o,n)),pv=(e,t,o)=>{let n={},r={};return W(o,e=>{e.fold(e=>{n[e.pname]=g2(!0,(t,o,n)=>e.factory.sketch(pb(t,e,o,n)))},e=>{let o=t.parts[e.name];r[e.name]=k(e.factory.sketch(pb(t,e,o[ph()]),o))},e=>{n[e.pname]=g2(!1,(t,o,n)=>e.factory.sketch(pb(t,e,o,n)))},e=>{n[e.pname]=g3(!0,(t,o,n)=>{let r=t[e.name];return U(r,o=>e.factory.sketch(rn(e.defaults(t,o,n),o,e.overrides(t,o))))})})}),{internals:k(n),externals:k(r)}},py=(e,t)=>{let o={};return W(t,t=>{pl(t).each(t=>{let n=px(e,t.pname);o[t.name]=o=>{let r=r1("Part: "+t.name+" in "+e,rI(t.schema),o);return{...n,config:o,validated:r}}})}),o},px=(e,t)=>({uiType:g5(),owner:e,name:t}),pw=(e,t,o)=>({uiType:g5(),owner:e,name:t,config:o,validated:{}}),pS=e=>Q(e,e=>e.fold(B.none,B.some,B.none,B.none).map(e=>an(e.name,e.schema.concat([co(ph())]))).toArray()),pk=e=>U(e,ps),pC=(e,t,o)=>pv(e,t,o),pO=(e,t,o)=>g1(B.some(e),t,t.components,o),p_=(e,t,o)=>{let n=t.partUids[o];return e.getSystem().getByUid(n).toOptional()},pT=(e,t,o)=>p_(e,t,o).getOrDie("Could not find part: "+o),pE=(e,t,o)=>{let n={},r=t.partUids,a=e.getSystem();return W(o,e=>{n[e]=k(a.getByUid(r[e]))}),n},pD=(e,t)=>{let o=e.getSystem();return ep(t.partUids,(e,t)=>k(o.getByUid(e)))},pA=e=>eu(e.partUids),pM=(e,t,o)=>{let n={},r=t.partUids,a=e.getSystem();return W(o,e=>{n[e]=k(a.getByUid(r[e]).getOrDie())}),n},pB=(e,t)=>{let o=pk(t);return aF(U(o,t=>({key:t,value:e+"-"+t})))},pF=e=>n8("partUids","partUids",rc(t=>pB(t.uid,e)),rL());var pI=Object.freeze({__proto__:null,generate:py,generateOne:pw,schemas:pS,names:pk,substitutes:pC,components:pO,defaultUids:pB,defaultUidsSchema:pF,getAllParts:pD,getAllPartNames:pA,getPart:p_,getPartOrDie:pT,getParts:pE,getPartsOrDie:pM});let pR=(e,t)=>{let o=e.length>0?[an("parts",e)]:[];return o.concat([r4("uid"),ah("dom",{}),ah("components",[]),co("originalSpec"),ah("debug.sketcher",{})]).concat(t)},pN=(e,t,o,n,r)=>{let a=pR(n,r);return r1(e+" [SpecSchema]",rF(a.concat(t)),o)},pV=(e,t,o,n)=>{let r=pL(n),a=pN(e,t,r,[],[]);return o(a,r)},pz=(e,t,o,n,r)=>{let a=pL(r),i=pS(o),l=pF(o),s=pN(e,t,a,i,[l]),c=pC(e,s,o),d=pO(e,s,c.internals());return n(s,d,a,c.externals())},pH=e=>eC(e,"uid"),pL=e=>pH(e)?e:{...e,uid:lm("uid")},pP=e=>void 0!==e.uid,pU=rF([r4("name"),r4("factory"),r4("configFields"),ah("apis",{}),ah("extraApis",{})]),pW=rF([r4("name"),r4("factory"),r4("configFields"),r4("partFields"),ah("apis",{}),ah("extraApis",{})]),pj=e=>{let t=r1("Sketcher for "+e.name,pU,e),o=e=>pV(t.name,t.configFields,t.factory,e),n=ep(t.apis,lk),r=ep(t.extraApis,(e,t)=>lb(e,t));return{name:t.name,configFields:t.configFields,sketch:o,...n,...r}},pG=e=>{let t=r1("Sketcher for "+e.name,pW,e),o=e=>pz(t.name,t.configFields,t.partFields,t.factory,e),n=py(t.name,t.partFields),r=ep(t.apis,lk),a=ep(t.extraApis,(e,t)=>lb(e,t));return{name:t.name,partFields:t.partFields,configFields:t.configFields,sketch:o,parts:n,...r,...a}},p$=e=>tr("input")(e)&&"radio"!==tP(e,"type")||tr("textarea")(e),pq=(e,t,o)=>t.find(e);var pX=Object.freeze({__proto__:null,getCurrent:pq});let pK=[r4("find")],pY=c5({fields:pK,name:"composing",apis:pX}),pJ=["input","button","textarea","select"],pZ=(e,t,o)=>{let n=t.disabled()?p4:p6;n(e,t)},pQ=(e,t)=>!0===t.useNative&&z(pJ,e4(e.element)),p0=e=>tW(e.element,"disabled"),p1=e=>{tH(e.element,"disabled","disabled")},p2=e=>{tj(e.element,"disabled")},p3=e=>"true"===tP(e.element,"aria-disabled"),p5=e=>{tH(e.element,"aria-disabled","true")},p9=e=>{tH(e.element,"aria-disabled","false")},p4=(e,t,o)=>{t.disableClass.each(t=>{l9(e.element,t)});let n=pQ(e,t)?p1:p5;n(e),t.onDisabled(e)},p6=(e,t,o)=>{t.disableClass.each(t=>{l6(e.element,t)});let n=pQ(e,t)?p2:p9;n(e),t.onEnabled(e)},p8=(e,t)=>pQ(e,t)?p0(e):p3(e),p7=(e,t,o,n)=>{(n?p4:p6)(e,t)};var he=Object.freeze({__proto__:null,enable:p6,disable:p4,isDisabled:p8,onLoad:pZ,set:p7});let ht=(e,t)=>lA({classes:t.disabled()?t.disableClass.toArray():[]}),ho=(e,t)=>iL([iP(id(),(t,o)=>p8(t,e)),cY(e,t,pZ)]);var hn=Object.freeze({__proto__:null,exhibit:ht,events:ho}),hr=[aw("disabled",A),ah("useNative",!0),ai("disableClass"),s6("onDisabled"),s6("onEnabled")];let ha=c5({fields:hr,name:"disabling",active:hn,apis:he}),hi=(e,t,o,n)=>{let r=u1(e.element,"."+t.highlightClass);W(r,o=>{let r=H(n,e=>tc(e.element,o));r||(l6(o,t.highlightClass),e.getSystem().getByDom(o).each(o=>{t.onDehighlight(e,o),iF(o,iB())}))})},hl=(e,t,o)=>hi(e,t,o,[]),hs=(e,t,o,n)=>{hp(e,t,o,n)&&(l6(n.element,t.highlightClass),t.onDehighlight(e,n),iF(n,iB()))},hc=(e,t,o,n)=>{hi(e,t,o,[n]),hp(e,t,o,n)||(l9(n.element,t.highlightClass),t.onHighlight(e,n),iF(n,iM()))},hd=(e,t,o)=>{hb(e,t).each(n=>{hc(e,t,o,n)})},hu=(e,t,o)=>{hv(e,t).each(n=>{hc(e,t,o,n)})},hm=(e,t,o,n)=>{hf(e,t,o,n).fold(e=>{throw e},n=>{hc(e,t,o,n)})},hg=(e,t,o,n)=>{let r=hS(e,t),a=Y(r,n);a.each(n=>{hc(e,t,o,n)})},hp=(e,t,o,n)=>l8(n.element,t.highlightClass),hh=(e,t,o)=>sH(e.element,"."+t.highlightClass).bind(t=>e.getSystem().getByDom(t).toOptional()),hf=(e,t,o,n)=>{let r=u1(e.element,"."+t.itemClass);return B.from(r[n]).fold(()=>nY.error(Error("No element found with index "+n)),e.getSystem().getByDom)},hb=(e,t,o)=>sH(e.element,"."+t.itemClass).bind(t=>e.getSystem().getByDom(t).toOptional()),hv=(e,t,o)=>{let n=u1(e.element,"."+t.itemClass),r=n.length>0?B.some(n[n.length-1]):B.none();return r.bind(t=>e.getSystem().getByDom(t).toOptional())},hy=(e,t,o,n)=>{let r=u1(e.element,"."+t.itemClass),a=J(r,e=>l8(e,t.highlightClass));return a.bind(t=>{let o=cb(t,n,0,r.length-1);return e.getSystem().getByDom(r[o]).toOptional()})},hx=(e,t,o)=>hy(e,t,o,-1),hw=(e,t,o)=>hy(e,t,o,1),hS=(e,t,o)=>{let n=u1(e.element,"."+t.itemClass);return eE(U(n,t=>e.getSystem().getByDom(t).toOptional()))};var hk=Object.freeze({__proto__:null,dehighlightAll:hl,dehighlight:hs,highlight:hc,highlightFirst:hd,highlightLast:hu,highlightAt:hm,highlightBy:hg,isHighlighted:hp,getHighlighted:hh,getFirst:hb,getLast:hv,getPrevious:hx,getNext:hw,getCandidates:hS}),hC=[r4("highlightClass"),r4("itemClass"),s6("onHighlight"),s6("onDehighlight")];let hO=c5({fields:hC,name:"highlighting",apis:hk}),h_=[9],hT=[13],hE=[27],hD=[32],hA=[37],hM=[38],hB=[39],hF=[40],hI=(e,t,o)=>{let n=et(e.slice(0,t)),r=et(e.slice(t+1));return Y(n.concat(r),o)},hR=(e,t,o)=>{let n=et(e.slice(0,t));return Y(n,o)},hN=(e,t,o)=>{let n=e.slice(0,t),r=e.slice(t+1);return Y(r.concat(n),o)},hV=(e,t,o)=>{let n=e.slice(t+1);return Y(n,o)},hz=e=>t=>{let o=t.raw;return z(e,o.which)},hH=e=>t=>ee(e,e=>e(t)),hL=e=>{let t=e.raw;return!0===t.shiftKey},hP=e=>{let t=e.raw;return!0===t.ctrlKey},hU=T(hL),hW=(e,t)=>({matches:e,classification:t}),hj=(e,t)=>{let o=Y(e,e=>e.matches(t));return o.map(e=>e.classification)},hG=(e,t,o)=>{let n=t.exists(e=>o.exists(t=>tc(t,e)));n||iI(e,i_(),{prevFocus:t,newFocus:o})},h$=()=>{let e=e=>di(e.element),t=(t,o)=>{let n=e(t);t.getSystem().triggerFocus(o,t.element);let r=e(t);hG(t,n,r)};return{get:e,set:t}},hq=()=>{let e=e=>hO.getHighlighted(e).map(e=>e.element),t=(t,o)=>{let n=e(t);t.getSystem().getByDom(o).fold(y,e=>{hO.highlight(t,e)});let r=e(t);hG(t,n,r)};return{get:e,set:t}};(nf=nE||(nE={})).OnFocusMode="onFocus",nf.OnEnterOrSpaceMode="onEnterOrSpace",nf.OnApiMode="onApi";let hX=(e,t,o,n,r)=>{let a=()=>e.concat([ah("focusManager",h$()),af("focusInside","onFocus",rY(e=>z(["onFocus","onEnterOrSpace","onApi"],e)?nY.value(e):nY.error("Invalid value for focusInside"))),ct("handler",s),ct("state",t),ct("sendFocusIn",r)]),i=(e,t,o,n,r)=>{let a=o(e,t,n,r);return hj(a,t.event).bind(o=>o(e,t,n,r))},l=(e,t)=>{let a=e.focusInside!==nE.OnFocusMode?B.none():r(e).map(o=>iW(ii(),(n,r)=>{o(n,e,t),r.stop()})),l=(o,n)=>{let a=hz(hD.concat(hT))(n.event);e.focusInside===nE.OnEnterOrSpaceMode&&a&&aL(o,n)&&r(e).each(r=>{r(o,e,t),n.stop()})},s=[iW(a5(),(n,r)=>{i(n,r,o,e,t).fold(()=>{l(n,r)},e=>{r.stop()})}),iW(a9(),(o,r)=>{i(o,r,n,e,t).each(e=>{r.stop()})})];return iL(a.toArray().concat(s))},s={schema:a,processKey:i,toEvents:l};return s},hK=e=>{let t=[ai("onEscape"),ai("onEnter"),ah("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),ah("firstTabstop",0),ah("useTabstopAt",M),ai("visibilitySelector")].concat([e]),o=(e,t)=>{let o=e.visibilitySelector.bind(e=>sL(t,e)).getOr(t);return t4(o)>0},n=(e,t)=>{let n=u1(e.element,t.selector),r=$(n,e=>o(t,e));return B.from(r[t.firstTabstop])},r=(e,t)=>t.focusManager.get(e).bind(e=>sL(e,t.selector)),a=(e,t)=>o(e,t)&&e.useTabstopAt(t),i=(e,t,o)=>{n(e,t).each(o=>{t.focusManager.set(e,o)})},l=(e,t,o,n,r)=>r(t,o,e=>a(n,e)).fold(()=>n.cyclic?B.some(!0):B.none(),t=>(n.focusManager.set(e,t),B.some(!0))),s=(e,t,o,n)=>{let a=u1(e.element,o.selector);return r(e,o).bind(t=>{let r=J(a,_(tc,t));return r.bind(t=>l(e,a,t,o,n))})},c=(e,t,o)=>{let n=o.cyclic?hI:hR;return s(e,t,o,n)},d=(e,t,o)=>{let n=o.cyclic?hN:hV;return s(e,t,o,n)},u=(e,t,o)=>o.onEnter.bind(o=>o(e,t)),m=(e,t,o)=>o.onEscape.bind(o=>o(e,t)),g=k([hW(hH([hL,hz(h_)]),c),hW(hz(h_),d),hW(hH([hU,hz(hT)]),u)]),p=k([hW(hz(hE),m)]);return hX(t,lC.init,g,p,()=>B.some(i))};var hY=hK(n7("cyclic",A)),hJ=hK(n7("cyclic",M));let hZ=(e,t,o)=>(iN(e,o,id()),B.some(!0)),hQ=(e,t,o)=>{let n=p$(o)&&hz(hD)(t.event);return n?B.none():hZ(e,t,o)},h0=(e,t)=>B.some(!0),h1=[ah("execute",hQ),ah("useSpace",!1),ah("useEnter",!0),ah("useControlEnter",!1),ah("useDown",!1)],h2=(e,t,o)=>o.execute(e,t,e.element),h3=(e,t,o,n)=>{let r=o.useSpace&&!p$(e.element)?hD:[],a=o.useEnter?hT:[],i=o.useDown?hF:[],l=r.concat(a).concat(i);return[hW(hz(l),h2)].concat(o.useControlEnter?[hW(hH([hP,hz(hT)]),h2)]:[])},h5=(e,t,o,n)=>o.useSpace&&!p$(e.element)?[hW(hz(hD),h0)]:[];var h9=hX(h1,lC.init,h3,h5,()=>B.none());let h4=()=>{let e=dR(),t=(t,o)=>{e.set({numRows:t,numColumns:o})},o=()=>e.get().map(e=>e.numRows),n=()=>e.get().map(e=>e.numColumns);return lO({readState:()=>e.get().map(e=>({numRows:String(e.numRows),numColumns:String(e.numColumns)})).getOr({numRows:"?",numColumns:"?"}),setGridSize:t,getNumRows:o,getNumColumns:n})},h6=e=>e.state(e);var h8=Object.freeze({__proto__:null,flatgrid:h4,init:h6});let h7=e=>(t,o,n,r)=>{let a=e(t.element);return fn(a,t,o,n,r)},fe=(e,t)=>{let o=d7(e,t);return h7(o)},ft=(e,t)=>{let o=d7(t,e);return h7(o)},fo=e=>(t,o,n,r)=>fn(e,t,o,n,r),fn=(e,t,o,n,r)=>{let a=n.focusManager.get(t).bind(o=>e(t.element,o,n,r));return a.map(e=>(n.focusManager.set(t,e),!0))},fr=e=>e.offsetWidth<=0&&e.offsetHeight<=0,fa=e=>!fr(e.dom),fi=(e,t)=>J(e,t).map(t=>({index:t,candidates:e})),fl=(e,t,o)=>{let n=e=>tc(e,t),r=u1(e,o),a=$(r,fa);return fi(a,n)},fs=(e,t)=>J(e,e=>tc(t,e)),fc=(e,t,o,n)=>n(Math.floor(t/o),t%o).bind(t=>{let n=t.row*o+t.column;return n>=0&&n<e.length?B.some(e[n]):B.none()}),fd=(e,t,o,n,r)=>fc(e,t,n,(t,a)=>{let i=t===o-1?e.length-t*n:n,l=cb(a,r,0,i-1);return B.some({row:t,column:l})}),fu=(e,t,o,n,r)=>fc(e,t,n,(t,a)=>{let i=cb(t,r,0,o-1),l=i===o-1?e.length-i*n:n,s=cv(a,0,l-1);return B.some({row:i,column:s})}),fm=(e,t,o,n)=>fd(e,t,o,n,1),fg=(e,t,o,n)=>fd(e,t,o,n,-1),fp=(e,t,o,n)=>fu(e,t,o,n,-1),fh=(e,t,o,n)=>fu(e,t,o,n,1),ff=[r4("selector"),ah("execute",hQ),s8("onEscape"),ah("captureTab",!1),cn()],fb=(e,t,o)=>{sH(e.element,t.selector).each(o=>{t.focusManager.set(e,o)})},fv=(e,t)=>t.focusManager.get(e).bind(e=>sL(e,t.selector)),fy=(e,t,o,n)=>fv(e,o).bind(n=>o.execute(e,t,n)),fx=e=>(t,o,n,r)=>fl(t,o,n.selector).bind(t=>e(t.candidates,t.index,r.getNumRows().getOr(n.initSize.numRows),r.getNumColumns().getOr(n.initSize.numColumns))),fw=(e,t,o)=>o.captureTab?B.some(!0):B.none(),fS=(e,t,o)=>o.onEscape(e,t),fk=fx(fg),fC=fx(fm),fO=fx(fp),f_=fx(fh),fT=k([hW(hz(hA),fe(fk,fC)),hW(hz(hB),ft(fk,fC)),hW(hz(hM),fo(fO)),hW(hz(hF),fo(f_)),hW(hH([hL,hz(h_)]),fw),hW(hH([hU,hz(h_)]),fw),hW(hz(hD.concat(hT)),fy)]),fE=k([hW(hz(hE),fS),hW(hz(hD),h0)]);var fD=hX(ff,h4,fT,fE,()=>B.some(fb));let fA=(e,t,o,n,r)=>{let a=e=>"button"===e4(e)&&"disabled"===tP(e,"disabled"),i=(e,t,o)=>r(e,t,n,0,o.length-1,o[t],t=>a(o[t])?i(e,t,o):B.from(o[t]));return fl(e,o,t).bind(e=>{let t=e.index,o=e.candidates;return i(t,t,o)})},fM=(e,t,o,n)=>fA(e,t,o,n,(e,t,o,n,r,a,i)=>{let l=cv(t+o,n,r);return l===e?B.from(a):i(l)}),fB=(e,t,o,n)=>fA(e,t,o,n,(e,t,o,n,r,a,i)=>{let l=cb(t,o,n,r);return l===e?B.none():i(l)}),fF=[r4("selector"),ah("getInitial",B.none),ah("execute",hQ),s8("onEscape"),ah("executeOnMove",!1),ah("allowVertical",!0),ah("allowHorizontal",!0),ah("cycles",!0)],fI=(e,t)=>t.focusManager.get(e).bind(e=>sL(e,t.selector)),fR=(e,t,o)=>fI(e,o).bind(n=>o.execute(e,t,n)),fN=(e,t,o)=>{t.getInitial(e).orThunk(()=>sH(e.element,t.selector)).each(o=>{t.focusManager.set(e,o)})},fV=(e,t,o)=>(o.cycles?fB:fM)(e,o.selector,t,-1),fz=(e,t,o)=>(o.cycles?fB:fM)(e,o.selector,t,1),fH=e=>(t,o,n,r)=>e(t,o,n,r).bind(()=>n.executeOnMove?fR(t,o,n):B.some(!0)),fL=(e,t,o)=>o.onEscape(e,t),fP=(e,t,o,n)=>{let r=[...o.allowHorizontal?hA:[]].concat(o.allowVertical?hM:[]),a=[...o.allowHorizontal?hB:[]].concat(o.allowVertical?hF:[]);return[hW(hz(r),fH(fe(fV,fz))),hW(hz(a),fH(ft(fV,fz))),hW(hz(hT),fR),hW(hz(hD),fR)]},fU=k([hW(hz(hD),h0),hW(hz(hE),fL)]);var fW=hX(fF,lC.init,fP,fU,()=>B.some(fN));let fj=(e,t,o)=>B.from(e[t]).bind(e=>B.from(e[o]).map(e=>({rowIndex:t,columnIndex:o,cell:e}))),fG=(e,t,o,n)=>{let r=e[t],a=r.length,i=cb(o,n,0,a-1);return fj(e,t,i)},f$=(e,t,o,n)=>{let r=cb(o,n,0,e.length-1),a=e[r].length,i=cv(t,0,a-1);return fj(e,r,i)},fq=(e,t,o,n)=>{let r=e[t],a=r.length,i=cv(o+n,0,a-1);return fj(e,t,i)},fX=(e,t,o,n)=>{let r=cv(o+n,0,e.length-1),a=e[r].length,i=cv(t,0,a-1);return fj(e,r,i)},fK=(e,t,o)=>fG(e,t,o,1),fY=(e,t,o)=>fG(e,t,o,-1),fJ=(e,t,o)=>f$(e,o,t,-1),fZ=(e,t,o)=>f$(e,o,t,1),fQ=(e,t,o)=>fq(e,t,o,-1),f0=(e,t,o)=>fq(e,t,o,1),f1=(e,t,o)=>fX(e,o,t,-1),f2=(e,t,o)=>fX(e,o,t,1),f3=[an("selectors",[r4("row"),r4("cell")]),ah("cycles",!0),ah("previousSelector",B.none),ah("execute",hQ)],f5=(e,t,o)=>{let n=t.previousSelector(e).orThunk(()=>{let o=t.selectors;return sH(e.element,o.cell)});n.each(o=>{t.focusManager.set(e,o)})},f9=(e,t,o)=>di(e.element).bind(n=>o.execute(e,t,n)),f4=(e,t)=>U(e,e=>u1(e,t.selectors.cell)),f6=(e,t)=>(o,n,r)=>{let a=r.cycles?e:t;return sL(n,r.selectors.row).bind(e=>{let t=u1(e,r.selectors.cell);return fs(t,n).bind(t=>{let n=u1(o,r.selectors.row);return fs(n,e).bind(e=>{let o=f4(n,r);return a(o,e,t).map(e=>e.cell)})})})},f8=f6(fY,fQ),f7=f6(fK,f0),be=f6(fJ,f1),bt=f6(fZ,f2),bo=k([hW(hz(hA),fe(f8,f7)),hW(hz(hB),ft(f8,f7)),hW(hz(hM),fo(be)),hW(hz(hF),fo(bt)),hW(hz(hD.concat(hT)),f9)]),bn=k([hW(hz(hD),h0)]);var br=hX(f3,lC.init,bo,bn,()=>B.some(f5));let ba=[r4("selector"),ah("execute",hQ),ah("moveOnTab",!1)],bi=(e,t,o)=>o.focusManager.get(e).bind(n=>o.execute(e,t,n)),bl=(e,t,o)=>{sH(e.element,t.selector).each(o=>{t.focusManager.set(e,o)})},bs=(e,t,o)=>fB(e,o.selector,t,-1),bc=(e,t,o)=>fB(e,o.selector,t,1),bd=(e,t,o,n)=>o.moveOnTab?fo(bs)(e,t,o,n):B.none(),bu=(e,t,o,n)=>o.moveOnTab?fo(bc)(e,t,o,n):B.none(),bm=k([hW(hz(hM),fo(bs)),hW(hz(hF),fo(bc)),hW(hH([hL,hz(h_)]),bd),hW(hH([hU,hz(h_)]),bu),hW(hz(hT),bi),hW(hz(hD),bi)]),bg=k([hW(hz(hD),h0)]);var bp=hX(ba,lC.init,bm,bg,()=>B.some(bl));let bh=[s8("onSpace"),s8("onEnter"),s8("onShiftEnter"),s8("onLeft"),s8("onRight"),s8("onTab"),s8("onShiftTab"),s8("onUp"),s8("onDown"),s8("onEscape"),ah("stopSpaceKeyup",!1),ai("focusIn")],bf=(e,t,o)=>[hW(hz(hD),o.onSpace),hW(hH([hU,hz(hT)]),o.onEnter),hW(hH([hL,hz(hT)]),o.onShiftEnter),hW(hH([hL,hz(h_)]),o.onShiftTab),hW(hH([hU,hz(h_)]),o.onTab),hW(hz(hM),o.onUp),hW(hz(hF),o.onDown),hW(hz(hA),o.onLeft),hW(hz(hB),o.onRight),hW(hz(hD),o.onSpace)],bb=(e,t,o)=>[...o.stopSpaceKeyup?[hW(hz(hD),h0)]:[],hW(hz(hE),o.onEscape)];var bv=hX(bh,lC.init,bf,bb,e=>e.focusIn);let by=hY.schema(),bx=hJ.schema(),bw=fW.schema(),bS=fD.schema(),bk=br.schema(),bC=h9.schema(),bO=bp.schema(),b_=bv.schema();var bT=Object.freeze({__proto__:null,acyclic:by,cyclic:bx,flow:bw,flatgrid:bS,matrix:bk,execution:bC,menu:bO,special:b_});let bE=e=>eO(e,"setGridSize"),bD=c4({branchKey:"mode",branches:bT,name:"keying",active:{events:(e,t)=>{let o=e.handler;return o.toEvents(e,t)}},apis:{focusIn:(e,t,o)=>{t.sendFocusIn(t).fold(()=>{e.getSystem().triggerFocus(e.element,e.element)},n=>{n(e,t,o)})},setGridSize:(e,t,o,n,r)=>{bE(o)?o.setGridSize(n,r):console.error("Layout does not support setGridSize")}},state:h8}),bA=(e,t)=>{dl(()=>{mU(e,t,()=>U(t,e.getSystem().build))},e.element)},bM=(e,t)=>{dl(()=>{mW(e,t,()=>sd(e.element,t,e.getSystem().buildOrPatch))},e.element)},bB=(e,t,o,n)=>{mH(t);let r=sc(e.element,o,n,e.getSystem().buildOrPatch);mz(e,r),e.syncComponents()},bF=(e,t,o)=>{let n=e.getSystem().build(o);mG(e,n,t)},bI=(e,t,o,n)=>{mq(t),bF(e,(e,t)=>o4(e,t,o),n)},bR=(e,t,o,n)=>{let r=t.reuseDom?bM:bA;return r(e,n)},bN=(e,t,o,n)=>{bF(e,o9,n)},bV=(e,t,o,n)=>{bF(e,o5,n)},bz=(e,t,o,n)=>{let r=bH(e),a=Y(r,e=>tc(n.element,e.element));a.each(mq)},bH=(e,t)=>e.components(),bL=(e,t,o,n,r)=>{let a=bH(e);return B.from(a[n]).map(o=>(r.fold(()=>mq(o),r=>{let a=t.reuseDom?bB:bI;a(e,o,n,r)}),o))},bP=(e,t,o,n,r)=>{let a=bH(e);return J(a,n).bind(n=>bL(e,t,o,n,r))};var bU=Object.freeze({__proto__:null,append:bN,prepend:bV,remove:bz,replaceAt:bL,replaceBy:bP,set:bR,contents:bH});let bW=c5({fields:[ax("reuseDom",!0)],name:"replacing",apis:bU}),bj=(e,t)=>{let o=iL(t);return c5({fields:[r4("enabled")],name:e,active:{events:k(o)}})},bG=(e,t)=>{let o=bj(e,t);return{key:e,value:{config:{},me:o,configAsRaw:k({}),initialConfig:{},state:lC}}},b$=(e,t)=>{t.ignore||(dt(e.element),t.onFocus(e))},bq=(e,t)=>{t.ignore||dn(e.element)},bX=e=>dr(e.element);var bK=Object.freeze({__proto__:null,focus:b$,blur:bq,isFocused:bX});let bY=(e,t)=>{let o=t.ignore?{}:{attributes:{tabindex:"-1"}};return lA(o)},bJ=e=>iL([iW(ii(),(t,o)=>{b$(t,e),o.stop()})].concat(e.stopMousedown?[iW(aJ(),(e,t)=>{t.event.prevent()})]:[]));var bZ=Object.freeze({__proto__:null,exhibit:bY,events:bJ}),bQ=[s6("onFocus"),ah("stopMousedown",!1),ah("ignore",!1)];let b0=c5({fields:bQ,name:"focusing",active:bZ,apis:bK}),b1=(e,t,o)=>{let n=t.aria;n.update(e,n,o.get())},b2=(e,t,o)=>{t.toggleClass.each(t=>{o.get()?l9(e.element,t):l6(e.element,t)})},b3=(e,t,o,n)=>{let r=o.get();o.set(n),b2(e,t,o),b1(e,t,o),r!==n&&t.onToggled(e,n)},b5=(e,t,o)=>{b3(e,t,o,!o.get())},b9=(e,t,o)=>{b3(e,t,o,!0)},b4=(e,t,o)=>{b3(e,t,o,!1)},b6=(e,t,o)=>o.get(),b8=(e,t,o)=>{b3(e,t,o,t.selected)};var b7=Object.freeze({__proto__:null,onLoad:b8,toggle:b5,isOn:b6,on:b9,off:b4,set:b3});let ve=()=>lA({}),vt=(e,t)=>{let o=cK(e,t,b5),n=cY(e,t,b8);return iL(Z([e.toggleOnExecute?[o]:[],[n]]))};var vo=Object.freeze({__proto__:null,exhibit:ve,events:vt});let vn=(e,t,o)=>{tH(e.element,"aria-pressed",o),t.syncWithExpanded&&vi(e,t,o)},vr=(e,t,o)=>{tH(e.element,"aria-selected",o)},va=(e,t,o)=>{tH(e.element,"aria-checked",o)},vi=(e,t,o)=>{tH(e.element,"aria-expanded",o)};var vl=[ah("selected",!1),ai("toggleClass"),ah("toggleOnExecute",!0),s6("onToggled"),af("aria",{mode:"none"},r3("mode",{pressed:[ah("syncWithExpanded",!1),ct("update",vn)],checked:[ct("update",va)],expanded:[ct("update",vi)],selected:[ct("update",vr)],none:[ct("update",y)]}))];let vs=c5({fields:vl,name:"toggling",active:vo,apis:b7,state:(e=>{let t=()=>{let t=aC(e),o=()=>t.get(),n=e=>t.set(e),r=()=>t.set(e),a=()=>t.get();return{get:o,set:n,clear:r,readState:a}};return{init:t}})(!1)}),vc=()=>{let e=(e,t)=>{t.stop(),iR(e)};return[iW(a8(),e),iW(im(),e),iK(aq()),iK(aJ())]},vd=e=>{let t=e=>i1((t,o)=>{e(t),o.stop()});return iL(Z([e.map(t).toArray(),vc()]))},vu="alloy.item-hover",vm="alloy.item-focus",vg="alloy.item-toggled",vp=e=>{(di(e.element).isNone()||b0.isFocused(e))&&(b0.isFocused(e)||b0.focus(e),iI(e,vu,{item:e}))},vh=e=>{iI(e,vm,{item:e})},vf=(e,t)=>{iI(e,vg,{item:e,state:t})},vb=k(vu),vv=k(vm),vy=k(vg),vx=e=>e.toggling.map(e=>e.exclusive?"menuitemradio":"menuitemcheckbox").getOr("menuitem"),vw=e=>({aria:{mode:"checked"},...ey(e,(e,t)=>"exclusive"!==t),onToggled:(t,o)=>{f(e.onToggled)&&e.onToggled(t,o),vf(t,o)}}),vS=e=>({dom:e.dom,domModification:{...e.domModification,attributes:{role:vx(e),...e.domModification.attributes,"aria-haspopup":e.hasSubmenu,...e.hasSubmenu?{"aria-expanded":!1}:{}}},behaviours:g$.augment(e.itemBehaviours,[e.toggling.fold(vs.revoke,e=>vs.config(vw(e))),b0.config({ignore:e.ignoreFocus,stopMousedown:e.ignoreFocus,onFocus:e=>{vh(e)}}),bD.config({mode:"execution"}),gU.config({store:{mode:"memory",initialValue:e.data}}),bG("item-type-events",[...vc(),iW(a1(),vp),iW(iu(),b0.focus)])]),components:e.components,eventOrder:e.eventOrder}),vk=[r4("data"),r4("components"),r4("dom"),ah("hasSubmenu",!1),ai("toggling"),g$.field("itemBehaviours",[vs,b0,bD,gU]),ah("ignoreFocus",!1),ah("domModification",{}),ct("builder",vS),ah("eventOrder",{})],vC=e=>({dom:e.dom,components:e.components,events:iL([iY(iu())])}),vO=[r4("dom"),r4("components"),ct("builder",vC)],v_=k("item-widget"),vT=k([pu({name:"widget",overrides:e=>({behaviours:c2([gU.config({store:{mode:"manual",getValue:t=>e.data,setValue:y}})])})})]),vE=e=>{let t=pC(v_(),e,vT()),o=pO(v_(),e,t.internals()),n=t=>p_(t,e,"widget").map(e=>(bD.focusIn(e),e)),r=(t,o)=>(p$(o.event.target)||e.autofocus&&o.setSource(t.element),B.none());return{dom:e.dom,components:o,domModification:e.domModification,events:iL([i1((e,t)=>{n(e).each(e=>{t.stop()})}),iW(a1(),vp),iW(iu(),(t,o)=>{e.autofocus?n(t):b0.focus(t)})]),behaviours:g$.augment(e.widgetBehaviours,[gU.config({store:{mode:"memory",initialValue:e.data}}),b0.config({ignore:e.ignoreFocus,onFocus:e=>{vh(e)}}),bD.config({mode:"special",focusIn:e.autofocus?e=>{n(e)}:c6(),onLeft:r,onRight:r,onEscape:(t,o)=>b0.isFocused(t)||e.autofocus?(e.autofocus&&o.setSource(t.element),B.none()):(b0.focus(t),B.some(!0))})])}},vD=[r4("uid"),r4("data"),r4("components"),r4("dom"),ah("autofocus",!1),ah("ignoreFocus",!1),g$.field("widgetBehaviours",[gU,b0,bD]),ah("domModification",{}),pF(vT()),ct("builder",vE)],vA=r3("type",{widget:vD,item:vk,separator:vO}),vM=(e,t)=>({mode:"flatgrid",selector:"."+e.markers.item,initSize:{numColumns:t.initSize.numColumns,numRows:t.initSize.numRows},focusManager:e.focusManager}),vB=(e,t)=>({mode:"matrix",selectors:{row:t.rowSelector,cell:"."+e.markers.item},previousSelector:t.previousSelector,focusManager:e.focusManager}),vF=(e,t)=>({mode:"menu",selector:"."+e.markers.item,moveOnTab:t.moveOnTab,focusManager:e.focusManager}),vI=k([pp({factory:{sketch:e=>{let t=r1("menu.spec item",vA,e);return t.builder(t)}},name:"items",unit:"item",defaults:(e,t)=>eC(t,"uid")?t:{...t,uid:lm("item")},overrides:(e,t)=>({type:t.type,ignoreFocus:e.fakeFocus,domModification:{classes:[e.markers.item]}})})]),vR=k([r4("value"),r4("items"),r4("dom"),r4("components"),ah("eventOrder",{}),gW("menuBehaviours",[hO,gU,pY,bD]),af("movement",{mode:"menu",moveOnTab:!0},r3("mode",{grid:[cn(),ct("config",vM)],matrix:[ct("config",vB),r4("rowSelector"),ah("previousSelector",B.none)],menu:[ah("moveOnTab",!0),ct("config",vF)]})),r6("markers",s2()),ah("fakeFocus",!1),ah("focusManager",h$()),s6("onHighlight"),s6("onDehighlight")]),vN=k("alloy.menu-focus"),vV=(e,t)=>{let o=u1(e.element,'[role="menuitemradio"][aria-checked="true"]');W(o,o=>{tc(o,t.element)||e.getSystem().getByDom(o).each(e=>{vs.off(e)})})},vz=(e,t,o,n)=>({uid:e.uid,dom:e.dom,markers:e.markers,behaviours:gG(e.menuBehaviours,[hO.config({highlightClass:e.markers.selectedItem,itemClass:e.markers.item,onHighlight:e.onHighlight,onDehighlight:e.onDehighlight}),gU.config({store:{mode:"memory",initialValue:e.value}}),pY.config({find:B.some}),bD.config(e.movement.config(e,e.movement))]),events:iL([iW(vv(),(e,t)=>{let o=t.event;e.getSystem().getByDom(o.target).each(o=>{hO.highlight(e,o),t.stop(),iI(e,vN(),{menu:e,item:o})})}),iW(vb(),(e,t)=>{let o=t.event.item;hO.highlight(e,o)}),iW(vy(),(e,t)=>{let{item:o,state:n}=t.event;n&&"menuitemradio"===tP(o.element,"role")&&vV(e,o)})]),components:t,eventOrder:e.eventOrder,domModification:{attributes:{role:"menu"}}}),vH=pG({name:"Menu",configFields:vR(),partFields:vI(),factory:vz}),vL=e=>eh(e,(e,t)=>({k:e,v:t})),vP=(e,t,o,n)=>ek(o,n).bind(n=>ek(e,n).bind(n=>{let r=vP(e,t,o,n);return B.some([n].concat(r))})).getOr([]),vU=(e,t)=>{let o={};eg(e,(e,t)=>{W(e,e=>{o[e]=t})});let n=vL(t),r=ep(n,(e,r)=>[r].concat(vP(o,t,n,r)));return ep(o,e=>ek(r,e).getOr([e]))},vW=()=>{let e=aC({}),t=aC({}),o=aC({}),n=dR(),r=aC({}),a=()=>{e.set({}),t.set({}),o.set({}),n.clear()},i=()=>n.get().isNone(),l=(e,o)=>{t.set({...t.get(),[e]:{type:"prepared",menu:o}})},s=(a,i,l,s)=>{n.set(a),e.set(l),t.set(i),r.set(s);let c=vU(s,l);o.set(c)},c=t=>ew(e.get(),(e,o)=>e===t),d=(e,t,o)=>h(e).bind(n=>c(e).bind(e=>t(e).map(e=>({triggeredMenu:n,triggeringItem:e,triggeringPath:o})))),u=(e,t)=>{let r=$(b(e).toArray(),e=>h(e).isSome());return ek(o.get(),e).bind(e=>{let o=et(r.concat(e)),a=Q(o,(e,r)=>d(e,t,o.slice(0,r+1)).fold(()=>e_(n.get(),e)?[]:[B.none()],e=>[B.some(e)]));return eD(a)})},m=t=>ek(e.get(),t).map(e=>{let n=ek(o.get(),t).getOr([]);return[e].concat(n)}),g=e=>ek(o.get(),e).bind(e=>e.length>1?B.some(e.slice(1)):B.none()),p=e=>ek(o.get(),e),h=e=>f(e).bind(vj),f=e=>ek(t.get(),e),b=t=>ek(e.get(),t),v=e=>{let t=r.get();return eo(eu(t),e)},y=()=>n.get().bind(h),x=()=>t.get();return{setMenuBuilt:l,setContents:s,expand:m,refresh:p,collapse:g,lookupMenu:f,lookupItem:b,otherMenus:v,getPrimary:y,getMenus:x,clear:a,isClear:i,getTriggeringPath:u}},vj=e=>"prepared"===e.type?B.some(e.menu):B.none(),vG={init:vW,extractPreparedMenu:vj},v$=lr("tiered-menu-item-highlight"),vq=lr("tiered-menu-item-dehighlight");(nb=nD||(nD={}))[nb.HighlightMenuAndItem=0]="HighlightMenuAndItem",nb[nb.HighlightJustMenu=1]="HighlightJustMenu",nb[nb.HighlightNone=2]="HighlightNone";let vX=(e,t)=>{var o;let n;let r=dR(),a=(t,o,n)=>ep(n,(n,r)=>{let a=()=>vH.sketch({...n,value:r,markers:e.markers,fakeFocus:e.fakeFocus,onHighlight:(e,t)=>{iI(e,v$,{menuComp:e,itemComp:t})},onDehighlight:(e,t)=>{iI(e,vq,{menuComp:e,itemComp:t})},focusManager:e.fakeFocus?hq():h$()});return r===o?{type:"prepared",menu:t.getSystem().build(a())}:{type:"notbuilt",nbMenu:a}}),i=vG.init(),l=t=>{let o=a(t,e.data.primary,e.data.menus),n=d();return i.setContents(e.data.primary,o,e.data.expansions,n),i.getPrimary()},s=e=>gU.getValue(e).value,c=(e,t,o)=>ed(t,e=>{if(!e.getSystem().isConnected())return B.none();let t=hO.getCandidates(e);return Y(t,e=>s(e)===o)}),d=t=>ep(e.data.menus,(e,t)=>Q(e.items,e=>"separator"===e.type?[]:[e.data.value])),u=hO.highlight,m=(t,o)=>{u(t,o),hO.getHighlighted(o).orThunk(()=>hO.getFirst(o)).each(n=>{e.fakeFocus?hO.highlight(o,n):iN(t,n.element,iu())})},g=(e,t)=>eE(U(t,t=>e.lookupMenu(t).bind(e=>"prepared"===e.type?B.some(e.menu):B.none()))),p=(t,o,n)=>{let r=g(o,o.otherMenus(n));W(r,o=>{se(o.element,[e.markers.backgroundMenu]),e.stayInDom||bW.remove(t,o)})},h=t=>r.get().getOrThunk(()=>{let o={},n=u1(t.element,`.${e.markers.item}`),a=$(n,e=>"true"===tP(e,"aria-haspopup"));return W(a,e=>{t.getSystem().getByDom(e).each(e=>{let t=s(e);o[t]=e})}),r.set(o),o}),f=(e,t)=>{let o=h(e);eg(o,(e,o)=>{let n=z(t,o);tH(e.element,"aria-expanded",n)})},b=(t,o,n)=>B.from(n[0]).bind(r=>o.lookupMenu(r).bind(r=>{if("notbuilt"===r.type)return B.none();{let a=r.menu,i=g(o,n.slice(1));return W(i,t=>{l9(t.element,e.markers.backgroundMenu)}),tR(a.element)||bW.append(t,lx(a)),se(a.element,[e.markers.backgroundMenu]),m(t,a),p(t,o,n),B.some(a)}}));(o=n||(n={}))[o.HighlightSubmenu=0]="HighlightSubmenu",o[o.HighlightParent=1]="HighlightParent";let v=(e,t,o)=>{if("notbuilt"!==o.type)return o.menu;{let n=e.getSystem().build(o.nbMenu());return i.setMenuBuilt(t,n),n}},x=(t,o,r=n.HighlightSubmenu)=>{if(o.hasConfigured(ha)&&ha.isDisabled(o))return B.some(o);{let a=s(o);return i.expand(a).bind(a=>(f(t,a),B.from(a[0]).bind(l=>i.lookupMenu(l).bind(s=>{let c=v(t,l,s);return(tR(c.element)||bW.append(t,lx(c)),e.onOpenSubmenu(t,o,c,et(a)),r===n.HighlightSubmenu)?(hO.highlightFirst(c),b(t,i,a)):(hO.dehighlightAll(c),B.some(o))}))))}},w=(t,o)=>{let n=s(o);return i.collapse(n).bind(n=>(f(t,n),b(t,i,n).map(n=>(e.onCollapseMenu(t,o,n),n))))},S=(e,t)=>{let o=s(t);return i.refresh(o).bind(t=>(f(e,t),b(e,i,t)))},k=(e,t)=>p$(t.element)?B.none():x(e,t,n.HighlightSubmenu),C=(e,t)=>p$(t.element)?B.none():w(e,t),O=(t,o)=>w(t,o).orThunk(()=>e.onEscape(t,o).map(()=>t)),_=t=>(o,n)=>sL(n.getSource(),`.${e.markers.item}`).bind(e=>o.getSystem().getByDom(e).toOptional().bind(e=>t(o,e).map(M))),T=iL([iW(vN(),(e,t)=>{let o=t.event.item;i.lookupItem(s(o)).each(()=>{let o=t.event.menu;hO.highlight(e,o);let n=s(t.event.item);i.refresh(n).each(t=>p(e,i,t))})}),i1((t,o)=>{let r=o.event.target;t.getSystem().getByDom(r).each(o=>{let r=s(o);0===r.indexOf("collapse-item")&&w(t,o),x(t,o,n.HighlightSubmenu).fold(()=>{e.onExecute(t,o)},y)})}),iZ((t,o)=>{l(t).each(o=>{bW.append(t,lx(o)),e.onOpenMenu(t,o),e.highlightOnOpen===nD.HighlightMenuAndItem?m(t,o):e.highlightOnOpen===nD.HighlightJustMenu&&u(t,o)})}),iW(v$,(t,o)=>{e.onHighlightItem(t,o.event.menuComp,o.event.itemComp)}),iW(vq,(t,o)=>{e.onDehighlightItem(t,o.event.menuComp,o.event.itemComp)}),...e.navigateOnHover?[iW(vb(),(t,o)=>{let r=o.event.item;S(t,r),x(t,r,n.HighlightParent),e.onHover(t,r)})]:[]]),E=e=>hO.getHighlighted(e).bind(hO.getHighlighted),D=e=>{E(e).each(t=>{w(e,t)})},A=e=>{i.getPrimary().each(t=>{m(e,t)})},F=e=>B.from(e.components()[0]).filter(e=>"menu"===tP(e.element,"role")),I=t=>{let o=i.getPrimary().bind(e=>E(t).bind(e=>{let o=s(e),n=eS(i.getMenus()),r=eE(U(n,vG.extractPreparedMenu));return i.getTriggeringPath(o,e=>c(t,r,e))}).map(t=>({primary:e,triggeringPath:t})));o.fold(()=>{F(t).each(o=>{e.onRepositionMenu(t,o,[])})},({primary:o,triggeringPath:n})=>{e.onRepositionMenu(t,o,n)})};return{uid:e.uid,dom:e.dom,markers:e.markers,behaviours:gG(e.tmenuBehaviours,[bD.config({mode:"special",onRight:_(k),onLeft:_(C),onEscape:_(O),focusIn:(e,t)=>{i.getPrimary().each(t=>{iN(e,t.element,iu())})}}),hO.config({highlightClass:e.markers.selectedMenu,itemClass:e.markers.menu}),pY.config({find:e=>hO.getHighlighted(e)}),bW.config({})]),eventOrder:e.eventOrder,apis:{collapseMenu:D,highlightPrimary:A,repositionMenus:I},events:T}},vK=k("collapse-item"),vY=(e,t,o)=>({primary:e,menus:t,expansions:o}),vJ=(e,t)=>({primary:e,menus:aB(e,t),expansions:{}}),vZ=e=>({value:lr(vK()),meta:{text:e}}),vQ=pj({name:"TieredMenu",configFields:[ce("onExecute"),ce("onEscape"),s7("onOpenMenu"),s7("onOpenSubmenu"),s6("onRepositionMenu"),s6("onCollapseMenu"),ah("highlightOnOpen",nD.HighlightMenuAndItem),an("data",[r4("primary"),r4("menus"),r4("expansions")]),ah("fakeFocus",!1),s6("onHighlightItem"),s6("onDehighlightItem"),s6("onHover"),s5(),r4("dom"),ah("navigateOnHover",!0),ah("stayInDom",!1),gW("tmenuBehaviours",[bD,hO,pY,bW]),ah("eventOrder",{})],apis:{collapseMenu:(e,t)=>{e.collapseMenu(t)},highlightPrimary:(e,t)=>{e.highlightPrimary(t)},repositionMenus:(e,t)=>{e.repositionMenus(t)}},factory:vX,extraApis:{tieredData:vY,singleData:vJ,collapseItem:vZ}}),v0=(e,t,o,n,r)=>{let a=()=>e.lazySink(t),i="horizontal"===n.type?{layouts:{onLtr:()=>cW(),onRtl:()=>cj()}}:{},l=e=>2===e.length,s=e=>l(e)?i:{};return vQ.sketch({dom:{tag:"div"},data:n.data,markers:n.menu.markers,highlightOnOpen:n.menu.highlightOnOpen,fakeFocus:n.menu.fakeFocus,onEscape:()=>(gs.close(t),e.onEscape.map(e=>e(t)),B.some(!0)),onExecute:()=>B.some(!0),onOpenMenu:(e,t)=>{mI.positionWithinBounds(a().getOrDie(),t,o,r())},onOpenSubmenu:(e,t,o,n)=>{let r=a().getOrDie();mI.position(r,o,{anchor:{type:"submenu",item:t,...s(n)}})},onRepositionMenu:(e,t,n)=>{let i=a().getOrDie();mI.positionWithinBounds(i,t,o,r()),W(n,e=>{let t=s(e.triggeringPath);mI.position(i,e.triggeredMenu,{anchor:{type:"submenu",item:e.triggeringItem,...t}})})}})},v1=(e,t)=>{let o=(t,o)=>{let n=e.getRelated(t);return n.exists(e=>sG(e,o))},n=(e,t)=>{gs.setContent(e,t)},r=(e,t,o)=>{let n=B.none;a(e,t,o,n)},a=(t,o,n,r)=>{let a=e.lazySink(t).getOrDie();gs.openWhileCloaked(t,o,()=>mI.positionWithinBounds(a,t,n,r())),gU.setValue(t,B.some({mode:"position",config:n,getBounds:r}))},i=(e,t,o)=>{l(e,t,o,B.none)},l=(t,o,n,r)=>{let a=v0(e,t,o,n,r);gs.open(t,a),gU.setValue(t,B.some({mode:"menu",menu:a}))},s=e=>{gs.isOpen(e)&&(gU.setValue(e,B.none()),gs.close(e))},c=e=>gs.getState(e),d=t=>{gs.isOpen(t)&&gU.getValue(t).each(o=>{switch(o.mode){case"menu":gs.getState(t).each(vQ.repositionMenus);break;case"position":let n=e.lazySink(t).getOrDie();mI.positionWithinBounds(n,t,o.config,o.getBounds())}})},u={setContent:n,showAt:r,showWithinBounds:a,showMenuAt:i,showMenuWithinBounds:l,hide:s,getContent:c,reposition:d,isOpen:gs.isOpen};return{uid:e.uid,dom:e.dom,behaviours:gG(e.inlineBehaviours,[gs.config({isPartOf:(e,t,n)=>sG(t,n)||o(e,n),getAttachPoint:t=>e.lazySink(t).getOrDie(),onOpen:t=>{e.onShow(t)},onClose:t=>{e.onHide(t)}}),gU.config({store:{mode:"memory",initialValue:B.none()}}),c8.config({channels:{...gg({isExtraPart:t.isExtraPart,...e.fireDismissalEventInstead.map(e=>({fireEventInstead:{event:e.event}})).getOr({})}),...gh({...e.fireRepositionEventInstead.map(e=>({fireEventInstead:{event:e.event}})).getOr({}),doReposition:d})}})]),eventOrder:e.eventOrder,apis:u}},v2=pj({name:"InlineView",configFields:[r4("lazySink"),s6("onShow"),s6("onHide"),au("onEscape"),gW("inlineBehaviours",[gs,gU,c8]),ag("fireDismissalEventInstead",[ah("event",iC())]),ag("fireRepositionEventInstead",[ah("event",iO())]),ah("getRelated",B.none),ah("isExtraPart",A),ah("eventOrder",B.none)],factory:v1,apis:{showAt:(e,t,o,n)=>{e.showAt(t,o,n)},showWithinBounds:(e,t,o,n,r)=>{e.showWithinBounds(t,o,n,r)},showMenuAt:(e,t,o,n)=>{e.showMenuAt(t,o,n)},showMenuWithinBounds:(e,t,o,n,r)=>{e.showMenuWithinBounds(t,o,n,r)},hide:(e,t)=>{e.hide(t)},isOpen:(e,t)=>e.isOpen(t),getContent:(e,t)=>e.getContent(t),setContent:(e,t,o)=>{e.setContent(t,o)},reposition:(e,t)=>{e.reposition(t)}}});var v3=tinymce.util.Tools.resolve("tinymce.util.Delay");let v5=e=>{let t=vd(e.action),o=e.dom.tag,n=t=>ek(e.dom,"attributes").bind(e=>ek(e,t));return{uid:e.uid,dom:e.dom,components:e.components,events:t,behaviours:g$.augment(e.buttonBehaviours,[b0.config({}),bD.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:(()=>{if("button"===o){let e=n("type").getOr("button"),t=n("role").map(e=>({role:e})).getOr({});return{type:e,...t}}{let t=e.role.getOr(n("role").getOr("button"));return{role:t}}})()},eventOrder:e.eventOrder}},v9=pj({name:"Button",factory:v5,configFields:[ah("uid",void 0),r4("dom"),ah("components",[]),g$.field("buttonBehaviours",[b0,bD]),ai("action"),ai("role"),ah("eventOrder",{})]}),v4=e=>{let t=pP(e)&&eO(e,"uid")?e.uid:lm("memento"),o=e=>e.getSystem().getByUid(t).getOrDie(),n=e=>e.getSystem().getByUid(t).toOptional(),r=()=>({...e,uid:t});return{get:o,getOpt:n,asSpec:r}};var v6=tinymce.util.Tools.resolve("tinymce.util.I18n");let v8={indent:!0,outdent:!0,"table-insert-column-after":!0,"table-insert-column-before":!0,"paste-column-after":!0,"paste-column-before":!0,"unordered-list":!0,"list-bull-circle":!0,"list-bull-default":!0,"list-bull-square":!0},v7="temporary-placeholder",ye=e=>()=>ek(e,v7).getOr("!not found!"),yt=(e,t)=>{let o=e.toLowerCase();if(!v6.isRtl())return o;{let e=ez(o,"-rtl");return eC(t,e)?e:o}},yo=(e,t)=>ek(t,yt(e,t)),yn=(e,t)=>{let o=t();return yo(e,o).getOrThunk(ye(o))},yr=(e,t,o)=>{let n=t();return yo(e,n).or(o).getOrThunk(ye(n))},ya=e=>!!v6.isRtl()&&eC(v8,e),yi=()=>bG("add-focusable",[iZ(e=>{sz(e.element,"svg").each(e=>tH(e,"focusable","false"))})]),yl=(e,t,o,n)=>{var r,a;let i=ya(t)?["tox-icon--flip"]:[],l=ek(o,yt(t,o)).or(n).getOrThunk(ye(o));return{dom:{tag:e.tag,attributes:null!==(r=e.attributes)&&void 0!==r?r:{},classes:e.classes.concat(i),innerHtml:l},behaviours:c2([...null!==(a=e.behaviours)&&void 0!==a?a:[],yi()])}},ys=(e,t,o,n=B.none())=>yl(t,e,o(),n),yc=(e,t,o)=>{let n=o(),r=Y(e,e=>eC(n,yt(e,n)));return yl(t,r.getOr(v7),n,B.none())},yd={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},yu=e=>{let t=v4({dom:{tag:"p",innerHtml:e.translationProvider(e.text)},behaviours:c2([bW.config({})])}),o=e=>({dom:{tag:"div",classes:["tox-bar"],styles:{width:`${e}%`}}}),n=e=>({dom:{tag:"div",classes:["tox-text"],innerHtml:`${e}%`}}),r=v4({dom:{tag:"div",classes:e.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[o(0)]},n(0)],behaviours:c2([bW.config({})])}),a=(e,t)=>{e.getSystem().isConnected()&&r.getOpt(e).each(e=>{bW.set(e,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[o(t)]},n(t)])})},i=(e,o)=>{if(e.getSystem().isConnected()){let n=t.get(e);bW.set(n,[s_(o)])}},l=Z([e.icon.toArray(),e.level.toArray(),e.level.bind(e=>B.from(yd[e])).toArray()]),s=v4(v9.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[ys("close",{tag:"div",classes:["tox-icon"],attributes:{"aria-label":e.translationProvider("Close")}},e.iconProvider)],action:t=>{e.onAction(t)}})),c=yc(l,{tag:"div",classes:["tox-notification__icon"]},e.iconProvider),d={dom:{tag:"div",classes:["tox-notification__body"]},components:[t.asSpec()],behaviours:c2([bW.config({})])};return{uid:e.uid,dom:{tag:"div",attributes:{role:"alert"},classes:e.level.map(e=>["tox-notification","tox-notification--in",`tox-notification--${e}`]).getOr(["tox-notification","tox-notification--in"])},behaviours:c2([b0.config({}),bG("notification-events",[iW(a2(),e=>{s.getOpt(e).each(b0.focus)})])]),components:[c,d].concat(e.progress?[r.asSpec()]:[]).concat(e.closeButton?[s.asSpec()]:[]),apis:{updateProgress:a,updateText:i}}},ym=pj({name:"Notification",factory:yu,configFields:[ai("level"),r4("progress"),ai("icon"),r4("onAction"),r4("text"),r4("iconProvider"),r4("translationProvider"),ax("closeButton",!0)],apis:{updateProgress:(e,t,o)=>{e.updateProgress(t,o)},updateText:(e,t,o)=>{e.updateText(t,o)}}});var yg=(e,t,o)=>{let n=t.backstage.shared,r=()=>{let t=nP(eJ.fromDom(e.getContentAreaContainer())),o=nG(),n=cv(o.x,t.x,t.right),r=cv(o.y,t.y,t.bottom),a=Math.max(t.right,o.right),i=Math.max(t.bottom,o.bottom);return B.some(nL(n,r,a-n,i-r))},a=(t,a)=>{let i=()=>{a(),v2.hide(s)},l=sA(ym.sketch({text:t.text,level:z(["success","error","warning","warn","info"],t.type)?t.type:void 0,progress:!0===t.progressBar,icon:t.icon,closeButton:t.closeButton,onAction:i,iconProvider:n.providers.icons,translationProvider:n.providers.translate})),s=sA(v2.sketch({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:n.getSink,fireDismissalEventInstead:{},...n.header.isPositionedAtTop()?{}:{fireRepositionEventInstead:{}}}));o.add(s),b(t.timeout)&&t.timeout>0&&v3.setEditorTimeout(e,()=>{i()},t.timeout);let c=()=>{let t=lx(l),o={maxHeightFunction:d2()},a=e.notificationManager.getNotifications();if(a[0]===d){let e={...n.anchors.banner(),overrides:o};v2.showWithinBounds(s,t,{anchor:e},r)}else V(a,d).each(e=>{let n=a[e-1].getEl(),i={type:"node",root:tN(),node:B.some(eJ.fromDom(n)),overrides:o,layouts:{onRtl:()=>[cN],onLtr:()=>[cN]}};v2.showWithinBounds(s,t,{anchor:i},r)})},d={close:i,reposition:c,text:e=>{ym.updateText(l,e)},settings:t,getEl:()=>l.element.dom,progressBar:{value:e=>{ym.updateProgress(l,e)}}};return d},i=e=>{e.close()};return{open:a,close:i,getArgs:e=>e.settings}},yp=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),yh=tinymce.util.Tools.resolve("tinymce.EditorManager"),yf=tinymce.util.Tools.resolve("tinymce.Env");(nv=nA||(nA={})).default="wrap",nv.floating="floating",nv.sliding="sliding",nv.scrolling="scrolling",(ny=nM||(nM={})).auto="auto",ny.top="top",ny.bottom="bottom";let yb=e=>t=>t.options.get(e),yv=e=>t=>B.from(e(t)),yy=e=>{let t=yf.deviceType.isPhone(),o=yf.deviceType.isTablet()||t,n=e.options.register,r=e=>l(e)||!1===e,a=e=>l(e)||b(e);n("skin",{processor:e=>l(e)||!1===e,default:"oxide"}),n("skin_url",{processor:"string"}),n("height",{processor:a,default:Math.max(e.getElement().offsetHeight,400)}),n("width",{processor:a,default:yp.DOM.getStyle(e.getElement(),"width")}),n("min_height",{processor:"number",default:100}),n("min_width",{processor:"number"}),n("max_height",{processor:"number"}),n("max_width",{processor:"number"}),n("style_formats",{processor:"object[]"}),n("style_formats_merge",{processor:"boolean",default:!1}),n("style_formats_autohide",{processor:"boolean",default:!1}),n("line_height_formats",{processor:"string",default:"1 1.1 1.2 1.3 1.4 1.5 2"}),n("font_family_formats",{processor:"string",default:"Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats"}),n("font_size_formats",{processor:"string",default:"8pt 10pt 12pt 14pt 18pt 24pt 36pt"}),n("font_size_input_default_unit",{processor:"string",default:"pt"}),n("block_formats",{processor:"string",default:"Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre"}),n("content_langs",{processor:"object[]"}),n("removed_menuitems",{processor:"string",default:""}),n("menubar",{processor:e=>l(e)||m(e),default:!t}),n("menu",{processor:"object",default:{}}),n("toolbar",{processor:e=>m(e)||l(e)||d(e)?{value:e,valid:!0}:{valid:!1,message:"Must be a boolean, string or array."},default:!0}),L(9,e=>{n("toolbar"+(e+1),{processor:"string"})}),n("toolbar_mode",{processor:"string",default:o?"scrolling":"floating"}),n("toolbar_groups",{processor:"object",default:{}}),n("toolbar_location",{processor:"string",default:nM.auto}),n("toolbar_persist",{processor:"boolean",default:!1}),n("toolbar_sticky",{processor:"boolean",default:e.inline}),n("toolbar_sticky_offset",{processor:"number",default:0}),n("fixed_toolbar_container",{processor:"string",default:""}),n("fixed_toolbar_container_target",{processor:"object"}),n("ui_mode",{processor:"string",default:"combined"}),n("file_picker_callback",{processor:"function"}),n("file_picker_validator_handler",{processor:"function"}),n("file_picker_types",{processor:"string"}),n("typeahead_urls",{processor:"boolean",default:!0}),n("anchor_top",{processor:r,default:"#top"}),n("anchor_bottom",{processor:r,default:"#bottom"}),n("draggable_modal",{processor:"boolean",default:!1}),n("statusbar",{processor:"boolean",default:!0}),n("elementpath",{processor:"boolean",default:!0}),n("branding",{processor:"boolean",default:!0}),n("promotion",{processor:"boolean",default:!0}),n("resize",{processor:e=>"both"===e||m(e),default:!yf.deviceType.isTouch()}),n("sidebar_show",{processor:"string"})},yx=yb("readonly"),yw=yb("height"),yS=yb("width"),yk=yv(yb("min_width")),yC=yv(yb("min_height")),yO=yv(yb("max_width")),y_=yv(yb("max_height")),yT=yv(yb("style_formats")),yE=yb("style_formats_merge"),yD=yb("style_formats_autohide"),yA=yb("content_langs"),yM=yb("removed_menuitems"),yB=yb("toolbar_mode"),yF=yb("toolbar_groups"),yI=yb("toolbar_location"),yR=yb("fixed_toolbar_container"),yN=yb("fixed_toolbar_container_target"),yV=yb("toolbar_persist"),yz=yb("toolbar_sticky_offset"),yH=yb("menubar"),yL=yb("toolbar"),yP=yb("file_picker_callback"),yU=yb("file_picker_validator_handler"),yW=yb("font_size_input_default_unit"),yj=yb("file_picker_types"),yG=yb("typeahead_urls"),y$=yb("anchor_top"),yq=yb("anchor_bottom"),yX=yb("draggable_modal"),yK=yb("statusbar"),yY=yb("elementpath"),yJ=yb("branding"),yZ=yb("resize"),yQ=yb("paste_as_text"),y0=yb("sidebar_show"),y1=yb("promotion"),y2=e=>!1===e.options.get("skin"),y3=e=>!1!==e.options.get("menubar"),y5=e=>{let t=e.options.get("skin_url");if(y2(e))return t;if(t)return e.documentBaseURI.toAbsolute(t);{let t=e.options.get("skin");return yh.baseURL+"/skins/ui/"+t}},y9=e=>e.options.get("line_height_formats").split(" "),y4=e=>{let t=yL(e),o=l(t),n=d(t)&&t.length>0;return!y8(e)&&(n||o||!0===t)},y6=e=>{let t=L(9,t=>e.options.get("toolbar"+(t+1))),o=$(t,l);return eF(o.length>0,o)},y8=e=>y6(e).fold(()=>{let t=yL(e);return v(t,l)&&t.length>0},M),y7=e=>yI(e)===nM.bottom,xe=e=>{var t;if(!e.inline)return B.none();let o=null!==(t=yR(e))&&void 0!==t?t:"";if(o.length>0)return sH(tN(),o);let n=yN(e);return h(n)?B.some(eJ.fromDom(n)):B.none()},xt=e=>e.inline&&xe(e).isSome(),xo=e=>{let t=xe(e);return t.getOrThunk(()=>tD(tE(eJ.fromDom(e.getElement()))))},xn=e=>e.inline&&!y3(e)&&!y4(e)&&!y8(e),xr=e=>{let t=e.options.get("toolbar_sticky");return(t||e.inline)&&!xt(e)&&!xn(e)},xa=e=>!xt(e)&&"split"===e.options.get("ui_mode"),xi=e=>{let t=e.options.get("menu");return ep(t,e=>({...e,items:e.items}))};var xl=Object.freeze({__proto__:null,get ToolbarMode(){return nA},get ToolbarLocation(){return nM},register:yy,getSkinUrl:y5,isReadOnly:yx,isSkinDisabled:y2,getHeightOption:yw,getWidthOption:yS,getMinWidthOption:yk,getMinHeightOption:yC,getMaxWidthOption:yO,getMaxHeightOption:y_,getUserStyleFormats:yT,shouldMergeStyleFormats:yE,shouldAutoHideStyleFormats:yD,getLineHeightFormats:y9,getContentLanguages:yA,getRemovedMenuItems:yM,isMenubarEnabled:y3,isMultipleToolbars:y8,isToolbarEnabled:y4,isToolbarPersist:yV,getMultipleToolbarsOption:y6,getUiContainer:xo,useFixedContainer:xt,isSplitUiMode:xa,getToolbarMode:yB,isDraggableModal:yX,isDistractionFree:xn,isStickyToolbar:xr,getStickyToolbarOffset:yz,getToolbarLocation:yI,isToolbarLocationBottom:y7,getToolbarGroups:yF,getMenus:xi,getMenubar:yH,getToolbar:yL,getFilePickerCallback:yP,getFilePickerTypes:yj,useTypeaheadUrls:yG,getAnchorTop:y$,getAnchorBottom:yq,getFilePickerValidatorHandler:yU,getFontSizeInputDefaultUnit:yW,useStatusBar:yK,useElementPath:yY,promotionEnabled:y1,useBranding:yJ,getResize:yZ,getPasteAsText:yQ,getSidebarShow:y0});let xs="[data-mce-autocompleter]",xc=e=>sL(e,xs),xd=e=>sH(e,xs),xu=(e,t)=>{let o=(e,t)=>{iI(e,a5(),{raw:t})},n=()=>e.getMenu().bind(hO.getHighlighted);t.on("keydown",t=>{let r=t.which;e.isActive()&&(e.isMenuOpen()?13===r?(n().each(iR),t.preventDefault()):40===r?(n().fold(()=>{e.getMenu().each(hO.highlightFirst)},e=>{o(e,t)}),t.preventDefault(),t.stopImmediatePropagation()):(37===r||38===r||39===r)&&n().each(e=>{o(e,t),t.preventDefault(),t.stopImmediatePropagation()}):(13===r||38===r||40===r)&&e.cancelIfNecessary())}),t.on("NodeChange",t=>{e.isActive()&&!e.isProcessingAction()&&xc(eJ.fromDom(t.element)).isNone()&&e.cancelIfNecessary()})},xm={setup:xu};(nx=nB||(nB={}))[nx.CLOSE_ON_EXECUTE=0]="CLOSE_ON_EXECUTE",nx[nx.BUBBLE_TO_SANDBOX=1]="BUBBLE_TO_SANDBOX";var xg=nB;let xp="tox-menu-nav__js",xh="tox-collection__item",xf="tox-swatch",xb={normal:xp,color:xf},xv="tox-collection__item--enabled",xy="tox-collection__item-icon",xx="tox-collection__item-label",xw="tox-collection__item-caret",xS="tox-collection__item--active",xk="tox-collection__item-container",xC="tox-collection__item-container--row",xO=e=>ek(xb,e).getOr(xp),x_=e=>"color"===e?"tox-swatches":"tox-menu",xT=e=>({backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:x_(e),tieredMenu:"tox-tiered-menu"}),xE=e=>{let t=xT(e);return{backgroundMenu:t.backgroundMenu,selectedMenu:t.selectedMenu,menu:t.menu,selectedItem:t.selectedItem,item:xO(e)}},xD=(e,t,o)=>{let n=xT(o);return{tag:"div",classes:Z([[n.menu,`tox-menu-${t}-column`],e?[n.hasIcons]:[]])}},xA=[vH.parts.items({})],xM=(e,t,o)=>{let n=xT(o),r={tag:"div",classes:Z([[n.tieredMenu]])};return{dom:r,markers:xE(o)}},xB=k([ai("data"),ah("inputAttributes",{}),ah("inputStyles",{}),ah("tag","input"),ah("inputClasses",[]),s6("onSetValue"),ah("styles",{}),ah("eventOrder",{}),gW("inputBehaviours",[gU,b0]),ah("selectOnFocus",!0)]),xF=e=>c2([b0.config({onFocus:e.selectOnFocus?e=>{let t=e.element,o=sr(t);t.dom.setSelectionRange(0,o.length)}:y})]),xI=e=>({...xF(e),...gG(e.inputBehaviours,[gU.config({store:{mode:"manual",...e.data.map(e=>({initialValue:e})).getOr({}),getValue:e=>sr(e.element),setValue:(e,t)=>{let o=sr(e.element);o!==t&&sa(e.element,t)}},onSetValue:e.onSetValue})])}),xR=e=>({tag:e.tag,attributes:{type:"text",...e.inputAttributes},styles:e.inputStyles,classes:e.inputClasses}),xN=(e,t)=>({uid:e.uid,dom:xR(e),components:[],behaviours:xI(e),eventOrder:e.eventOrder}),xV=pj({name:"Input",configFields:xB(),factory:xN}),xz=lr("refetch-trigger-event"),xH=lr("redirect-menu-item-interaction"),xL="tox-menu__searcher",xP=e=>sH(e.element,`.${xL}`).bind(t=>e.getSystem().getByDom(t).toOptional()),xU=(e,t)=>{gU.setValue(e,t.fetchPattern),e.element.dom.selectionStart=t.selectionStart,e.element.dom.selectionEnd=t.selectionEnd},xW=e=>{let t=gU.getValue(e),o=e.element.dom.selectionStart,n=e.element.dom.selectionEnd;return{fetchPattern:t,selectionStart:o,selectionEnd:n}},xj=(e,t)=>{tU(t.element,"id").each(t=>tH(e.element,"aria-activedescendant",t))},xG=e=>{let t=(e,t)=>(t.cut(),B.none()),o=(e,t)=>{let o={interactionEvent:t.event,eventType:t.event.raw.type};return iI(e,xH,o),B.some(!0)},n="searcher-events";return{dom:{tag:"div",classes:[xh]},components:[xV.sketch({inputClasses:[xL,"tox-textfield"],inputAttributes:{...e.placeholder.map(t=>({placeholder:e.i18n(t)})).getOr({}),type:"search","aria-autocomplete":"list"},inputBehaviours:c2([bG(n,[iW(a4(),e=>{iF(e,xz)}),iW(a5(),(e,t)=>{"Escape"===t.event.raw.key&&t.stop()})]),bD.config({mode:"special",onLeft:t,onRight:t,onSpace:t,onEnter:o,onEscape:o,onUp:o,onDown:o})]),eventOrder:{keydown:[n,bD.name()]}})]}},x$="tox-collection--results__js",xq=e=>{var t;return e.dom?{...e,dom:{...e.dom,attributes:{...null!==(t=e.dom.attributes)&&void 0!==t?t:{},id:lr("aria-item-search-result-id"),"aria-selected":"false"}}}:e},xX=(e,t)=>o=>{let n=P(o,t);return U(n,t=>({dom:e,components:t}))},xK=e=>({dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[vH.parts.items({preprocess:"auto"!==e?xX({tag:"div",classes:["tox-swatches__row"]},e):C})]}]}),xY=e=>({dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[vH.parts.items({preprocess:xX({tag:"div",classes:["tox-collection__group"]},e)})]}),xJ=(e,t)=>{let o=[],n=[];return W(e,(e,r)=>{t(e,r)?(n.length>0&&o.push(n),n=[],(eC(e.dom,"innerHtml")||e.components&&e.components.length>0)&&n.push(e)):n.push(e)}),n.length>0&&o.push(n),U(o,e=>({dom:{tag:"div",classes:["tox-collection__group"]},components:e}))},xZ=(e,t,o)=>vH.parts.items({preprocess:n=>{let r=U(n,o);return"auto"!==e&&e>1?xX({tag:"div",classes:["tox-collection__group"]},e)(r):xJ(r,(e,o)=>"separator"===t[o].type)}}),xQ=(e,t,o=!0)=>({dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===e?["tox-collection--list"]:["tox-collection--grid"])},components:[xZ(e,t,C)]}),x0=(e,t,o=!0)=>{let n=lr("aria-controls-search-results");return{dom:{tag:"div",classes:["tox-menu","tox-collection",x$].concat(1===e?["tox-collection--list"]:["tox-collection--grid"]),attributes:{id:n}},components:[xZ(e,t,xq)]}},x1=(e,t,o)=>{let n=lr("aria-controls-search-results");return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===e?["tox-collection--list"]:["tox-collection--grid"])},components:[xG({i18n:v6.translate,placeholder:o.placeholder}),{dom:{tag:"div",classes:[...1===e?["tox-collection--list"]:["tox-collection--grid"],x$],attributes:{id:n}},components:[xZ(e,t,xq)]}]}},x2=(e,t=!0)=>({dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[vH.parts.items({preprocess:t=>xJ(t,(t,o)=>"separator"===e[o].type)})]}),x3=e=>H(e,e=>"icon"in e&&void 0!==e.icon),x5=e=>(console.error(r2(e)),console.log(e),B.none()),x9=(e,t,o,n,r)=>{let a=x2(o);return{value:e,dom:a.dom,components:a.components,items:o}},x4=(e,t,o,n,r)=>{if("color"===r.menuType){let t=xK(n);return{value:e,dom:t.dom,components:t.components,items:o}}if("normal"===r.menuType&&"auto"===n){let t=xQ(n,o);return{value:e,dom:t.dom,components:t.components,items:o}}if("normal"===r.menuType||"searchable"===r.menuType){let t="searchable"!==r.menuType?xQ(n,o):"search-with-field"===r.searchMode.searchMode?x1(n,o,r.searchMode):x0(n,o);return{value:e,dom:t.dom,components:t.components,items:o}}{if("listpreview"!==r.menuType||"auto"===n)return{value:e,dom:xD(t,n,r.menuType),components:xA,items:o};let a=xY(n);return{value:e,dom:a.dom,components:a.components,items:o}}},x6=r7("type"),x8=r7("name"),x7=r7("label"),we=r7("text"),wt=r7("title"),wo=r7("icon"),wn=r7("value"),wr=at("fetch"),wa=at("getSubmenuItems"),wi=at("onAction"),wl=at("onItemAction"),ws=aw("onSetup",()=>y),wc=ac("name"),wd=ac("text"),wu=ac("icon"),wm=ac("tooltip"),wg=ac("label"),wp=ac("shortcut"),wh=au("select"),wf=ax("active",!1),wb=ax("borderless",!1),wv=ax("enabled",!0),wy=ax("primary",!1),wx=e=>ah("columns",e),ww=ah("meta",{}),wS=aw("onAction",y),wk=e=>av("type",e),wC=e=>n8("name","name",ri(()=>lr(`${e}-name`)),rW),wO=rI([x6,wd]),w_=e=>rQ("separatormenuitem",wO,e),wT=rI([wk("autocompleteitem"),wf,wv,ww,wn,wd,wu]),wE=e=>rQ("Autocompleter.Separator",wO,e),wD=e=>rQ("Autocompleter.Item",wT,e),wA=[wv,wm,wu,wd,ws],wM=rI([x6,wi].concat(wA)),wB=e=>rQ("toolbarbutton",wM,e),wF=[wf].concat(wA),wI=rI(wF.concat([x6,wi])),wR=e=>rQ("ToggleButton",wI,e),wN=[aw("predicate",A),ay("scope","node",["node","editor"]),ay("position","selection",["node","selection","line"])],wV=wA.concat([wk("contextformbutton"),wy,wi,n7("original",C)]),wz=wF.concat([wk("contextformbutton"),wy,wi,n7("original",C)]),wH=wA.concat([wk("contextformbutton")]),wL=wF.concat([wk("contextformtogglebutton")]),wP=r3("type",{contextformbutton:wV,contextformtogglebutton:wz}),wU=rI([wk("contextform"),aw("initValue",k("")),wg,aa("commands",wP),al("launch",r3("type",{contextformbutton:wH,contextformtogglebutton:wL}))].concat(wN)),wW=e=>rQ("ContextForm",wU,e),wj=rI([wk("contexttoolbar"),r7("items")].concat(wN)),wG=e=>rQ("ContextToolbar",wj,e),w$=[x6,r7("src"),ac("alt"),aS("classes",[],rW)],wq=rI(w$),wX=[x6,we,wc,aS("classes",["tox-collection__item-label"],rW)],wK=rI(wX),wY=rM(()=>rK("type",{cardimage:wq,cardtext:wK,cardcontainer:wJ})),wJ=rI([x6,av("direction","horizontal"),av("align","left"),av("valign","middle"),aa("items",wY)]),wZ=[wv,wd,wp,n8("value","value",ri(()=>lr("menuitem-value")),rL()),ww],wQ=rI([x6,wg,aa("items",wY),ws,wS].concat(wZ)),w0=e=>rQ("cardmenuitem",wQ,e),w1=rI([x6,wf,wu].concat(wZ)),w2=e=>rQ("choicemenuitem",w1,e),w3=[x6,r7("fancytype"),wS],w5=[ah("initData",{})].concat(w3),w9=[au("select"),ak("initData",{},[ax("allowCustomColors",!0),av("storageKey","default"),am("colors",rL())])].concat(w3),w4=r3("fancytype",{inserttable:w5,colorswatch:w9}),w6=e=>rQ("fancymenuitem",w4,e),w8=rI([x6,ws,wS,wu].concat(wZ)),w7=e=>rQ("menuitem",w8,e),Se=rI([x6,wa,ws,wu].concat(wZ)),St=e=>rQ("nestedmenuitem",Se,e),So=rI([x6,wu,wf,ws,wi].concat(wZ)),Sn=e=>rQ("togglemenuitem",So,e),Sr=(e,t,o)=>{let n=u1(e.element,"."+o);if(!(n.length>0))return B.none();{let e=J(n,e=>{let o=e.dom.getBoundingClientRect().top,r=n[0].dom.getBoundingClientRect().top;return Math.abs(o-r)>t}).getOr(n.length);return B.some({numColumns:e,numRows:Math.ceil(n.length/e)})}},Sa=(e,t)=>c2([bG(e,t)]),Si=e=>Sa(lr("unnamed-events"),e),Sl={namedEvents:Sa,unnamedEvents:Si},Ss=lr("tooltip.exclusive"),Sc=lr("tooltip.show"),Sd=lr("tooltip.hide"),Su=(e,t,o)=>{e.getSystem().broadcastOn([Ss],{})},Sm=(e,t,o,n)=>{o.getTooltip().each(e=>{e.getSystem().isConnected()&&bW.set(e,n)})};var Sg=Object.freeze({__proto__:null,hideAllExclusive:Su,setComponents:Sm});let Sp=(e,t)=>{let o=o=>{t.getTooltip().each(n=>{mq(n),e.onHide(o,n),t.clearTooltip()}),t.clearTimer()},n=o=>{if(!t.isShowing()){Su(o);let n=e.lazySink(o).getOrDie(),r=o.getSystem().build({dom:e.tooltipDom,components:e.tooltipComponents,events:iL("normal"===e.mode?[iW(a1(),e=>{iF(o,Sc)}),iW(aQ(),e=>{iF(o,Sd)})]:[]),behaviours:c2([bW.config({})])});t.setTooltip(r),mj(n,r),e.onShow(o,r),mI.position(n,r,{anchor:e.anchor(o)})}};return iL(Z([[iW(Sc,o=>{t.resetTimer(()=>{n(o)},e.delay)}),iW(Sd,n=>{t.resetTimer(()=>{o(n)},e.delay)}),iW(ic(),(e,t)=>{!t.universal&&z(t.channels,Ss)&&o(e)}),iQ(e=>{o(e)})],"normal"===e.mode?[iW(a2(),e=>{iF(e,Sc)}),iW(il(),e=>{iF(e,Sd)}),iW(a1(),e=>{iF(e,Sc)}),iW(aQ(),e=>{iF(e,Sd)})]:[iW(iM(),(e,t)=>{iF(e,Sc)}),iW(iB(),e=>{iF(e,Sd)})]]))};var Sh=Object.freeze({__proto__:null,events:Sp}),Sf=[r4("lazySink"),r4("tooltipDom"),ah("exclusive",!0),ah("tooltipComponents",[]),ah("delay",300),ay("mode","normal",["normal","follow-highlight"]),ah("anchor",e=>({type:"hotspot",hotspot:e,layouts:{onLtr:k([cN,cR,cM,cF,cB,cI]),onRtl:k([cN,cR,cM,cF,cB,cI])}})),s6("onHide"),s6("onShow")];let Sb=()=>{let e=dR(),t=dR(),o=()=>{e.on(clearTimeout)},n=(t,n)=>{o(),e.set(setTimeout(t,n))},r=k("not-implemented");return lO({getTooltip:t.get,isShowing:t.isSet,setTooltip:t.set,clearTooltip:t.clear,clearTimer:o,resetTimer:n,readState:r})};var Sv=Object.freeze({__proto__:null,init:Sb});let Sy=c5({fields:Sf,name:"tooltipping",active:Sh,state:Sv,apis:Sg}),Sx=e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),Sw="silver.readonly",SS=rI([r6("readonly",rj)]),Sk=(e,t)=>{let o=e.mainUi.outerContainer,n=o.element,r=[e.mainUi.mothership,...e.uiMotherships];t&&W(r,e=>{e.broadcastOn([gc()],{target:n})}),W(r,e=>{e.broadcastOn([Sw],{readonly:t})})},SC=(e,t)=>{e.on("init",()=>{e.mode.isReadOnly()&&Sk(t,!0)}),e.on("SwitchMode",()=>Sk(t,e.mode.isReadOnly())),yx(e)&&e.mode.set("readonly")},SO=()=>c8.config({channels:{[Sw]:{schema:SS,onReceive:(e,t)=>{ha.set(e,t.readonly)}}}}),S_=e=>ha.config({disabled:e,disableClass:"tox-collection__item--state-disabled"}),ST=e=>ha.config({disabled:e}),SE=e=>ha.config({disabled:e,disableClass:"tox-tbtn--disabled"}),SD=e=>ha.config({disabled:e,disableClass:"tox-tbtn--disabled",useNative:!1}),SA={item:S_,button:ST,splitButton:SE,toolbarButton:SD},SM=(e,t)=>{let o=e.getApi(t);return e=>{e(o)}},SB=(e,t)=>iZ(o=>{let n=SM(e,o);n(o=>{let n=e.onSetup(o);f(n)&&t.set(n)})}),SF=(e,t)=>iQ(o=>SM(e,o)(t.get())),SI=(e,t)=>i1((o,n)=>{SM(e,o)(e.onAction),e.triggersSubmenu||t!==xg.CLOSE_ON_EXECUTE||(o.getSystem().isConnected()&&iF(o,ip()),n.stop())}),SR={[id()]:["disabling","alloy.base.behaviour","toggling","item-events"]},SN=(e,t,o,n)=>{let r=aC(y);return{type:"item",dom:t.dom,components:eE(t.optComponents),data:e.data,eventOrder:SR,hasSubmenu:e.triggersSubmenu,itemBehaviours:c2([bG("item-events",[SI(e,o),SB(e,r),SF(e,r)]),SA.item(()=>!e.enabled||n.isDisabled()),SO(),bW.config({})].concat(e.itemBehaviours))}},SV=e=>({value:e.value,meta:{text:e.text.getOr(""),...e.meta}}),Sz=e=>{let t=yf.os.isMacOS()||yf.os.isiOS(),o=t?{alt:"⌥",ctrl:"⌃",shift:"⇧",meta:"⌘",access:"⌃⌥"}:{meta:"Ctrl",access:"Shift+Alt"},n=e.split("+"),r=U(n,e=>{let t=e.toLowerCase().trim();return eC(o,t)?o[t]:e});return t?r.join(""):r.join("+")},SH=(e,t,o=[xy])=>ys(e,{tag:"div",classes:o},t),SL=e=>({dom:{tag:"div",classes:[xx]},components:[s_(v6.translate(e))]}),SP=(e,t)=>({dom:{tag:"div",classes:t,innerHtml:e}}),SU=(e,t)=>({dom:{tag:"div",classes:[xx]},components:[{dom:{tag:e.tag,styles:e.styles},components:[s_(v6.translate(t))]}]}),SW=e=>({dom:{tag:"div",classes:["tox-collection__item-accessory"]},components:[s_(Sz(e))]}),Sj=e=>SH("checkmark",e,["tox-collection__item-checkmark"]),SG=e=>SH("chevron-right",e,[xw]),S$=e=>SH("chevron-down",e,[xw]),Sq=(e,t)=>{let o="vertical"===e.direction?"tox-collection__item-container--column":xC,n="left"===e.align?"tox-collection__item-container--align-left":"tox-collection__item-container--align-right";return{dom:{tag:"div",classes:[xk,o,n,(()=>{switch(e.valign){case"top":return"tox-collection__item-container--valign-top";case"middle":return"tox-collection__item-container--valign-middle";case"bottom":return"tox-collection__item-container--valign-bottom"}})()]},components:t}},SX=(e,t,o)=>({dom:{tag:"img",classes:t,attributes:{src:e,alt:o.getOr("")}}}),SK=(e,t,o)=>{let n=e.ariaLabel,r=e.value,a=e.iconContent.map(e=>yr(e,t.icons,o));return{dom:(()=>{let e=a.getOr(""),o=n.map(e=>({title:t.translate(e)})).getOr({}),i={tag:"div",attributes:o,classes:[xf]};return"custom"===r?{...i,tag:"button",classes:[...i.classes,"tox-swatches__picker-btn"],innerHtml:e}:"remove"===r?{...i,classes:[...i.classes,"tox-swatch--remove"],innerHtml:e}:h(r)?{...i,attributes:{...i.attributes,"data-mce-color":r},styles:{"background-color":r},innerHtml:e}:i})(),optComponents:[]}},SY=e=>{let t=e.map(e=>({attributes:{title:v6.translate(e)}})).getOr({});return{tag:"div",classes:[xp,xh],...t}},SJ=(e,t,o,n)=>{let r={tag:"div",classes:[xy]},a=e=>ys(e,r,t.icons,n),i=()=>B.some({dom:r}),l=o?e.iconContent.map(a).orThunk(i):B.none(),s=e.checkMark,c=B.from(e.meta).fold(()=>SL,e=>eC(e,"style")?_(SU,e.style):SL),d=e.htmlContent.fold(()=>e.textContent.map(c),e=>B.some(SP(e,[xx]))),u={dom:SY(e.ariaLabel),optComponents:[l,d,e.shortcutContent.map(SW),s,e.caret]};return u},SZ=(e,t,o,n=B.none())=>"color"===e.presets?SK(e,t,n):SJ(e,t,o,n),SQ=(e,t)=>ek(e,"tooltipWorker").map(e=>[Sy.config({lazySink:t.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:e=>({type:"submenu",item:e,overrides:{maxHeightFunction:d2}}),mode:"follow-highlight",onShow:(t,o)=>{e(e=>{Sy.setComponents(t,[sT({element:eJ.fromDom(e)})])})}})]).getOr([]),S0=e=>yp.DOM.encode(e),S1=(e,t)=>{let o=v6.translate(e),n=S0(o);if(!(t.length>0))return n;{let e=RegExp(Sx(t),"gi");return n.replace(e,e=>`<span class="tox-autocompleter-highlight">${e}</span>`)}},S2=(e,t,o,n,r,a,i,l=!0)=>{let s=SZ({presets:n,textContent:B.none(),htmlContent:o?e.text.map(e=>S1(e,t)):B.none(),ariaLabel:e.text,iconContent:e.icon,shortcutContent:B.none(),checkMark:B.none(),caret:B.none(),value:e.value},i.providers,l,e.icon);return SN({data:SV(e),enabled:e.enabled,getApi:k({}),onAction:t=>r(e.value,e.meta),onSetup:k(y),triggersSubmenu:!1,itemBehaviours:SQ(e.meta,i)},s,a,i.providers)},S3=(e,t)=>U(e,e=>{switch(e.type){case"cardcontainer":return Sq(e,S3(e.items,t));case"cardimage":return SX(e.src,e.classes,e.alt);case"cardtext":let o=e.name.exists(e=>z(t.cardText.highlightOn,e)),n=o?B.from(t.cardText.matchText).getOr(""):"";return SP(S1(e.text,n),e.classes)}}),S5=(e,t,o,n)=>{let r=e=>({isEnabled:()=>!ha.isDisabled(e),setEnabled:t=>{ha.set(e,!t),W(u1(e.element,"*"),o=>{e.getSystem().getByDom(o).each(e=>{e.hasConfigured(ha)&&ha.set(e,!t)})})}}),a={dom:SY(e.label),optComponents:[B.some({dom:{tag:"div",classes:[xk,xC]},components:S3(e.items,n)})]};return SN({data:SV({text:B.none(),...e}),enabled:e.enabled,getApi:r,onAction:e.onAction,onSetup:e.onSetup,triggersSubmenu:!1,itemBehaviours:B.from(n.itemBehaviours).getOr([])},a,t,o.providers)},S9=(e,t,o,n,r,a,i,l=!0)=>{let s=e=>({setActive:t=>{vs.set(e,t)},isActive:()=>vs.isOn(e),isEnabled:()=>!ha.isDisabled(e),setEnabled:t=>ha.set(e,!t)}),c=SZ({presets:o,textContent:t?e.text:B.none(),htmlContent:B.none(),ariaLabel:e.text,iconContent:e.icon,shortcutContent:t?e.shortcut:B.none(),checkMark:t?B.some(Sj(i.icons)):B.none(),caret:B.none(),value:e.value},i,l);return rn(SN({data:SV(e),enabled:e.enabled,getApi:s,onAction:t=>n(e.value),onSetup:e=>(e.setActive(r),y),triggersSubmenu:!1,itemBehaviours:[]},c,a,i),{toggling:{toggleClass:xv,toggleOnExecute:!1,selected:e.active,exclusive:!0}})},S4=py(v_(),vT()),S6=e=>({value:kt(e)}),S8=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,S7=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,ke=e=>S8.test(e)||S7.test(e),kt=e=>eV(e,"#").toUpperCase(),ko=e=>ke(e)?B.some({value:kt(e)}):B.none(),kn=e=>{let t=e.value.replace(S8,(e,t,o,n)=>t+t+o+o+n+n);return{value:t}},kr=e=>{let t=kn(e),o=S7.exec(t.value);return null===o?["FFFFFF","FF","FF","FF"]:o},ka=e=>{let t=e.toString(16);return(1===t.length?"0"+t:t).toUpperCase()},ki=e=>{let t=ka(e.red)+ka(e.green)+ka(e.blue);return S6(t)},kl=Math.min,ks=Math.max,kc=Math.round,kd=/^\s*rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/i,ku=/^\s*rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?(?:\.\d+)?)\s*\)\s*$/i,km=(e,t,o,n)=>({red:e,green:t,blue:o,alpha:n}),kg=e=>{let t=parseInt(e,10);return t.toString()===e&&t>=0&&t<=255},kp=e=>{let t,o,n;let r=(e.hue||0)%360,a=e.saturation/100,i=e.value/100;if(a=ks(0,kl(a,1)),i=ks(0,kl(i,1)),0===a)return km(t=o=n=kc(255*i),o,n,1);let l=r/60,s=i*a,c=s*(1-Math.abs(l%2-1)),d=i-s;switch(Math.floor(l)){case 0:t=s,o=c,n=0;break;case 1:t=c,o=s,n=0;break;case 2:t=0,o=s,n=c;break;case 3:t=0,o=c,n=s;break;case 4:t=c,o=0,n=s;break;case 5:t=s,o=0,n=c;break;default:t=o=n=0}return km(t=kc(255*(t+d)),o=kc(255*(o+d)),n=kc(255*(n+d)),1)},kh=e=>{let t=kr(e),o=parseInt(t[1],16),n=parseInt(t[2],16),r=parseInt(t[3],16);return km(o,n,r,1)},kf=(e,t,o,n)=>{let r=parseInt(e,10),a=parseInt(t,10),i=parseInt(o,10),l=parseFloat(n);return km(r,a,i,l)},kb=e=>{if("transparent"===e)return B.some(km(0,0,0,0));let t=kd.exec(e);if(null!==t)return B.some(kf(t[1],t[2],t[3],"1"));let o=ku.exec(e);return null!==o?B.some(kf(o[1],o[2],o[3],o[4])):B.none()},kv=e=>`rgba(${e.red},${e.green},${e.blue},${e.alpha})`,ky=km(255,0,0,1),kx=e=>{e.dispatch("SkinLoaded")},kw=(e,t)=>{e.dispatch("SkinLoadError",t)},kS=e=>{e.dispatch("ResizeEditor")},kk=(e,t)=>{e.dispatch("ResizeContent",t)},kC=(e,t)=>{e.dispatch("ScrollContent",t)},kO=(e,t)=>{e.dispatch("TextColorChange",t)},k_=(e,t)=>{e.dispatch("AfterProgressState",{state:t})},kT=(e,t)=>e.dispatch("ResolveName",{name:t.nodeName.toLowerCase(),target:t}),kE=(e,t)=>{e.dispatch("ToggleToolbarDrawer",{state:t})};var kD=tinymce.util.Tools.resolve("tinymce.util.LocalStorage");let kA={},kM=(e,t=10)=>{let o=kD.getItem(e),n=l(o)?JSON.parse(o):[],r=(e=>{let o=t-e.length;return o<0?e.slice(0,t):e})(n),a=o=>{V(r,o).each(i),r.unshift(o),r.length>t&&r.pop(),kD.setItem(e,JSON.stringify(r))},i=e=>{r.splice(e,1)},s=()=>r.slice(0);return{add:a,state:s}},kB=e=>ek(kA,e).getOrThunk(()=>{let t=`tinymce-custom-colors-${e}`,o=kD.getItem(t);if(p(o)){let e=kD.getItem("tinymce-custom-colors");kD.setItem(t,h(e)?e:"[]")}let n=kM(t,10);return kA[e]=n,n}),kF=e=>U(kB(e).state(),e=>({type:"choiceitem",text:e,icon:"checkmark",value:e})),kI=(e,t)=>{kB(e).add(t)},kR=(e,t,o)=>({hue:e,saturation:t,value:o}),kN=e=>{let t=0,o=e.red/255,n=e.green/255,r=e.blue/255,a=Math.min(o,Math.min(n,r)),i=Math.max(o,Math.max(n,r));return a===i?kR(0,0,100*a):kR(Math.round(60*((o===a?3:r===a?1:5)-(o===a?n-r:r===a?o-n:r-o)/(i-a))),Math.round(100*((i-a)/i)),Math.round(100*i))},kV=e=>kN(kh(e)),kz=e=>ki(kp(e)),kH=e=>ko(e).orThunk(()=>kb(e).map(ki)).getOrThunk(()=>{let t=document.createElement("canvas");t.height=1,t.width=1;let o=t.getContext("2d");o.clearRect(0,0,t.width,t.height),o.fillStyle="#FFFFFF",o.fillStyle=e,o.fillRect(0,0,1,1);let n=o.getImageData(0,0,1,1).data,r=n[0],a=n[1],i=n[2],l=n[3];return ki(km(r,a,i,l))}),kL="forecolor",kP="hilitecolor",kU=e=>Math.max(5,Math.ceil(Math.sqrt(e))),kW=(e,t)=>{let o=kU(t),n=kG("color_cols")(e);return 5===o?n:o},kj=e=>{let t=[];for(let o=0;o<e.length;o+=2)t.push({text:e[o+1],value:"#"+kH(e[o]).value,icon:"checkmark",type:"choiceitem"});return t},kG=e=>t=>t.options.get(e),k$="#000000",kq=e=>{let t=e.options.register,o=e=>v(e,l)?{value:kj(e),valid:!0}:{valid:!1,message:"Must be an array of strings."};t("color_map",{processor:o,default:["#BFEDD2","Light Green","#FBEEB8","Light Yellow","#F8CAC6","Light Red","#ECCAFA","Light Purple","#C2E0F4","Light Blue","#2DC26B","Green","#F1C40F","Yellow","#E03E2D","Red","#B96AD9","Purple","#3598DB","Blue","#169179","Dark Turquoise","#E67E23","Orange","#BA372A","Dark Red","#843FA1","Dark Purple","#236FA1","Dark Blue","#ECF0F1","Light Gray","#CED4D9","Medium Gray","#95A5A6","Gray","#7E8C8D","Dark Gray","#34495E","Navy Blue","#000000","Black","#ffffff","White"]}),t("color_map_background",{processor:o}),t("color_map_foreground",{processor:o}),t("color_cols",{processor:"number",default:kU(kJ(e,"default").length)}),t("color_cols_foreground",{processor:"number",default:kW(e,kJ(e,kL).length)}),t("color_cols_background",{processor:"number",default:kW(e,kJ(e,kP).length)}),t("custom_colors",{processor:"boolean",default:!0}),t("color_default_foreground",{processor:"string",default:k$}),t("color_default_background",{processor:"string",default:k$})},kX=(e,t)=>t===kL?kG("color_cols_foreground")(e):t===kP?kG("color_cols_background")(e):kG("color_cols")(e),kK=(e,t)=>{let o=kX(e,t);return o>0?o:5},kY=kG("custom_colors"),kJ=(e,t)=>t===kL&&e.options.isSet("color_map_foreground")?kG("color_map_foreground")(e):t===kP&&e.options.isSet("color_map_background")?kG("color_map_background")(e):kG("color_map")(e),kZ=kG("color_default_foreground"),kQ=kG("color_default_background"),k0=e=>kb(e).exists(e=>0!==e.alpha),k1=e=>aH(e,e=>{if(!te(e))return B.none();{let t=tJ(e,"background-color");return eF(k0(t),t)}}).getOr("rgba(0, 0, 0, 0)"),k2=(e,t)=>{let o=eJ.fromDom(e.selection.getStart()),n="hilitecolor"===t?k1(o):tJ(o,"color");return kb(n).map(e=>"#"+ki(e).value)},k3=(e,t,o)=>{e.undoManager.transact(()=>{e.focus(),e.formatter.apply(t,{value:o}),e.nodeChanged()})},k5=(e,t)=>{e.undoManager.transact(()=>{e.focus(),e.formatter.remove(t,{value:null},void 0,!0),e.nodeChanged()})},k9=e=>{e.addCommand("mceApplyTextcolor",(t,o)=>{k3(e,t,o)}),e.addCommand("mceRemoveTextcolor",t=>{k5(e,t)})},k4=e=>{let t="choiceitem",o={type:t,text:"Remove color",icon:"color-swatch-remove-color",value:"remove"};return e?[o,{type:t,text:"Custom color",icon:"color-picker",value:"custom"}]:[o]},k6=(e,t,o,n)=>{if("custom"===o){let o=Cr(e);o(o=>{o.each(o=>{kI(t,o),e.execCommand("mceApplyTextcolor",t,o),n(o)})},k2(e,t).getOr(k$))}else"remove"===o?(n(""),e.execCommand("mceRemoveTextcolor",t)):(n(o),e.execCommand("mceApplyTextcolor",t,o))},k8=(e,t,o)=>e.concat(kF(t).concat(k4(o))),k7=(e,t,o)=>n=>{n(k8(e,t,o))},Ce=(e,t,o)=>{e.setIconFill("forecolor"===t?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color",o)},Ct=(e,t)=>o=>{let n=k2(e,t);return e_(n,o.toUpperCase())},Co=(e,t,o,n,r)=>{e.ui.registry.addSplitButton(t,{tooltip:n,presets:"color",icon:"forecolor"===t?"text-color":"highlight-bg-color",select:Ct(e,o),columns:kK(e,o),fetch:k7(kJ(e,o),o,kY(e)),onAction:t=>{k6(e,o,r.get(),y)},onItemAction:(n,a)=>{k6(e,o,a,o=>{r.set(o),kO(e,{name:t,color:o})})},onSetup:o=>{Ce(o,t,r.get());let n=e=>{e.name===t&&Ce(o,e.name,e.color)};return e.on("TextColorChange",n),()=>{e.off("TextColorChange",n)}}})},Cn=(e,t,o,n,r)=>{e.ui.registry.addNestedMenuItem(t,{text:n,icon:"forecolor"===t?"text-color":"highlight-bg-color",onSetup:e=>(Ce(e,t,r.get()),y),getSubmenuItems:()=>[{type:"fancymenuitem",fancytype:"colorswatch",select:Ct(e,o),initData:{storageKey:o},onAction:n=>{k6(e,o,n.value,o=>{r.set(o),kO(e,{name:t,color:o})})}}]})},Cr=e=>(t,o)=>{let n=!1,r=o=>{let r=o.getData(),a=r.colorpicker;n?(t(B.from(a)),o.close()):e.windowManager.alert(e.translate(["Invalid hex color code: {0}",a]))},a=(e,t)=>{"hex-valid"===t.name&&(n=t.value)};e.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:{colorpicker:o},onAction:a,onSubmit:r,onClose:y,onCancel:()=>{t(B.none())}})},Ca=e=>{k9(e);let t=kZ(e),o=kQ(e),n=aC(t),r=aC(o);Co(e,"forecolor","forecolor","Text color",n),Co(e,"backcolor","hilitecolor","Background color",r),Cn(e,"forecolor","forecolor","Text color",n),Cn(e,"backcolor","hilitecolor","Background color",r)},Ci=(e,t,o,n,r,a,i,l)=>{let s=x3(t),c=Cl(t,o,n,"color"!==r?"normal":"color",a,i,l);return x4(e,s,c,n,{menuType:r})},Cl=(e,t,o,n,r,a,i)=>eE(U(e,l=>"choiceitem"===l.type?w2(l).fold(x5,l=>B.some(S9(l,1===o,n,t,a(l.value),r,i,x3(e)))):B.none())),Cs=(e,t)=>{let o=xE(t);return 1===e?{mode:"menu",moveOnTab:!0}:"auto"===e?{mode:"grid",selector:"."+o.item,initSize:{numColumns:1,numRows:1}}:{mode:"matrix",rowSelector:"."+("color"===t?"tox-swatches__row":"tox-collection__group"),previousSelector:e=>"color"===t?sH(e.element,"[aria-checked=true]"):B.none()}},Cc=(e,t)=>1===e?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===e?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:"color"===t?".tox-swatches__row":".tox-collection__group",cell:"color"===t?`.${xf}`:`.${xh}`}},Cd=(e,t)=>{let o=Cu(e,t),n=t.colorinput.getColorCols(e.initData.storageKey),r="color",a=Ci(lr("menu-value"),o,t=>{e.onAction({value:t})},n,r,xg.CLOSE_ON_EXECUTE,e.select.getOr(A),t.shared.providers),i={...a,markers:xE(r),movement:Cs(n,r)};return{type:"widget",data:{value:lr("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[S4.widget(vH.sketch(i))]}},Cu=(e,t)=>{let o=e.initData.allowCustomColors&&t.colorinput.hasCustomColors();return e.initData.colors.fold(()=>k8(t.colorinput.getColors(e.initData.storageKey),e.initData.storageKey,o),e=>e.concat(k4(o)))},Cm=lr("cell-over"),Cg=lr("cell-execute"),Cp=(e,t,o)=>{let n=o=>iI(o,Cm,{row:e,col:t}),r=o=>iI(o,Cg,{row:e,col:t}),a=(e,t)=>{t.stop(),r(e)};return sA({dom:{tag:"div",attributes:{role:"button","aria-labelledby":o}},behaviours:c2([bG("insert-table-picker-cell",[iW(a1(),b0.focus),iW(id(),r),iW(a8(),a),iW(im(),a)]),vs.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),b0.config({onFocus:n})])})},Ch=(e,t,o)=>{let n=[];for(let r=0;r<t;r++){let t=[];for(let n=0;n<o;n++)t.push(Cp(r,n,e));n.push(t)}return n},Cf=(e,t,o,n,r)=>{for(let a=0;a<n;a++)for(let n=0;n<r;n++)vs.set(e[a][n],a<=t&&n<=o)},Cb=e=>Q(e,e=>U(e,lx)),Cv=(e,t)=>s_(`${t}x${e}`),Cy=e=>{let t=lr("size-label"),o=Ch(t,10,10),n=Cv(0,0),r=v4({dom:{tag:"span",classes:["tox-insert-table-picker__label"],attributes:{id:t}},components:[n],behaviours:c2([bW.config({})])});return{type:"widget",data:{value:lr("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[S4.widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:Cb(o).concat(r.asSpec()),behaviours:c2([bG("insert-table-picker",[iZ(e=>{bW.set(r.get(e),[n])}),iX(Cm,(e,t,n)=>{let{row:a,col:i}=n.event;Cf(o,a,i,10,10),bW.set(r.get(e),[Cv(a+1,i+1)])}),iX(Cg,(t,o,n)=>{let{row:r,col:a}=n.event;e.onAction({numRows:r+1,numColumns:a+1}),iF(t,ip())})]),bD.config({initSize:{numRows:10,numColumns:10},mode:"flatgrid",selector:'[role="button"]'})])})]}},Cx={inserttable:Cy,colorswatch:Cd},Cw=(e,t)=>ek(Cx,e.fancytype).map(o=>o(e,t)),CS=(e,t,o,n=!0,r=!1)=>{let a=r?S$(o.icons):SG(o.icons),i=e=>({isEnabled:()=>!ha.isDisabled(e),setEnabled:t=>ha.set(e,!t),setIconFill:(t,o)=>{sH(e.element,`svg path[id="${t}"], rect[id="${t}"]`).each(e=>{tH(e,"fill",o)})}}),l=SZ({presets:"normal",iconContent:e.icon,textContent:e.text,htmlContent:B.none(),ariaLabel:e.text,caret:B.some(a),checkMark:B.none(),shortcutContent:e.shortcut},o,n);return SN({data:SV(e),getApi:i,enabled:e.enabled,onAction:y,onSetup:e.onSetup,triggersSubmenu:!0,itemBehaviours:[]},l,t,o)},Ck=(e,t,o,n=!0)=>{let r=e=>({isEnabled:()=>!ha.isDisabled(e),setEnabled:t=>ha.set(e,!t)}),a=SZ({presets:"normal",iconContent:e.icon,textContent:e.text,htmlContent:B.none(),ariaLabel:e.text,caret:B.none(),checkMark:B.none(),shortcutContent:e.shortcut},o,n);return SN({data:SV(e),getApi:r,enabled:e.enabled,onAction:e.onAction,onSetup:e.onSetup,triggersSubmenu:!1,itemBehaviours:[]},a,t,o)},CC=e=>({type:"separator",dom:{tag:"div",classes:[xh,"tox-collection__group-heading"]},components:e.text.map(s_).toArray()}),CO=(e,t,o,n=!0)=>{let r=e=>({setActive:t=>{vs.set(e,t)},isActive:()=>vs.isOn(e),isEnabled:()=>!ha.isDisabled(e),setEnabled:t=>ha.set(e,!t)}),a=SZ({iconContent:e.icon,textContent:e.text,htmlContent:B.none(),ariaLabel:e.text,checkMark:B.some(Sj(o.icons)),caret:B.none(),shortcutContent:e.shortcut,presets:"normal",meta:e.meta},o,n);return rn(SN({data:SV(e),enabled:e.enabled,getApi:r,onAction:e.onAction,onSetup:e.onSetup,triggersSubmenu:!1,itemBehaviours:[]},a,t,o),{toggling:{toggleClass:xv,toggleOnExecute:!1,selected:e.active}})},C_=(e,t,o,n)=>o.getOrCreate(e,t,n),CT=(e,t,o,n)=>o.getExisting(e,t,n);var CE=Object.freeze({__proto__:null,getCoupled:C_,getExistingCoupled:CT}),CD=[r6("others",rJ(nY.value,rL()))];let CA=()=>{let e={},t=(t,o)=>{let n=eu(t.others);if(0!==n.length)return ek(e,o);throw Error("Cannot find any known coupled components")},o=(o,n,r)=>t(n,r).getOrThunk(()=>{let t=ek(n.others,r).getOrDie("No information found for coupled component: "+r),a=t(o),i=o.getSystem().build(a);return e[r]=i,i}),n=(e,o,n)=>t(o,n).orThunk(()=>(ek(o.others,n).getOrDie("No information found for coupled component: "+n),B.none())),r=k({});return lO({readState:r,getExisting:n,getOrCreate:o})};var CM=Object.freeze({__proto__:null,init:CA});let CB=c5({fields:CD,name:"coupling",apis:CE,state:CM}),CF=e=>{let t=B.none(),o=[],n=e=>CF(t=>{r(o=>{t(e(o))})}),r=e=>{i()?s(e):o.push(e)},a=e=>{i()||(t=B.some(e),l(o),o=[])},i=()=>t.isSome(),l=e=>{W(e,s)},s=e=>{t.each(t=>{setTimeout(()=>{e(t)},0)})};return e(a),{get:r,map:n,isReady:i}},CI=e=>CF(t=>{t(e)}),CR={nu:CF,pure:CI},CN=e=>{setTimeout(()=>{throw e},0)},CV=e=>{let t=t=>{e().then(t,CN)},o=t=>CV(()=>e().then(t)),n=t=>CV(()=>e().then(e=>t(e).toPromise())),r=t=>CV(()=>e().then(()=>t.toPromise())),a=()=>CR.nu(t),i=()=>{let t=null;return CV(()=>(null===t&&(t=e()),t))};return{map:o,bind:n,anonBind:r,toLazy:a,toCached:i,toPromise:e,get:t}},Cz=e=>CV(()=>new Promise(e)),CH=e=>CV(()=>Promise.resolve(e)),CL={nu:Cz,pure:CH},CP=k("sink"),CU=k(pg({name:CP(),overrides:k({dom:{tag:"div"},behaviours:c2([mI.config({useFixed:M})]),events:iL([iK(a5()),iK(aJ()),iK(a8())])})})),CW=(e,t)=>{let o=e.getHotspot(t).getOr(t),n="hotspot",r=e.getAnchorOverrides();return e.layouts.fold(()=>({type:n,hotspot:o,overrides:r}),e=>({type:n,hotspot:o,overrides:r,layouts:e}))},Cj=(e,t,o)=>{let n=e.fetch;return n(o).map(t)},CG=(e,t,o,n,r,a,i)=>{let l=Cj(e,t,n),s=CY(n,e);return l.map(e=>e.bind(e=>B.from(vQ.sketch({...a.menu(),uid:lm(""),data:e,highlightOnOpen:i,onOpenMenu:(e,t)=>{let n=s().getOrDie();mI.position(n,t,{anchor:o}),gs.decloak(r)},onOpenSubmenu:(e,t,o)=>{let n=s().getOrDie();mI.position(n,o,{anchor:{type:"submenu",item:t}}),gs.decloak(r)},onRepositionMenu:(e,t,n)=>{let r=s().getOrDie();mI.position(r,t,{anchor:o}),W(n,e=>{mI.position(r,e.triggeredMenu,{anchor:{type:"submenu",item:e.triggeringItem}})})},onEscape:()=>(b0.focus(n),gs.close(r),B.some(!0))}))))},C$=(e,t,o,n,r,a,i)=>{let l=CW(e,o),s=CG(e,t,l,o,n,r,i);return s.map(e=>(e.fold(()=>{gs.isOpen(n)&&gs.close(n)},e=>{gs.cloak(n),gs.open(n,e),a(n)}),n))},Cq=(e,t,o,n,r,a,i)=>(gs.close(n),CL.pure(n)),CX=(e,t,o,n,r,a)=>{let i=CB.getCoupled(o,"sandbox"),l=gs.isOpen(i);return(l?Cq:C$)(e,t,o,i,n,r,a)},CK=(e,t,o)=>{let n=pY.getCurrent(t).getOr(t),r=oi(e.element);o?tX(n.element,"min-width",r+"px"):oa(n.element,r)},CY=(e,t)=>e.getSystem().getByUid(t.uid+"-"+CP()).map(e=>()=>nY.value(e)).getOrThunk(()=>t.lazySink.fold(()=>()=>nY.error(Error("No internal sink is specified, nor could an external sink be found")),t=>()=>t(e))),CJ=e=>{gs.getState(e).each(e=>{vQ.repositionMenus(e)})},CZ=(e,t,o)=>{let n=sW(),r=(r,a)=>{let i=CW(e,t);n.link(t.element),e.matchWidth&&CK(i.hotspot,a,e.useMinWidth),e.onOpen(i,r,a),void 0!==o&&void 0!==o.onOpen&&o.onOpen(r,a)},a=(e,r)=>{n.unlink(t.element),void 0!==o&&void 0!==o.onClose&&o.onClose(e,r)},i=CY(t,e);return{dom:{tag:"div",classes:e.sandboxClasses,attributes:{id:n.id,role:"listbox"}},behaviours:g$.augment(e.sandboxBehaviours,[gU.config({store:{mode:"memory",initialValue:t}}),gs.config({onOpen:r,onClose:a,isPartOf:(e,o,n)=>sG(o,n)||sG(t,n),getAttachPoint:()=>i().getOrDie()}),pY.config({find:e=>gs.getState(e).bind(e=>pY.getCurrent(e))}),c8.config({channels:{...gg({isExtraPart:A}),...gh({doReposition:CJ})}})])}},CQ=e=>{let t=CB.getCoupled(e,"sandbox");CJ(t)},C0=()=>[ah("sandboxClasses",[]),g$.field("sandboxBehaviours",[pY,c8,gs,gU])],C1=k([r4("dom"),r4("fetch"),s6("onOpen"),s8("onExecute"),ah("getHotspot",B.some),ah("getAnchorOverrides",k({})),un(),gW("dropdownBehaviours",[vs,CB,bD,b0]),r4("toggleClass"),ah("eventOrder",{}),ai("lazySink"),ah("matchWidth",!1),ah("useMinWidth",!1),ai("role")].concat(C0())),C2=k([pm({schema:[s5(),ah("fakeFocus",!1)],name:"menu",defaults:e=>({onExecute:e.onExecute})}),CU()]),C3=(e,t,o,n)=>{let r=e=>{gs.getState(e).each(e=>{vQ.highlightPrimary(e)})},a=(t,o,r)=>CX(e,C,t,n,o,r),i=e=>{a(e,r,nD.HighlightMenuAndItem).get(y)},l={expand:e=>{vs.isOn(e)||a(e,y,nD.HighlightNone).get(y)},open:e=>{vs.isOn(e)||a(e,y,nD.HighlightMenuAndItem).get(y)},refetch:t=>{let o=CB.getExistingCoupled(t,"sandbox");return o.fold(()=>a(t,y,nD.HighlightMenuAndItem).map(y),o=>C$(e,C,t,o,n,y,nD.HighlightMenuAndItem).map(y))},isOpen:vs.isOn,close:e=>{vs.isOn(e)&&a(e,y,nD.HighlightMenuAndItem).get(y)},repositionMenus:e=>{vs.isOn(e)&&CQ(e)}},s=(e,t)=>(iR(e),B.some(!0));return{uid:e.uid,dom:e.dom,components:t,behaviours:gG(e.dropdownBehaviours,[vs.config({toggleClass:e.toggleClass,aria:{mode:"expanded"}}),CB.config({others:{sandbox:t=>CZ(e,t,{onOpen:()=>vs.on(t),onClose:()=>vs.off(t)})}}),bD.config({mode:"special",onSpace:s,onEnter:s,onDown:(e,t)=>{if(C5.isOpen(e)){let t=CB.getCoupled(e,"sandbox");r(t)}else C5.open(e);return B.some(!0)},onEscape:(e,t)=>C5.isOpen(e)?(C5.close(e),B.some(!0)):B.none()}),b0.config({})]),events:vd(B.some(i)),eventOrder:{...e.eventOrder,[id()]:["disabling","toggling","alloy.base.behaviour"]},apis:l,domModification:{attributes:{"aria-haspopup":"true",...e.role.fold(()=>({}),e=>({role:e})),..."button"===e.dom.tag?{type:ek(e.dom,"attributes").bind(e=>ek(e,"type")).getOr("button")}:{}}}}},C5=pG({name:"Dropdown",configFields:C1(),partFields:C2(),factory:C3,apis:{open:(e,t)=>e.open(t),refetch:(e,t)=>e.refetch(t),expand:(e,t)=>e.expand(t),close:(e,t)=>e.close(t),isOpen:(e,t)=>e.isOpen(t),repositionMenus:(e,t)=>e.repositionMenus(t)}}),C9=e=>"no-search"===e.searchMode?{menuType:"normal"}:{menuType:"searchable",searchMode:e},C4=e=>{let t=gU.getValue(e),o=xP(e).map(xW);C5.refetch(t).get(()=>{let e=CB.getCoupled(t,"sandbox");o.each(t=>xP(e).each(e=>xU(e,t)))})},C6=(e,t)=>{C8(e).each(o=>{iz(e,o.element,t.event.eventType,t.event.interactionEvent)})},C8=e=>gs.getState(e).bind(hO.getHighlighted).bind(hO.getHighlighted),C7=e=>l8(e.element,x$)?B.some(e.element):sH(e.element,"."+x$),Oe=(e,t,o)=>{xP(e).each(e=>{xj(e,o);let n=C7(t);n.each(t=>{tU(t,"id").each(t=>tH(e.element,"aria-controls",t))})}),tH(o.element,"aria-selected","true")},Ot=(e,t,o)=>{tH(o.element,"aria-selected","false")},Oo=e=>{xP(e).each(e=>b0.focus(e))},On=e=>{let t=CB.getExistingCoupled(e,"sandbox");return t.bind(xP).map(xW).map(e=>e.fetchPattern).getOr("")};(nw=nF||(nF={}))[nw.ContentFocus=0]="ContentFocus",nw[nw.UiFocus=1]="UiFocus";let Or=(e,t,o,n,r)=>{let a=o.shared.providers,i=e=>r?{...e,shortcut:B.none(),icon:e.text.isSome()?B.none():e.icon}:e;switch(e.type){case"menuitem":return w7(e).fold(x5,e=>B.some(Ck(i(e),t,a,n)));case"nestedmenuitem":return St(e).fold(x5,e=>B.some(CS(i(e),t,a,n,r)));case"togglemenuitem":return Sn(e).fold(x5,e=>B.some(CO(i(e),t,a,n)));case"separator":return w_(e).fold(x5,e=>B.some(CC(e)));case"fancymenuitem":return w6(e).fold(x5,e=>Cw(e,o));default:return console.error("Unknown item in general menu",e),B.none()}},Oa=(e,t,o,n,r,a,i)=>{let l=1===n,s=!l||x3(e);return eE(U(e,e=>{switch(e.type){case"separator":return wE(e).fold(x5,e=>B.some(CC(e)));case"cardmenuitem":return w0(e).fold(x5,e=>B.some(S5({...e,onAction:t=>{e.onAction(t),o(e.value,e.meta)}},r,a,{itemBehaviours:SQ(e.meta,a),cardText:{matchText:t,highlightOn:i}})));default:return wD(e).fold(x5,e=>B.some(S2(e,t,l,"normal",o,r,a,s)))}}))},Oi=(e,t,o,n,r,a)=>{let i=x3(t),l=eE(U(t,e=>{var t;let a=e=>r?!eC(e,"text"):i;return Or(t="nestedmenuitem"===e.type&&e.getSubmenuItems().length<=0?{...e,enabled:!1}:e,o,n,a(t),r)})),s=C9(a);return(r?x9:x4)(e,i,l,1,s)},Ol=e=>vQ.singleData(e.value,e),Os=(e,t,o,n)=>{let r=Cs(t,n),a=xE(n);return{data:Ol({...e,movement:r,menuBehaviours:Sl.unnamedEvents("auto"!==t?[]:[iZ((e,t)=>{Sr(e,4,a.item).each(({numColumns:t,numRows:o})=>{bD.setGridSize(e,o,t)})})])}),menu:{markers:xE(n),fakeFocus:o===nF.ContentFocus}}},Oc=(e,t)=>xc(eJ.fromDom(t.startContainer)).map(t=>{let o=e.createRng();return o.selectNode(t.dom),o}),Od=(e,t)=>{let o=aC(!1),n=aC(!1),r=sA(v2.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:c2([bG("dismissAutocompleter",[iW(iC(),()=>c())])]),lazySink:t.getSink})),a=()=>v2.isOpen(r),i=n.get,l=()=>{a()&&v2.hide(r)},s=()=>v2.getContent(r).bind(e=>ei(e.components(),0)),c=()=>e.execCommand("mceAutocompleterClose"),d=n=>{let r=ed(n,e=>B.from(e.columns)).getOr(1);return Q(n,n=>{let a=n.items;return Oa(a,n.matchText,(t,r)=>{let a=e.selection.getRng();Oc(e.dom,a).each(a=>{o.set(!0),n.onAction({hide:()=>c(),reload:t=>{l(),e.execCommand("mceAutocompleterReload",!1,{fetchOptions:t})}},a,t,r),o.set(!1)})},r,xg.BUBBLE_TO_SANDBOX,t,n.highlightOn)})},u=(t,o)=>{xd(eJ.fromDom(e.getBody())).each(n=>{let a=ed(t,e=>B.from(e.columns)).getOr(1);v2.showMenuAt(r,{anchor:{type:"node",root:eJ.fromDom(e.getBody()),node:B.from(n)}},Os(x4("autocompleter-value",!0,o,a,{menuType:"normal"}),a,nF.ContentFocus,"normal"))}),s().each(hO.highlightFirst)},m=e=>{let t=d(e);t.length>0?u(e,t):l()};e.on("AutocompleterStart",({lookupData:e})=>{n.set(!0),o.set(!1),m(e)}),e.on("AutocompleterUpdate",({lookupData:e})=>m(e)),e.on("AutocompleterEnd",()=>{l(),n.set(!1),o.set(!1)});let g={cancelIfNecessary:c,isMenuOpen:a,isActive:i,isProcessingAction:o.get,getMenu:s};xm.setup(g,e)},Ou={register:Od},Om=["visible","hidden"],Og=e=>{if(!e7(e))return!1;{let t=tJ(e,"overflow");return eU(t).length>0&&!z(Om,t)}},Op=e=>{let t=u0(e,Og);return el(t).map(e=>({element:e,others:t.slice(1)}))},Oh=(e,t)=>xa(e)?Op(t):B.none(),Of=e=>{let t=[...U(e.others,nP),nG()];return nj(nP(e.element),t)},Ob=(e,t,o)=>sL(e,t,o).isSome(),Ov=(e,t)=>{let o=null,n=(...n)=>{o=setTimeout(()=>{e.apply(null,n),o=null},t)},r=()=>{null!==o&&(clearTimeout(o),o=null)};return{cancel:r,schedule:n}},Oy=e=>{let t=e.raw;return void 0===t.touches||1!==t.touches.length?B.none():B.some(t.touches[0])},Ox=(e,t)=>{let o=Math.abs(e.clientX-t.x),n=Math.abs(e.clientY-t.y);return o>5||n>5},Ow=e=>{let t=dR(),o=aC(!1),n=Ov(t=>{e.triggerEvent(ig(),t),o.set(!0)},400),r=e=>(Oy(e).each(r=>{n.cancel();let a={x:r.clientX,y:r.clientY,target:e.target};n.schedule(e),o.set(!1),t.set(a)}),B.none()),a=e=>(n.cancel(),Oy(e).each(e=>{t.on(o=>{Ox(e,o)&&t.clear()})}),B.none()),i=r=>{n.cancel();let a=e=>tc(e.target,r.target);return t.get().filter(a).map(t=>o.get()?(r.prevent(),!1):e.triggerEvent(im(),r))},l=aF([{key:aq(),value:r},{key:aX(),value:a},{key:aK(),value:i}]),s=(e,t)=>ek(l,t).bind(t=>t(e));return{fireIfReady:s}},OS=e=>{let t=e.raw;return 8===t.which&&!z(["input","textarea"],e4(e.target))&&!Ob(e.target,'[contenteditable="true"]')},Ok=(e,t)=>{let o={stopBackspace:!0,...t},n=Ow(o),r=U(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","transitioncancel","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),t=>dN(e,t,e=>{n.fireIfReady(e,t).each(t=>{t&&e.kill()});let r=o.triggerEvent(t,e);r&&e.kill()})),a=dR(),i=dN(e,"paste",e=>{n.fireIfReady(e,"paste").each(t=>{t&&e.kill()});let t=o.triggerEvent("paste",e);t&&e.kill(),a.set(setTimeout(()=>{o.triggerEvent(is(),e)},0))}),l=dN(e,"keydown",e=>{let t=o.triggerEvent("keydown",e);t?e.kill():o.stopBackspace&&OS(e)&&e.prevent()}),s=dN(e,"focusin",e=>{let t=o.triggerEvent("focusin",e);t&&e.kill()}),c=dR(),d=dN(e,"focusout",e=>{let t=o.triggerEvent("focusout",e);t&&e.kill(),c.set(setTimeout(()=>{o.triggerEvent(il(),e)},0))}),u=()=>{W(r,e=>{e.unbind()}),l.unbind(),s.unbind(),d.unbind(),i.unbind(),a.on(clearTimeout),c.on(clearTimeout)};return{unbind:u}},OC=(e,t)=>{let o=ek(e,"target").getOr(t);return aC(o)},OO=(e,t)=>{let o=aC(!1),n=aC(!1),r=()=>{o.set(!0)},a=()=>{n.set(!0)};return{stop:r,cut:a,isStopped:o.get,isCut:n.get,event:e,setSource:t.set,getSource:t.get}},O_=e=>{let t=aC(!1),o=()=>{t.set(!0)};return{stop:o,cut:y,isStopped:t.get,isCut:A,event:e,setSource:E("Cannot set source of a broadcasted event"),getSource:E("Cannot get source of a broadcasted event")}},OT=a_.generate([{stopped:[]},{resume:["element"]},{complete:[]}]),OE=(e,t,o,n,r,a)=>{let i=e(t,n),l=OO(o,r);return i.fold(()=>(a.logEventNoHandlers(t,n),OT.complete()),e=>{let o=e.descHandler,n=lV(o);return(n(l),l.isStopped())?(a.logEventStopped(t,e.element,o.purpose),OT.stopped()):l.isCut()?(a.logEventCut(t,e.element,o.purpose),OT.complete()):th(e.element).fold(()=>(a.logNoParent(t,e.element,o.purpose),OT.complete()),n=>(a.logEventResponse(t,e.element,o.purpose),OT.resume(n)))})},OD=(e,t,o,n,r,a)=>OE(e,t,o,n,r,a).fold(M,n=>OD(e,t,o,n,r,a),A),OA=(e,t,o,n,r)=>{let a=OC(o,n);return OE(e,t,o,n,a,r)},OM=(e,t,o)=>{let n=O_(t);return W(e,e=>{let t=e.descHandler,o=lV(t);o(n)}),n.isStopped()},OB=(e,t,o,n)=>OF(e,t,o,o.target,n),OF=(e,t,o,n,r)=>{let a=OC(o,n);return OD(e,t,o,n,a,r)},OI=(e,t)=>({element:e,descHandler:t}),OR=(e,t)=>({id:e,descHandler:t}),ON=()=>{let e={},t=(t,o,n)=>{eg(n,(n,r)=>{let a=void 0!==e[r]?e[r]:{};a[o]=lN(n,t),e[r]=a})},o=(e,t)=>lu(t).bind(t=>ek(e,t)).map(e=>OI(t,e)),n=t=>ek(e,t).map(e=>ex(e,(e,t)=>OR(t,e))).getOr([]),r=(t,n,r)=>ek(e,n).bind(e=>aH(r,t=>o(e,t),t)),a=t=>{eg(e,(e,o)=>{eC(e,t)&&delete e[t]})};return{registerId:t,unregisterId:a,filterByType:n,find:r}},OV=()=>{let e=ON(),t={},o=e=>{let t=e.element;return lu(t).getOrThunk(()=>lc("uid-",e.element))},n=(e,o)=>{let n=t[o];if(n===e)a(e);else throw Error('The tagId "'+o+'" is already used by: '+i7(n.element)+"\nCannot use it for: "+i7(e.element)+"\nThe conflicting element is"+(tR(n.element)?" ":" not ")+"already in the DOM")},r=r=>{let a=o(r);eO(t,a)&&n(r,a),e.registerId([r],a,r.events),t[a]=r},a=o=>{lu(o.element).each(o=>{delete t[o],e.unregisterId(o)})},i=t=>e.filterByType(t),l=(t,o,n)=>e.find(t,o,n),s=e=>ek(t,e);return{find:l,filter:i,register:r,unregister:a,getById:s}},Oz=e=>{let{attributes:t,...o}=e.dom;return{uid:e.uid,dom:{tag:"div",attributes:{role:"presentation",...t},...o},components:e.components,behaviours:gj(e.containerBehaviours),events:e.events,domModification:e.domModification,eventOrder:e.eventOrder}},OH=pj({name:"Container",factory:Oz,configFields:[ah("components",[]),gW("containerBehaviours",[]),ah("events",{}),ah("domModification",{}),ah("eventOrder",{})]}),OL=e=>{let t=t=>th(e.element).fold(M,e=>tc(t,e)),o=OV(),n=(e,n)=>o.find(t,e,n),r=Ok(e.element,{triggerEvent:(e,t)=>sZ(e,t.target,o=>OB(n,e,t,o))}),a={debugInfo:k("real"),triggerEvent:(e,t,o)=>{sZ(e,t,r=>OF(n,e,o,t,r))},triggerFocus:(e,t)=>{lu(e).fold(()=>{dt(e)},o=>{sZ(ii(),e,o=>(OA(n,ii(),{originator:t,kill:y,prevent:y,target:e},e,o),!1))})},triggerEscape:(e,t)=>{a.triggerEvent("keydown",e.element,t.event)},getByUid:e=>h(e),getByDom:e=>f(e),build:sA,buildOrPatch:sD,addToGui:e=>{s(e)},removeFromGui:e=>{c(e)},addToWorld:e=>{i(e)},removeFromWorld:e=>{l(e)},broadcast:e=>{m(e)},broadcastOn:(e,t)=>{g(e,t)},broadcastEvent:(e,t)=>{p(e,t)},isConnected:M},i=e=>{e.connect(a),tt(e.element)||(o.register(e),W(e.components(),i),a.triggerEvent(ib(),e.element,{target:e.element}))},l=e=>{tt(e.element)||(W(e.components(),l),o.unregister(e)),e.disconnect()},s=t=>{mj(e,t)},c=e=>{mq(e)},d=()=>{r.unbind(),o7(e.element)},u=e=>{let t=o.filter(ic());W(t,t=>{let o=t.descHandler,n=lV(o);n(e)})},m=e=>{u({universal:!0,data:e})},g=(e,t)=>{u({universal:!1,channels:e,data:t})},p=(e,t)=>{let n=o.filter(e);return OM(n,t)},h=e=>o.getById(e).fold(()=>nY.error(Error('Could not find component with uid: "'+e+'" in system.')),nY.value),f=e=>{let t=lu(e).getOr("not found");return h(t)};return i(e),{root:e,element:e.element,destroy:d,add:s,remove:c,getByUid:h,getByDom:f,addToWorld:i,removeFromWorld:l,broadcast:m,broadcastOn:g,broadcastEvent:p}},OP=(e,t)=>({dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:U(e.items,t.interpreter)}),OU=k([ah("prefix","form-field"),gW("fieldBehaviours",[pY,gU])]),OW=k([pg({schema:[r4("dom")],name:"label"}),pg({factory:{sketch:e=>({uid:e.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:e.text}})},schema:[r4("text")],name:"aria-descriptor"}),pu({factory:{sketch:e=>{let t=aM(e,["factory"]);return e.factory.sketch(t)}},schema:[r4("factory")],name:"field"})]),Oj=(e,t,o,n)=>{let r=gG(e.fieldBehaviours,[pY.config({find:t=>p_(t,e,"field")}),gU.config({store:{mode:"manual",getValue:e=>pY.getCurrent(e).bind(gU.getValue),setValue:(e,t)=>{pY.getCurrent(e).each(e=>{gU.setValue(e,t)})}}})]),a=iL([iZ((t,o)=>{let n=pE(t,e,["label","field","aria-descriptor"]);n.field().each(t=>{let o=lr(e.prefix);n.label().each(e=>{tH(e.element,"for",o),tH(t.element,"id",o)}),n["aria-descriptor"]().each(o=>{let n=lr(e.prefix);tH(o.element,"id",n),tH(t.element,"aria-describedby",n)})})})]);return{uid:e.uid,dom:e.dom,components:t,behaviours:r,events:a,apis:{getField:t=>p_(t,e,"field"),getLabel:t=>p_(t,e,"label")}}},OG=pG({name:"FormField",configFields:OU(),partFields:OW(),factory:Oj,apis:{getField:(e,t)=>e.getField(t),getLabel:(e,t)=>e.getLabel(t)}}),O$=(e,t)=>lA({attributes:aF([{key:t.tabAttr,value:"true"}])});var Oq=Object.freeze({__proto__:null,exhibit:O$}),OX=[ah("tabAttr","data-alloy-tabstop")];let OK=c5({fields:OX,name:"tabstopping",active:Oq});var OY=tinymce.util.Tools.resolve("tinymce.html.Entities");let OJ=(e,t,o,n)=>{let r=OQ(e,t,o,n);return OG.sketch(r)},OZ=(e,t)=>OJ(e,t,[],[]),OQ=(e,t,o,n)=>({dom:O1(o),components:e.toArray().concat([t]),fieldBehaviours:c2(n)}),O0=()=>O1([]),O1=e=>({tag:"div",classes:["tox-form__group"].concat(e)}),O2=(e,t)=>OG.parts.label({dom:{tag:"label",classes:["tox-label"]},components:[s_(t.translate(e))]}),O3=lr("form-component-change"),O5=lr("form-close"),O9=lr("form-cancel"),O4=lr("form-action"),O6=lr("form-submit"),O8=lr("form-block"),O7=lr("form-unblock"),_e=lr("form-tabchange"),_t=lr("form-resize"),_o=(e,t,o)=>{let n=e.label.map(e=>O2(e,t)),r=e=>(t,o)=>{sL(o.event.target,"[data-collection-item-value]").each(n=>{e(t,o,n,tP(n,"data-collection-item-value"))})},a=(o,n)=>{let r=U(n,o=>{let n=v6.translate(o.text),r=1===e.columns?`<div class="tox-collection__item-label">${n}</div>`:"",a=`<div class="tox-collection__item-icon">${o.icon}</div>`,i={_:" "," - ":" ","-":" "},l=n.replace(/\_| \- |\-/g,e=>i[e]),s=t.isDisabled()?" tox-collection__item--state-disabled":"";return`<div class="tox-collection__item${s}" tabindex="-1" data-collection-item-value="${OY.encodeAllRaw(o.value)}" title="${l}" aria-label="${l}">${a}${r}</div>`}),a="auto"!==e.columns&&e.columns>1?P(r,e.columns):[r],i=U(a,e=>`<div class="tox-collection__group">${e.join("")}</div>`);i5(o.element,i.join(""))},i=r((o,n,r,a)=>{n.stop(),t.isDisabled()||iI(o,O4,{name:e.name,value:a})}),l=[iW(a1(),r((e,t,o)=>{dt(o)})),iW(a8(),i),iW(im(),i),iW(a2(),r((e,t,o)=>{sH(e.element,"."+xS).each(e=>{l6(e,xS)}),l9(o,xS)})),iW(a3(),r(e=>{sH(e.element,"."+xS).each(e=>{l6(e,xS)})})),i1(r((t,o,n,r)=>{iI(t,O4,{name:e.name,value:r})}))],s=(e,t)=>U(u1(e.element,".tox-collection__item"),t),c=OG.parts.field({dom:{tag:"div",classes:["tox-collection"].concat(1!==e.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:C},behaviours:c2([ha.config({disabled:t.isDisabled,onDisabled:e=>{s(e,e=>{l9(e,"tox-collection__item--state-disabled"),tH(e,"aria-disabled",!0)})},onEnabled:e=>{s(e,e=>{l6(e,"tox-collection__item--state-disabled"),tj(e,"aria-disabled")})}}),SO(),bW.config({}),gU.config({store:{mode:"memory",initialValue:o.getOr([])},onSetValue:(t,o)=>{a(t,o),"auto"===e.columns&&Sr(t,5,"tox-collection__item").each(({numRows:e,numColumns:o})=>{bD.setGridSize(t,e,o)}),iF(t,_t)}}),OK.config({}),bD.config(Cc(e.columns,"normal")),bG("collection-events",l)]),eventOrder:{[id()]:["disabling","alloy.base.behaviour","collection-events"]}});return OJ(n,c,["tox-form__group--collection"],[])},_n=["input","textarea"],_r=e=>{let t=e4(e);return z(_n,t)},_a=(e,t)=>{let o=t.getRoot(e).getOr(e.element);l6(o,t.invalidClass),t.notify.each(t=>{_r(e.element)&&tH(e.element,"aria-invalid",!1),t.getContainer(e).each(e=>{i5(e,t.validHtml)}),t.onValid(e)})},_i=(e,t,o,n)=>{let r=t.getRoot(e).getOr(e.element);l9(r,t.invalidClass),t.notify.each(t=>{_r(e.element)&&tH(e.element,"aria-invalid",!0),t.getContainer(e).each(e=>{i5(e,n)}),t.onInvalid(e,n)})},_l=(e,t,o)=>t.validator.fold(()=>CL.pure(nY.value(!0)),t=>t.validate(e)),_s=(e,t,o)=>(t.notify.each(t=>{t.onValidate(e)}),_l(e,t).map(n=>e.getSystem().isConnected()?n.fold(n=>(_i(e,t,o,n),nY.error(n)),o=>(_a(e,t),nY.value(o))):nY.error("No longer in system"))),_c=(e,t)=>{let o=t.getRoot(e).getOr(e.element);return l8(o,t.invalidClass)};var _d=Object.freeze({__proto__:null,markValid:_a,markInvalid:_i,query:_l,run:_s,isInvalid:_c});let _u=(e,t)=>e.validator.map(o=>iL([iW(o.onEvent,o=>{_s(o,e,t).get(C)})].concat(o.validateOnLoad?[iZ(o=>{_s(o,e,t).get(y)})]:[]))).getOr({});var _m=Object.freeze({__proto__:null,events:_u}),_g=[r4("invalidClass"),ah("getRoot",B.none),ag("notify",[ah("aria","alert"),ah("getContainer",B.none),ah("validHtml",""),s6("onValid"),s6("onInvalid"),s6("onValidate")]),ag("validator",[r4("validate"),ah("onEvent","input"),ah("validateOnLoad",!0)])];let _p=c5({fields:_g,name:"invalidating",active:_m,apis:_d,extra:{validation:e=>t=>{let o=gU.getValue(t);return CL.pure(e(o))}}}),_h=()=>lA({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}}),_f=()=>iL([iP(io(),M)]);var _b=Object.freeze({__proto__:null,events:_f,exhibit:_h});let _v=c5({fields:[],name:"unselecting",active:_b}),_y=(e,t)=>C5.sketch({dom:e.dom,components:e.components,toggleClass:"mce-active",dropdownBehaviours:c2([SA.button(t.providers.isDisabled),SO(),_v.config({}),OK.config({})]),layouts:e.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:t.getSink,fetch:o=>CL.nu(t=>e.fetch(t)).map(n=>B.from(Ol(rn(Ci(lr("menu-value"),n,t=>{e.onItemAction(o,t)},e.columns,e.presets,xg.CLOSE_ON_EXECUTE,A,t.providers),{movement:Cs(e.columns,e.presets)})))),parts:{menu:xM(!1,1,e.presets)}}),_x=lr("color-input-change"),_w=lr("color-swatch-change"),_S=lr("color-picker-cancel"),_k=(e,t,o,n)=>{let r=OG.parts.field({factory:xV,inputClasses:["tox-textfield"],data:n,onSetValue:e=>_p.run(e).get(y),inputBehaviours:c2([ha.config({disabled:t.providers.isDisabled}),SO(),OK.config({}),_p.config({invalidClass:"tox-textbox-field-invalid",getRoot:e=>tf(e.element),notify:{onValid:e=>{let t=gU.getValue(e);iI(e,_x,{color:t})}},validator:{validateOnLoad:!1,validate:e=>{let t=gU.getValue(e);if(0===t.length)return CL.pure(nY.value(!0));{let e=eJ.fromTag("span");tX(e,"background-color",t);let o=tQ(e,"background-color").fold(()=>nY.error("blah"),e=>nY.value(t));return CL.pure(o)}}}})]),selectOnFocus:!1}),a=e.label.map(e=>O2(e,t.providers)),i=(e,t)=>{iI(e,_w,{value:t})},l=(t,n)=>{s.getOpt(t).each(t=>{"custom"===n?o.colorPicker(o=>{o.fold(()=>iF(t,_S),o=>{i(t,o),kI(e.storageKey,o)})},"#ffffff"):"remove"===n?i(t,""):i(t,n)})},s=v4(_y({dom:{tag:"span",attributes:{"aria-label":t.providers.translate("Color swatch")}},layouts:{onRtl:()=>[cB,cM,cN],onLtr:()=>[cM,cB,cN]},components:[],fetch:k7(o.getColors(e.storageKey),e.storageKey,o.hasCustomColors()),columns:o.getColorCols(e.storageKey),presets:"color",onItemAction:l},t));return OG.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:a.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[r,s.asSpec()]}]),fieldBehaviours:c2([bG("form-field-events",[iW(_x,(t,o)=>{s.getOpt(t).each(e=>{tX(e.element,"background-color",o.event.color)}),iI(t,O3,{name:e.name})}),iW(_w,(e,t)=>{OG.getField(e).each(o=>{gU.setValue(o,t.event.value),pY.getCurrent(e).each(b0.focus)})}),iW(_S,(e,t)=>{OG.getField(e).each(t=>{pY.getCurrent(e).each(b0.focus)})})])])})},_C=pg({schema:[r4("dom")],name:"label"}),_O=e=>pg({name:""+e+"-edge",overrides:t=>{let o=t.model.manager.edgeActions[e];return o.fold(()=>({}),e=>({events:iL([ij(aq(),(t,o,n)=>e(t,n),[t]),ij(aJ(),(t,o,n)=>e(t,n),[t]),ij(aZ(),(t,o,n)=>{n.mouseIsDown.get()&&e(t,n)},[t])])}))}}),__=_O("top-left"),_T=_O("top"),_E=_O("top-right"),_D=_O("right"),_A=_O("bottom-right"),_M=_O("bottom"),_B=_O("bottom-left"),_F=_O("left"),_I=pu({name:"thumb",defaults:k({dom:{styles:{position:"absolute"}}}),overrides:e=>({events:iL([iq(aq(),e,"spectrum"),iq(aX(),e,"spectrum"),iq(aK(),e,"spectrum"),iq(aJ(),e,"spectrum"),iq(aZ(),e,"spectrum"),iq(a0(),e,"spectrum")])})}),_R=pu({schema:[n7("mouseIsDown",()=>aC(!1))],name:"spectrum",overrides:e=>{let t=e.model,o=t.manager,n=(t,n)=>o.getValueFromEvent(n).map(n=>o.setValueFrom(t,e,n));return{behaviours:c2([bD.config({mode:"special",onLeft:t=>o.onLeft(t,e),onRight:t=>o.onRight(t,e),onUp:t=>o.onUp(t,e),onDown:t=>o.onDown(t,e)}),b0.config({})]),events:iL([iW(aq(),n),iW(aX(),n),iW(aJ(),n),iW(aZ(),(t,o)=>{e.mouseIsDown.get()&&n(t,o)})])}}}),_N=k("slider.change.value"),_V=e=>-1!==e.type.indexOf("touch"),_z=e=>{let t=e.event.raw;return _V(t)?void 0!==t.touches&&1===t.touches.length?B.some(t.touches[0]).map(e=>t7(e.clientX,e.clientY)):B.none():void 0!==t.clientX?B.some(t).map(e=>t7(e.clientX,e.clientY)):B.none()},_H=e=>e.model.minX,_L=e=>e.model.minY,_P=e=>e.model.minX-1,_U=e=>e.model.minY-1,_W=e=>e.model.maxX,_j=e=>e.model.maxY,_G=e=>e.model.maxX+1,_$=e=>e.model.maxY+1,_q=(e,t,o)=>t(e)-o(e),_X=e=>_q(e,_W,_H),_K=e=>_q(e,_j,_L),_Y=e=>_X(e)/2,_J=e=>_K(e)/2,_Z=e=>e.stepSize,_Q=e=>e.snapToGrid,_0=e=>e.snapStart,_1=e=>e.rounded,_2=(e,t)=>void 0!==e[t+"-edge"],_3=e=>_2(e,"left"),_5=e=>_2(e,"right"),_9=e=>_2(e,"top"),_4=e=>_2(e,"bottom"),_6=e=>e.model.value.get(),_8=(e,t)=>({x:e,y:t}),_7=(e,t)=>{iI(e,_N(),{value:t})},Te=(e,t)=>{_7(e,_8(_P(t),_U(t)))},Tt=(e,t)=>{_7(e,_U(t))},To=(e,t)=>{_7(e,_8(_Y(t),_U(t)))},Tn=(e,t)=>{_7(e,_8(_G(t),_U(t)))},Tr=(e,t)=>{_7(e,_G(t))},Ta=(e,t)=>{_7(e,_8(_G(t),_J(t)))},Ti=(e,t)=>{_7(e,_8(_G(t),_$(t)))},Tl=(e,t)=>{_7(e,_$(t))},Ts=(e,t)=>{_7(e,_8(_Y(t),_$(t)))},Tc=(e,t)=>{_7(e,_8(_P(t),_$(t)))},Td=(e,t)=>{_7(e,_P(t))},Tu=(e,t)=>{_7(e,_8(_P(t),_J(t)))},Tm=(e,t,o,n)=>e<t?e:e>o?o:e===t?t-1:Math.max(t,e-n),Tg=(e,t,o,n)=>e>o?e:e<t?t:e===o?o+1:Math.min(o,e+n),Tp=(e,t,o)=>Math.max(t,Math.min(o,e)),Th=(e,t,o,n,r)=>r.fold(()=>Tp(t+Math.round((e-t)/n)*n,t-1,o+1),t=>Math.max(t,t+Math.min(Math.floor((o-t)/n),Math.floor((e-t)/n)+Math.round((e-t)%n/n))*n)),Tf=(e,t,o)=>Math.min(o,Math.max(e,t))-t,Tb=e=>{let{min:t,max:o,range:n,value:r,step:a,snap:i,snapStart:l,rounded:s,hasMinEdge:c,hasMaxEdge:d,minBound:u,maxBound:m,screenRange:g}=e,p=c?t-1:t,h=d?o+1:o;if(r<u)return p;if(r>m)return h;{let e=Tf(r,u,m),c=Tp(e/g*n+t,p,h);return i&&c>=t&&c<=o?Th(c,t,o,a,l):s?Math.round(c):c}},Tv=e=>{let{min:t,max:o,range:n,value:r,hasMinEdge:a,hasMaxEdge:i,maxBound:l,maxOffset:s,centerMinEdge:c,centerMaxEdge:d}=e;return r<t?a?0:c:r>o?i?l:d:(r-t)/n*s},Ty="right",Tx="bottom",Tw="left",TS=e=>e.element.dom.getBoundingClientRect(),Tk=(e,t)=>e[t],TC=e=>{let t=TS(e);return Tk(t,Tw)},TO=e=>{let t=TS(e);return Tk(t,Ty)},T_=e=>{let t=TS(e);return Tk(t,"top")},TT=e=>{let t=TS(e);return Tk(t,Tx)},TE=e=>{let t=TS(e);return Tk(t,"width")},TD=e=>{let t=TS(e);return Tk(t,"height")},TA=(e,t,o)=>(e+t)/2-o,TM=(e,t)=>{let o=TS(e),n=TS(t),r=Tk(o,Tw),a=Tk(o,Ty),i=Tk(n,Tw);return TA(r,a,i)},TB=(e,t)=>{let o=TS(e),n=TS(t),r=Tk(o,"top"),a=Tk(o,Tx),i=Tk(n,"top");return TA(r,a,i)},TF=(e,t)=>{iI(e,_N(),{value:t})},TI=(e,t,o)=>{let n={min:_H(t),max:_W(t),range:_X(t),value:o,step:_Z(t),snap:_Q(t),snapStart:_0(t),rounded:_1(t),hasMinEdge:_3(t),hasMaxEdge:_5(t),minBound:TC(e),maxBound:TO(e),screenRange:TE(e)};return Tb(n)},TR=(e,t,o)=>{let n=TI(e,t,o);return TF(e,n),n},TN=(e,t)=>{let o=_H(t);TF(e,o)},TV=(e,t)=>{let o=_W(t);TF(e,o)},Tz=(e,t,o)=>{let n=(e>0?Tg:Tm)(_6(o),_H(o),_W(o),_Z(o));return TF(t,n),B.some(n)},TH=e=>(t,o)=>Tz(e,t,o).map(M),TL=e=>{let t=_z(e);return t.map(e=>e.left)},TP=(e,t,o,n,r)=>{let a=TE(e),i=n.bind(t=>B.some(TM(t,e))).getOr(0),l=r.bind(t=>B.some(TM(t,e))).getOr(a),s={min:_H(t),max:_W(t),range:_X(t),value:o,hasMinEdge:_3(t),hasMaxEdge:_5(t),minBound:TC(e),minOffset:0,maxBound:TO(e),maxOffset:a,centerMinEdge:i,centerMaxEdge:l};return Tv(s)},TU=(e,t,o,n,r,a)=>{let i=TP(t,a,o,n,r);return TC(t)-TC(e)+i},TW=(e,t,o,n)=>{let r=_6(o),a=TU(e,n.getSpectrum(e),r,n.getLeftEdge(e),n.getRightEdge(e),o),i=oi(t.element)/2;tX(t.element,"left",a-i+"px")},Tj=TH(-1),TG=TH(1),T$=B.none,Tq=B.none,TX={"top-left":B.none(),top:B.none(),"top-right":B.none(),right:B.some(Tr),"bottom-right":B.none(),bottom:B.none(),"bottom-left":B.none(),left:B.some(Td)};var TK=Object.freeze({__proto__:null,setValueFrom:TR,setToMin:TN,setToMax:TV,findValueOfOffset:TI,getValueFromEvent:TL,findPositionOfValue:TU,setPositionFromValue:TW,onLeft:Tj,onRight:TG,onUp:T$,onDown:Tq,edgeActions:TX});let TY=(e,t)=>{iI(e,_N(),{value:t})},TJ=(e,t,o)=>{let n={min:_L(t),max:_j(t),range:_K(t),value:o,step:_Z(t),snap:_Q(t),snapStart:_0(t),rounded:_1(t),hasMinEdge:_9(t),hasMaxEdge:_4(t),minBound:T_(e),maxBound:TT(e),screenRange:TD(e)};return Tb(n)},TZ=(e,t,o)=>{let n=TJ(e,t,o);return TY(e,n),n},TQ=(e,t)=>{let o=_L(t);TY(e,o)},T0=(e,t)=>{let o=_j(t);TY(e,o)},T1=(e,t,o)=>{let n=(e>0?Tg:Tm)(_6(o),_L(o),_j(o),_Z(o));return TY(t,n),B.some(n)},T2=e=>(t,o)=>T1(e,t,o).map(M),T3=e=>{let t=_z(e);return t.map(e=>e.top)},T5=(e,t,o,n,r)=>{let a=TD(e),i=n.bind(t=>B.some(TB(t,e))).getOr(0),l=r.bind(t=>B.some(TB(t,e))).getOr(a),s={min:_L(t),max:_j(t),range:_K(t),value:o,hasMinEdge:_9(t),hasMaxEdge:_4(t),minBound:T_(e),minOffset:0,maxBound:TT(e),maxOffset:a,centerMinEdge:i,centerMaxEdge:l};return Tv(s)},T9=(e,t,o,n,r,a)=>{let i=T5(t,a,o,n,r);return T_(t)-T_(e)+i},T4=(e,t,o,n)=>{let r=_6(o),a=T9(e,n.getSpectrum(e),r,n.getTopEdge(e),n.getBottomEdge(e),o),i=t4(t.element)/2;tX(t.element,"top",a-i+"px")},T6=B.none,T8=B.none,T7=T2(-1),Ee=T2(1),Et={"top-left":B.none(),top:B.some(Tt),"top-right":B.none(),right:B.none(),"bottom-right":B.none(),bottom:B.some(Tl),"bottom-left":B.none(),left:B.none()};var Eo=Object.freeze({__proto__:null,setValueFrom:TZ,setToMin:TQ,setToMax:T0,findValueOfOffset:TJ,getValueFromEvent:T3,findPositionOfValue:T9,setPositionFromValue:T4,onLeft:T6,onRight:T8,onUp:T7,onDown:Ee,edgeActions:Et});let En=(e,t)=>{iI(e,_N(),{value:t})},Er=(e,t)=>({x:e,y:t}),Ea=(e,t,o)=>{let n=TI(e,t,o.left),r=TJ(e,t,o.top),a=Er(n,r);return En(e,a),a},Ei=(e,t,o,n)=>{let r=e>0?Tg:Tm,a=t?_6(n).x:r(_6(n).x,_H(n),_W(n),_Z(n)),i=t?r(_6(n).y,_L(n),_j(n),_Z(n)):_6(n).y;return En(o,Er(a,i)),B.some(a)},El=(e,t)=>(o,n)=>Ei(e,t,o,n).map(M),Es=(e,t)=>{let o=_H(t),n=_L(t);En(e,Er(o,n))},Ec=(e,t)=>{let o=_W(t),n=_j(t);En(e,Er(o,n))},Ed=e=>_z(e),Eu=(e,t,o,n)=>{let r=_6(o),a=TU(e,n.getSpectrum(e),r.x,n.getLeftEdge(e),n.getRightEdge(e),o),i=T9(e,n.getSpectrum(e),r.y,n.getTopEdge(e),n.getBottomEdge(e),o),l=oi(t.element)/2,s=t4(t.element)/2;tX(t.element,"left",a-l+"px"),tX(t.element,"top",i-s+"px")},Em=El(-1,!1),Eg=El(1,!1),Ep=El(-1,!0),Eh=El(1,!0),Ef={"top-left":B.some(Te),top:B.some(To),"top-right":B.some(Tn),right:B.some(Ta),"bottom-right":B.some(Ti),bottom:B.some(Ts),"bottom-left":B.some(Tc),left:B.some(Tu)};var Eb=Object.freeze({__proto__:null,setValueFrom:Ea,setToMin:Es,setToMax:Ec,getValueFromEvent:Ed,setPositionFromValue:Eu,onLeft:Em,onRight:Eg,onUp:Ep,onDown:Eh,edgeActions:Ef});let Ev=[ah("stepSize",1),ah("onChange",y),ah("onChoose",y),ah("onInit",y),ah("onDragStart",y),ah("onDragEnd",y),ah("snapToGrid",!1),ah("rounded",!0),ai("snapStart"),r6("model",r3("mode",{x:[ah("minX",0),ah("maxX",100),n7("value",e=>aC(e.mode.minX)),r4("getInitialValue"),ct("manager",TK)],y:[ah("minY",0),ah("maxY",100),n7("value",e=>aC(e.mode.minY)),r4("getInitialValue"),ct("manager",Eo)],xy:[ah("minX",0),ah("maxX",100),ah("minY",0),ah("maxY",100),n7("value",e=>aC({x:e.mode.minX,y:e.mode.minY})),r4("getInitialValue"),ct("manager",Eb)]})),gW("sliderBehaviours",[bD,gU]),n7("mouseIsDown",()=>aC(!1))],Ey=(e,t,o,n)=>{let r=t=>pT(t,e,"thumb"),a=t=>pT(t,e,"spectrum"),i=t=>p_(t,e,"left-edge"),l=t=>p_(t,e,"right-edge"),s=t=>p_(t,e,"top-edge"),c=t=>p_(t,e,"bottom-edge"),d=e.model,u=d.manager,m=(t,o)=>{u.setPositionFromValue(t,o,e,{getLeftEdge:i,getRightEdge:l,getTopEdge:s,getBottomEdge:c,getSpectrum:a})},g=(e,t)=>{d.value.set(t);let o=r(e);m(e,o)},p=(t,o)=>{g(t,o);let n=r(t);return e.onChange(t,n,o),B.some(!0)},h=t=>{u.setToMin(t,e)},f=t=>{u.setToMax(t,e)},b=t=>{let o=e.mouseIsDown.get();e.mouseIsDown.set(!1),o&&p_(t,e,"thumb").each(o=>{let n=d.value.get();e.onChoose(t,o,n)})},v=(t,o)=>{o.stop(),e.mouseIsDown.set(!0),e.onDragStart(t,r(t))},y=(t,o)=>{o.stop(),e.onDragEnd(t,r(t)),b(t)};return{uid:e.uid,dom:e.dom,components:t,behaviours:gG(e.sliderBehaviours,[bD.config({mode:"special",focusIn:t=>p_(t,e,"spectrum").map(bD.focusIn).map(M)}),gU.config({store:{mode:"manual",getValue:e=>d.value.get(),setValue:g}}),c8.config({channels:{[gu()]:{onReceive:b}}})]),events:iL([iW(_N(),(e,t)=>{p(e,t.event.value)}),iZ((t,o)=>{let n=d.getInitialValue();d.value.set(n);let i=r(t);m(t,i);let l=a(t);e.onInit(t,i,l,d.value.get())}),iW(aq(),v),iW(aK(),y),iW(aJ(),v),iW(a0(),y)]),apis:{resetToMin:h,resetToMax:f,setValue:g,refresh:m},domModification:{styles:{position:"relative"}}}},Ex=pG({name:"Slider",configFields:Ev,partFields:[_C,_F,_D,_T,_M,__,_E,_B,_A,_I,_R],factory:Ey,apis:{setValue:(e,t,o)=>{e.setValue(t,o)},resetToMin:(e,t)=>{e.resetToMin(t)},resetToMax:(e,t)=>{e.resetToMax(t)},refresh:(e,t)=>{e.refresh(t)}}}),Ew=lr("rgb-hex-update"),ES=lr("slider-update"),Ek=lr("palette-update"),EC=(e,t)=>{let o=Ex.parts.spectrum({dom:{tag:"div",classes:[t("hue-slider-spectrum")],attributes:{role:"presentation"}}}),n=Ex.parts.thumb({dom:{tag:"div",classes:[t("hue-slider-thumb")],attributes:{role:"presentation"}}});return Ex.sketch({dom:{tag:"div",classes:[t("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:k(0)},components:[o,n],sliderBehaviours:c2([b0.config({})]),onChange:(e,t,o)=>{iI(e,ES,{value:o})}})},EO="form",E_=[gW("formBehaviours",[gU])],ET=e=>"<alloy.field."+e+">",EE=e=>{let t=(()=>{let e=[],t=(t,o)=>(e.push(t),pw(EO,ET(t),o));return{field:t,record:k(e)}})(),o=e(t),n=t.record(),r=U(n,e=>pu({name:e,pname:ET(e)}));return pz(EO,E_,r,EA,o)},ED=(e,t)=>e.fold(()=>nY.error(t),nY.value),EA=(e,t)=>({uid:e.uid,dom:e.dom,components:t,behaviours:gG(e.formBehaviours,[gU.config({store:{mode:"manual",getValue:t=>{let o=pD(t,e);return ep(o,(e,t)=>e().bind(e=>{let o=pY.getCurrent(e);return ED(o,Error(`Cannot find a current component to extract the value from for form part '${t}': `+i7(e.element)))}).map(gU.getValue))},setValue:(t,o)=>{eg(o,(o,n)=>{p_(t,e,n).each(e=>{pY.getCurrent(e).each(e=>{gU.setValue(e,o)})})})}}})]),apis:{getField:(t,o)=>p_(t,e,o).bind(pY.getCurrent)}}),EM={getField:lk((e,t,o)=>e.getField(t,o)),sketch:EE},EB=lr("valid-input"),EF=lr("invalid-input"),EI=lr("validating-input"),ER="colorcustom.rgb.",EN=(e,t,o,n)=>{let r=(o,n)=>_p.config({invalidClass:t("invalid"),notify:{onValidate:e=>{iI(e,EI,{type:o})},onValid:e=>{iI(e,EB,{type:o,value:gU.getValue(e)})},onInvalid:e=>{iI(e,EF,{type:o,value:gU.getValue(e)})}},validator:{validate:t=>{let o=gU.getValue(t),r=n(o)?nY.value(!0):nY.error(e("aria.input.invalid"));return CL.pure(r)},validateOnLoad:!1}}),a=(o,n,a,i,l)=>{let s=e(ER+"range"),c=OG.parts.label({dom:{tag:"label",attributes:{"aria-label":i}},components:[s_(a)]}),d=OG.parts.field({data:l,factory:xV,inputAttributes:{type:"text",..."hex"===n?{"aria-live":"polite"}:{}},inputClasses:[t("textfield")],inputBehaviours:c2([r(n,o),OK.config({})]),onSetValue:e=>{if(_p.isInvalid(e)){let t=_p.run(e);t.get(y)}}}),u="hex"!==n?[OG.parts["aria-descriptor"]({text:s})]:[],m=[c,d].concat(u);return{dom:{tag:"div",attributes:{role:"presentation"}},components:m}},i=(e,t)=>{let o=ki(t);return EM.getField(e,"hex").each(t=>{b0.isFocused(t)||gU.setValue(e,{hex:o.value})}),o},l=(e,t)=>{let o=t.red,n=t.green,r=t.blue;gU.setValue(e,{red:o,green:n,blue:r})},s=v4({dom:{tag:"div",classes:[t("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}}),c=(e,t)=>{s.getOpt(e).each(e=>{tX(e.element,"background-color","#"+t.value)})},d=()=>{let r={red:aC(B.some(255)),green:aC(B.some(255)),blue:aC(B.some(255)),hex:aC(B.some("ffffff"))},d=(e,t)=>{let o=kh(t);l(e,o),p(o)},u=e=>r[e].get(),m=(e,t)=>{r[e].set(t)},g=()=>u("red").bind(e=>u("green").bind(t=>u("blue").map(o=>km(e,t,o,1)))),p=e=>{let t=e.red,o=e.green,n=e.blue;m("red",B.some(t)),m("green",B.some(o)),m("blue",B.some(n))},h=(e,t)=>{let o=t.event;"hex"!==o.type?m(o.type,B.none()):n(e)},f=(e,t)=>{o(e);let n=S6(t);m("hex",B.some(n.value));let r=kh(n);l(e,r),p(r),iI(e,Ew,{hex:n}),c(e,n)},b=(e,t,o)=>{let n=parseInt(o,10);m(t,B.some(n)),g().each(t=>{let o=i(e,t);iI(e,Ew,{hex:o}),c(e,o)})},v=e=>"hex"===e.type,y=(e,t)=>{let o=t.event;v(o)?f(e,o.value):b(e,o.type,o.value)},x=t=>({label:e(ER+t+".label"),description:e(ER+t+".description")}),w=x("red"),S=x("green"),k=x("blue"),C=x("hex");return rn(EM.sketch(o=>({dom:{tag:"form",classes:[t("rgb-form")],attributes:{"aria-label":e("aria.color.picker")}},components:[o.field("red",OG.sketch(a(kg,"red",w.label,w.description,255))),o.field("green",OG.sketch(a(kg,"green",S.label,S.description,255))),o.field("blue",OG.sketch(a(kg,"blue",k.label,k.description,255))),o.field("hex",OG.sketch(a(ke,"hex",C.label,C.description,"ffffff"))),s.asSpec()],formBehaviours:c2([_p.config({invalidClass:t("form-invalid")}),bG("rgb-form-events",[iW(EB,y),iW(EF,h),iW(EI,h)])])})),{apis:{updateHex:(e,t)=>{gU.setValue(e,{hex:t.value}),d(e,t),c(e,t)}}})},u=pj({factory:d,name:"RgbForm",configFields:[],apis:{updateHex:(e,t,o)=>{e.updateHex(t,o)}},extraApis:{}});return u},EV=(e,t)=>{let o=Ex.parts.spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[t("sv-palette-spectrum")]}}),n=Ex.parts.thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[t("sv-palette-thumb")],innerHtml:`<div class=${t("sv-palette-inner-thumb")} role="presentation"></div>`}}),r=(e,t)=>{let{width:o,height:n}=e,r=e.getContext("2d");if(null===r)return;r.fillStyle=t,r.fillRect(0,0,o,n);let a=r.createLinearGradient(0,0,o,0);a.addColorStop(0,"rgba(255,255,255,1)"),a.addColorStop(1,"rgba(255,255,255,0)"),r.fillStyle=a,r.fillRect(0,0,o,n);let i=r.createLinearGradient(0,0,0,n);i.addColorStop(0,"rgba(0,0,0,0)"),i.addColorStop(1,"rgba(0,0,0,1)"),r.fillStyle=i,r.fillRect(0,0,o,n)},a=(e,t)=>{let o=e.components()[0].element.dom,n=kR(t,100,100),a=kp(n);r(o,kv(a))},i=(e,t)=>{let o=kN(kh(t));Ex.setValue(e,{x:o.saturation,y:100-o.value})},l=e=>{let a=k({x:0,y:0}),i=(e,t,o)=>{iI(e,Ek,{value:o})},l=(e,t,o,n)=>{r(o.element.dom,kv(ky))},s=c2([pY.config({find:B.some}),b0.config({})]);return Ex.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[t("sv-palette")]},model:{mode:"xy",getInitialValue:a},rounded:!1,components:[o,n],onChange:i,onInit:l,sliderBehaviours:s})},s=pj({factory:l,name:"SaturationBrightnessPalette",configFields:[],apis:{setHue:(e,t,o)=>{a(t,o)},setThumb:(e,t,o)=>{i(t,o)}},extraApis:{}});return s},Ez=(e,t)=>{let o=o=>{let n=EN(e,t,o.onValidHex,o.onInvalidHex),r=EV(e,t),a=e=>(100-e)/100*360,i=e=>100-e/360*100,l={paletteRgba:aC(ky),paletteHue:aC(0)},s=v4(EC(e,t)),c=v4(r.sketch({})),d=v4(n.sketch({})),u=(e,t,o)=>{c.getOpt(e).each(e=>{r.setHue(e,o)})},m=(e,t)=>{d.getOpt(e).each(e=>{n.updateHex(e,t)})},g=(e,t,o)=>{s.getOpt(e).each(e=>{Ex.setValue(e,i(o))})},p=(e,t)=>{c.getOpt(e).each(e=>{r.setThumb(e,t)})},h=(e,t)=>{let o=kh(e);l.paletteRgba.set(o),l.paletteHue.set(t)},f=(e,t,o,n)=>{h(t,o),W(n,n=>{n(e,t,o)})};return{uid:o.uid,dom:o.dom,components:[c.asSpec(),s.asSpec(),d.asSpec()],behaviours:c2([bG("colour-picker-events",[iW(Ew,(()=>{let e=[u,g,p];return(t,o)=>{let n=o.event.hex,r=kV(n);f(t,n,r.hue,e)}})()),iW(Ek,(()=>{let e=[m];return(t,o)=>{let n=o.event.value,r=l.paletteHue.get(),a=kR(r,n.x,100-n.y),i=kz(a);f(t,i,r,e)}})()),iW(ES,(()=>{let e=[u,m];return(t,o)=>{let n=a(o.event.value),r=l.paletteRgba.get(),i=kN(r),s=kR(n,i.saturation,i.value),c=kz(s);f(t,c,n,e)}})())]),pY.config({find:e=>d.getOpt(e)}),bD.config({mode:"acyclic"})])}},n=pj({name:"ColourPicker",configFields:[r4("dom"),ah("onValidHex",y),ah("onInvalidHex",y)],factory:o});return n},EH=()=>pY.config({find:B.some}),EL=e=>pY.config({find:e.getOpt}),EP=e=>pY.config({find:t=>tw(t.element,e).bind(e=>t.getSystem().getByDom(e).toOptional())}),EU={self:EH,memento:EL,childAt:EP},EW=rI([ah("preprocess",C),ah("postprocess",C)]),Ej=(e,t)=>{let o=r1("RepresentingConfigs.memento processors",EW,t);return gU.config({store:{mode:"manual",getValue:t=>{let n=e.get(t),r=gU.getValue(n);return o.postprocess(r)},setValue:(t,n)=>{let r=o.preprocess(n),a=e.get(t);gU.setValue(a,r)}}})},EG=(e,t,o)=>gU.config({store:{mode:"manual",...e.map(e=>({initialValue:e})).getOr({}),getValue:t,setValue:o}}),E$=(e,t,o)=>EG(e,e=>t(e.element),(e,t)=>o(e.element,t)),Eq=e=>E$(e,sr,sa),EX=e=>E$(e,i3,i5),EK=e=>gU.config({store:{mode:"memory",initialValue:e}}),EY={memento:Ej,withElement:E$,withComp:EG,domValue:Eq,domHtml:EX,memory:EK},EJ={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"},EZ=e=>t=>e.translate(EJ[t]),EQ=(e,t,o)=>{let n=e=>"tox-"+e,r=Ez(EZ(t),n),a=e=>{iI(e,O4,{name:"hex-valid",value:!0})},i=e=>{iI(e,O4,{name:"hex-valid",value:!1})},l=v4(r.sketch({dom:{tag:"div",classes:[n("color-picker-container")],attributes:{role:"presentation"}},onValidHex:a,onInvalidHex:i}));return{dom:{tag:"div"},components:[l.asSpec()],behaviours:c2([EY.withComp(o,e=>{let t=l.get(e),o=pY.getCurrent(t),n=o.bind(e=>{let t=gU.getValue(e);return t.hex});return n.map(e=>"#"+eV(e,"#")).getOr("")},(e,t)=>{let o=B.from(/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/.exec(t)).bind(e=>ei(e,1)),n=l.get(e),r=pY.getCurrent(n);r.fold(()=>{console.log("Can not find form")},e=>{gU.setValue(e,{hex:o.getOr("")}),EM.getField(e,"hex").each(e=>{iF(e,a4())})})}),EU.self()])}};var E0=tinymce.util.Tools.resolve("tinymce.Resource");let E1=e=>eC(e,"init"),E2=e=>{let t=dR(),o=v4({dom:{tag:e.tag}}),n=dR();return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:c2([bG("custom-editor-events",[iZ(r=>{o.getOpt(r).each(o=>{(E1(e)?e.init(o.element.dom):E0.load(e.scriptId,e.scriptUrl).then(t=>t(o.element.dom,e.settings))).then(e=>{n.on(t=>{e.setValue(t)}),n.clear(),t.set(e)})})})]),EY.withComp(B.none(),()=>t.get().fold(()=>n.get().getOr(""),e=>e.getValue()),(e,o)=>{t.get().fold(()=>n.set(o),e=>e.setValue(o))}),EU.self()]),components:[o.asSpec()]}};var E3=tinymce.util.Tools.resolve("tinymce.util.Tools");let E5=(e,t)=>{let o=E3.explode(t.getOption("images_file_types")),n=e=>H(o,t=>eP(e.name.toLowerCase(),`.${t.toLowerCase()}`));return $(ec(e),n)},E9=(e,t,o)=>{let n=(e,t)=>{t.stop()},r=e=>(t,o)=>{W(e,e=>{e(t,o)})},a=(e,t)=>{var o;if(!ha.isDisabled(e)){let n=t.event.raw;l(e,null===(o=n.dataTransfer)||void 0===o?void 0:o.files)}},i=(e,t)=>{let o=t.event.raw.target;l(e,o.files)},l=(o,n)=>{n&&(gU.setValue(o,E5(n,t)),iI(o,O3,{name:e.name}))},s=v4({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:c2([bG("input-file-events",[iK(a8()),iK(im())])])}),c=e=>({uid:e.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:c2([EY.memory(o.getOr([])),EU.self(),ha.config({}),vs.config({toggleClass:"dragenter",toggleOnExecute:!1}),bG("dropzone-events",[iW("dragenter",r([n,vs.toggle])),iW("dragleave",r([n,vs.toggle])),iW("dragover",n),iW("drop",r([n,a])),iW(a6(),i)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p"},components:[s_(t.translate("Drop an image here"))]},v9.sketch({dom:{tag:"button",styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[s_(t.translate("Browse for an image")),s.asSpec()],action:e=>{let t=s.get(e);t.element.dom.click()},buttonBehaviours:c2([OK.config({}),SA.button(t.isDisabled),SO()])})]}]}),d=e.label.map(e=>O2(e,t)),u=OG.parts.field({factory:{sketch:c}});return OJ(d,u,["tox-form__group--stretched"],[])},E4=(e,t)=>({dom:{tag:"div",classes:["tox-form__grid",`tox-form__grid--${e.columns}col`]},components:U(e.items,t.interpreter)}),E6=lr("alloy-fake-before-tabstop"),E8=lr("alloy-fake-after-tabstop"),E7=e=>({dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:e},behaviours:c2([b0.config({ignore:!0}),OK.config({})])}),De=e=>({dom:{tag:"div",classes:["tox-navobj"]},components:[E7([E6]),e,E7([E8])],behaviours:c2([EU.childAt(1)])}),Dt=(e,t)=>{iI(e,a5(),{raw:{which:9,shiftKey:t}})},Do=(e,t)=>{let o=t.element;l8(o,E6)?Dt(e,!0):l8(o,E8)&&Dt(e,!1)},Dn=e=>Ob(e,["."+E6,"."+E8].join(","),A),Dr=e=>{let t=aC(e.getOr(""));return{getValue:e=>t.get(),setValue:(e,o)=>{t.get()!==o&&tH(e.element,"srcdoc",o),t.set(o)}}},Da=(e,t,o)=>{let n=e.sandboxed,r=e.transparent,a="tox-dialog__iframe",i={...e.label.map(e=>({title:e})).getOr({}),...o.map(e=>({srcdoc:e})).getOr({}),...n?{sandbox:"allow-scripts allow-same-origin"}:{}},l=Dr(o),s=e.label.map(e=>O2(e,t)),c=e=>De({uid:e.uid,dom:{tag:"iframe",attributes:i,classes:r?[a]:[a,`${a}--opaque`]},behaviours:c2([OK.config({}),b0.config({}),EY.withComp(o,l.getValue,l.setValue)])}),d=OG.parts.field({factory:{sketch:c}});return OJ(s,d,["tox-form__group--stretched"],[])},Di=e=>new Promise((t,o)=>{let n=()=>{a(),t(e)},r=[dN(e,"load",n),dN(e,"error",()=>{a(),o("Unable to load data from image: "+e.dom.src)})],a=()=>W(r,e=>e.unbind());e.dom.complete&&n()}),Dl=(e,t,o,n,r)=>{let a=o*r,i=n*r;return{left:Math.max(0,e/2-a/2).toString()+"px",top:Math.max(0,t/2-i/2).toString()+"px",width:a.toString()+"px",height:i.toString()+"px"}},Ds=(e,t,o)=>{let n=oi(e),r=t4(e);return Math.min(n/t,r/o,1)},Dc=(e,t)=>{let o=aC(t.getOr({url:""})),n=v4({dom:{tag:"img",classes:["tox-imagepreview__image"],attributes:t.map(e=>({src:e.url})).getOr({})}}),r=v4({dom:{tag:"div",classes:["tox-imagepreview__container"],attributes:{role:"presentation"}},components:[n.asSpec()]}),a=(e,t)=>{let a={url:t.url};t.zoom.each(e=>a.zoom=e),t.cachedWidth.each(e=>a.cachedWidth=e),t.cachedHeight.each(e=>a.cachedHeight=e),o.set(a);let i=()=>{let{cachedWidth:t,cachedHeight:o,zoom:n}=a;if(!g(t)&&!g(o)){if(g(n)){let n=Ds(e.element,t,o);a.zoom=n}let i=Dl(oi(e.element),t4(e.element),t,o,a.zoom);r.getOpt(e).each(e=>{tK(e.element,i)})}};n.getOpt(e).each(o=>{let n=o.element;t.url!==tP(n,"src")&&(tH(n,"src",t.url),l6(e.element,"tox-imagepreview__loaded")),i(),Di(n).then(t=>{e.getSystem().isConnected()&&(l9(e.element,"tox-imagepreview__loaded"),a.cachedWidth=t.dom.naturalWidth,a.cachedHeight=t.dom.naturalHeight,i())})})},i={};e.height.each(e=>i.height=e);let l=t.map(e=>({url:e.url,zoom:B.from(e.zoom),cachedWidth:B.from(e.cachedWidth),cachedHeight:B.from(e.cachedHeight)}));return{dom:{tag:"div",classes:["tox-imagepreview"],styles:i,attributes:{role:"presentation"}},components:[r.asSpec()],behaviours:c2([EU.self(),EY.withComp(l,()=>o.get(),a)])}},Dd=(e,t)=>{let o={dom:{tag:"label",classes:["tox-label"]},components:[s_(t.providers.translate(e.label))]},n=U(e.items,t.interpreter);return{dom:{tag:"div",classes:["tox-form__group"]},components:[o,...n],behaviours:c2([EU.self(),bW.config({}),EY.domHtml(B.none()),bD.config({mode:"acyclic"})])}},Du=lr("toolbar.button.execute"),Dm=e=>i1((t,o)=>{SM(e,t)(o=>{iI(t,Du,{buttonApi:o}),e.onAction(o)})}),Dg=lr("common-button-display-events"),Dp={[id()]:["disabling","alloy.base.behaviour","toggling","toolbar-button-events"],[iS()]:["toolbar-button-events",Dg],[aJ()]:["focusing","alloy.base.behaviour",Dg]},Dh=e=>tX(e.element,"width",tJ(e.element,"width")),Df=(e,t,o)=>ys(e,{tag:"span",classes:["tox-icon","tox-tbtn__icon-wrap"],behaviours:o},t),Db=(e,t)=>Df(e,t,[]),Dv=(e,t)=>Df(e,t,[bW.config({})]),Dy=(e,t,o)=>({dom:{tag:"span",classes:[`${t}__select-label`]},components:[s_(o.translate(e))],behaviours:c2([bW.config({})])}),Dx=lr("update-menu-text"),Dw=lr("update-menu-icon"),DS=(e,t,o)=>{let n=aC(y),r=e.text.map(e=>v4(Dy(e,t,o.providers))),a=e.icon.map(e=>v4(Dv(e,o.providers.icons))),i=(e,t)=>{let o=gU.getValue(e);return b0.focus(o),iI(o,"keydown",{raw:t.event.raw}),C5.close(o),B.some(!0)},l=e.role.fold(()=>({}),e=>({role:e})),s=e.tooltip.fold(()=>({}),e=>{let t=o.providers.translate(e);return{title:t,"aria-label":t}}),c=ys("chevron-down",{tag:"div",classes:[`${t}__select-chevron`]},o.providers.icons),d=lr("common-button-display-events"),u=v4(C5.sketch({...e.uid?{uid:e.uid}:{},...l,dom:{tag:"button",classes:[t,`${t}--select`].concat(U(e.classes,e=>`${t}--${e}`)),attributes:{...s}},components:eE([a.map(e=>e.asSpec()),r.map(e=>e.asSpec()),B.some(c)]),matchWidth:!0,useMinWidth:!0,onOpen:(t,o,n)=>{e.searchable&&Oo(n)},dropdownBehaviours:c2([...e.dropdownBehaviours,SA.button(()=>e.disabled||o.providers.isDisabled()),SO(),_v.config({}),bW.config({}),bG("dropdown-events",[SB(e,n),SF(e,n)]),bG(d,[iZ((e,t)=>Dh(e))]),bG("menubutton-update-display-text",[iW(Dx,(e,t)=>{r.bind(t=>t.getOpt(e)).each(e=>{bW.set(e,[s_(o.providers.translate(t.event.text))])})}),iW(Dw,(e,t)=>{a.bind(t=>t.getOpt(e)).each(e=>{bW.set(e,[Dv(t.event.icon,o.providers.icons)])})})])]),eventOrder:rn(Dp,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"],[iS()]:["toolbar-button-events","dropdown-events",d]}),sandboxBehaviours:c2([bD.config({mode:"special",onLeft:i,onRight:i}),bG("dropdown-sandbox-events",[iW(xz,(e,t)=>{C4(e),t.stop()}),iW(xH,(e,t)=>{C6(e,t),t.stop()})])]),lazySink:o.getSink,toggleClass:`${t}--active`,parts:{menu:{...xM(!1,e.columns,e.presets),fakeFocus:e.searchable,onHighlightItem:Oe,onCollapseMenu:(e,t,o)=>{hO.getHighlighted(o).each(t=>{Oe(e,o,t)})},onDehighlightItem:Ot}},fetch:t=>CL.nu(_(e.fetch,t))}));return u.asSpec()},Dk=e=>l(e),DC=e=>"separator"===e.type,DO=e=>eC(e,"getSubmenuItems"),D_={type:"separator"},DT=(e,t)=>{let o=X(e,(e,o)=>Dk(o)?""===o?e:"|"===o?e.length>0&&!DC(e[e.length-1])?e.concat([D_]):e:eC(t,o.toLowerCase())?e.concat([t[o.toLowerCase()]]):e:e.concat([o]),[]);return o.length>0&&DC(o[o.length-1])&&o.pop(),o},DE=(e,t)=>{let o=e.getSubmenuItems(),n=DA(o,t),r=rn(n.menus,{[e.value]:n.items}),a=rn(n.expansions,{[e.value]:e.value});return{item:e,menus:r,expansions:a}},DD=e=>{let t=ek(e,"value").getOrThunk(()=>lr("generated-menu-item"));return rn({value:t},e)},DA=(e,t)=>{let o=DT(l(e)?e.split(" "):e,t);return q(o,(e,o)=>{if(!DO(o))return{...e,items:[o,...e.items]};{let n=DD(o),r=DE(n,t);return{menus:rn(e.menus,r.menus),items:[r.item,...e.items],expansions:rn(e.expansions,r.expansions)}}},{menus:{},expansions:{},items:[]})},DM=e=>e.search.fold(()=>({searchMode:"no-search"}),e=>({searchMode:"search-with-field",placeholder:e.placeholder})),DB=e=>e.search.fold(()=>({searchMode:"no-search"}),e=>({searchMode:"search-with-results"})),DF=(e,t,o,n)=>{let r=lr("primary-menu"),a=DA(e,o.shared.providers.menuItems());if(0===a.items.length)return B.none();let i=DM(n),l=Oi(r,a.items,t,o,n.isHorizontalMenu,i),s=DB(n),c=ep(a.menus,(e,n)=>Oi(n,e,t,o,!1,s)),d=rn(c,aB(r,l));return B.from(vQ.tieredData(r,d,a.expansions))},DI=e=>!eC(e,"items"),DR="data-value",DN=(e,t,o,n)=>U(o,o=>DI(o)?{type:"togglemenuitem",text:o.text,value:o.value,active:o.value===n,onAction:()=>{gU.setValue(e,o.value),iI(e,O3,{name:t}),b0.focus(e)}}:{type:"nestedmenuitem",text:o.text,getSubmenuItems:()=>DN(e,t,o.items,n)}),DV=(e,t)=>ed(e,e=>DI(e)?eF(e.value===t,e):DV(e.items,t)),Dz=(e,t,o)=>{let n=t.shared.providers,r=o.bind(t=>DV(e.items,t)).orThunk(()=>el(e.items).filter(DI)),a=e.label.map(e=>O2(e,n)),i=OG.parts.field({dom:{},factory:{sketch:o=>DS({uid:o.uid,text:r.map(e=>e.text),icon:B.none(),tooltip:e.label,role:B.none(),fetch:(o,n)=>{let r=DN(o,e.name,e.items,gU.getValue(o));n(DF(r,xg.CLOSE_ON_EXECUTE,t,{isHorizontalMenu:!1,search:B.none()}))},onSetup:k(y),getApi:k({}),columns:1,presets:"normal",classes:[],dropdownBehaviours:[OK.config({}),EY.withComp(r.map(e=>e.value),e=>tP(e.element,DR),(t,o)=>{DV(e.items,o).each(e=>{tH(t.element,DR,e.value),iI(t,Dx,{text:e.text})})})]},"tox-listbox",t.shared)}});return OG.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:Z([a.toArray(),[{dom:{tag:"div",classes:["tox-listboxfield"]},components:[i]}]]),fieldBehaviours:c2([ha.config({disabled:k(!e.enabled),onDisabled:e=>{OG.getField(e).each(ha.disable)},onEnabled:e=>{OG.getField(e).each(ha.enable)}})])})},DH=(e,t)=>({dom:{tag:"div",classes:e.classes},components:U(e.items,t.shared.interpreter)}),DL=(e,t)=>{let o=U(e.options,e=>({dom:{tag:"option",value:e.value,innerHtml:e.text}})),n=e.data.map(e=>aB("initialValue",e)).getOr({});return{uid:e.uid,dom:{tag:"select",classes:e.selectClasses,attributes:e.selectAttributes},components:o,behaviours:gG(e.selectBehaviours,[b0.config({}),gU.config({store:{mode:"manual",getValue:e=>sr(e.element),setValue:(t,o)=>{let n=Y(e.options,e=>e.value===o);n.isSome()&&sa(t.element,o)},...n}})])}},DP=pj({name:"HtmlSelect",configFields:[r4("options"),gW("selectBehaviours",[b0,gU]),ah("selectClasses",[]),ah("selectAttributes",{}),ai("data")],factory:DL}),DU=(e,t,o)=>{let n=U(e.items,e=>({text:t.translate(e.text),value:e.value})),r=e.label.map(e=>O2(e,t)),a=OG.parts.field({dom:{},...o.map(e=>({data:e})).getOr({}),selectAttributes:{size:e.size},options:n,factory:DP,selectBehaviours:c2([ha.config({disabled:()=>!e.enabled||t.isDisabled()}),OK.config({}),bG("selectbox-change",[iW(a6(),(t,o)=>{iI(t,O3,{name:e.name})})])])}),i=e.size>1?B.none():B.some(ys("chevron-down",{tag:"div",classes:["tox-selectfield__icon-js"]},t.icons)),l={dom:{tag:"div",classes:["tox-selectfield"]},components:Z([[a],i.toArray()])};return OG.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:Z([r.toArray(),[l]]),fieldBehaviours:c2([ha.config({disabled:()=>!e.enabled||t.isDisabled(),onDisabled:e=>{OG.getField(e).each(ha.disable)},onEnabled:e=>{OG.getField(e).each(ha.enable)}}),SO()])})},DW=k([ah("field1Name","field1"),ah("field2Name","field2"),s7("onLockedChange"),s9(["lockClass"]),ah("locked",!1),g$.field("coupledFieldBehaviours",[pY,gU])]),Dj=(e,t,o)=>p_(e,t,o).bind(pY.getCurrent),DG=(e,t)=>pu({factory:OG,name:e,overrides:e=>({fieldBehaviours:c2([bG("coupled-input-behaviour",[iW(a4(),o=>{Dj(o,e,t).each(t=>{p_(o,e,"lock").each(n=>{vs.isOn(n)&&e.onLockedChange(o,t,n)})})})])])})}),D$=k([DG("field1","field2"),DG("field2","field1"),pu({factory:v9,schema:[r4("dom")],name:"lock",overrides:e=>({buttonBehaviours:c2([vs.config({selected:e.locked,toggleClass:e.markers.lockClass,aria:{mode:"pressed"}})])})})]),Dq=(e,t,o,n)=>({uid:e.uid,dom:e.dom,components:t,behaviours:g$.augment(e.coupledFieldBehaviours,[pY.config({find:B.some}),gU.config({store:{mode:"manual",getValue:t=>{let o=pM(t,e,["field1","field2"]);return{[e.field1Name]:gU.getValue(o.field1()),[e.field2Name]:gU.getValue(o.field2())}},setValue:(t,o)=>{let n=pM(t,e,["field1","field2"]);eO(o,e.field1Name)&&gU.setValue(n.field1(),o[e.field1Name]),eO(o,e.field2Name)&&gU.setValue(n.field2(),o[e.field2Name])}}})]),apis:{getField1:t=>p_(t,e,"field1"),getField2:t=>p_(t,e,"field2"),getLock:t=>p_(t,e,"lock")}}),DX=pG({name:"FormCoupledInputs",configFields:DW(),partFields:D$(),factory:Dq,apis:{getField1:(e,t)=>e.getField1(t),getField2:(e,t)=>e.getField2(t),getLock:(e,t)=>e.getLock(t)}}),DK=e=>{var t;let o={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,in:4,"%":4},n=e.value.toFixed((t=e.unit)in o?o[t]:1);return -1!==n.indexOf(".")&&(n=n.replace(/\.?0*$/,"")),n+e.unit},DY=e=>{let t=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/.exec(e);if(null===t)return nY.error(e);{let e=parseFloat(t[1]),o=t[2];return nY.value({value:e,unit:o})}},DJ=(e,t)=>{let o={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,in:1},n=e=>eC(o,e);return e.unit===t?B.some(e.value):n(e.unit)&&n(t)?o[e.unit]===o[t]?B.some(e.value):B.some(e.value/o[e.unit]*o[t]):B.none()},DZ=e=>B.none(),DQ=(e,t)=>o=>DJ(o,t).map(o=>({value:o*e,unit:t})),D0=(e,t)=>{let o=DY(e).toOptional(),n=DY(t).toOptional();return eA(o,n,(e,t)=>DJ(e,t.unit).map(e=>t.value/e).map(e=>DQ(e,t.unit)).getOr(DZ)).getOr(DZ)},D1=(e,t)=>{let o=DZ,n=lr("ratio-event"),r=e=>ys(e,{tag:"span",classes:["tox-icon","tox-lock-icon__"+e]},t.icons),a=DX.parts.lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:t.translate(e.label.getOr("Constrain proportions"))}},components:[r("lock"),r("unlock")],buttonBehaviours:c2([ha.config({disabled:()=>!e.enabled||t.isDisabled()}),SO(),OK.config({})])}),i=e=>({dom:{tag:"div",classes:["tox-form__group"]},components:e}),l=o=>OG.parts.field({factory:xV,inputClasses:["tox-textfield"],inputBehaviours:c2([ha.config({disabled:()=>!e.enabled||t.isDisabled()}),SO(),OK.config({}),bG("size-input-events",[iW(a2(),(e,t)=>{iI(e,n,{isField1:o})}),iW(a6(),(t,o)=>{iI(t,O3,{name:e.name})})])]),selectOnFocus:!1}),s=e=>({dom:{tag:"label",classes:["tox-label"]},components:[s_(t.translate(e))]}),c=DX.parts.field1(i([OG.parts.label(s("Width")),l(!0)])),d=DX.parts.field2(i([OG.parts.label(s("Height")),l(!1)]));return DX.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[c,d,i([s("\xa0"),a])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:(e,t,n)=>{DY(gU.getValue(e)).each(e=>{o(e).each(e=>{gU.setValue(t,DK(e))})})},coupledFieldBehaviours:c2([ha.config({disabled:()=>!e.enabled||t.isDisabled(),onDisabled:e=>{DX.getField1(e).bind(OG.getField).each(ha.disable),DX.getField2(e).bind(OG.getField).each(ha.disable),DX.getLock(e).each(ha.disable)},onEnabled:e=>{DX.getField1(e).bind(OG.getField).each(ha.enable),DX.getField2(e).bind(OG.getField).each(ha.enable),DX.getLock(e).each(ha.enable)}}),SO(),bG("size-input-events2",[iW(n,(e,t)=>{let n=t.event.isField1,r=n?DX.getField1(e):DX.getField2(e),a=n?DX.getField2(e):DX.getField1(e),i=r.map(gU.getValue).getOr(""),l=a.map(gU.getValue).getOr("");o=D0(i,l)})])])})},D2=(e,t,o)=>{let n=Ex.parts.label({dom:{tag:"label",classes:["tox-label"]},components:[s_(t.translate(e.label))]}),r=Ex.parts.spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),a=Ex.parts.thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}});return Ex.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:e.min,maxX:e.max,getInitialValue:k(o.getOrThunk(()=>(Math.abs(e.max)-Math.abs(e.min))/2))},components:[n,r,a],sliderBehaviours:c2([EU.self(),b0.config({})]),onChoose:(t,o,n)=>{iI(t,O3,{name:e.name,value:n})}})},D3=(e,t)=>{let o=e=>({dom:{tag:"th",innerHtml:t.translate(e)}}),n=e=>({dom:{tag:"td",innerHtml:t.translate(e)}}),r=e=>({dom:{tag:"tr"},components:U(e,n)});return{dom:{tag:"table",classes:["tox-dialog__table"]},components:[{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:U(e.header,o)}]},{dom:{tag:"tbody"},components:U(e.cells,r)}],behaviours:c2([OK.config({}),b0.config({})])}},D5=(e,t)=>{let o=e.label.map(e=>O2(e,t)),n=[ha.config({disabled:()=>e.disabled||t.isDisabled()}),SO(),bD.config({mode:"execution",useEnter:!0!==e.multiline,useControlEnter:!0===e.multiline,execute:e=>(iF(e,O6),B.some(!0))}),bG("textfield-change",[iW(a4(),(t,o)=>{iI(t,O3,{name:e.name})}),iW(is(),(t,o)=>{iI(t,O3,{name:e.name})})]),OK.config({})],r=e.validation.map(e=>_p.config({getRoot:e=>tf(e.element),invalidClass:"tox-invalid",validator:{validate:t=>{let o=gU.getValue(t),n=e.validator(o);return CL.pure(!0===n?nY.value(o):nY.error(n))},validateOnLoad:e.validateOnLoad}})).toArray(),a=e.placeholder.fold(k({}),e=>({placeholder:t.translate(e)})),i=e.inputMode.fold(k({}),e=>({inputmode:e})),l={...a,...i},s=OG.parts.field({tag:!0===e.multiline?"textarea":"input",...e.data.map(e=>({data:e})).getOr({}),inputAttributes:l,inputClasses:[e.classname],inputBehaviours:c2(Z([n,r])),selectOnFocus:!1,factory:xV}),c=e.multiline?{dom:{tag:"div",classes:["tox-textarea-wrap"]},components:[s]}:s,d=e.flex?["tox-form__group--stretched"]:[],u=d.concat(e.maximized?["tox-form-group--maximize"]:[]),m=[ha.config({disabled:()=>e.disabled||t.isDisabled(),onDisabled:e=>{OG.getField(e).each(ha.disable)},onEnabled:e=>{OG.getField(e).each(ha.enable)}}),SO()];return OJ(o,c,u,m)},D9=(e,t,o)=>D5({name:e.name,multiline:!1,label:e.label,inputMode:e.inputMode,placeholder:e.placeholder,flex:!1,disabled:!e.enabled,classname:"tox-textfield",validation:B.none(),maximized:e.maximized,data:o},t),D4=(e,t,o)=>D5({name:e.name,multiline:!0,label:e.label,inputMode:B.none(),placeholder:e.placeholder,flex:!0,disabled:!e.enabled,classname:"tox-textarea",validation:B.none(),maximized:e.maximized,data:o},t),D6=(e,t)=>t.getAnimationRoot.fold(()=>e.element,t=>t(e)),D8=e=>e.dimension.property,D7=(e,t)=>e.dimension.getDimension(t),Ae=(e,t)=>{let o=D6(e,t);se(o,[t.shrinkingClass,t.growingClass])},At=(e,t)=>{l6(e.element,t.openClass),l9(e.element,t.closedClass),tX(e.element,D8(t),"0px"),t3(e.element)},Ao=(e,t)=>{l6(e.element,t.closedClass),l9(e.element,t.openClass),t2(e.element,D8(t))},An=(e,t,o,n)=>{o.setCollapsed(),tX(e.element,D8(t),D7(t,e.element)),Ae(e,t),At(e,t),t.onStartShrink(e),t.onShrunk(e)},Ar=(e,t,o,n)=>{let r=n.getOrThunk(()=>D7(t,e.element));o.setCollapsed(),tX(e.element,D8(t),r),t3(e.element);let a=D6(e,t);l6(a,t.growingClass),l9(a,t.shrinkingClass),At(e,t),t.onStartShrink(e)},Aa=(e,t,o)=>{let n=D7(t,e.element);("0px"===n?An:Ar)(e,t,o,B.some(n))},Ai=(e,t,o)=>{let n=D6(e,t),r=l8(n,t.shrinkingClass),a=D7(t,e.element);Ao(e,t);let i=D7(t,e.element),l=()=>{tX(e.element,D8(t),a),t3(e.element)},s=()=>{At(e,t)};(r?l:s)(),l6(n,t.shrinkingClass),l9(n,t.growingClass),Ao(e,t),tX(e.element,D8(t),i),o.setExpanded(),t.onStartGrow(e)},Al=(e,t,o)=>{if(o.isExpanded()){t2(e.element,D8(t));let o=D7(t,e.element);tX(e.element,D8(t),o)}},As=(e,t,o)=>{o.isExpanded()||Ai(e,t,o)},Ac=(e,t,o)=>{o.isExpanded()&&Aa(e,t,o)},Ad=(e,t,o)=>{o.isExpanded()&&An(e,t,o)},Au=(e,t,o)=>o.isExpanded(),Am=(e,t,o)=>o.isCollapsed(),Ag=(e,t,o)=>{let n=D6(e,t);return!0===l8(n,t.growingClass)},Ap=(e,t,o)=>{let n=D6(e,t);return!0===l8(n,t.shrinkingClass)},Ah=(e,t,o)=>Ag(e,t)||Ap(e,t),Af=(e,t,o)=>{let n=o.isExpanded()?Aa:Ai;n(e,t,o)},Ab=(e,t,o)=>{o.isExpanded()||(Ao(e,t),tX(e.element,D8(t),D7(t,e.element)),Ae(e,t),o.setExpanded(),t.onStartGrow(e),t.onGrown(e))};var Av=Object.freeze({__proto__:null,refresh:Al,grow:As,shrink:Ac,immediateShrink:Ad,hasGrown:Au,hasShrunk:Am,isGrowing:Ag,isShrinking:Ap,isTransitioning:Ah,toggleGrow:Af,disableTransitions:Ae,immediateGrow:Ab});let Ay=(e,t,o)=>{let n=t.expanded;return n?lA({classes:[t.openClass],styles:{}}):lA({classes:[t.closedClass],styles:aB(t.dimension.property,"0px")})},Ax=(e,t)=>iL([iJ(ie(),(o,n)=>{let r=n.event.raw;if(r.propertyName===e.dimension.property){Ae(o,e),t.isExpanded()&&t2(o.element,e.dimension.property);let n=t.isExpanded()?e.onGrown:e.onShrunk;n(o)}})]);var Aw=Object.freeze({__proto__:null,exhibit:Ay,events:Ax}),AS=[r4("closedClass"),r4("openClass"),r4("shrinkingClass"),r4("growingClass"),ai("getAnimationRoot"),s6("onShrunk"),s6("onStartShrink"),s6("onGrown"),s6("onStartGrow"),ah("expanded",!1),r6("dimension",r3("property",{width:[ct("property","width"),ct("getDimension",e=>oi(e)+"px")],height:[ct("property","height"),ct("getDimension",e=>t4(e)+"px")]}))];let Ak=e=>{let t=aC(e.expanded),o=()=>"expanded: "+t.get();return lO({isExpanded:()=>!0===t.get(),isCollapsed:()=>!1===t.get(),setCollapsed:_(t.set,!1),setExpanded:_(t.set,!0),readState:o})};var AC=Object.freeze({__proto__:null,init:Ak});let AO=c5({fields:AS,name:"sliding",active:Aw,apis:Av,state:AC}),A_=e=>({isEnabled:()=>!ha.isDisabled(e),setEnabled:t=>ha.set(e,!t),setActive:t=>{let o=e.element;t?(l9(o,"tox-tbtn--enabled"),tH(o,"aria-pressed",!0)):(l6(o,"tox-tbtn--enabled"),tj(o,"aria-pressed"))},isActive:()=>l8(e.element,"tox-tbtn--enabled"),setText:t=>{iI(e,Dx,{text:t})},setIcon:t=>iI(e,Dw,{icon:t})}),AT=(e,t,o,n,r=!0)=>DS({text:e.text,icon:e.icon,tooltip:e.tooltip,searchable:e.search.isSome(),role:n,fetch:(t,n)=>{let r={pattern:e.search.isSome()?On(t):""};e.fetch(t=>{n(DF(t,xg.CLOSE_ON_EXECUTE,o,{isHorizontalMenu:!1,search:e.search}))},r,A_(t))},onSetup:e.onSetup,getApi:A_,columns:1,presets:"normal",classes:[],dropdownBehaviours:[...r?[OK.config({})]:[]]},t,o.shared),AE=(e,t,o)=>{let n=e=>n=>{let r=!n.isActive();n.setActive(r),e.storage.set(r),o.shared.getSink().each(o=>{t().getOpt(o).each(t=>{dt(t.element),iI(t,O4,{name:e.name,value:e.storage.get()})})})},r=e=>t=>{t.setActive(e.storage.get())};return t=>{t(U(e,e=>{let t=e.text.fold(()=>({}),e=>({text:e}));return{type:e.type,active:!1,...t,onAction:n(e),onSetup:r(e)}}))}},AD=e=>({dom:{tag:"span",classes:["tox-tree__label"],attributes:{title:e,"aria-label":e}},components:[s_(e)]}),AA=lr("leaf-label-event-id"),AM=({leaf:e,onLeafAction:t,visible:o,treeId:n,backstage:r})=>{let a=e.menu.map(e=>AT(e,"tox-mbtn",r,B.none(),o)),i=[AD(e.title)];return a.each(e=>i.push(e)),v9.sketch({dom:{tag:"div",classes:["tox-tree--leaf__label","tox-trbtn"].concat(o?["tox-tree--leaf__label--visible"]:[])},components:i,role:"treeitem",action:o=>{t(e.id),o.getSystem().broadcastOn([`update-active-item-${n}`],{value:e.id})},eventOrder:{[a5()]:[AA,"keying"]},buttonBehaviours:c2([...o?[OK.config({})]:[],vs.config({toggleClass:"tox-trbtn--enabled",toggleOnExecute:!1,aria:{mode:"selected"}}),c8.config({channels:{[`update-active-item-${n}`]:{onReceive:(t,o)=>{(o.value===e.id?vs.on:vs.off)(t)}}}}),bG(AA,[iW(a5(),(e,t)=>{let o="ArrowLeft"===t.event.raw.code,n="ArrowRight"===t.event.raw.code;o?(sV(e.element,".tox-tree--directory").each(t=>{e.getSystem().getByDom(t).each(e=>{sz(t,".tox-tree--directory__label").each(t=>{e.getSystem().getByDom(t).each(b0.focus)})})}),t.stop()):n&&t.stop()})])])})},AB=(e,t,o)=>ys(e,{tag:"span",classes:["tox-tree__icon-wrap","tox-icon"],behaviours:o},t),AF=(e,t)=>AB(e,t,[]),AI=lr("directory-label-event-id"),AR=({directory:e,visible:t,noChildren:o,backstage:n})=>{let r=e.menu.map(e=>AT(e,"tox-mbtn",n,B.none())),a=[{dom:{tag:"div",classes:["tox-chevron"]},components:[AF("chevron-right",n.shared.providers.icons)]},AD(e.title)];r.each(e=>{a.push(e)});let i=e=>{sV(e.element,".tox-tree--directory").each(t=>{e.getSystem().getByDom(t).each(e=>vs.toggle(e))})};return v9.sketch({dom:{tag:"div",classes:["tox-tree--directory__label","tox-trbtn"].concat(t?["tox-tree--directory__label--visible"]:[])},components:a,action:i,eventOrder:{[a5()]:[AI,"keying"]},buttonBehaviours:c2([...t?[OK.config({})]:[],bG(AI,[iW(a5(),(e,t)=>{let n="ArrowRight"===t.event.raw.code,r="ArrowLeft"===t.event.raw.code;n&&o&&t.stop(),(n||r)&&sV(e.element,".tox-tree--directory").each(o=>{e.getSystem().getByDom(o).each(o=>{!vs.isOn(o)&&n||vs.isOn(o)&&r?(i(e),t.stop()):r&&!vs.isOn(o)&&(sV(o.element,".tox-tree--directory").each(e=>{sz(e,".tox-tree--directory__label").each(e=>{o.getSystem().getByDom(e).each(b0.focus)})}),t.stop())})})})])])})},AN=({children:e,onLeafAction:t,visible:o,treeId:n,backstage:r})=>({dom:{tag:"div",classes:["tox-tree--directory__children"]},components:e.map(e=>"leaf"===e.type?AM({leaf:e,onLeafAction:t,visible:o,treeId:n,backstage:r}):AV({directory:e,onLeafAction:t,labelTabstopping:o,treeId:n,backstage:r})),behaviours:c2([AO.config({dimension:{property:"height"},closedClass:"tox-tree--directory__children--closed",openClass:"tox-tree--directory__children--open",growingClass:"tox-tree--directory__children--growing",shrinkingClass:"tox-tree--directory__children--shrinking"}),bW.config({})])}),AV=({directory:e,onLeafAction:t,labelTabstopping:o,treeId:n,backstage:r})=>{let{children:a}=e,i=e=>a.map(o=>"leaf"===o.type?AM({leaf:o,onLeafAction:t,visible:e,treeId:n,backstage:r}):AV({directory:o,onLeafAction:t,labelTabstopping:e,treeId:n,backstage:r}));return{dom:{tag:"div",classes:["tox-tree--directory"],attributes:{role:"treeitem"}},components:[AR({directory:e,visible:o,noChildren:0===e.children.length,backstage:r}),AN({children:a,onLeafAction:t,visible:!1,treeId:n,backstage:r})],behaviours:c2([vs.config({...e.children.length>0?{aria:{mode:"expanded"}}:{},toggleClass:"tox-tree--directory--expanded",onToggled:(e,t)=>{let o=e.components()[1],n=i(t);t?AO.grow(o):AO.shrink(o),bW.set(o,n)}})])}},Az=(e,t)=>{let o=e.onLeafAction.getOr(y),n=lr("tree-id"),r=e.items.map(e=>"leaf"===e.type?AM({leaf:e,onLeafAction:o,visible:!0,treeId:n,backstage:t}):AV({directory:e,onLeafAction:o,labelTabstopping:!0,treeId:n,backstage:t}));return{dom:{tag:"div",classes:["tox-tree"],attributes:{role:"tree"}},components:r,behaviours:c2([bD.config({mode:"flow",selector:".tox-tree--leaf__label--visible, .tox-tree--directory__label--visible",cycles:!1})])}},AH=(e,t)=>{let o=e.stream.streams,n=o.setup(e,t);return iL([iW(e.event,n),iQ(()=>t.cancel())].concat(e.cancelEvent.map(e=>[iW(e,()=>t.cancel())]).getOr([])))};var AL=Object.freeze({__proto__:null,events:AH});let AP=(e,t)=>{let o=null,n=()=>{u(o)||(clearTimeout(o),o=null)},r=(...n)=>{u(o)&&(o=setTimeout(()=>{o=null,e.apply(null,n)},t))};return{cancel:n,throttle:r}},AU=(e,t)=>{let o=null,n=()=>{u(o)||(clearTimeout(o),o=null)},r=(...r)=>{n(),o=setTimeout(()=>{o=null,e.apply(null,r)},t)};return{cancel:n,throttle:r}},AW=e=>{let t=aC(null),o=()=>({timer:null!==t.get()?"set":"unset"}),n=e=>{t.set(e)},r=()=>{let e=t.get();null!==e&&e.cancel()};return lO({readState:o,setTimer:n,cancel:r})},Aj=e=>e.stream.streams.state(e);var AG=Object.freeze({__proto__:null,throttle:AW,init:Aj});let A$=(e,t)=>{let o=e.stream,n=AU(e.onStream,o.delay);return t.setTimer(n),(e,t)=>{n.throttle(e,t),o.stopEvent&&t.stop()}};var Aq=[r6("stream",r3("mode",{throttle:[r4("delay"),ah("stopEvent",!0),ct("streams",{setup:A$,state:AW})]})),ah("event","input"),ai("cancelEvent"),s7("onStream")];let AX=c5({fields:Aq,name:"streaming",active:AL,state:AG}),AK=(e,t,o)=>{let n=gU.getValue(o);gU.setValue(t,n),AJ(t)},AY=(e,t)=>{let o=e.element,n=sr(o),r=o.dom;"number"!==tP(o,"type")&&t(r,n)},AJ=e=>{AY(e,(e,t)=>e.setSelectionRange(t.length,t.length))},AZ=(e,t)=>{AY(e,(e,o)=>e.setSelectionRange(t,o.length))},AQ=(e,t,o)=>{if(!e.selectsOver)return B.none();{let n=gU.getValue(t),r=e.getDisplayText(n),a=gU.getValue(o),i=e.getDisplayText(a);return 0===i.indexOf(r)?B.some(()=>{AK(e,t,o),AZ(t,r.length)}):B.none()}},A0=k("alloy.typeahead.itemexecute"),A1=(e,t,o,n)=>{let r=(t,o,r)=>{e.previewing.set(!1);let a=CB.getCoupled(t,"sandbox");if(gs.isOpen(a))pY.getCurrent(a).each(e=>{hO.getHighlighted(e).fold(()=>{r(e)},()=>{iH(a,e.element,"keydown",o)})});else{let o=e=>{pY.getCurrent(e).each(r)};C$(e,i(t),t,a,n,o,nD.HighlightMenuAndItem).get(y)}},a=xF(e),i=e=>t=>t.map(t=>{let o=eS(t.menus),n=Q(o,e=>$(e.items,e=>"item"===e.type)),r=gU.getState(e);return r.update(U(n,e=>e.data)),t}),l=e=>pY.getCurrent(e),s="typeaheadevents",c=[b0.config({}),gU.config({onSetValue:e.onSetValue,store:{mode:"dataset",getDataKey:e=>sr(e.element),getFallbackEntry:e=>({value:e,meta:{}}),setValue:(t,o)=>{sa(t.element,e.model.getDisplayText(o))},...e.initialData.map(e=>aB("initialValue",e)).getOr({})}}),AX.config({stream:{mode:"throttle",delay:e.responseTime,stopEvent:!1},onStream:(t,o)=>{let r=CB.getCoupled(t,"sandbox"),a=b0.isFocused(t);if(a&&sr(t.element).length>=e.minChars){let o=l(r).bind(e=>hO.getHighlighted(e).map(gU.getValue));e.previewing.set(!0);let a=t=>{l(r).each(t=>{o.fold(()=>{e.model.selectsOver&&hO.highlightFirst(t)},e=>{hO.highlightBy(t,t=>{let o=gU.getValue(t);return o.value===e.value}),hO.getHighlighted(t).orThunk(()=>(hO.highlightFirst(t),B.none()))})})};C$(e,i(t),t,r,n,a,nD.HighlightJustMenu).get(y)}},cancelEvent:ih()}),bD.config({mode:"special",onDown:(e,t)=>(r(e,t,hO.highlightFirst),B.some(!0)),onEscape:e=>{let t=CB.getCoupled(e,"sandbox");return gs.isOpen(t)?(gs.close(t),B.some(!0)):B.none()},onUp:(e,t)=>(r(e,t,hO.highlightLast),B.some(!0)),onEnter:t=>{let o=CB.getCoupled(t,"sandbox"),n=gs.isOpen(o);if(n&&!e.previewing.get())return l(o).bind(e=>hO.getHighlighted(e)).map(e=>(iI(t,A0(),{item:e}),!0));{let r=gU.getValue(t);return iF(t,ih()),e.onExecute(o,t,r),n&&gs.close(o),B.some(!0)}}}),vs.config({toggleClass:e.markers.openClass,aria:{mode:"expanded"}}),CB.config({others:{sandbox:t=>CZ(e,t,{onOpen:()=>vs.on(t),onClose:()=>vs.off(t)})}}),bG(s,[iZ(t=>{e.lazyTypeaheadComp.set(B.some(t))}),iQ(t=>{e.lazyTypeaheadComp.set(B.none())}),i1(t=>{CX(e,i(t),t,n,y,nD.HighlightMenuAndItem).get(y)}),iW(A0(),(t,o)=>{let n=CB.getCoupled(t,"sandbox");AK(e.model,t,o.event.item),iF(t,ih()),e.onItemExecute(t,n,o.event.item,gU.getValue(t)),gs.close(n),AJ(t)})].concat(e.dismissOnBlur?[iW(il(),e=>{let t=CB.getCoupled(e,"sandbox");di(t.element).isNone()&&gs.close(t)})]:[]))],d={[ik()]:[gU.name(),AX.name(),s],...e.eventOrder};return{uid:e.uid,dom:xR(rn(e,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:{...a,...gG(e.typeaheadBehaviours,c)},eventOrder:d}},A2=k([ai("lazySink"),r4("fetch"),ah("minChars",5),ah("responseTime",1e3),s6("onOpen"),ah("getHotspot",B.some),ah("getAnchorOverrides",k({})),ah("layouts",B.none()),ah("eventOrder",{}),ak("model",{},[ah("getDisplayText",e=>void 0!==e.meta&&void 0!==e.meta.text?e.meta.text:e.value),ah("selectsOver",!0),ah("populateFromBrowse",!0)]),s6("onSetValue"),s8("onExecute"),s6("onItemExecute"),ah("inputClasses",[]),ah("inputAttributes",{}),ah("inputStyles",{}),ah("matchWidth",!0),ah("useMinWidth",!1),ah("dismissOnBlur",!0),s9(["openClass"]),ai("initialData"),gW("typeaheadBehaviours",[b0,gU,AX,bD,vs,CB]),n7("lazyTypeaheadComp",()=>aC(B.none)),n7("previewing",()=>aC(!0))].concat(xB()).concat(C0())),A3=k([pm({schema:[s5()],name:"menu",overrides:e=>({fakeFocus:!0,onHighlightItem:(t,o,n)=>{e.previewing.get()?e.lazyTypeaheadComp.get().each(t=>{AQ(e.model,t,n).fold(()=>{e.model.selectsOver?(hO.dehighlight(o,n),e.previewing.set(!0)):e.previewing.set(!1)},t=>{t(),e.previewing.set(!1)})}):e.lazyTypeaheadComp.get().each(t=>{e.model.populateFromBrowse&&AK(e.model,t,n)})},onExecute:(t,o)=>e.lazyTypeaheadComp.get().map(e=>(iI(e,A0(),{item:o}),!0)),onHover:(t,o)=>{e.previewing.set(!1),e.lazyTypeaheadComp.get().each(t=>{e.model.populateFromBrowse&&AK(e.model,t,o)})}})})]),A5=pG({name:"Typeahead",configFields:A2(),partFields:A3(),factory:A1}),A9=e=>{let t=()=>A9(e.toCached()),o=t=>A9(e.bind(e=>e.fold(e=>CL.pure(nY.error(e)),e=>t(e)))),n=t=>A9(e.map(e=>e.bind(t))),r=t=>A9(e.map(e=>e.map(t))),a=t=>A9(e.map(e=>e.mapError(t))),i=(t,o)=>e.map(e=>e.fold(t,o)),l=(t,o)=>A9(CL.nu(n=>{let r=!1,a=setTimeout(()=>{r=!0,n(nY.error(o()))},t);e.get(e=>{r||(clearTimeout(a),n(e))})}));return{...e,toCached:t,bindFuture:o,bindResult:n,mapResult:r,mapError:a,foldResult:i,withTimeout:l}},A4=e=>A9(CL.nu(e)),A6=e=>A9(CL.pure(nY.value(e))),A8=e=>A9(CL.pure(nY.error(e))),A7=e=>A9(CL.pure(e)),Me=e=>A9(e.map(nY.value)),Mt=e=>A4(t=>{e.then(e=>{t(nY.value(e))},e=>{t(nY.error(e))})}),Mo={nu:A4,wrap:A9,pure:A6,value:A6,error:A8,fromResult:A7,fromFuture:Me,fromPromise:Mt},Mn=(e,t,o=[],n,r,a)=>{let i=t.fold(()=>({}),e=>({action:e})),l={buttonBehaviours:c2([SA.button(()=>!e.enabled||a.isDisabled()),SO(),OK.config({}),bG("button press",[iU("click"),iU("mousedown")])].concat(o)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]},...i},s=rn(l,{dom:n});return rn(s,{components:r})},Mr=(e,t,o,n=[])=>{let r=e.tooltip.map(e=>({"aria-label":o.translate(e),title:o.translate(e)})).getOr({}),a=e.icon.map(e=>Db(e,o.icons)),i=eE([a]);return Mn(e,t,n,{tag:"button",classes:["tox-tbtn"],attributes:r},i,o)},Ma=e=>{switch(e){case"primary":return["tox-button"];case"toolbar":return["tox-tbtn"];default:return["tox-button","tox-button--secondary"]}},Mi=(e,t,o,n=[],r=[])=>{let a=o.translate(e.text),i=e.icon.map(e=>Db(e,o.icons)),l=[i.getOrThunk(()=>s_(a))],s=e.buttonType.getOr(e.primary||e.borderless?"primary":"secondary"),c=Ma(s),d=[...c,...i.isSome()?["tox-button--icon"]:[],...e.borderless?["tox-button--naked"]:[],...r];return Mn(e,t,n,{tag:"button",classes:d,attributes:{title:a}},l,o)},Ml=(e,t,o,n=[],r=[])=>{let a=Mi(e,B.some(t),o,n,r);return v9.sketch(a)},Ms=(e,t)=>o=>{"custom"===t?iI(o,O4,{name:e,value:{}}):"submit"===t?iF(o,O6):"cancel"===t?iF(o,O9):console.error("Unknown button type: ",t)},Mc=(e,t)=>"menu"===t,Md=(e,t)=>"custom"===t||"cancel"===t||"submit"===t,Mu=(e,t)=>"togglebutton"===t,Mm=(e,t)=>{var o,n,r;let a=B.from(e.icon).map(e=>Dv(e,t.icons)).map(v4),i=o=>{iI(o,O4,{name:e.name,value:{setIcon:e=>{a.map(n=>n.getOpt(o).each(o=>{bW.set(o,[Dv(e,t.icons)])}))}}})},l={...e,name:null!==(o=e.name)&&void 0!==o?o:"",primary:"primary"===e.buttonType,buttonType:B.from(e.buttonType),tooltip:B.from(e.tooltip),icon:B.from(e.name),enabled:null!==(n=e.enabled)&&void 0!==n&&n,borderless:!1},s=l.tooltip.map(e=>({"aria-label":t.translate(e),title:t.translate(e)})).getOr({}),c=Ma(null!==(r=e.buttonType)&&void 0!==r?r:"secondary"),d=!!e.icon&&!!e.text,u={tag:"button",classes:[...c.concat(["tox-button--icon"]),...e.active?["tox-button--enabled"]:[],...d?["tox-button--icon-and-text"]:[]],attributes:s},m=t.translate(e.text),g=s_(m),p=eE([a.map(e=>e.asSpec())]),h=[...p,...d?[g]:[]],f=Mn(l,B.some(i),[],u,h,t);return v9.sketch(f)},Mg=(e,t,o)=>{if(Mc(e,t)){let t={...e,type:"menubutton",search:B.none(),onSetup:t=>(t.setEnabled(e.enabled),y),fetch:AE(e.items,()=>n,o)},n=v4(AT(t,"tox-tbtn",o,B.none()));return n.asSpec()}if(Md(e,t)){let n=Ms(e.name,t),r={...e,borderless:!1};return Ml(r,n,o.shared.providers,[])}if(Mu(e,t)){let t={...e,tooltip:e.tooltip,text:e.text.getOrUndefined(),buttonType:e.buttonType.getOrUndefined()};return Mm(t,o.shared.providers)}throw console.error("Unknown footer button type: ",t),Error("Unknown footer button type")},Mp=(e,t)=>{let o=Ms(e.name,"custom");return OZ(B.none(),OG.parts.field({factory:v9,...Mi(e,B.some(o),t,[EY.memory(""),EU.self()])}))},Mh={type:"separator"},Mf=e=>({type:"menuitem",value:e.url,text:e.title,meta:{attach:e.attach},onAction:y}),Mb=(e,t)=>({type:"menuitem",value:t,text:e,meta:{attach:void 0},onAction:y}),Mv=e=>U(e,Mf),My=(e,t)=>$(t,t=>t.type===e),Mx=(e,t)=>Mv(My(e,t)),Mw=e=>Mx("header",e.targets),MS=e=>Mx("anchor",e.targets),Mk=e=>B.from(e.anchorTop).map(e=>Mb("<top>",e)).toArray(),MC=e=>B.from(e.anchorBottom).map(e=>Mb("<bottom>",e)).toArray(),MO=e=>U(e,e=>Mb(e,e)),M_=e=>X(e,(e,t)=>{let o=0===e.length||0===t.length;return o?e.concat(t):e.concat(Mh,t)},[]),MT=(e,t)=>{let o=e.toLowerCase();return $(t,e=>{var t;let n=void 0!==e.meta&&void 0!==e.meta.text?e.meta.text:e.text,r=null!==(t=e.value)&&void 0!==t?t:"";return eH(n.toLowerCase(),o)||eH(r.toLowerCase(),o)})},ME=(e,t,o)=>{let n=gU.getValue(t),r=void 0!==n.meta.text?n.meta.text:n.value,a=o.getLinkInformation();return a.fold(()=>[],t=>{let n=MT(r,MO(o.getHistory(e)));return"file"===e?M_([n,MT(r,Mw(t)),MT(r,Z([Mk(t),MS(t),MC(t)]))]):n})},MD=lr("aria-invalid"),MA=(e,t,o,n)=>{let r=t.shared.providers,a=t=>{let n=gU.getValue(t);o.addToHistory(n.value,e.filetype)},i={...n.map(e=>({initialData:e})).getOr({}),dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":MD,type:"url"},minChars:0,responseTime:0,fetch:n=>{let r=ME(e.filetype,n,o),a=DF(r,xg.BUBBLE_TO_SANDBOX,t,{isHorizontalMenu:!1,search:B.none()});return CL.pure(a)},getHotspot:e=>g.getOpt(e),onSetValue:(e,t)=>{e.hasConfigured(_p)&&_p.run(e).get(y)},typeaheadBehaviours:c2([...o.getValidationHandler().map(t=>_p.config({getRoot:e=>tf(e.element),invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:(e,t)=>{c.getOpt(e).each(e=>{tH(e.element,"title",r.translate(t))})}},validator:{validate:o=>{let n=gU.getValue(o);return Mo.nu(o=>{t({type:e.filetype,url:n.value},e=>{if("invalid"===e.status){let t=nY.error(e.message);o(t)}else{let t=nY.value(e.message);o(t)}})})},validateOnLoad:!1}})).toArray(),ha.config({disabled:()=>!e.enabled||r.isDisabled()}),OK.config({}),bG("urlinput-events",[iW(a4(),t=>{let o=sr(t.element),n=o.trim();n!==o&&sa(t.element,n),"file"===e.filetype&&iI(t,O3,{name:e.name})}),iW(a6(),t=>{iI(t,O3,{name:e.name}),a(t)}),iW(is(),t=>{iI(t,O3,{name:e.name}),a(t)})])]),eventOrder:{[a4()]:["streaming","urlinput-events","invalidating"]},model:{getDisplayText:e=>e.value,selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:t.shared.getSink,parts:{menu:xM(!1,1,"normal")},onExecute:(e,t,o)=>{iI(t,O6,{})},onItemExecute:(t,o,n,r)=>{a(t),iI(t,O3,{name:e.name})}},l=OG.parts.field({...i,factory:A5}),s=e.label.map(e=>O2(e,r)),c=v4(((e,t,o=e,n=e)=>ys(o,{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+e],attributes:{title:r.translate(n),"aria-live":"polite",...t.fold(()=>({}),e=>({id:e}))}},r.icons))("invalid",B.some(MD),"warning")),d=v4({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[c.asSpec()]}),u=o.getUrlPicker(e.filetype),m=lr("browser.url.event"),g=v4({dom:{tag:"div",classes:["tox-control-wrap"]},components:[l,d.asSpec()],behaviours:c2([ha.config({disabled:()=>!e.enabled||r.isDisabled()})])}),p=v4(Ml({name:e.name,icon:B.some("browse"),text:e.label.getOr(""),enabled:e.enabled,primary:!1,buttonType:B.none(),borderless:!0},e=>iF(e,m),r,[],["tox-browse-url"])),h=t=>{pY.getCurrent(t).each(o=>{let n=gU.getValue(o),r={fieldname:e.name,...n};u.each(n=>{n(r).get(n=>{gU.setValue(o,n),iI(t,O3,{name:e.name})})})})};return OG.sketch({dom:O0(),components:s.toArray().concat([{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:Z([[g.asSpec()],u.map(()=>p.asSpec()).toArray()])}]),fieldBehaviours:c2([ha.config({disabled:()=>!e.enabled||r.isDisabled(),onDisabled:e=>{OG.getField(e).each(ha.disable),p.getOpt(e).each(ha.disable)},onEnabled:e=>{OG.getField(e).each(ha.enable),p.getOpt(e).each(ha.enable)}}),SO(),bG("url-input-events",[iW(m,h)])])})},MM=(e,t)=>OH.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in",`tox-notification--${e.level}`]},components:[{dom:{tag:"div",classes:["tox-notification__icon"]},components:[v9.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:yn(e.icon,t.icons),attributes:{title:t.translate(e.iconTooltip)}},action:t=>{iI(t,O4,{name:"alert-banner",value:e.url})},buttonBehaviours:c2([yi()])})]},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:t.translate(e.text)}}]}),MB=(e,t)=>{e.dom.checked=t},MF=e=>e.dom.checked,MI=(e,t,o)=>{let n=e=>(e.element.dom.click(),B.some(!0)),r=OG.parts.field({factory:{sketch:C},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:c2([EU.self(),ha.config({disabled:()=>!e.enabled||t.isDisabled()}),OK.config({}),b0.config({}),EY.withElement(o,MF,MB),bD.config({mode:"special",onEnter:n,onSpace:n,stopSpaceKeyup:!0}),bG("checkbox-events",[iW(a6(),(t,o)=>{iI(t,O3,{name:e.name})})])])}),a=OG.parts.label({dom:{tag:"span",classes:["tox-checkbox__label"]},components:[s_(t.translate(e.label))],behaviours:c2([_v.config({})])}),i=e=>ys("checked"===e?"selected":"unselected",{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+e]},t.icons),l=v4({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[i("checked"),i("unchecked")]});return OG.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[r,l.asSpec(),a],fieldBehaviours:c2([ha.config({disabled:()=>!e.enabled||t.isDisabled(),disableClass:"tox-checkbox--disabled",onDisabled:e=>{OG.getField(e).each(ha.disable)},onEnabled:e=>{OG.getField(e).each(ha.enable)}}),SO()])})},MR=e=>"presentation"===e.presets?OH.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:e.html}}):OH.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:e.html,attributes:{role:"document"}},containerBehaviours:c2([OK.config({}),b0.config({})])}),MN=e=>(t,o,n,r)=>ek(o,"name").fold(()=>e(o,r,B.none()),a=>t.field(a,e(o,r,ek(n,a)))),MV={bar:MN((e,t)=>OP(e,t.shared)),collection:MN((e,t,o)=>_o(e,t.shared.providers,o)),alertbanner:MN((e,t)=>MM(e,t.shared.providers)),input:MN((e,t,o)=>D9(e,t.shared.providers,o)),textarea:MN((e,t,o)=>D4(e,t.shared.providers,o)),label:MN((e,t)=>Dd(e,t.shared)),iframe:(nS=(e,t,o)=>Da(e,t.shared.providers,o),(e,t,o,n)=>{let r=rn(t,{source:"dynamic"});return MN(nS)(e,r,o,n)}),button:MN((e,t)=>Mp(e,t.shared.providers)),checkbox:MN((e,t,o)=>MI(e,t.shared.providers,o)),colorinput:MN((e,t,o)=>_k(e,t.shared,t.colorinput,o)),colorpicker:MN((e,t,o)=>EQ(e,t.shared.providers,o)),dropzone:MN((e,t,o)=>E9(e,t.shared.providers,o)),grid:MN((e,t)=>E4(e,t.shared)),listbox:MN((e,t,o)=>Dz(e,t,o)),selectbox:MN((e,t,o)=>DU(e,t.shared.providers,o)),sizeinput:MN((e,t)=>D1(e,t.shared.providers)),slider:MN((e,t,o)=>D2(e,t.shared.providers,o)),urlinput:MN((e,t,o)=>MA(e,t,t.urlinput,o)),customeditor:MN(E2),htmlpanel:MN(MR),imagepreview:MN((e,t,o)=>Dc(e,o)),table:MN((e,t)=>D3(e,t.shared.providers)),tree:MN((e,t)=>Az(e,t)),panel:MN((e,t)=>DH(e,t))},Mz={field:(e,t)=>t,record:k([])},MH=(e,t,o,n)=>{let r=rn(n,{shared:{interpreter:t=>ML(e,t,o,r)}});return ML(e,t,o,r)},ML=(e,t,o,n)=>ek(MV,t.type).fold(()=>(console.error(`Unknown factory type "${t.type}", defaulting to container: `,t),t),r=>r(e,t,o,n)),MP=(e,t,o)=>ML(Mz,e,t,o),MU="layout-inset",MW=e=>e.x,Mj=(e,t)=>e.x+e.width/2-t.width/2,MG=(e,t)=>e.x+e.width-t.width,M$=e=>e.y,Mq=(e,t)=>e.y+e.height-t.height,MX=(e,t)=>e.y+e.height/2-t.height/2,MK=(e,t,o)=>cr(MG(e,t),Mq(e,t),o.insetSouthwest(),cm(),"southwest",cx(e,{right:0,bottom:3}),MU),MY=(e,t,o)=>cr(MW(e),Mq(e,t),o.insetSoutheast(),cu(),"southeast",cx(e,{left:1,bottom:3}),MU),MJ=(e,t,o)=>cr(MG(e,t),M$(e),o.insetNorthwest(),cd(),"northwest",cx(e,{right:0,top:2}),MU),MZ=(e,t,o)=>cr(MW(e),M$(e),o.insetNortheast(),cc(),"northeast",cx(e,{left:1,top:2}),MU),MQ=(e,t,o)=>cr(Mj(e,t),M$(e),o.insetNorth(),cg(),"north",cx(e,{top:2}),MU),M0=(e,t,o)=>cr(Mj(e,t),Mq(e,t),o.insetSouth(),cp(),"south",cx(e,{bottom:3}),MU),M1=(e,t,o)=>cr(MG(e,t),MX(e,t),o.insetEast(),cf(),"east",cx(e,{right:0}),MU),M2=(e,t,o)=>cr(MW(e),MX(e,t),o.insetWest(),ch(),"west",cx(e,{left:1}),MU),M3=e=>{switch(e){case"north":return MQ;case"northeast":return MZ;case"northwest":return MJ;case"south":return M0;case"southeast":return MY;case"southwest":return MK;case"east":return M1;case"west":return M2}},M5=(e,t,o,n,r)=>{let a=dC(n).map(M3).getOr(MQ);return a(e,t,o,n,r)},M9=e=>{switch(e){case"north":return M0;case"northeast":return MY;case"northwest":return MK;case"south":return MQ;case"southeast":return MZ;case"southwest":return MJ;case"east":return M2;case"west":return M1}},M4=(e,t,o,n,r)=>{let a=dC(n).map(M9).getOr(MQ);return a(e,t,o,n,r)},M6={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},M8=(e,t,o)=>{let n={maxHeightFunction:d2()},r=()=>({type:"node",root:tD(tE(e())),node:B.from(e()),bubble:d6(12,12,M6),layouts:{onRtl:()=>[MZ],onLtr:()=>[MJ]},overrides:n}),a=()=>({type:"hotspot",hotspot:t(),bubble:d6(-12,12,M6),layouts:{onRtl:()=>[cM,cB,cN],onLtr:()=>[cB,cM,cN]},overrides:n});return()=>o()?r():a()},M7=(e,t,o)=>{let n=()=>({type:"node",root:tD(tE(e())),node:B.from(e()),layouts:{onRtl:()=>[MQ],onLtr:()=>[MQ]}}),r=()=>({type:"hotspot",hotspot:t(),layouts:{onRtl:()=>[cN],onLtr:()=>[cN]}});return()=>o()?n():r()},Be=(e,t)=>()=>({type:"selection",root:t(),getSelection:()=>{let t=e.selection.getRng();return B.some(uL.range(eJ.fromDom(t.startContainer),t.startOffset,eJ.fromDom(t.endContainer),t.endOffset))}}),Bt=e=>t=>({type:"node",root:e(),node:t}),Bo=(e,t,o)=>{let n=xt(e),r=()=>eJ.fromDom(e.getBody()),a=()=>eJ.fromDom(e.getContentAreaContainer()),i=()=>n||!o();return{inlineDialog:M8(a,t,i),banner:M7(a,t,i),cursor:Be(e,r),node:Bt(r)}},Bn=e=>(t,o)=>{let n=Cr(e);n(t,o)},Br=e=>()=>kY(e),Ba=e=>t=>kJ(e,t),Bi=e=>t=>kK(e,t),Bl=e=>({colorPicker:Bn(e),hasCustomColors:Br(e),getColors:Ba(e),getColorCols:Bi(e)}),Bs=e=>()=>yX(e),Bc=e=>({isDraggableModal:Bs(e)}),Bd=e=>{let t=aC(y7(e)?"bottom":"top");return{isPositionedAtTop:()=>"top"===t.get(),getDockingMode:t.get,setDockingMode:t.set}},Bu=e=>eO(e,"items"),Bm=e=>eO(e,"format"),Bg=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",format:"bold"},{title:"Italic",format:"italic"},{title:"Underline",format:"underline"},{title:"Strikethrough",format:"strikethrough"},{title:"Superscript",format:"superscript"},{title:"Subscript",format:"subscript"},{title:"Code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",format:"alignleft"},{title:"Center",format:"aligncenter"},{title:"Right",format:"alignright"},{title:"Justify",format:"alignjustify"}]}],Bp=e=>eC(e,"items"),Bh=e=>eC(e,"block"),Bf=e=>eC(e,"inline"),Bb=e=>eC(e,"selector"),Bv=e=>X(e,(e,t)=>{if(Bp(t)){let o=Bv(t.items);return{customFormats:e.customFormats.concat(o.customFormats),formats:e.formats.concat([{title:t.title,items:o.formats}])}}if(!(Bf(t)||Bh(t)||Bb(t)))return{...e,formats:e.formats.concat(t)};{let o=l(t.name)?t.name:t.title.toLowerCase(),n=`custom-${o}`;return{customFormats:e.customFormats.concat([{name:n,format:t}]),formats:e.formats.concat([{title:t.title,format:n,icon:t.icon}])}}},{customFormats:[],formats:[]}),By=(e,t)=>{let o=Bv(t),n=t=>{W(t,t=>{e.formatter.has(t.name)||e.formatter.register(t.name,t.format)})};return e.formatter?n(o.customFormats):e.on("init",()=>{n(o.customFormats)}),o.formats},Bx=e=>yT(e).map(t=>{let o=By(e,t);return yE(e)?Bg.concat(o):o}).getOr(Bg),Bw=e=>{let t=eu(e);return 1===t.length&&z(t,"title")},BS=(e,t,o)=>({...e,type:"formatter",isSelected:t(e.format),getStylePreview:o(e.format)}),Bk=(e,t,o,n)=>{let r=e=>BS(e,o,n),a=e=>{let t=s(e.items);return{...e,type:"submenu",getStyleItems:k(t)}},i=t=>{let r=l(t.name)?t.name:lr(t.title),a=`custom-${r}`,i={...t,type:"formatter",format:a,isSelected:o(a),getStylePreview:n(a)};return e.formatter.register(r,i),i},s=e=>U(e,e=>Bu(e)?a(e):Bm(e)?r(e):Bw(e)?{...e,type:"separator"}:i(e));return s(t)},BC=e=>{let t=t=>()=>e.formatter.match(t),o=t=>()=>{let o=e.formatter.get(t);return void 0!==o?B.some({tag:o.length>0&&(o[0].inline||o[0].block)||"div",styles:e.dom.parseStyle(e.formatter.getCssText(t))}):B.none()},n=aC([]),r=aC([]),a=aC(!1);e.on("PreInit",r=>{let a=Bx(e),i=Bk(e,a,t,o);n.set(i)}),e.on("addStyleModifications",n=>{let i=Bk(e,n.items,t,o);r.set(i),a.set(n.replace)});let i=()=>{let e=a.get()?[]:n.get(),t=r.get();return e.concat(t)};return{getData:i}},BO=e=>h(e)&&1===e.nodeType,B_=E3.trim,BT=e=>t=>!!BO(t)&&(t.contentEditable===e||t.getAttribute("data-mce-contenteditable")===e),BE=BT("true"),BD=BT("false"),BA=(e,t,o,n,r)=>({type:e,title:t,url:o,level:n,attach:r}),BM=e=>{let t=e;for(;t=t.parentNode;){let e=t.contentEditable;if(e&&"inherit"!==e)return BE(t)}return!1},BB=(e,t)=>U(u1(eJ.fromDom(t),e),e=>e.dom),BF=e=>e.innerText||e.textContent,BI=e=>e.id?e.id:lr("h"),BR=e=>e&&"A"===e.nodeName&&(e.id||e.name)!==void 0,BN=e=>BR(e)&&Bz(e),BV=e=>e&&/^(H[1-6])$/.test(e.nodeName),Bz=e=>BM(e)&&!BD(e),BH=e=>BV(e)&&Bz(e),BL=e=>BV(e)?parseInt(e.nodeName.substr(1),10):0,BP=e=>{var t;let o=BI(e),n=()=>{e.id=o};return BA("header",null!==(t=BF(e))&&void 0!==t?t:"","#"+o,BL(e),n)},BU=e=>{let t=e.id||e.name,o=BF(e);return BA("anchor",o||"#"+t,"#"+t,0,y)},BW=e=>U($(e,BH),BP),Bj=e=>U($(e,BN),BU),BG=e=>{let t=BB("h1,h2,h3,h4,h5,h6,a:not([href])",e);return t},B$=e=>B_(e.title).length>0,Bq=e=>{let t=BG(e);return $(BW(t).concat(Bj(t)),B$)},BX={find:Bq},BK="tinymce-url-history",BY=e=>l(e)&&/^https?/.test(e),BJ=e=>d(e)&&e.length<=5&&ee(e,BY),BZ=e=>s(e)&&ew(e,e=>!BJ(e)).isNone(),BQ=()=>{let e;let t=kD.getItem(BK);if(null===t)return{};try{e=JSON.parse(t)}catch(e){if(e instanceof SyntaxError)return console.log("Local storage "+BK+" was not valid JSON",e),{};throw e}return BZ(e)?e:(console.log("Local storage "+BK+" was not valid format",e),{})},B0=e=>{if(!BZ(e))throw Error("Bad format for history:\n"+JSON.stringify(e));kD.setItem(BK,JSON.stringify(e))},B1=e=>{let t=BQ();return ek(t,e).getOr([])},B2=(e,t)=>{if(!BY(e))return;let o=BQ(),n=ek(o,t).getOr([]),r=$(n,t=>t!==e);o[t]=[e].concat(r).slice(0,5),B0(o)},B3=e=>!!e,B5=e=>ep(E3.makeMap(e,/[, ]/),B3),B9=e=>B.from(yP(e)),B4=e=>{let t=B.from(yj(e)).filter(B3).map(B5);return B9(e).fold(A,e=>t.fold(M,e=>eu(e).length>0&&e))},B6=(e,t)=>{let o=B4(e);return m(o)?o?B9(e):B.none():o[t]?B9(e):B.none()},B8=(e,t)=>B6(e,t).map(o=>n=>CL.nu(r=>{let a=(e,t)=>{if(!l(e))throw Error("Expected value to be string");if(void 0!==t&&!s(t))throw Error("Expected meta to be a object");r({value:e,meta:t})},i={filetype:t,fieldname:n.fieldname,...B.from(n.meta).getOr({})};o.call(e,a,n.value,i)})),B7=e=>B.from(e).filter(l).getOrUndefined(),Fe=e=>yG(e)?B.some({targets:BX.find(e.getBody()),anchorTop:B7(y$(e)),anchorBottom:B7(yq(e))}):B.none(),Ft=e=>B.from(yU(e)),Fo=e=>({getHistory:B1,addToHistory:B2,getLinkInformation:()=>Fe(e),getValidationHandler:()=>Ft(e),getUrlPicker:t=>B8(e,t)}),Fn=(e,t,o)=>{let n=aC(!1),r=Bd(t),a={icons:()=>t.ui.registry.getAll().icons,menuItems:()=>t.ui.registry.getAll().menuItems,translate:v6.translate,isDisabled:()=>t.mode.isReadOnly()||!t.ui.isEnabled(),getOption:t.options.get},i=Fo(t),l=BC(t),s=Bl(t),c=Bc(t),d=()=>n.get(),u=e=>n.set(e),m={shared:{providers:a,anchors:Bo(t,o,r.isPositionedAtTop),header:r},urlinput:i,styles:l,colorinput:s,dialog:c,isContextMenuOpen:d,setContextMenuState:u},g={...m,shared:{...m.shared,interpreter:e=>MP(e,{},g),getSink:e.popup}},p={...m,shared:{...m.shared,interpreter:e=>MP(e,{},p),getSink:e.dialog}};return{popup:g,dialog:p}},Fr=(e,t,o)=>{let n=(e,n)=>{W([t,...o],t=>{t.broadcastEvent(e,n)})},r=(e,n)=>{W([t,...o],t=>{t.broadcastOn([e],n)})},a=e=>r(gc(),{target:e.target}),i=na(),l=dN(i,"touchstart",a),s=dN(i,"touchmove",e=>n(iv(),e)),c=dN(i,"touchend",e=>n(iy(),e)),d=dN(i,"mousedown",a),u=dN(i,"mouseup",e=>{0===e.raw.button&&r(gu(),{target:e.target})}),m=e=>r(gc(),{target:eJ.fromDom(e.target)}),g=e=>{0===e.button&&r(gu(),{target:eJ.fromDom(e.target)})},p=()=>{W(e.editorManager.get(),t=>{e!==t&&t.dispatch("DismissPopups",{relatedTarget:e})})},h=e=>n(ix(),oY(e)),f=e=>{r(gd(),{}),n(iw(),oY(e))},b=tE(eJ.fromDom(e.getElement())),v=dV(b,"scroll",o=>{requestAnimationFrame(()=>{let r=e.getContainer();if(null!=r){let r=Oh(e,t.element),a=r.map(e=>[e.element,...e.others]).getOr([]);H(a,e=>tc(e,o.target))&&(e.dispatch("ElementScroll",{target:o.target.dom}),n(iE(),o))}})}),y=()=>r(gd(),{}),x=t=>{t.state&&r(gc(),{target:eJ.fromDom(e.getContainer())})},w=e=>{r(gc(),{target:eJ.fromDom(e.relatedTarget.getContainer())})};e.on("PostRender",()=>{e.on("click",m),e.on("tap",m),e.on("mouseup",g),e.on("mousedown",p),e.on("ScrollWindow",h),e.on("ResizeWindow",f),e.on("ResizeEditor",y),e.on("AfterProgressState",x),e.on("DismissPopups",w)}),e.on("remove",()=>{e.off("click",m),e.off("tap",m),e.off("mouseup",g),e.off("mousedown",p),e.off("ScrollWindow",h),e.off("ResizeWindow",f),e.off("ResizeEditor",y),e.off("AfterProgressState",x),e.off("DismissPopups",w),d.unbind(),l.unbind(),s.unbind(),c.unbind(),u.unbind(),v.unbind()}),e.on("detach",()=>{W([t,...o],mZ),W([t,...o],e=>e.destroy())})},Fa=k([ah("shell",!1),r4("makeItem"),ah("setupItem",y),g$.field("listBehaviours",[bW])]),Fi=()=>({behaviours:c2([bW.config({})])}),Fl=pg({name:"items",overrides:Fi}),Fs=k([Fl]),Fc=k("CustomList"),Fd=(e,t,o,n)=>{let r=(t,o)=>{i(t).fold(()=>{throw console.error("Custom List was defined to not be a shell, but no item container was specified in components"),Error("Custom List was defined to not be a shell, but no item container was specified in components")},n=>{let r=bW.contents(n),a=o.length,i=a-r.length,l=i>0?L(i,()=>e.makeItem()):[],s=r.slice(a);W(s,e=>bW.remove(n,e)),W(l,e=>bW.append(n,e));let c=bW.contents(n);W(c,(n,r)=>{e.setupItem(t,n,o[r],r)})})},a=e.shell?{behaviours:[bW.config({})],components:[]}:{behaviours:[],components:t},i=t=>e.shell?B.some(t):p_(t,e,"items");return{uid:e.uid,dom:e.dom,components:a.components,behaviours:gG(e.listBehaviours,a.behaviours),apis:{setItems:r}}},Fu=pG({name:Fc(),configFields:Fa(),partFields:Fs(),factory:Fd,apis:{setItems:(e,t,o)=>{e.setItems(t,o)}}}),Fm=k([r4("dom"),ah("shell",!0),gW("toolbarBehaviours",[bW])]),Fg=()=>({behaviours:c2([bW.config({})])}),Fp=k([pg({name:"groups",overrides:Fg})]),Fh=(e,t,o,n)=>{let r=(e,t)=>{a(e).fold(()=>{throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),Error("Toolbar was defined to not be a shell, but no groups container was specified in components")},e=>{bW.set(e,t)})},a=t=>e.shell?B.some(t):p_(t,e,"groups"),i=e.shell?{behaviours:[bW.config({})],components:[]}:{behaviours:[],components:t};return{uid:e.uid,dom:e.dom,components:i.components,behaviours:gG(e.toolbarBehaviours,i.behaviours),apis:{setGroups:r},domModification:{attributes:{role:"group"}}}},Ff=pG({name:"Toolbar",configFields:Fm(),partFields:Fp(),factory:Fh,apis:{setGroups:(e,t,o)=>{e.setGroups(t,o)}}}),Fb=k([]);var Fv=Object.freeze({__proto__:null,setup:y,isDocked:A,getBehaviours:Fb});let Fy=e=>{let t=e_(tQ(e,"position"),"fixed"),o=t?B.none():tv(e);return o.orThunk(()=>{let t=eJ.fromTag("span");return th(e).bind(e=>{o9(e,t);let o=tv(t);return o7(t),o})})},Fx=e=>Fy(e).map(oo).getOrThunk(()=>t7(0,0)),Fw=(e,t)=>{let o=e.element;l9(o,t.transitionClass),l6(o,t.fadeOutClass),l9(o,t.fadeInClass),t.onShow(e)},FS=(e,t)=>{let o=e.element;l9(o,t.transitionClass),l6(o,t.fadeInClass),l9(o,t.fadeOutClass),t.onHide(e)},Fk=(e,t)=>e.y<t.bottom&&e.bottom>t.y,FC=(e,t)=>e.y>=t.y,FO=(e,t)=>e.bottom<=t.bottom,F_=(e,t,o)=>({location:"top",leftX:t,topY:o.bounds.y-e.y}),FT=(e,t,o)=>({location:"bottom",leftX:t,bottomY:e.bottom-o.bounds.bottom}),FE=e=>e.box.x-e.win.x,FD=(e,t,o)=>{let n=t.win,r=t.box,a=FE(t);return ed(e,e=>{switch(e){case"bottom":return FO(r,o.bounds)?B.none():B.some(FT(n,a,o));case"top":return FC(r,o.bounds)?B.none():B.some(F_(n,a,o));default:return B.none()}}).getOr({location:"no-dock"})},FA=(e,t,o)=>ee(e,e=>{switch(e){case"bottom":return FO(t,o.bounds);case"top":return FC(t,o.bounds)}}),FM=(e,t)=>{let o=t.optScrollEnv.fold(k(e.bounds.y),t=>t.scrollElmTop+(e.bounds.y-t.currentScrollTop));return t7(e.bounds.x,o)},FB=(e,t)=>{let o=t.optScrollEnv.fold(k(e.y),t=>e.y+t.currentScrollTop-t.scrollElmTop);return t7(e.x,o)},FF=(e,t,o)=>o.getInitialPos().map(o=>{let n=FM(o,t);return{box:nL(n.left,n.top,oi(e),t4(e)),location:o.location}}),FI=(e,t,o,n,r)=>{let a=FB(t,o),i=nL(a.left,a.top,t.width,t.height);n.setInitialPos({style:t0(e),position:tJ(e,"position")||"static",bounds:i,location:r.location})},FR=(e,t,o,n,r)=>{n.getInitialPos().fold(()=>FI(e,t,o,n,r),()=>y)},FN=(e,t,o)=>o.getInitialPos().bind(n=>{var r;switch(o.clearInitialPos(),n.position){case"static":return B.some({morph:"static"});case"absolute":let a=Fy(e).getOr(tN()),i=nP(a),l=null!==(r=a.dom.scrollTop)&&void 0!==r?r:0;return B.some({morph:"absolute",positionCss:ds("absolute",ek(n.style,"left").map(e=>t.x-i.x),ek(n.style,"top").map(e=>t.y-i.y+l),ek(n.style,"right").map(e=>i.right-t.right),ek(n.style,"bottom").map(e=>i.bottom-t.bottom))});default:return B.none()}}),FV=(e,t,o)=>FF(e,t,o).filter(({box:e})=>FA(o.getModes(),e,t)).bind(({box:t})=>FN(e,t,o)),Fz=e=>{switch(e.location){case"top":return B.some({morph:"fixed",positionCss:ds("fixed",B.some(e.leftX),B.some(e.topY),B.none(),B.none())});case"bottom":return B.some({morph:"fixed",positionCss:ds("fixed",B.some(e.leftX),B.none(),B.none(),B.some(e.bottomY))});default:return B.none()}},FH=(e,t,o)=>{let n=nP(e),r=nG(),a=FD(o.getModes(),{win:r,box:n},t);return"top"===a.location||"bottom"===a.location?(FI(e,n,t,o,a),Fz(a)):B.none()},FL=(e,t,o)=>FV(e,t,o).orThunk(()=>t.optScrollEnv.bind(n=>FF(e,t,o)).bind(({box:e,location:o})=>{let n=nG(),r=FE({win:n,box:e}),a="top"===o?F_(n,r,t):FT(n,r,t);return Fz(a)})),FP=(e,t,o)=>{let n=e.element,r=e_(tQ(n,"position"),"fixed");return r?FL(n,t,o):FH(n,t,o)},FU=(e,t,o)=>{let n=e.element;return FF(n,t,o).bind(({box:e})=>FN(n,e,o))},FW=(e,t,o,n)=>{let r=nP(e),a=nG(),i=FE({win:a,box:r}),l=n(a,i,t);return"bottom"===l.location||"top"===l.location?(FR(e,r,t,o,l),Fz(l)):B.none()},Fj=(e,t,o)=>{o.setDocked(!1),W(["left","right","top","bottom","position"],t=>t2(e.element,t)),t.onUndocked(e)},FG=(e,t,o,n)=>{let r="fixed"===n.position;o.setDocked(r),dd(e.element,n);let a=r?t.onDocked:t.onUndocked;a(e)},F$=(e,t,o,n,r=!1)=>{t.contextual.each(t=>{t.lazyContext(e).each(a=>{let i=Fk(a,n.bounds);i!==o.isVisible()&&(o.setVisible(i),r&&!i?(l7(e.element,[t.fadeOutClass]),t.onHide(e)):(i?Fw:FS)(e,t))})})},Fq=(e,t,o,n,r)=>{F$(e,t,o,n,!0),FG(e,t,o,r.positionCss)},FX=(e,t,o,n,r)=>{switch(r.morph){case"static":return Fj(e,t,o);case"absolute":return FG(e,t,o,r.positionCss);case"fixed":return Fq(e,t,o,n,r)}},FK=(e,t,o)=>{let n=t.lazyViewport(e);F$(e,t,o,n),FP(e,n,o).each(r=>{FX(e,t,o,n,r)})},FY=(e,t,o)=>{let n=e.element;o.setDocked(!1);let r=t.lazyViewport(e);FU(e,r,o).each(n=>{switch(n.morph){case"static":Fj(e,t,o);break;case"absolute":FG(e,t,o,n.positionCss)}}),o.setVisible(!0),t.contextual.each(t=>{se(n,[t.fadeInClass,t.fadeOutClass,t.transitionClass]),t.onShow(e)}),FJ(e,t,o)},FJ=(e,t,o)=>{e.getSystem().isConnected()&&FK(e,t,o)},FZ=(e,t,o)=>{o.isDocked()&&FY(e,t,o)},FQ=e=>(t,o,n)=>{let r=o.lazyViewport(t),a=FW(t.element,r,n,e);a.each(e=>{Fq(t,o,n,r,e)})},F0=FQ(F_),F1=FQ(FT),F2=(e,t,o)=>o.isDocked(),F3=(e,t,o,n)=>o.setModes(n),F5=(e,t,o)=>o.getModes();var F9=Object.freeze({__proto__:null,refresh:FJ,reset:FZ,isDocked:F2,getModes:F5,setModes:F3,forceDockToTop:F0,forceDockToBottom:F1});let F4=(e,t)=>iL([iJ(ie(),(o,n)=>{e.contextual.each(e=>{if(l8(o.element,e.transitionClass)){se(o.element,[e.transitionClass,e.fadeInClass]);let n=t.isVisible()?e.onShown:e.onHidden;n(o)}n.stop()})}),iW(ix(),(o,n)=>{FJ(o,e,t)}),iW(iE(),(o,n)=>{FJ(o,e,t)}),iW(iw(),(o,n)=>{FZ(o,e,t)})]);var F6=Object.freeze({__proto__:null,events:F4}),F8=[ag("contextual",[r7("fadeInClass"),r7("fadeOutClass"),r7("transitionClass"),at("lazyContext"),s6("onShow"),s6("onShown"),s6("onHide"),s6("onHidden")]),aw("lazyViewport",()=>({bounds:nG(),optScrollEnv:B.none()})),aS("modes",["top","bottom"],rW),s6("onDocked"),s6("onUndocked")];let F7=e=>{let t=aC(!1),o=aC(!0),n=dR(),r=aC(e.modes),a=()=>`docked:  ${t.get()}, visible: ${o.get()}, modes: ${r.get().join(",")}`;return lO({isDocked:t.get,setDocked:t.set,getInitialPos:n.get,setInitialPos:n.set,clearInitialPos:n.clear,isVisible:o.get,setVisible:o.set,getModes:r.get,setModes:r.set,readState:a})};var Ie=Object.freeze({__proto__:null,init:F7});let It=c5({fields:F8,name:"docking",active:F6,apis:F9,state:Ie}),Io=k(lr("toolbar-height-change")),In={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},Ir="tox-tinymce--toolbar-sticky-on",Ia="tox-tinymce--toolbar-sticky-off",Ii=(e,t)=>{let o=tu(t),n=tp(t),r=n.dom.innerHeight,a=ne(o),i=eJ.fromDom(e.elm),l=nU(i),s=t4(i),c=l.y,d=oo(t),u=t4(t),m=d.top,g=m+u,p=2>Math.abs(m-a.top),h=2>Math.abs(g-(a.top+r));p&&c<g?nt(a.left,c-u,o):h&&c+s>m&&nt(a.left,c-r+s+u,o)},Il=(e,t)=>z(It.getModes(e),t),Is=e=>{let t=e=>t6(e)+(parseInt(tJ(e,"margin-top"),10)||0)+(parseInt(tJ(e,"margin-bottom"),10)||0),o=e.element;tf(o).each(n=>{let r="padding-"+It.getModes(e)[0];if(It.isDocked(e)){let e=oi(n);tX(o,"width",e+"px"),tX(n,r,t(o)+"px")}else t2(o,"width"),t2(n,r)})},Ic=(e,t)=>{t?(l6(e,In.fadeOutClass),l7(e,[In.transitionClass,In.fadeInClass])):(l6(e,In.fadeInClass),l7(e,[In.fadeOutClass,In.transitionClass]))},Id=(e,t)=>{let o=eJ.fromDom(e.getContainer());t?(l9(o,Ir),l6(o,Ia)):(l9(o,Ia),l6(o,Ir))},Iu=(e,t)=>{let o=tu(t);da(o).filter(e=>!tc(t,e)).filter(t=>tc(t,eJ.fromDom(o.dom.body))||td(e,t)).each(()=>dt(t))},Im=(e,t)=>di(e).orThunk(()=>t().toOptional().bind(e=>di(e.element))),Ig=(e,t,o)=>{e.inline||(t.header.isPositionedAtTop()||e.on("ResizeEditor",()=>{o().each(It.reset)}),e.on("ResizeWindow ResizeEditor",()=>{o().each(Is)}),e.on("SkinLoaded",()=>{o().each(e=>{It.isDocked(e)?It.reset(e):It.refresh(e)})}),e.on("FullscreenStateChanged",()=>{o().each(It.reset)})),e.on("AfterScrollIntoView",e=>{o().each(t=>{It.refresh(t);let o=t.element;fa(o)&&Ii(e,o)})}),e.on("PostRender",()=>{Id(e,!1)})},Ip=e=>e().map(It.isDocked).getOr(!1),Ih=()=>[c8.config({channels:{[Io()]:{onReceive:Is}}})],If=(e,t)=>{let o=dR(),n=t.getSink,r=e=>{n().each(t=>e(t.element))},a=t=>{e.inline||Is(t),Id(e,It.isDocked(t)),t.getSystem().broadcastOn([gd()],{}),n().each(e=>e.getSystem().broadcastOn([gd()],{}))},i=e.inline?[]:Ih();return[b0.config({}),It.config({contextual:{lazyContext:t=>{let o=t6(t.element),n=e.inline?e.getContentAreaContainer():e.getContainer();return B.from(n).map(n=>{let r=nP(eJ.fromDom(n)),a=Oh(e,t.element);return a.fold(()=>{let e=r.height-o,n=r.y+(Il(t,"top")?0:o);return nL(r.x,n,r.width,e)},e=>{let t=nW(r,Of(e));return nL(t.x,t.y,t.width,t.height-o)})})},onShow:()=>{r(e=>Ic(e,!0))},onShown:e=>{r(e=>se(e,[In.transitionClass,In.fadeInClass])),o.get().each(t=>{Iu(e.element,t),o.clear()})},onHide:e=>{Im(e.element,n).fold(o.clear,o.set),r(e=>Ic(e,!1))},onHidden:()=>{r(e=>se(e,[In.transitionClass]))},...In},lazyViewport:t=>{let o=Oh(e,t.element);return o.fold(()=>{let o=nG(),n=yz(e),r=o.y+(Il(t,"top")?n:0),a=o.height-(Il(t,"bottom")?n:0);return{bounds:nL(o.x,r,o.width,a),optScrollEnv:B.none()}},e=>{let t=Of(e);return{bounds:t,optScrollEnv:B.some({currentScrollTop:e.element.dom.scrollTop,scrollElmTop:oo(e.element).top})}})},modes:[t.header.getDockingMode()],onDocked:a,onUndocked:a}),...i]};var Ib=Object.freeze({__proto__:null,setup:Ig,isDocked:Ip,getBehaviours:If});let Iv=e=>{let t=e.editor,o=e.sticky?If:Fb;return{uid:e.uid,dom:e.dom,components:e.components,behaviours:c2(o(t,e.sharedBackstage))}},Iy=rI([x6,r6("items",rN([rH([x8,aa("items",rW)]),rW]))].concat(wA)),Ix=e=>rQ("GroupToolbarButton",Iy,e),Iw=[ac("text"),ac("tooltip"),ac("icon"),af("search",!1,rN([rj,rI([ac("placeholder")])],e=>m(e)?e?B.some({placeholder:B.none()}):B.none():B.some(e))),at("fetch"),aw("onSetup",()=>y)],IS=rI([x6,...Iw]),Ik=e=>rQ("menubutton",IS,e),IC=rI([x6,wm,wu,wd,wh,wr,ws,ay("presets","normal",["normal","color","listpreview"]),wx(1),wi,wl]),IO=e=>rQ("SplitButton",IC,e),I_=(e,t)=>{let o=(e,o)=>{let n=U(o,e=>{let o={type:"menubutton",text:e.text,fetch:t=>{t(e.getItems())}},n=Ik(o).mapError(e=>r2(e)).getOrDie();return AT(n,"tox-mbtn",t.backstage,B.some("menuitem"))});bW.set(e,n)},n={focus:bD.focusIn,setMenus:o};return{uid:e.uid,dom:e.dom,components:[],behaviours:c2([bW.config({}),bG("menubar-events",[iZ(t=>{e.onSetup(t)}),iW(a1(),(e,t)=>{sH(e.element,".tox-mbtn--active").each(o=>{sL(t.event.target,".tox-mbtn").each(t=>{tc(o,t)||e.getSystem().getByDom(o).each(o=>{e.getSystem().getByDom(t).each(e=>{C5.expand(e),C5.close(o),b0.focus(e)})})})})}),iW(i_(),(e,t)=>{t.event.prevFocus.bind(t=>e.getSystem().getByDom(t).toOptional()).each(o=>{t.event.newFocus.bind(t=>e.getSystem().getByDom(t).toOptional()).each(e=>{C5.isOpen(o)&&(C5.expand(e),C5.close(o))})})})]),bD.config({mode:"flow",selector:".tox-mbtn",onEscape:t=>(e.onEscape(t),B.some(!0))}),OK.config({})]),apis:n,domModification:{attributes:{role:"menubar"}}}};var IT=pj({factory:I_,name:"silver.Menubar",configFields:[r4("dom"),r4("uid"),r4("onEscape"),r4("backstage"),ah("onSetup",y)],apis:{focus:(e,t)=>{e.focus(t)},setMenus:(e,t,o)=>{e.setMenus(t,o)}}});let IE=e=>({uid:e.uid,dom:e.dom,components:[{dom:{tag:"a",attributes:{href:"https://www.tiny.cloud/tinymce-self-hosted-premium-features/?utm_source=TinyMCE&utm_medium=SPAP&utm_campaign=SPAP&utm_id=editorreferral",rel:"noopener",target:"_blank","aria-hidden":"true"},classes:["tox-promotion-link"],innerHtml:"⚡️Upgrade"}}]}),ID="container",IA=[gW("slotBehaviours",[])],IM=e=>"<alloy.field."+e+">",IB=e=>{let t=(()=>{let e=[],t=(t,o)=>(e.push(t),pw(ID,IM(t),o));return{slot:t,record:k(e)}})(),o=e(t),n=t.record(),r=U(n,e=>pu({name:e,pname:IM(e)}));return pz(ID,IA,r,IF,o)},IF=(e,t)=>{let o=t=>pA(e),n=(t,o)=>p_(t,e,o),r=(t,o)=>(n,r)=>p_(n,e,r).map(e=>t(e,r)).getOr(o),a=(e,t)=>"true"!==tP(e.element,"aria-hidden"),i=(e,t)=>{if(!a(e)){let o=e.element;t2(o,"display"),tj(o,"aria-hidden"),iI(e,iT(),{name:t,visible:!0})}},l=(e,t)=>{if(a(e)){let o=e.element;tX(o,"display","none"),tH(o,"aria-hidden","true"),iI(e,iT(),{name:t,visible:!1})}},s=r(a,!1),c=r(l),d=(e,t)=>{W(t,t=>c(e,t))},u=e=>d(e,o()),m=r(i);return{uid:e.uid,dom:e.dom,components:t,behaviours:gj(e.slotBehaviours),apis:{getSlotNames:o,getSlot:n,isShowing:s,hideSlot:c,hideAllSlots:u,showSlot:m}}},II=ep({getSlotNames:(e,t)=>e.getSlotNames(t),getSlot:(e,t,o)=>e.getSlot(t,o),isShowing:(e,t,o)=>e.isShowing(t,o),hideSlot:(e,t,o)=>e.hideSlot(t,o),hideAllSlots:(e,t)=>e.hideAllSlots(t),showSlot:(e,t,o)=>e.showSlot(t,o)},e=>lk(e)),IR={...II,sketch:IB},IN=rI([wu,wm,aw("onShow",y),aw("onHide",y),ws]),IV=e=>rQ("sidebar",IN,e),Iz=e=>{let{sidebars:t}=e.ui.registry.getAll();W(eu(t),o=>{let n=t[o],r=()=>e_(B.from(e.queryCommandValue("ToggleSidebar")),o);e.ui.registry.addToggleButton(o,{icon:n.icon,tooltip:n.tooltip,onAction:t=>{e.execCommand("ToggleSidebar",!1,o),t.setActive(r())},onSetup:t=>{t.setActive(r());let o=()=>t.setActive(r());return e.on("ToggleSidebar",o),()=>{e.off("ToggleSidebar",o)}}})})},IH=e=>({element:()=>e.element.dom}),IL=(e,t)=>{let o=U(eu(t),e=>{let o=t[e],n=r0(IV(o));return{name:e,getApi:IH,onSetup:n.onSetup,onShow:n.onShow,onHide:n.onHide}});return U(o,t=>{let n=aC(y);return e.slot(t.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:Sl.unnamedEvents([SB(t,n),SF(t,n),iW(iT(),(e,t)=>{let n=t.event,r=Y(o,e=>e.name===n.name);r.each(t=>{let o=n.visible?t.onShow:t.onHide;o(t.getApi(e))})})])})})},IP=e=>IR.sketch(t=>({dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:IL(t,e),slotBehaviours:Sl.unnamedEvents([iZ(e=>IR.hideAllSlots(e))])})),IU=(e,t,o)=>{let n=pY.getCurrent(e);n.each(n=>{bW.set(n,[IP(t)]);let r=null==o?void 0:o.toLowerCase();l(r)&&eC(t,r)&&pY.getCurrent(n).each(t=>{IR.showSlot(t,r),AO.immediateGrow(n),t2(n.element,"width"),IW(e.element,"region")})})},IW=(e,t)=>{tH(e,"role",t)},Ij=(e,t)=>{let o=pY.getCurrent(e);o.each(o=>{let n=pY.getCurrent(o);n.each(n=>{AO.hasGrown(o)?IR.isShowing(n,t)?(AO.shrink(o),IW(e.element,"presentation")):(IR.hideAllSlots(n),IR.showSlot(n,t),IW(e.element,"region")):(IR.hideAllSlots(n),IR.showSlot(n,t),AO.grow(o),IW(e.element,"region"))})})},IG=e=>{let t=pY.getCurrent(e);return t.bind(e=>{let t=AO.isGrowing(e)||AO.hasGrown(e);if(!t)return B.none();{let t=pY.getCurrent(e);return t.bind(e=>Y(IR.getSlotNames(e),t=>IR.isShowing(e,t)))}})},I$=lr("FixSizeEvent"),Iq=lr("AutoSizeEvent"),IX=e=>({uid:e.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"presentation"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:c2([OK.config({}),b0.config({}),AO.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:e=>{let t=pY.getCurrent(e);t.each(IR.hideAllSlots),iF(e,Iq)},onGrown:e=>{iF(e,Iq)},onStartGrow:e=>{iI(e,I$,{width:tQ(e.element,"width").getOr("")})},onStartShrink:e=>{iI(e,I$,{width:oi(e.element)+"px"})}}),bW.config({}),pY.config({find:e=>{let t=bW.contents(e);return el(t)}})])}],behaviours:c2([EU.childAt(0),bG("sidebar-sliding-events",[iW(I$,(e,t)=>{tX(e.element,"width",t.event.width)}),iW(Iq,(e,t)=>{t2(e.element,"width")})])])}),IK=(e,t,o,n)=>{tH(e.element,"aria-busy",!0);let r=t.getRoot(e).getOr(e),a=c2([bD.config({mode:"special",onTab:()=>B.some(!0),onShiftTab:()=>B.some(!0)}),b0.config({})]),i=n(r,a),l=r.getSystem().build(i);bW.append(r,lx(l)),l.hasConfigured(bD)&&t.focus&&bD.focusIn(l),o.isBlocked()||t.onBlock(e),o.blockWith(()=>bW.remove(r,l))},IY=(e,t,o)=>{tj(e.element,"aria-busy"),o.isBlocked()&&t.onUnblock(e),o.clear()};var IJ=Object.freeze({__proto__:null,block:IK,unblock:IY}),IZ=[aw("getRoot",B.none),ax("focus",!0),s6("onBlock"),s6("onUnblock")];let IQ=()=>{let e=dF(),t=t=>{e.set({destroy:t})};return lO({readState:e.isSet,blockWith:t,clear:e.clear,isBlocked:e.isSet})};var I0=Object.freeze({__proto__:null,init:IQ});let I1=c5({fields:IZ,name:"blocking",apis:IJ,state:I0}),I2=e=>{let t=void 0!==e.dom.attributes?e.dom.attributes:[];return X(t,(e,t)=>"class"===t.name?e:{...e,[t.name]:t.value},{})},I3=e=>Array.prototype.slice.call(e.dom.classList,0),I5=e=>{let t=eJ.fromHtml(e),o=tx(t),n=I2(t),r=I3(t),a=0===o.length?{}:{innerHtml:i3(t)};return{tag:e4(t),classes:r,attributes:n,...a}},I9=e=>(t,o)=>({dom:{tag:"div",attributes:{"aria-label":e.translate("Loading..."),tabindex:"0"},classes:["tox-throbber__busy-spinner"]},components:[{dom:I5('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}),I4=e=>pY.getCurrent(e).each(e=>dt(e.element)),I6=(e,t)=>{let o="tabindex",n=`data-mce-${o}`;B.from(e.iframeElement).map(eJ.fromDom).each(e=>{t?(tU(e,o).each(t=>tH(e,n,t)),tH(e,o,-1)):(tj(e,o),tU(e,n).each(t=>{tH(e,o,t),tj(e,n)}))})},I8=(e,t,o,n)=>{let r=t.element;if(I6(e,o),o)I1.block(t,I9(n)),t2(r,"display"),tj(r,"aria-hidden"),e.hasFocus()&&I4(t);else{let o=pY.getCurrent(t).exists(e=>dr(e.element));I1.unblock(t),tX(r,"display","none"),tH(r,"aria-hidden","true"),o&&e.focus()}},I7=e=>({uid:e.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:c2([bW.config({}),I1.config({focus:!1}),pY.config({find:e=>el(e.components())})]),components:[]}),Re=e=>"focusin"===e.type,Rt=e=>{if(!Re(e))return!1;{let t=e.composed?el(e.composedPath()):B.from(e.target);return t.map(eJ.fromDom).filter(te).exists(e=>l8(e,"mce-pastebin"))}},Ro=(e,t,o)=>{let n=aC(!1),r=dR(),a=o=>{n.get()&&!Rt(o)&&(o.preventDefault(),I4(t()),e.editorManager.setActive(e))};e.inline||e.on("PreInit",()=>{e.dom.bind(e.getWin(),"focusin",a),e.on("BeforeExecCommand",e=>{"mcefocus"===e.command.toLowerCase()&&!0!==e.value&&a(e)})});let i=r=>{r!==n.get()&&(n.set(r),I8(e,t(),r,o.providers),k_(e,r))};e.on("ProgressState",t=>{if(r.on(clearTimeout),b(t.time)){let o=v3.setEditorTimeout(e,()=>i(t.state),t.time);r.set(o)}else i(t.state),r.clear()})},Rn=(e,t)=>{let o=X(e,(e,o)=>{let n=t(o,e.len);return n.fold(k(e),t=>({len:t.finish,list:e.list.concat([t])}))},{len:0,list:[]});return o.list},Rr=(e,t,o)=>({within:e,extra:t,withinWidth:o}),Ra=(e,t,o)=>{let n=Rn(e,(e,t)=>{let n=o(e);return B.some({element:e,start:t,finish:t+n,width:n})}),r=$(n,e=>e.finish<=t),a=q(r,(e,t)=>e+t.width,0),i=n.slice(r.length);return{within:r,extra:i,withinWidth:a}},Ri=e=>U(e,e=>e.element),Rl=(e,t,o)=>{let n=Ri(e.concat(t));return Rr(n,[],o)},Rs=(e,t,o,n)=>{let r=Ri(e).concat([o]);return Rr(r,Ri(t),n)},Rc=(e,t,o)=>Rr(Ri(e),[],o),Rd=(e,t,o)=>{let n=Ra(t,e,o);return 0===n.extra.length?B.some(n):B.none()},Ru=(e,t,o,n)=>{let r=Rd(e,t,o).getOrThunk(()=>Ra(t,e-o(n),o)),a=r.within,i=r.extra,l=r.withinWidth;return 1===i.length&&i[0].width<=o(n)?Rl(a,i,l):i.length>=1?Rs(a,i,n,l):Rc(a,i,l)},Rm=(e,t)=>{let o=U(t,e=>lx(e));Ff.setGroups(e,o)},Rg=e=>ed(e,e=>di(e.element).bind(t=>e.getSystem().getByDom(t).toOptional())),Rp=(e,t,o)=>{let n=t.builtGroups.get();if(0===n.length)return;let r=pT(e,t,"primary"),a=CB.getCoupled(e,"overflowGroup");tX(r.element,"visibility","hidden");let i=n.concat([a]),l=Rg(i);o([]),Rm(r,i);let s=oi(r.element),c=Ru(s,t.builtGroups.get(),e=>oi(e.element),a);0===c.extra.length?(bW.remove(r,a),o([])):(Rm(r,c.within),o(c.extra)),t2(r.element,"visibility"),t3(r.element),l.each(b0.focus)},Rh=k([gW("splitToolbarBehaviours",[CB]),n7("builtGroups",()=>aC([]))]),Rf=k([s9(["overflowToggledClass"]),au("getOverflowBounds"),r4("lazySink"),n7("overflowGroups",()=>aC([])),s6("onOpened"),s6("onClosed")].concat(Rh())),Rb=k([pu({factory:Ff,schema:Fm(),name:"primary"}),pm({schema:Fm(),name:"overflow"}),pm({name:"overflow-button"}),pm({name:"overflow-group"})]),Rv=k((e,t)=>{os(e,Math.floor(t))}),Ry=k([s9(["toggledClass"]),r4("lazySink"),at("fetch"),au("getBounds"),ag("fireDismissalEventInstead",[ah("event",iC())]),un(),s6("onToggled")]),Rx=k([pm({name:"button",overrides:e=>({dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:c2([vs.config({toggleClass:e.markers.toggledClass,aria:{mode:"expanded"},toggleOnExecute:!1,onToggled:e.onToggled})])})}),pm({factory:Ff,schema:Fm(),name:"toolbar",overrides:e=>({toolbarBehaviours:c2([bD.config({mode:"cyclic",onEscape:t=>(p_(t,e,"button").each(b0.focus),B.none())})])})})]),Rw=dR(),RS=(e,t)=>{Rw.set(!0),Rk(e,t),Rw.clear()},Rk=(e,t)=>{let o=CB.getCoupled(e,"toolbarSandbox");gs.isOpen(o)?gs.close(o):gs.open(o,t.toolbar())},RC=(e,t,o,n)=>{let r=o.getBounds.map(e=>e()),a=o.lazySink(e).getOrDie();mI.positionWithinBounds(a,t,{anchor:{type:"hotspot",hotspot:e,layouts:n,overrides:{maxWidthFunction:Rv()}}},r)},RO=(e,t,o,n,r)=>{Ff.setGroups(t,r),RC(e,t,o,n),vs.on(e)},R_=(e,t,o)=>{let n=sW(),r=(r,a)=>{let i=Rw.get().getOr(!1);o.fetch().get(r=>{RO(e,a,o,t.layouts,r),n.link(e.element),i||bD.focusIn(a)})},a=()=>{vs.off(e),Rw.get().getOr(!1)||b0.focus(e),n.unlink(e.element)};return{dom:{tag:"div",attributes:{id:n.id}},behaviours:c2([bD.config({mode:"special",onEscape:e=>(gs.close(e),B.some(!0))}),gs.config({onOpen:r,onClose:a,isPartOf:(t,o,n)=>sG(o,n)||sG(e,n),getAttachPoint:()=>o.lazySink(e).getOrDie()}),c8.config({channels:{...gg({isExtraPart:A,...o.fireDismissalEventInstead.map(e=>({fireEventInstead:{event:e.event}})).getOr({})}),...gh({doReposition:()=>{gs.getState(CB.getCoupled(e,"toolbarSandbox")).each(n=>{RC(e,n,o,t.layouts)})}})}})])}},RT=(e,t,o,n)=>({...v9.sketch({...n.button(),action:e=>{Rk(e,n)},buttonBehaviours:g$.augment({dump:n.button().buttonBehaviours},[CB.config({others:{toolbarSandbox:t=>R_(t,o,e)}})])}),apis:{setGroups:(t,n)=>{gs.getState(CB.getCoupled(t,"toolbarSandbox")).each(r=>{RO(t,r,e,o.layouts,n)})},reposition:t=>{gs.getState(CB.getCoupled(t,"toolbarSandbox")).each(n=>{RC(t,n,e,o.layouts)})},toggle:e=>{Rk(e,n)},toggleWithoutFocusing:e=>{RS(e,n)},getToolbar:e=>gs.getState(CB.getCoupled(e,"toolbarSandbox")),isOpen:e=>gs.isOpen(CB.getCoupled(e,"toolbarSandbox"))}}),RE=pG({name:"FloatingToolbarButton",factory:RT,configFields:Ry(),partFields:Rx(),apis:{setGroups:(e,t,o)=>{e.setGroups(t,o)},reposition:(e,t)=>{e.reposition(t)},toggle:(e,t)=>{e.toggle(t)},toggleWithoutFocusing:(e,t)=>{e.toggleWithoutFocusing(t)},getToolbar:(e,t)=>e.getToolbar(t),isOpen:(e,t)=>e.isOpen(t)}}),RD=k([r4("items"),s9(["itemSelector"]),gW("tgroupBehaviours",[bD])]),RA=k([pp({name:"items",unit:"item"})]),RM=(e,t,o,n)=>({uid:e.uid,dom:e.dom,components:t,behaviours:gG(e.tgroupBehaviours,[bD.config({mode:"flow",selector:e.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}),RB=pG({name:"ToolbarGroup",configFields:RD(),partFields:RA(),factory:RM}),RF=e=>U(e,e=>lx(e)),RI=(e,t,o)=>{Rp(e,o,n=>{o.overflowGroups.set(n),t.getOpt(e).each(e=>{RE.setGroups(e,RF(n))})})},RR=(e,t,o,n)=>{let r=v4(RE.sketch({fetch:()=>CL.nu(t=>{t(RF(e.overflowGroups.get()))}),layouts:{onLtr:()=>[cB,cM],onRtl:()=>[cM,cB],onBottomLtr:()=>[cI,cF],onBottomRtl:()=>[cF,cI]},getBounds:o.getOverflowBounds,lazySink:e.lazySink,fireDismissalEventInstead:{},markers:{toggledClass:e.markers.overflowToggledClass},parts:{button:n["overflow-button"](),toolbar:n.overflow()},onToggled:(t,o)=>e[o?"onOpened":"onClosed"](t)}));return{uid:e.uid,dom:e.dom,components:t,behaviours:gG(e.splitToolbarBehaviours,[CB.config({others:{overflowGroup:()=>RB.sketch({...n["overflow-group"](),items:[r.asSpec()]})}})]),apis:{setGroups:(t,o)=>{e.builtGroups.set(U(o,t.getSystem().build)),RI(t,r,e)},refresh:t=>RI(t,r,e),toggle:e=>{r.getOpt(e).each(e=>{RE.toggle(e)})},toggleWithoutFocusing:e=>{r.getOpt(e).each(RE.toggleWithoutFocusing)},isOpen:e=>r.getOpt(e).map(RE.isOpen).getOr(!1),reposition:e=>{r.getOpt(e).each(e=>{RE.reposition(e)})},getOverflow:e=>r.getOpt(e).bind(RE.getToolbar)},domModification:{attributes:{role:"group"}}}},RN=pG({name:"SplitFloatingToolbar",configFields:Rf(),partFields:Rb(),factory:RR,apis:{setGroups:(e,t,o)=>{e.setGroups(t,o)},refresh:(e,t)=>{e.refresh(t)},reposition:(e,t)=>{e.reposition(t)},toggle:(e,t)=>{e.toggle(t)},toggleWithoutFocusing:(e,t)=>{e.toggle(t)},isOpen:(e,t)=>e.isOpen(t),getOverflow:(e,t)=>e.getOverflow(t)}}),RV=k([s9(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),s6("onOpened"),s6("onClosed")].concat(Rh())),Rz=k([pu({factory:Ff,schema:Fm(),name:"primary"}),pu({factory:Ff,schema:Fm(),name:"overflow",overrides:e=>({toolbarBehaviours:c2([AO.config({dimension:{property:"height"},closedClass:e.markers.closedClass,openClass:e.markers.openClass,shrinkingClass:e.markers.shrinkingClass,growingClass:e.markers.growingClass,onShrunk:t=>{p_(t,e,"overflow-button").each(e=>{vs.off(e),b0.focus(e)}),e.onClosed(t)},onGrown:t=>{bD.focusIn(t),e.onOpened(t)},onStartGrow:t=>{p_(t,e,"overflow-button").each(vs.on)}}),bD.config({mode:"acyclic",onEscape:t=>(p_(t,e,"overflow-button").each(b0.focus),B.some(!0))})])})}),pm({name:"overflow-button",overrides:e=>({buttonBehaviours:c2([vs.config({toggleClass:e.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])})}),pm({name:"overflow-group"})]),RH=(e,t)=>p_(e,t,"overflow").map(AO.hasGrown).getOr(!1),RL=(e,t)=>{p_(e,t,"overflow-button").bind(()=>p_(e,t,"overflow")).each(o=>{RP(e,t),AO.toggleGrow(o)})},RP=(e,t)=>{p_(e,t,"overflow").each(o=>{Rp(e,t,e=>{let t=U(e,e=>lx(e));Ff.setGroups(o,t)}),p_(e,t,"overflow-button").each(e=>{AO.hasGrown(o)&&vs.on(e)}),AO.refresh(o)})},RU=(e,t,o,n)=>{let r="alloy.toolbar.toggle",a=(t,o)=>{let n=U(o,t.getSystem().build);e.builtGroups.set(n)};return{uid:e.uid,dom:e.dom,components:t,behaviours:gG(e.splitToolbarBehaviours,[CB.config({others:{overflowGroup:e=>RB.sketch({...n["overflow-group"](),items:[v9.sketch({...n["overflow-button"](),action:t=>{iF(e,r)}})]})}}),bG("toolbar-toggle-events",[iW(r,t=>{RL(t,e)})])]),apis:{setGroups:(t,o)=>{a(t,o),RP(t,e)},refresh:t=>RP(t,e),toggle:t=>RL(t,e),isOpen:t=>RH(t,e)},domModification:{attributes:{role:"group"}}}},RW=pG({name:"SplitSlidingToolbar",configFields:RV(),partFields:Rz(),factory:RU,apis:{setGroups:(e,t,o)=>{e.setGroups(t,o)},refresh:(e,t)=>{e.refresh(t)},toggle:(e,t)=>{e.toggle(t)},isOpen:(e,t)=>e.isOpen(t)}}),Rj=e=>{let t=e.title.fold(()=>({}),e=>({attributes:{title:e}}));return{dom:{tag:"div",classes:["tox-toolbar__group"],...t},components:[RB.parts.items({})],items:e.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled]), .tox-number-input:not([disabled])"},tgroupBehaviours:c2([OK.config({}),b0.config({})])}},RG=e=>RB.sketch(Rj(e)),R$=(e,t)=>{let o=iZ(t=>{let o=U(e.initGroups,RG);Ff.setGroups(t,o)});return c2([SA.toolbarButton(e.providers.isDisabled),SO(),bD.config({mode:t,onEscape:e.onEscape,selector:".tox-toolbar__group"}),bG("toolbar-events",[o])])},Rq=e=>{let t=e.cyclicKeying?"cyclic":"acyclic";return{uid:e.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":Rj({title:B.none(),items:[]}),"overflow-button":Mr({name:"more",icon:B.some("more-drawer"),enabled:!0,tooltip:B.some("More..."),primary:!1,buttonType:B.none(),borderless:!1},B.none(),e.providers)},splitToolbarBehaviours:R$(e,t)}},RX=e=>{let t=Rq(e),o=RN.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}});return RN.sketch({...t,lazySink:e.getSink,getOverflowBounds:()=>{let t=e.moreDrawerData.lazyHeader().element,o=nU(t),n=tg(t),r=nU(n),a=Math.max(n.dom.scrollHeight,r.height);return nL(o.x+4,r.y,o.width-8,a)},parts:{...t.parts,overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:e.attributes}}},components:[o],markers:{overflowToggledClass:"tox-tbtn--enabled"},onOpened:t=>e.onToggled(t,!0),onClosed:t=>e.onToggled(t,!1)})},RK=e=>{let t=RW.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),o=RW.parts.overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),n=Rq(e);return RW.sketch({...n,components:[t,o],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:t=>{t.getSystem().broadcastOn([Io()],{type:"opened"}),e.onToggled(t,!0)},onClosed:t=>{t.getSystem().broadcastOn([Io()],{type:"closed"}),e.onToggled(t,!1)}})},RY=e=>{let t=e.cyclicKeying?"cyclic":"acyclic";return Ff.sketch({uid:e.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(e.type===nA.scrolling?["tox-toolbar--scrolling"]:[])},components:[Ff.parts.groups({})],toolbarBehaviours:R$(e,t)})},RJ=[wd,wu,ac("tooltip"),ay("buttonType","secondary",["primary","secondary"]),ax("borderless",!1),at("onAction")],RZ=[...RJ,we,ae("type",["button"])],RQ=[...RJ,ax("active",!1),ae("type",["togglebutton"])],R0={button:RZ,togglebutton:RQ},R1=[ae("type",["group"]),aS("buttons",[],r3("type",R0))],R2=r3("type",{...R0,group:R1}),R3=rI([aS("buttons",[],R2),at("onShow"),at("onHide")]),R5=e=>rQ("view",R3,e),R9=(e,t)=>{var o,n;let r="togglebutton"===e.type,a=e.icon.map(e=>Dv(e,t.icons)).map(v4),i=o=>{let n=e=>{a.map(n=>n.getOpt(o).each(o=>{bW.set(o,[Dv(e,t.icons)])}))},i=e=>{let t=o.element;e?(l9(t,"tox-button--enabled"),tH(t,"aria-pressed",!0)):(l6(t,"tox-button--enabled"),tj(t,"aria-pressed"))},l=()=>l8(o.element,"tox-button--enabled");return r?e.onAction({setIcon:n,setActive:i,isActive:l}):"button"===e.type?e.onAction({setIcon:n}):void 0},l={...e,name:r?e.text.getOr(e.icon.getOr("")):null!==(o=e.text)&&void 0!==o?o:e.icon.getOr(""),primary:"primary"===e.buttonType,buttonType:B.from(e.buttonType),tooltip:e.tooltip,icon:e.icon,enabled:!0,borderless:e.borderless},s=Ma(null!==(n=e.buttonType)&&void 0!==n?n:"secondary"),c=r?e.text.map(t.translate):B.some(t.translate(e.text)),d=c.map(s_),u=l.tooltip.or(c).map(e=>({"aria-label":t.translate(e),title:t.translate(e)})).getOr({}),m=a.map(e=>e.asSpec()),g=eE([m,d]),p=e.icon.isSome()&&d.isSome(),h={tag:"button",classes:s.concat(...e.icon.isSome()&&!p?["tox-button--icon"]:[]).concat(...p?["tox-button--icon-and-text"]:[]).concat(...e.borderless?["tox-button--naked"]:[]).concat(..."togglebutton"===e.type&&e.active?["tox-button--enabled"]:[]),attributes:u},f=Mn(l,B.some(i),[],h,g,t);return v9.sketch(f)},R4=(e,t)=>R9(e,t),R6=(e,t)=>({dom:{tag:"div",classes:["tox-view__toolbar__group"]},components:U(e.buttons,e=>R4(e,t))}),R8=oX().deviceType,R7=R8.isPhone(),Ne=R8.isTablet(),Nt=e=>{let t=!1,o=U(e.buttons,o=>"group"===o.type?(t=!0,R6(o,e.providers)):R4(o,e.providers));return{uid:e.uid,dom:{tag:"div",classes:[t?"tox-view__toolbar":"tox-view__header",...R7||Ne?["tox-view--mobile","tox-view--scrolling"]:[]]},behaviours:c2([b0.config({}),bD.config({mode:"flow",selector:"button, .tox-button",focusInside:nE.OnEnterOrSpaceMode})]),components:t?o:[OH.sketch({dom:{tag:"div",classes:["tox-view__header-start"]},components:[]}),OH.sketch({dom:{tag:"div",classes:["tox-view__header-end"]},components:o})]}},No=e=>({uid:e.uid,dom:{tag:"div",classes:["tox-view__pane"]}}),Nn=(e,t,o,n)=>({uid:e.uid,dom:e.dom,components:t,apis:{getPane:t=>pI.getPart(t,e,"pane"),getOnShow:t=>e.viewConfig.onShow,getOnHide:t=>e.viewConfig.onHide}});var Nr=pG({name:"silver.View",configFields:[r4("viewConfig")],partFields:[pg({factory:{sketch:Nt},schema:[r4("buttons"),r4("providers")],name:"header"}),pg({factory:{sketch:No},schema:[],name:"pane"})],factory:Nn,apis:{getPane:(e,t)=>e.getPane(t),getOnShow:(e,t)=>e.getOnShow(t),getOnHide:(e,t)=>e.getOnHide(t)}});let Na=(e,t,o)=>ex(t,(t,n)=>{let r=r0(R5(t));return e.slot(n,Nr.sketch({dom:{tag:"div",classes:["tox-view"]},viewConfig:r,components:[...r.buttons.length>0?[Nr.parts.header({buttons:r.buttons,providers:o})]:[],Nr.parts.pane({})]}))}),Ni=(e,t)=>IR.sketch(o=>({dom:{tag:"div",classes:["tox-view-wrap__slot-container"]},components:Na(o,e,t),slotBehaviours:Sl.unnamedEvents([iZ(e=>IR.hideAllSlots(e))])})),Nl=e=>Y(IR.getSlotNames(e),t=>IR.isShowing(e,t)),Ns=e=>{let t=e.element;tX(t,"display","none"),tH(t,"aria-hidden","true")},Nc=e=>{let t=e.element;t2(t,"display"),tj(t,"aria-hidden")},Nd=e=>({getContainer:k(e)}),Nu=(e,t,o)=>{IR.getSlot(e,t).each(e=>{Nr.getPane(e).each(t=>{let n=o(e);n(Nd(t.element.dom))})})},Nm=(e,t)=>Nu(e,t,Nr.getOnShow),Ng=(e,t)=>Nu(e,t,Nr.getOnHide),Np=(e,t)=>{let o=(e,o)=>{bW.set(e,[Ni(o,t.backstage.shared.providers)])},n=e=>pY.getCurrent(e).bind(Nl),r=(e,t,o,n)=>pY.getCurrent(e).exists(r=>{let a=Nl(r),i=a.exists(e=>n===e),l=IR.getSlot(r,n).isSome();return l&&(IR.hideAllSlots(r),i?(Ns(e),t()):(o(),Nc(e),IR.showSlot(r,n),Nm(r,n)),a.each(e=>Ng(r,e))),l});return{uid:e.uid,dom:{tag:"div",classes:["tox-view-wrap"],attributes:{"aria-hidden":"true"},styles:{display:"none"}},components:[],behaviours:c2([bW.config({}),pY.config({find:e=>{let t=bW.contents(e);return el(t)}})]),apis:{setViews:o,whichView:n,toggleView:r}}};var Nh=pj({factory:Np,name:"silver.ViewWrapper",configFields:[r4("backstage")],apis:{setViews:(e,t,o)=>e.setViews(t,o),toggleView:(e,t,o,n,r)=>e.toggleView(t,o,n,r),whichView:(e,t)=>e.whichView(t)}});let Nf=(e,t,o)=>{let n=!1,r={getSocket:t=>pI.getPart(t,e,"socket"),setSidebar:(t,o,n)=>{pI.getPart(t,e,"sidebar").each(e=>IU(e,o,n))},toggleSidebar:(t,o)=>{pI.getPart(t,e,"sidebar").each(e=>Ij(e,o))},whichSidebar:t=>pI.getPart(t,e,"sidebar").bind(IG).getOrNull(),getHeader:t=>pI.getPart(t,e,"header"),getToolbar:t=>pI.getPart(t,e,"toolbar"),setToolbar:(t,o)=>{pI.getPart(t,e,"toolbar").each(e=>{let t=U(o,RG);e.getApis().setGroups(e,t)})},setToolbars:(t,o)=>{pI.getPart(t,e,"multiple-toolbar").each(e=>{let t=U(o,e=>U(e,RG));Fu.setItems(e,t)})},refreshToolbar:t=>{let o=pI.getPart(t,e,"toolbar");o.each(e=>e.getApis().refresh(e))},toggleToolbarDrawer:t=>{pI.getPart(t,e,"toolbar").each(e=>{eB(e.getApis().toggle,t=>t(e))})},toggleToolbarDrawerWithoutFocusing:t=>{pI.getPart(t,e,"toolbar").each(e=>{eB(e.getApis().toggleWithoutFocusing,t=>t(e))})},isToolbarDrawerToggled:t=>pI.getPart(t,e,"toolbar").bind(e=>B.from(e.getApis().isOpen).map(t=>t(e))).getOr(!1),getThrobber:t=>pI.getPart(t,e,"throbber"),focusToolbar:t=>{let o=pI.getPart(t,e,"toolbar").orThunk(()=>pI.getPart(t,e,"multiple-toolbar"));o.each(e=>{bD.focusIn(e)})},setMenubar:(t,o)=>{pI.getPart(t,e,"menubar").each(e=>{IT.setMenus(e,o)})},focusMenubar:t=>{pI.getPart(t,e,"menubar").each(e=>{IT.focus(e)})},setViews:(t,o)=>{pI.getPart(t,e,"viewWrapper").each(e=>{Nh.setViews(e,o)})},toggleView:(t,o)=>pI.getPart(t,e,"viewWrapper").exists(e=>Nh.toggleView(e,()=>r.showMainView(t),()=>r.hideMainView(t),o)),whichView:t=>pI.getPart(t,e,"viewWrapper").bind(Nh.whichView).getOrNull(),hideMainView:t=>{(n=r.isToolbarDrawerToggled(t))&&r.toggleToolbarDrawer(t),pI.getPart(t,e,"editorContainer").each(e=>{let t=e.element;tX(t,"display","none"),tH(t,"aria-hidden","true")})},showMainView:t=>{n&&r.toggleToolbarDrawer(t),pI.getPart(t,e,"editorContainer").each(e=>{let t=e.element;t2(t,"display"),tj(t,"aria-hidden")}),r.refreshToolbar(t)}};return{uid:e.uid,dom:e.dom,components:t,apis:r,behaviours:e.behaviours}},Nb=pf.optional({factory:IT,name:"menubar",schema:[r4("backstage")]}),Nv=e=>e.type===nA.sliding?RK:e.type===nA.floating?RX:RY,Ny=pf.optional({factory:{sketch:e=>Fu.sketch({uid:e.uid,dom:e.dom,listBehaviours:c2([bD.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:()=>RY({type:e.type,uid:lr("multiple-toolbar-item"),cyclicKeying:!1,initGroups:[],providers:e.providers,onEscape:()=>(e.onEscape(),B.some(!0))}),setupItem:(e,t,o,n)=>{Ff.setGroups(t,o)},shell:!0})},name:"multiple-toolbar",schema:[r4("dom"),r4("onEscape")]}),Nx=pf.optional({factory:{sketch:e=>{let t=Nv(e),o={type:e.type,uid:e.uid,onEscape:()=>(e.onEscape(),B.some(!0)),onToggled:(t,o)=>e.onToolbarToggled(o),cyclicKeying:!1,initGroups:[],getSink:e.getSink,providers:e.providers,moreDrawerData:{lazyToolbar:e.lazyToolbar,lazyMoreButton:e.lazyMoreButton,lazyHeader:e.lazyHeader},attributes:e.attributes};return t(o)}},name:"toolbar",schema:[r4("dom"),r4("onEscape"),r4("getSink")]}),Nw=pf.optional({factory:{sketch:Iv},name:"header",schema:[r4("dom")]}),NS=pf.optional({factory:{sketch:IE},name:"promotion",schema:[r4("dom")]}),Nk=pf.optional({name:"socket",schema:[r4("dom")]}),NC=pf.optional({factory:{sketch:IX},name:"sidebar",schema:[r4("dom")]}),NO=pf.optional({factory:{sketch:I7},name:"throbber",schema:[r4("dom")]}),N_=pf.optional({factory:Nh,name:"viewWrapper",schema:[r4("backstage")]}),NT=e=>({uid:e.uid,dom:{tag:"div",classes:["tox-editor-container"]},components:e.components}),NE=pf.optional({factory:{sketch:NT},name:"editorContainer",schema:[]});var ND=pG({name:"OuterContainer",factory:Nf,configFields:[r4("dom"),r4("behaviours")],partFields:[Nw,Nb,Nx,Ny,Nk,NC,NS,NO,N_,NE],apis:{getSocket:(e,t)=>e.getSocket(t),setSidebar:(e,t,o,n)=>{e.setSidebar(t,o,n)},toggleSidebar:(e,t,o)=>{e.toggleSidebar(t,o)},whichSidebar:(e,t)=>e.whichSidebar(t),getHeader:(e,t)=>e.getHeader(t),getToolbar:(e,t)=>e.getToolbar(t),setToolbar:(e,t,o)=>{e.setToolbar(t,o)},setToolbars:(e,t,o)=>{e.setToolbars(t,o)},refreshToolbar:(e,t)=>e.refreshToolbar(t),toggleToolbarDrawer:(e,t)=>{e.toggleToolbarDrawer(t)},toggleToolbarDrawerWithoutFocusing:(e,t)=>{e.toggleToolbarDrawerWithoutFocusing(t)},isToolbarDrawerToggled:(e,t)=>e.isToolbarDrawerToggled(t),getThrobber:(e,t)=>e.getThrobber(t),setMenubar:(e,t,o)=>{e.setMenubar(t,o)},focusMenubar:(e,t)=>{e.focusMenubar(t)},focusToolbar:(e,t)=>{e.focusToolbar(t)},setViews:(e,t,o)=>{e.setViews(t,o)},toggleView:(e,t,o)=>e.toggleView(t,o),whichView:(e,t)=>e.whichView(t)}});let NA={file:{title:"File",items:"newdocument restoredraft | preview | export print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template inserttemplate codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor tableofcontents footnotes | mergetags | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | styles blocks fontfamily fontsize align lineheight | forecolor backcolor | language | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | autocorrect capitalization | a11ycheck code typography wordcount addtemplate"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},NM=(e,t,o)=>{let n=yM(o).split(/[ ,]/);return{text:e.title,getItems:()=>Q(e.items,e=>{let o=e.toLowerCase();return 0===o.trim().length||H(n,e=>e===o)?[]:"separator"===o||"|"===o?[{type:"separator"}]:t.menuItems[o]?[t.menuItems[o]]:[]})}},NB=e=>e.split(" "),NF=(e,t)=>{let o={...NA,...t.menus},n=eu(t.menus).length>0,r=void 0===t.menubar||!0===t.menubar?NB("file edit view insert format tools table help"):NB(!1===t.menubar?"":t.menubar),a=$(r,e=>{let o=eC(NA,e);return n?o||ek(t.menus,e).exists(e=>eC(e,"items")):o}),i=U(a,n=>{let r=o[n];return NM({title:r.title,items:NB(r.items)},t,e)});return $(i,e=>{let t=e=>l(e)||"separator"!==e.type;return e.getItems().length>0&&H(e.getItems(),t)})},NI=e=>{let t=()=>{e._skinLoaded=!0,kx(e)};return()=>{e.initialized?t():e.on("init",t)}},NR=(e,t)=>()=>kw(e,{message:t}),NN=(e,t,o)=>(e.on("remove",()=>o.unload(t)),o.load(t)),NV=(e,t)=>NN(e,t+"/skin.min.css",e.ui.styleSheetLoader),Nz=(e,t)=>{let o=tA(eJ.fromDom(e.getElement()));return o?NN(e,t+"/skin.shadowdom.min.css",yp.DOM.styleSheetLoader):Promise.resolve()},NH=(e,t)=>{let o=y5(t);return(o&&t.contentCSS.push(o+(e?"/content.inline":"/content")+".min.css"),!y2(t)&&l(o))?Promise.all([NV(t,o),Nz(t,o)]).then(NI(t),NR(t,"Skin could not be loaded")):Promise.resolve(NI(t)())},NL=_(NH,!1),NP=_(NH,!0),NU=(e,t)=>o=>{let n=dI(),r=()=>{o.setActive(e.formatter.match(t));let r=e.formatter.formatChanged(t,o.setActive);n.set(r)};return e.initialized?r():e.once("init",r),()=>{e.off("init",r),n.clear()}},NW=(e,t,o)=>n=>{let r=()=>o(n),a=()=>{o(n),e.on(t,r)};return e.initialized?a():e.once("init",a),()=>{e.off("init",a),e.off(t,r)}},Nj=e=>t=>()=>{e.undoManager.transact(()=>{e.focus(),e.execCommand("mceToggleFormat",!1,t.format)})},NG=(e,t)=>()=>e.execCommand(t),N$=(e,t,o)=>{let n=(e,n,a,i)=>{let l=t.shared.providers.translate(e.title);if("separator"===e.type)return B.some({type:"separator",text:l});if("submenu"!==e.type)return B.some({type:"togglemenuitem",text:l,icon:e.icon,active:e.isSelected(i),enabled:!a,onAction:o.onAction(e),...e.getStylePreview().fold(()=>({}),e=>({meta:{style:e}}))});{let t=Q(e.getStyleItems(),e=>r(e,n,i));return 0===n&&t.length<=0?B.none():B.some({type:"nestedmenuitem",text:l,enabled:t.length>0,getSubmenuItems:()=>Q(e.getStyleItems(),e=>r(e,n,i))})}},r=(e,t,r)=>{let a="formatter"===e.type&&o.isInvalid(e);return 0===t?a?[]:n(e,t,!1,r).toArray():n(e,t,a,r).toArray()},a=e=>{let t=o.getCurrentValue(),n=o.shouldHide?0:1;return Q(e,e=>r(e,n,t))},i=(e,t)=>(o,n)=>{let r=t(),i=a(r),l=DF(i,xg.CLOSE_ON_EXECUTE,e,{isHorizontalMenu:!1,search:B.none()});n(l)};return{validateItems:a,getFetch:i}},Nq=(e,t,o)=>{let n=o.dataset,r="basic"===n.type?()=>U(n.data,e=>BS(e,o.isSelectedFor,o.getPreviewFor)):n.getData;return{items:N$(e,t,o),getStyleItems:r}},NX=(e,t,o)=>{let{items:n,getStyleItems:r}=Nq(e,t,o),a=e=>({getComponent:k(e)}),i=NW(e,"NodeChange",e=>{let t=e.getComponent();o.updateText(t)});return DS({text:o.icon.isSome()?B.none():o.text,icon:o.icon,tooltip:B.from(o.tooltip),role:B.none(),fetch:n.getFetch(t,r),onSetup:i,getApi:a,columns:1,presets:"normal",classes:o.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",t.shared)},NK=e=>U(e,e=>{let t=e,o=e,n=e.split("=");return n.length>1&&(t=n[0],o=n[1]),{title:t,format:o}}),NY=e=>({type:"basic",data:e});(nk=nI||(nI={}))[nk.SemiColon=0]="SemiColon",nk[nk.Space=1]="Space";let NJ=(e,t)=>t===nI.SemiColon?e.replace(/;$/,"").split(";"):e.split(" "),NZ=(e,t,o)=>{let n=e.options.get(t),r=NK(NJ(n,o));return{type:"basic",data:r}},NQ=[{title:"Left",icon:"align-left",format:"alignleft",command:"JustifyLeft"},{title:"Center",icon:"align-center",format:"aligncenter",command:"JustifyCenter"},{title:"Right",icon:"align-right",format:"alignright",command:"JustifyRight"},{title:"Justify",icon:"align-justify",format:"alignjustify",command:"JustifyFull"}],N0=e=>{let t=()=>Y(NQ,t=>e.formatter.match(t.format)),o=t=>()=>e.formatter.match(t),n=e=>{let o=t(),n=o.fold(k("left"),e=>e.title.toLowerCase());iI(e,Dw,{icon:`align-${n}`})},r=NY(NQ),a=t=>()=>Y(NQ,e=>e.format===t.format).each(t=>e.execCommand(t.command));return{tooltip:"Align",text:B.none(),icon:B.some("align-left"),isSelectedFor:o,getCurrentValue:B.none,getPreviewFor:e=>B.none,onAction:a,updateText:n,dataset:r,shouldHide:!1,isInvalid:t=>!e.formatter.canApply(t.format)}},N1=(e,t)=>NX(e,t,N0(e)),N2=(e,t)=>{let o=Nq(e,t,N0(e));e.ui.registry.addNestedMenuItem("align",{text:t.shared.providers.translate("Align"),getSubmenuItems:()=>o.items.validateItems(o.getStyleItems())})},N3=(e,t)=>{let o=t(),n=U(o,e=>e.format);return B.from(e.formatter.closest(n)).bind(e=>Y(o,t=>t.format===e)).orThunk(()=>eF(e.formatter.match("p"),{title:"Paragraph",format:"p"}))},N5=e=>{let t="Paragraph",o=t=>()=>e.formatter.match(t),n=t=>()=>{let o=e.formatter.get(t);return o?B.some({tag:o.length>0&&(o[0].inline||o[0].block)||"div",styles:e.dom.parseStyle(e.formatter.getCssText(t))}):B.none()},r=o=>{let n=N3(e,()=>a.data),r=n.fold(k(t),e=>e.title);iI(o,Dx,{text:r})},a=NZ(e,"block_formats",nI.SemiColon);return{tooltip:"Blocks",text:B.some(t),icon:B.none(),isSelectedFor:o,getCurrentValue:B.none,getPreviewFor:n,onAction:Nj(e),updateText:r,dataset:a,shouldHide:!1,isInvalid:t=>!e.formatter.canApply(t.format)}},N9=(e,t)=>NX(e,t,N5(e)),N4=(e,t)=>{let o=Nq(e,t,N5(e));e.ui.registry.addNestedMenuItem("blocks",{text:"Blocks",getSubmenuItems:()=>o.items.validateItems(o.getStyleItems())})},N6=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],N8=e=>{let t=e.split(/\s*,\s*/);return U(t,e=>e.replace(/^['"]+|['"]+$/g,""))},N7=e=>0===e.indexOf("-apple-system")&&(()=>{let t=N8(e.toLowerCase());return ee(N6,e=>t.indexOf(e.toLowerCase())>-1)})(),Ve=e=>{let t="System Font",o=()=>{let o=e=>e?N8(e)[0]:"",n=e.queryCommandValue("FontName"),r=s.data,a=n?n.toLowerCase():"",i=Y(r,e=>{let t=e.format;return t.toLowerCase()===a||o(t).toLowerCase()===o(a).toLowerCase()}).orThunk(()=>eF(N7(a),{title:t,format:a}));return{matchOpt:i,font:n}},n=e=>t=>t.exists(t=>t.format===e),r=()=>{let{matchOpt:e}=o();return e},a=e=>()=>B.some({tag:"div",styles:-1===e.indexOf("dings")?{"font-family":e}:{}}),i=t=>()=>{e.undoManager.transact(()=>{e.focus(),e.execCommand("FontName",!1,t.format)})},l=e=>{let{matchOpt:t,font:n}=o(),r=t.fold(k(n),e=>e.title);iI(e,Dx,{text:r})},s=NZ(e,"font_family_formats",nI.SemiColon);return{tooltip:"Fonts",text:B.some(t),icon:B.none(),isSelectedFor:n,getCurrentValue:r,getPreviewFor:a,onAction:i,updateText:l,dataset:s,shouldHide:!1,isInvalid:A}},Vt=(e,t)=>NX(e,t,Ve(e)),Vo=(e,t)=>{let o=Nq(e,t,Ve(e));e.ui.registry.addNestedMenuItem("fontfamily",{text:t.shared.providers.translate("Fonts"),getSubmenuItems:()=>o.items.validateItems(o.getStyleItems())})},Vn={tab:k(9),escape:k(27),enter:k(13),backspace:k(8),delete:k(46),left:k(37),up:k(38),right:k(39),down:k(40),space:k(32),home:k(36),end:k(35),pageUp:k(33),pageDown:k(34)},Vr={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},Va=(()=>{let e="[0-9]+",t="[eE][+-]?"+e,o=e=>`(?:${e})?`,n=["Infinity",e+"\\."+o(e)+o(t),"\\."+e+o(t),e+o(t)].join("|"),r=`[+-]?(?:${n})`;return RegExp(`^(${r})(.*)$`)})(),Vi=(e,t)=>H(t,t=>H(Vr[t],t=>e===t)),Vl=(e,t)=>{let o=B.from(Va.exec(e));return o.bind(e=>{let o=Number(e[1]),n=e[2];return Vi(n,t)?B.some({value:o,unit:n}):B.none()})},Vs=(e,t)=>Vl(e,t).map(({value:e,unit:t})=>e+t),Vc=(e,t,o)=>{let n=B.none(),r=e=>e.map(e=>gU.getValue(e)).getOr(""),a=NW(e,"NodeChange",e=>{let t=e.getComponent();n=B.some(t),o.updateInputValue(t)}),i=e=>({getComponent:k(e)}),l=aC(y),s=lr("custom-number-input-events"),c=e=>e>=0,d=(t,a,i)=>{let l=r(n),s=Vl(l,["unsupportedLength","empty"]),d=s.map(e=>e.value).getOr(0),u=yW(e),m=s.map(e=>e.unit).filter(e=>""!==e).getOr(u),g=t(d,o.getConfigFromUnit(m).step),p=`${c(g)?g:d}${m}`,h=`${d}${m}`.length-`${p}`.length,f=n.map(e=>e.element.dom.selectionStart-h),b=n.map(e=>e.element.dom.selectionEnd-h);o.onAction(p,i),n.each(e=>{gU.setValue(e,p),a&&(f.each(t=>e.element.dom.selectionStart=t),b.each(t=>e.element.dom.selectionEnd=t))})},u=(e,t)=>d((e,t)=>e-t,e,t),m=(e,t)=>d((e,t)=>e+t,e,t),g=e=>tf(e.element).fold(B.none,e=>(dt(e),B.some(!0))),p=e=>dr(e.element)?(tS(e.element).each(e=>dt(e)),B.some(!0)):B.none(),h=(e,o,n,r)=>{let a=t.shared.providers.translate(n),i=lr("altExecuting");return v9.sketch({dom:{tag:"button",attributes:{title:a,"aria-label":a},classes:r.concat(o)},components:[Db(o,t.shared.providers.icons)],buttonBehaviours:c2([bG(i,[iW(a5(),(t,o)=>{(o.event.raw.keyCode===Vn.space()||o.event.raw.keyCode===Vn.enter())&&e(!1)}),iW(a8(),(t,o)=>{e(!0)})])]),eventOrder:{[a5()]:[i,"keying"],[a8()]:[i,"alloy.base.behaviour"]}})},f=v4(h(e=>u(!1,e),"minus","Decrease font size",["highlight-on-focus"])),b=v4(h(e=>m(!1,e),"plus","Increase font size",["highlight-on-focus"])),v=v4({dom:{tag:"div",classes:["tox-input-wrapper","highlight-on-focus"]},components:[xV.sketch({inputBehaviours:c2([bG(s,[SB({onSetup:a,getApi:i},l),SF({getApi:i},l)]),bG("input-update-display-text",[iW(Dx,(e,t)=>{gU.setValue(e,t.event.text)}),iW(a3(),e=>{o.onAction(gU.getValue(e))}),iW(a6(),e=>{o.onAction(gU.getValue(e))})]),bD.config({mode:"special",onEnter:e=>(d(C,!0,!0),B.some(!0)),onEscape:g,onUp:e=>(m(!0,!1),B.some(!0)),onDown:e=>(u(!0,!1),B.some(!0)),onLeft:(e,t)=>(t.cut(),B.none()),onRight:(e,t)=>(t.cut(),B.none())})])})],behaviours:c2([b0.config({}),bD.config({mode:"special",onEnter:p,onSpace:p,onEscape:g}),bG("input-wrapper-events",[iW(a1(),e=>{W([f,b],t=>{let o=eJ.fromDom(t.get(e).element.dom);dr(o)&&dn(o)})})])])});return{dom:{tag:"div",classes:["tox-number-input"]},components:[f.asSpec(),v.asSpec(),b.asSpec()],behaviours:c2([b0.config({}),bD.config({mode:"flow",focusInside:nE.OnEnterOrSpaceMode,cycles:!1,selector:"button, .tox-input-wrapper",onEscape:e=>dr(e.element)?B.none():(dt(e.element),B.some(!0))})])}},Vd={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},Vu={"xx-small":"7pt","x-small":"8pt",small:"10pt",medium:"12pt",large:"14pt","x-large":"18pt","xx-large":"24pt"},Vm=(e,t)=>{let o=Math.pow(10,t);return Math.round(e*o)/o},Vg=(e,t)=>/[0-9.]+px$/.test(e)?Vm(72*parseInt(e,10)/96,t||0)+"pt":ek(Vu,e).getOr(e),Vp=e=>ek(Vd,e).getOr(""),Vh=e=>{let t=()=>{let t=B.none(),o=l.data,n=e.queryCommandValue("FontSize");if(n)for(let e=3;t.isNone()&&e>=0;e--){let r=Vg(n,e),a=Vp(r);t=Y(o,e=>e.format===n||e.format===r||e.format===a)}return{matchOpt:t,size:n}},o=e=>t=>t.exists(t=>t.format===e),n=()=>{let{matchOpt:e}=t();return e},r=k(B.none),a=t=>()=>{e.undoManager.transact(()=>{e.focus(),e.execCommand("FontSize",!1,t.format)})},i=e=>{let{matchOpt:o,size:n}=t(),r=o.fold(k(n),e=>e.title);iI(e,Dx,{text:r})},l=NZ(e,"font_size_formats",nI.Space);return{tooltip:"Font sizes",text:B.some("12pt"),icon:B.none(),isSelectedFor:o,getPreviewFor:r,getCurrentValue:n,onAction:a,updateText:i,dataset:l,shouldHide:!1,isInvalid:A}},Vf=(e,t)=>NX(e,t,Vh(e)),Vb=e=>{var t;return null!==(t=({em:{step:.1},cm:{step:.1},in:{step:.1},pc:{step:.1},ch:{step:.1},rem:{step:.1}})[e])&&void 0!==t?t:{step:1}},Vv=e=>{let t=t=>iI(t,Dx,{text:e.queryCommandValue("FontSize")});return{updateInputValue:t,getConfigFromUnit:Vb,onAction:(t,o)=>e.execCommand("FontSize",!1,t,{skip_focus:!o})}},Vy=(e,t)=>Vc(e,t,Vv(e)),Vx=(e,t)=>{let o=Nq(e,t,Vh(e));e.ui.registry.addNestedMenuItem("fontsize",{text:"Font sizes",getSubmenuItems:()=>o.items.validateItems(o.getStyleItems())})},Vw=(e,t)=>{let o="Paragraph",n=t=>()=>e.formatter.match(t),r=t=>()=>{let o=e.formatter.get(t);return void 0!==o?B.some({tag:o.length>0&&(o[0].inline||o[0].block)||"div",styles:e.dom.parseStyle(e.formatter.getCssText(t))}):B.none()},a=t=>{let n=e=>Bu(e)?Q(e.items,n):Bm(e)?[{title:e.title,format:e.format}]:[],r=Q(Bx(e),n),a=N3(e,k(r)),i=a.fold(k(o),e=>e.title);iI(t,Dx,{text:i})};return{tooltip:"Formats",text:B.some(o),icon:B.none(),isSelectedFor:n,getCurrentValue:B.none,getPreviewFor:r,onAction:Nj(e),updateText:a,shouldHide:yD(e),isInvalid:t=>!e.formatter.canApply(t.format),dataset:t}},VS=(e,t)=>{let o={type:"advanced",...t.styles};return NX(e,t,Vw(e,o))},Vk=(e,t)=>{let o={type:"advanced",...t.styles},n=Nq(e,t,Vw(e,o));e.ui.registry.addNestedMenuItem("styles",{text:"Formats",getSubmenuItems:()=>n.items.validateItems(n.getStyleItems())})},VC=k([r4("toggleClass"),r4("fetch"),s7("onExecute"),ah("getHotspot",B.some),ah("getAnchorOverrides",k({})),un(),s7("onItemExecute"),ai("lazySink"),r4("dom"),s6("onOpen"),gW("splitDropdownBehaviours",[CB,bD,b0]),ah("matchWidth",!1),ah("useMinWidth",!1),ah("eventOrder",{}),ai("role")].concat(C0())),VO=pu({factory:v9,schema:[r4("dom")],name:"arrow",defaults:()=>({buttonBehaviours:c2([b0.revoke()])}),overrides:e=>({dom:{tag:"span",attributes:{role:"presentation"}},action:t=>{t.getSystem().getByUid(e.uid).each(iR)},buttonBehaviours:c2([vs.config({toggleOnExecute:!1,toggleClass:e.toggleClass})])})}),V_=pu({factory:v9,schema:[r4("dom")],name:"button",defaults:()=>({buttonBehaviours:c2([b0.revoke()])}),overrides:e=>({dom:{tag:"span",attributes:{role:"presentation"}},action:t=>{t.getSystem().getByUid(e.uid).each(o=>{e.onExecute(o,t)})}})}),VT=k([VO,V_,pg({factory:{sketch:e=>({uid:e.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:e.text}})},schema:[r4("text")],name:"aria-descriptor"}),pm({schema:[s5()],name:"menu",defaults:e=>({onExecute:(t,o)=>{t.getSystem().getByUid(e.uid).each(n=>{e.onItemExecute(n,t,o)})}})}),CU()]),VE=(e,t,o,n)=>{let r=e=>{pY.getCurrent(e).each(e=>{hO.highlightFirst(e),bD.focusIn(e)})},a=t=>{CX(e,C,t,n,r,nD.HighlightMenuAndItem).get(y)},i=e=>(a(e),B.some(!0)),l=t=>{let o=pT(t,e,"button");return iR(o),B.some(!0)},s={...iL([iZ((t,o)=>{let n=p_(t,e,"aria-descriptor");n.each(e=>{let o=lr("aria");tH(e.element,"id",o),tH(t.element,"aria-describedby",o)})})]),...vd(B.some(a))};return{uid:e.uid,dom:e.dom,components:t,apis:{repositionMenus:e=>{vs.isOn(e)&&CQ(e)}},eventOrder:{...e.eventOrder,[id()]:["disabling","toggling","alloy.base.behaviour"]},events:s,behaviours:gG(e.splitDropdownBehaviours,[CB.config({others:{sandbox:t=>{let o=pT(t,e,"arrow");return CZ(e,t,{onOpen:()=>{vs.on(o),vs.on(t)},onClose:()=>{vs.off(o),vs.off(t)}})}}}),bD.config({mode:"special",onSpace:l,onEnter:l,onDown:i}),b0.config({}),vs.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:e.role.getOr("button"),"aria-haspopup":!0}}}},VD=pG({name:"SplitDropdown",configFields:VC(),partFields:VT(),factory:VE,apis:{repositionMenus:(e,t)=>e.repositionMenus(t)}}),VA=e=>({isEnabled:()=>!ha.isDisabled(e),setEnabled:t=>ha.set(e,!t),setText:t=>iI(e,Dx,{text:t}),setIcon:t=>iI(e,Dw,{icon:t})}),VM=e=>({setActive:t=>{vs.set(e,t)},isActive:()=>vs.isOn(e),isEnabled:()=>!ha.isDisabled(e),setEnabled:t=>ha.set(e,!t),setText:t=>iI(e,Dx,{text:t}),setIcon:t=>iI(e,Dw,{icon:t})}),VB=(e,t)=>e.map(e=>({"aria-label":t.translate(e),title:t.translate(e)})).getOr({}),VF=lr("focus-button"),VI=(e,t,o,n,r)=>{let a=t.map(e=>v4(Dy(e,"tox-tbtn",r))),i=e.map(e=>v4(Dv(e,r.icons)));return{dom:{tag:"button",classes:["tox-tbtn"].concat(t.isSome()?["tox-tbtn--select"]:[]),attributes:VB(o,r)},components:eE([i.map(e=>e.asSpec()),a.map(e=>e.asSpec())]),eventOrder:{[aJ()]:["focusing","alloy.base.behaviour",Dg],[iS()]:[Dg,"toolbar-group-button-events"]},buttonBehaviours:c2([SA.toolbarButton(r.isDisabled),SO(),bG(Dg,[iZ((e,t)=>Dh(e)),iW(Dx,(e,t)=>{a.bind(t=>t.getOpt(e)).each(e=>{bW.set(e,[s_(r.translate(t.event.text))])})}),iW(Dw,(e,t)=>{i.bind(t=>t.getOpt(e)).each(e=>{bW.set(e,[Dv(t.event.icon,r.icons)])})}),iW(aJ(),(e,t)=>{t.event.prevent(),iF(e,VF)})])].concat(n.getOr([])))}},VR=(e,t,o,n)=>{let r=t.shared,a=aC(y),i={toolbarButtonBehaviours:[],getApi:VA,onSetup:e.onSetup},l=[bG("toolbar-group-button-events",[SB(i,a),SF(i,a)])];return RE.sketch({lazySink:r.getSink,fetch:()=>CL.nu(t=>{t(U(o(e.items),RG))}),markers:{toggledClass:"tox-tbtn--enabled"},parts:{button:VI(e.icon,e.text,e.tooltip,B.some(l),r.providers),toolbar:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:n}}}})},VN=(e,t,o)=>{var n;let r=aC(y),a=VI(e.icon,e.text,e.tooltip,B.none(),o);return v9.sketch({dom:a.dom,components:a.components,eventOrder:Dp,buttonBehaviours:{...c2([bG("toolbar-button-events",[Dm({onAction:e.onAction,getApi:t.getApi}),SB(t,r),SF(t,r)]),SA.toolbarButton(()=>!e.enabled||o.isDisabled()),SO()].concat(t.toolbarButtonBehaviours)),[Dg]:null===(n=a.buttonBehaviours)||void 0===n?void 0:n[Dg]}})},VV=(e,t)=>Vz(e,t,[]),Vz=(e,t,o)=>VN(e,{toolbarButtonBehaviours:o.length>0?[bG("toolbarButtonWith",o)]:[],getApi:VA,onSetup:e.onSetup},t),VH=(e,t)=>VL(e,t,[]),VL=(e,t,o)=>VN(e,{toolbarButtonBehaviours:[bW.config({}),vs.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(o.length>0?[bG("toolbarToggleButtonWith",o)]:[]),getApi:VM,onSetup:e.onSetup},t),VP=(e,t,o)=>n=>CL.nu(e=>t.fetch(e)).map(r=>B.from(Ol(rn(Ci(lr("menu-value"),r,o=>{t.onItemAction(e(n),o)},t.columns,t.presets,xg.CLOSE_ON_EXECUTE,t.select.getOr(A),o),{movement:Cs(t.columns,t.presets),menuBehaviours:Sl.unnamedEvents("auto"!==t.columns?[]:[iZ((e,o)=>{Sr(e,4,xO(t.presets)).each(({numRows:t,numColumns:o})=>{bD.setGridSize(e,t,o)})})])})))),VU=(e,t)=>{let o=e=>({isEnabled:()=>!ha.isDisabled(e),setEnabled:t=>ha.set(e,!t),setIconFill:(t,o)=>{sH(e.element,`svg path[id="${t}"], rect[id="${t}"]`).each(e=>{tH(e,"fill",o)})},setActive:t=>{tH(e.element,"aria-pressed",t),sH(e.element,"span").each(o=>{e.getSystem().getByDom(o).each(e=>vs.set(e,t))})},isActive:()=>sH(e.element,"span").exists(t=>e.getSystem().getByDom(t).exists(vs.isOn)),setText:t=>sH(e.element,"span").each(o=>e.getSystem().getByDom(o).each(e=>iI(e,Dx,{text:t}))),setIcon:t=>sH(e.element,"span").each(o=>e.getSystem().getByDom(o).each(e=>iI(e,Dw,{icon:t})))}),n=aC(y),r={getApi:o,onSetup:e.onSetup};return VD.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:{"aria-pressed":!1,...VB(e.tooltip,t.providers)}},onExecute:t=>{let n=o(t);n.isEnabled()&&e.onAction(n)},onItemExecute:(e,t,o)=>{},splitDropdownBehaviours:c2([SA.splitButton(t.providers.isDisabled),SO(),bG("split-dropdown-events",[iZ((e,t)=>Dh(e)),iW(VF,b0.focus),SB(r,n),SF(r,n)]),_v.config({})]),eventOrder:{[iS()]:["alloy.base.behaviour","split-dropdown-events"]},toggleClass:"tox-tbtn--enabled",lazySink:t.getSink,fetch:VP(o,e,t.providers),parts:{menu:xM(!1,e.columns,e.presets)},components:[VD.parts.button(VI(e.icon,e.text,B.none(),B.some([vs.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),t.providers)),VD.parts.arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:yn("chevron-down",t.providers.icons)},buttonBehaviours:c2([SA.splitButton(t.providers.isDisabled),SO(),yi()])}),VD.parts["aria-descriptor"]({text:t.providers.translate("To open the popup, press Shift+Enter")})]})},VW=[{name:"history",items:["undo","redo"]},{name:"styles",items:["styles"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],Vj=(e,t)=>(o,n,r)=>{let a=e(o).mapError(e=>r2(e)).getOrDie();return t(a,n,r)},VG={button:Vj(wB,(e,t)=>VV(e,t.shared.providers)),togglebutton:Vj(wR,(e,t)=>VH(e,t.shared.providers)),menubutton:Vj(Ik,(e,t)=>AT(e,"tox-tbtn",t,B.none())),splitbutton:Vj(IO,(e,t)=>VU(e,t.shared)),grouptoolbarbutton:Vj(Ix,(e,t,o)=>{let n=o.ui.registry.getAll().buttons,r=e=>VQ(o,{buttons:n,toolbar:e,allowToolbarGroups:!1},t,B.none()),a={[ut]:t.shared.header.isPositionedAtTop()?nT.TopToBottom:nT.BottomToTop};if(yB(o)===nA.floating)return VR(e,t,r,a);throw Error("Toolbar groups are only supported when using floating toolbar mode")})},V$=(e,t,o)=>ek(VG,e.type).fold(()=>(console.error("skipping button defined by",e),B.none()),n=>B.some(n(e,t,o))),Vq={styles:VS,fontsize:Vf,fontsizeinput:Vy,fontfamily:Vt,blocks:N9,align:N1},VX=e=>{let t=U(VW,t=>{let o=$(t.items,t=>eC(e,t)||eC(Vq,t));return{name:t.name,items:o}});return $(t,e=>e.items.length>0)},VK=e=>{let t=e.split("|");return U(t,e=>({items:e.trim().split(" ")}))},VY=e=>v(e,e=>eC(e,"name")&&eC(e,"items")),VJ=e=>{let t=e.toolbar,o=e.buttons;return!1===t?[]:void 0===t||!0===t?VX(o):l(t)?VK(t):VY(t)?t:(console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[])},VZ=(e,t,o,n,r,a)=>ek(t,o.toLowerCase()).orThunk(()=>a.bind(e=>ed(e,e=>ek(t,e+o.toLowerCase())))).fold(()=>ek(Vq,o.toLowerCase()).map(t=>t(e,r)),t=>"grouptoolbarbutton"!==t.type||n?V$(t,r,e):(console.warn(`Ignoring the '${o}' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested.`),B.none())),VQ=(e,t,o,n)=>{let r=VJ(t),a=U(r,r=>{let a=Q(r.items,r=>0===r.trim().length?[]:VZ(e,t.buttons,r,t.allowToolbarGroups,o,n).toArray());return{title:B.from(e.translate(r.name)),items:a}});return $(a,e=>e.items.length>0)},V0=(e,t,o,n)=>{let r=t.mainUi.outerContainer,a=o.toolbar,i=o.buttons;if(v(a,l)){let t=a.map(t=>{let r={toolbar:t,buttons:i,allowToolbarGroups:o.allowToolbarGroups};return VQ(e,r,n,B.none())});ND.setToolbars(r,t)}else ND.setToolbar(r,VQ(e,o,n,B.none()))},V1=oX(),V2=V1.os.isiOS()&&V1.os.version.major<=12,V3=(e,t)=>{let{uiMotherships:o}=t,n=e.dom,r=e.getWin(),a=e.getDoc().documentElement,i=aC(t7(r.innerWidth,r.innerHeight)),l=aC(t7(a.offsetWidth,a.offsetHeight)),s=()=>{let t=i.get();(t.left!==r.innerWidth||t.top!==r.innerHeight)&&(i.set(t7(r.innerWidth,r.innerHeight)),kk(e))},c=()=>{let t=e.getDoc().documentElement,o=l.get();(o.left!==t.offsetWidth||o.top!==t.offsetHeight)&&(l.set(t7(t.offsetWidth,t.offsetHeight)),kk(e))},d=t=>{kC(e,t)};n.bind(r,"resize",s),n.bind(r,"scroll",d);let u=dV(eJ.fromDom(e.getBody()),"load",c);e.on("hide",()=>{W(o,e=>{tX(e.element,"display","none")})}),e.on("show",()=>{W(o,e=>{t2(e.element,"display")})}),e.on("NodeChange",c),e.on("remove",()=>{u.unbind(),n.unbind(r,"resize",s),n.unbind(r,"scroll",d),r=null})},V5=(e,t,o)=>{xa(e)&&mY(o.mainUi.mothership.element,o.popupUi.mothership),mK(t,o.dialogUi.mothership)},V9=async(e,t,o,n,r)=>{let{mainUi:a,uiMotherships:i}=t,l=aC(0),s=a.outerContainer;await NL(e);let c=eJ.fromDom(r.targetNode),d=tD(tE(c));mY(c,a.mothership),V5(e,d,t),e.on("PostRender",()=>{ND.setSidebar(s,o.sidebar,y0(e)),V0(e,t,o,n),l.set(e.getWin().innerWidth),ND.setMenubar(s,NF(e,o)),ND.setViews(s,o.views),V3(e,t)});let m=ND.getSocket(s).getOrDie("Could not find expected socket element");if(V2){tK(m.element,{overflow:"scroll","-webkit-overflow-scrolling":"touch"});let t=AP(()=>{e.dispatch("ScrollContent")},20),o=dN(m.element,"scroll",t.throttle);e.on("remove",o.unbind)}SC(e,t),e.addCommand("ToggleSidebar",(t,o)=>{ND.toggleSidebar(s,o),e.dispatch("ToggleSidebar")}),e.addQueryValueHandler("ToggleSidebar",()=>{var e;return null!==(e=ND.whichSidebar(s))&&void 0!==e?e:""}),e.addCommand("ToggleView",(t,o)=>{if(ND.toggleView(s,o)){let t=s.element;a.mothership.broadcastOn([gc()],{target:t}),W(i,e=>{e.broadcastOn([gc()],{target:t})}),u(ND.whichView(s))&&(e.focus(),e.nodeChanged())}}),e.addQueryValueHandler("ToggleView",()=>{var e;return null!==(e=ND.whichView(s))&&void 0!==e?e:""});let g=yB(e),p=()=>{ND.refreshToolbar(t.mainUi.outerContainer)};return(g===nA.sliding||g===nA.floating)&&e.on("ResizeWindow ResizeEditor ResizeContent",()=>{let t=e.getWin().innerWidth;t!==l.get()&&(p(),l.set(t))}),{iframeContainer:m.element.dom,editorContainer:s.element.dom,api:{setEnabled:e=>{Sk(t,!e)},isEnabled:()=>!ha.isDisabled(s)}}};var V4=Object.freeze({__proto__:null,render:V9});let V6=e=>/^[0-9\.]+(|px)$/i.test(""+e)?B.some(parseInt(""+e,10)):B.none(),V8=e=>b(e)?e+"px":e,V7=(e,t,o)=>{let n=t.filter(t=>e<t),r=o.filter(t=>e>t);return n.or(r).getOr(e)},ze=e=>{let t=yw(e),o=yC(e),n=y_(e);return V6(t).map(e=>V7(e,o,n))},zt=e=>{let t=ze(e);return t.getOr(yw(e))},zo=e=>{let t=yS(e),o=yk(e),n=yO(e);return V6(t).map(e=>V7(e,o,n))},zn=e=>{let t=zo(e);return t.getOr(yS(e))},{ToolbarLocation:zr,ToolbarMode:za}=xl,zi=(e,t,o,n,r)=>{let{mainUi:a,uiMotherships:i}=o,l=yp.DOM,s=xt(e),c=xr(e),d=yO(e).or(zo(e)),u=n.shared.header,m=u.isPositionedAtTop,g=yB(e),p=g===za.sliding||g===za.floating,h=aC(!1),f=()=>h.get()&&!e.removed,b=e=>p?e.fold(k(0),e=>e.components().length>1?t4(e.components()[1].element):0):0,v=o=>{switch(yI(e)){case zr.auto:let n=ND.getToolbar(a.outerContainer),r=b(n),i=t4(o.element)-r,l=nP(t),s=l.y>i;if(s)return"top";{let e=tg(t),o=Math.max(e.dom.scrollHeight,t4(e)),n=l.bottom<o-i;if(n)return"bottom";{let e=nG(),t=e.bottom<l.bottom-i;return t?"bottom":"top"}}case zr.bottom:return"bottom";case zr.top:default:return"top"}},y=e=>{r.on(t=>{It.setModes(t,[e]),u.setDockingMode(e);let o=m()?nT.TopToBottom:nT.BottomToTop;tH(t.element,ut,o)})},x=()=>{r.on(e=>{let o=d.getOrThunk(()=>{let e=V6(tJ(tN(),"margin-left")).getOr(0);return oi(tN())-oo(t).left+e});tX(e.element,"max-width",o+"px")})},w=o=>{r.on(n=>{let r=ND.getToolbar(a.outerContainer),i=b(r),l=nP(t),{top:s,left:c}=S(e,a.outerContainer.element).fold(()=>({top:m()?Math.max(l.y-t4(n.element)+i,0):l.bottom,left:l.x}),e=>{var t;let o=nP(e),r=null!==(t=e.dom.scrollTop)&&void 0!==t?t:0,a=tc(e,tN()),s=a?Math.max(l.y-t4(n.element)+i,0):l.y-o.y+r-t4(n.element)+i;return{top:m()?s:l.bottom,left:a?l.x:l.x-o.x}}),d=o.bind(e=>{let t=ne(),o=window.innerWidth-(c-t.left),n=Math.max(Math.min(e,o),150);return o>n?B.none():B.some({width:n+"px"})}).getOr({});tK(a.outerContainer.element,{position:"absolute",left:Math.round(c)+"px",top:Math.round(s)+"px",...d})})},S=(e,t)=>xa(e)?Fy(t):B.none(),C=()=>{W(i,e=>{e.broadcastOn([gd()],{})})},O=()=>{if(s)return B.none();{let e=oo(a.outerContainer.element).left+ol(a.outerContainer.element);if(!(e>=window.innerWidth-40||tQ(a.outerContainer.element,"width").isSome()))return B.none();{tX(a.outerContainer.element,"position","absolute"),tX(a.outerContainer.element,"left","0px"),t2(a.outerContainer.element,"width");let e=ol(a.outerContainer.element);return B.some(e)}}},_=e=>{if(!f())return;s||x();let t=s?B.none():O();p&&ND.refreshToolbar(a.outerContainer),s||w(t),c&&r.on(e),C()},T=()=>!!(!s&&c&&f())&&r.get().exists(e=>{let t=u.getDockingMode(),o=v(e);return o!==t&&(y(o),!0)}),E=()=>{h.set(!0),tX(a.outerContainer.element,"display","flex"),l.addClass(e.getBody(),"mce-edit-focus"),W(i,e=>{t2(e.element,"display")}),T(),xa(e)?_(e=>It.isDocked(e)?It.reset(e):It.refresh(e)):_(It.refresh)},D=()=>{h.set(!1),tX(a.outerContainer.element,"display","none"),l.removeClass(e.getBody(),"mce-edit-focus"),W(i,e=>{tX(e.element,"display","none")})},A=()=>{let e=T();e&&_(It.reset)};return{isVisible:f,isPositionedAtTop:m,show:E,hide:D,update:_,updateMode:A,repositionPopups:C}},zl=(e,t)=>{let o=nP(e);return{pos:t?o.y:o.bottom,bounds:o}},zs=(e,t,o,n)=>{let r=aC(zl(t,o.isPositionedAtTop())),a=n=>{let{pos:a,bounds:i}=zl(t,o.isPositionedAtTop()),{pos:l,bounds:s}=r.get(),c=i.height!==s.height||i.width!==s.width;r.set({pos:a,bounds:i}),c&&kk(e,n),o.isVisible()&&(l!==a?o.update(It.reset):c&&(o.updateMode(),o.repositionPopups()))};n||(e.on("activate",o.show),e.on("deactivate",o.hide)),e.on("SkinLoaded ResizeWindow",()=>o.update(It.reset)),e.on("NodeChange keydown",e=>{requestAnimationFrame(()=>a(e))});let i=0,l=AU(()=>o.update(It.refresh),33);e.on("ScrollWindow",()=>{let e=ne().left;e!==i&&(i=e,l.throttle()),o.updateMode()}),xa(e)&&e.on("ElementScroll",e=>{o.update(It.refresh)});let s=dI();s.set(dV(eJ.fromDom(e.getBody()),"load",e=>a(e.raw))),e.on("remove",()=>{s.clear()})},zc=async(e,t,o,n,r)=>{let{mainUi:a}=t,i=dR(),l=eJ.fromDom(r.targetNode),s=zi(e,l,t,n,i),c=yV(e);await NP(e);let d=()=>{if(i.isSet()){s.show();return}i.set(ND.getHeader(a.outerContainer).getOrDie());let r=xo(e);xa(e)?(mY(l,a.mothership),mY(l,t.popupUi.mothership)):mK(r,a.mothership),mK(r,t.dialogUi.mothership),V0(e,t,o,n),ND.setMenubar(a.outerContainer,NF(e,o)),s.show(),zs(e,l,s,c),e.nodeChanged()};e.on("show",d),e.on("hide",s.hide),c||(e.on("focus",d),e.on("blur",s.hide)),e.on("init",()=>{(e.hasFocus()||c)&&d()}),SC(e,t);let u={show:d,hide:s.hide,setEnabled:e=>{Sk(t,!e)},isEnabled:()=>!ha.isDisabled(a.outerContainer)};return{editorContainer:a.outerContainer.element.dom,api:u}};var zd=Object.freeze({__proto__:null,render:zc});let zu=()=>{let e=dR(),t=dR(),o=dR(),n=(e,t)=>()=>o.get().bind(e=>t(e.outerContainer)).getOrDie(`Could not find ${e} element in OuterContainer`),r=()=>{let o=e.get().map(e=>e.mothership),n=t.get().map(e=>e.mothership);return o.fold(()=>n.toArray(),e=>n.fold(()=>[e],t=>tc(e.element,t.element)?[e]:[e,t]))};return{dialogUi:e,popupUi:t,mainUi:o,getUiMotherships:r,lazyGetInOuterOrDie:n}},zm="contexttoolbar-hide",zg=e=>({hide:()=>iF(e,ip()),getValue:()=>gU.getValue(e)}),zp=(e,t)=>iW(Du,(o,n)=>{let r=e.get(o),a=zg(r);t.onAction(a,n.event.buttonApi)}),zh=(e,t,o)=>{let{primary:n,...r}=t.original,a=r0(wB({...r,type:"button",onAction:y}));return Vz(a,o,[zp(e,t)])},zf=(e,t,o)=>{let{primary:n,...r}=t.original,a=r0(wR({...r,type:"togglebutton",onAction:y}));return VL(a,o,[zp(e,t)])},zb=e=>"contextformtogglebutton"===e.type,zv=(e,t,o)=>zb(t)?zf(e,t,o):zh(e,t,o),zy=(e,t,o)=>{let n=U(t,t=>v4(zv(e,t,o))),r=()=>U(n,e=>e.asSpec()),a=e=>ed(t,(t,o)=>t.primary?B.from(n[o]).bind(t=>t.getOpt(e)).filter(T(ha.isDisabled)):B.none());return{asSpecs:r,findPrimary:a}},zx=(e,t)=>{let o=e.label.fold(()=>({}),e=>({"aria-label":e})),n=v4(xV.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:e.initValue(),inputAttributes:o,selectOnFocus:!0,inputBehaviours:c2([bD.config({mode:"special",onEnter:e=>r.findPrimary(e).map(e=>(iR(e),!0)),onLeft:(e,t)=>(t.cut(),B.none()),onRight:(e,t)=>(t.cut(),B.none())})])})),r=zy(n,e.commands,t);return[{title:B.none(),items:[n.asSpec()]},{title:B.none(),items:r.asSpecs()}]},zw=(e,t,o)=>RY({type:e,uid:lr("context-toolbar"),initGroups:zx(t,o),onEscape:B.none,cyclicKeying:!0,providers:o}),zS={renderContextForm:zw,buildInitGroups:zx},zk=(e,t,o)=>t.bottom-e.y>=o&&e.bottom-t.y>=o,zC=e=>{let t=e.getBoundingClientRect();if(!(t.height<=0)||!(t.width<=0))return t;{let o=tC(eJ.fromDom(e.startContainer),e.startOffset).element,n=tt(o)?th(o):B.some(o);return n.filter(te).map(e=>e.dom.getBoundingClientRect()).getOr(t)}},zO=e=>{let t=e.selection.getRng(),o=zC(t);if(e.inline){let e=ne();return nL(e.left+o.left,e.top+o.top,o.width,o.height)}{let t=nU(eJ.fromDom(e.getBody()));return nL(t.x+o.left,t.y+o.top,o.width,o.height)}},z_=(e,t)=>t.filter(e=>tR(e)&&e7(e)).map(nU).getOrThunk(()=>zO(e)),zT=(e,t,o)=>{let n=Math.max(e.x+o,t.x),r=Math.min(e.right-o,t.right);return{x:n,width:r-n}},zE=(e,t,o,n,r,a)=>{let i=eJ.fromDom(e.getContainer()),l=sH(i,".tox-editor-header").getOr(i),s=nP(l),c=s.y>=t.bottom,d=n&&!c;if(e.inline&&d)return{y:Math.max(s.bottom+a,o.y),bottom:o.bottom};if(e.inline&&!d)return{y:o.y,bottom:Math.min(s.y-a,o.bottom)};let u="line"===r?nP(i):t;return d?{y:Math.max(s.bottom+a,o.y),bottom:Math.min(u.bottom-a,o.bottom)}:{y:Math.max(u.y+a,o.y),bottom:Math.min(s.y-a,o.bottom)}},zD=(e,t,o,n=0)=>{let r=nr(window),a=nP(eJ.fromDom(e.getContentAreaContainer())),i=y3(e)||y4(e)||y8(e),{x:l,width:s}=zT(a,r,n);if(e.inline&&!i)return nL(l,r.y,s,r.height);{let i=t.header.isPositionedAtTop(),{y:c,bottom:d}=zE(e,a,r,i,o,n);return nL(l,c,s,d-c)}},zA={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"],inset:["tox-pop--inset"]},zM={maxHeightFunction:d2(),maxWidthFunction:Rv()},zB=(e,t)=>{let o=e.selection.getRng(),n=tC(eJ.fromDom(o.startContainer),o.startOffset);return o.startContainer===o.endContainer&&o.startOffset===o.endOffset-1&&tc(n.element,t)},zF=(e,t,o)=>{let n=tQ(e,"position");tX(e,"position",t);let r=o(e);return n.each(t=>tX(e,"position",t)),r},zI=e=>"node"===e,zR=(e,t,o,n,r)=>{let a=zO(e),i=n.lastElement().exists(e=>tc(o,e));if(zB(e,o))return i?M5:MQ;if(i)return zF(t,n.getMode(),()=>{let e=zk(a,nP(t),-20);return e&&!n.isReposition()?M4:M5});{let e="fixed"===n.getMode()?r.y+ne().top:r.y,o=t4(t)+12;return e+o<=a.y?MQ:M0}},zN=(e,t,o,n)=>{let r=t=>(n,r,a,i,l)=>{let s=zR(e,i,t,o,l),c={...n,y:l.y,height:l.height};return{...s(c,r,a,i,l),alwaysFit:!0}},a=e=>zI(n)?[r(e)]:[];return t?{onLtr:e=>[cN,cM,cB,cF,cI,cR].concat(a(e)),onRtl:e=>[cN,cB,cM,cI,cF,cR].concat(a(e))}:{onLtr:e=>[cR,cN,cF,cM,cI,cB].concat(a(e)),onRtl:e=>[cR,cN,cI,cB,cF,cM].concat(a(e))}},zV=(e,t,o,n)=>"line"===t?{bubble:d6(12,0,zA),layouts:{onLtr:()=>[cV],onRtl:()=>[cz]},overrides:zM}:{bubble:d6(0,12,zA,.08333333333333333),layouts:zN(e,o,n,t),overrides:zM},zz=(e,t)=>{let o=$(t,t=>t.predicate(e.dom)),{pass:n,fail:r}=G(o,e=>"contexttoolbar"===e.type);return{contextToolbars:n,contextForms:r}},zH=e=>{if(e.length<=1)return e;{let t=t=>H(e,e=>e.position===t),o=t=>$(e,e=>e.position===t),n=t("selection"),r=t("node");if(!n&&!r)return o("line");if(!r||!n)return o(n?"selection":"node");{let e=o("node"),t=U(o("selection"),e=>({...e,position:"node"}));return e.concat(t)}}},zL=e=>{if(e.length<=1)return e;{let t=t=>Y(e,e=>e.position===t),o=t("selection").orThunk(()=>t("node")).orThunk(()=>t("line")).map(e=>e.position);return o.fold(()=>[],t=>$(e,e=>e.position===t))}},zP=(e,t,o)=>{let n=zz(e,t);if(n.contextForms.length>0)return B.some({elem:e,toolbars:[n.contextForms[0]]});{let t=zz(e,o);if(t.contextForms.length>0)return B.some({elem:e,toolbars:[t.contextForms[0]]});if(!(n.contextToolbars.length>0)&&!(t.contextToolbars.length>0))return B.none();{let o=zH(n.contextToolbars.concat(t.contextToolbars));return B.some({elem:e,toolbars:o})}}},zU=(e,t,o)=>e(t)?B.none():az(t,e=>{if(!te(e))return B.none();{let{contextToolbars:t,contextForms:n}=zz(e,o.inNodeScope),r=n.length>0?n:zL(t);return r.length>0?B.some({elem:e,toolbars:r}):B.none()}},e),zW=(e,t)=>{let o=eJ.fromDom(t.getBody()),n=e=>tc(e,o),r=eJ.fromDom(t.selection.getNode());return n(r)||td(o,r)?zP(r,e.inNodeScope,e.inEditorScope).orThunk(()=>zU(n,r,e)):B.none()},zj=(e,t)=>{let o={},n=[],r=[],a={},i={},l=(e,l)=>{let s=r0(wW(l));o[e]=s,s.launch.map(o=>{a["form:"+e]={...l.launch,type:"contextformtogglebutton"===o.type?"togglebutton":"button",onAction:()=>{t(s)}}}),"editor"===s.scope?r.push(s):n.push(s),i[e]=s},s=(e,t)=>{wG(t).each(o=>{"editor"===t.scope?r.push(o):n.push(o),i[e]=o})},c=eu(e);return W(c,t=>{let o=e[t];"contextform"===o.type?l(t,o):"contexttoolbar"===o.type&&s(t,o)}),{forms:o,inNodeScope:n,inEditorScope:r,lookupTable:i,formNavigators:a}},zG=lr("forward-slide"),z$=lr("backward-slide"),zq=lr("change-slide-event"),zX="tox-pop--resizing",zK=e=>{let t=aC([]);return v2.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:e=>{t.set([]),v2.getContent(e).each(e=>{t2(e.element,"visibility")}),l6(e.element,zX),t2(e.element,"width")},inlineBehaviours:c2([bG("context-toolbar-events",[iJ(ie(),(e,t)=>{"width"===t.event.raw.propertyName&&(l6(e.element,zX),t2(e.element,"width"))}),iW(zq,(e,t)=>{let o=e.element;t2(o,"width");let n=oi(o);v2.setContent(e,t.event.contents),l9(o,zX);let r=oi(o);tX(o,"width",n+"px"),v2.getContent(e).each(e=>{t.event.focus.bind(e=>(dt(e),di(o))).orThunk(()=>(bD.focusIn(e),da(tE(o))))}),setTimeout(()=>{tX(e.element,"width",r+"px")},0)}),iW(zG,(e,o)=>{v2.getContent(e).each(o=>{t.set(t.get().concat([{bar:o,focus:da(tE(e.element))}]))}),iI(e,zq,{contents:o.event.forwardContents,focus:B.none()})}),iW(z$,(e,o)=>{es(t.get()).each(o=>{t.set(t.get().slice(0,t.get().length-1)),iI(e,zq,{contents:lx(o.bar),focus:o.focus})})})]),bD.config({mode:"special",onEscape:o=>es(t.get()).fold(()=>e.onEscape(),e=>(iF(o,z$),B.some(!0)))})]),lazySink:()=>nY.value(e.sink)})},zY="tox-pop--transition",zJ=(e,t,o,n)=>{let r=n.backstage,a=r.shared,i=oX().deviceType.isTouch,l=dR(),s=dR(),c=dR(),d=sA(zK({sink:o,onEscape:()=>(e.focus(),B.some(!0))})),u=()=>{let t=c.get().getOr("node"),o=zI(t)?1:0;return zD(e,a,t,o)},m=()=>!e.removed&&!(i()&&r.isContextMenuOpen()),g=e=>e_(eA(e,l.get(),tc),!0),p=()=>{if(!m())return!0;{let t=u(),o=e_(c.get(),"node")?z_(e,l.get()):zO(e);return t.height<=0||!zk(o,t,.01)}},h=()=>{l.clear(),s.clear(),c.clear(),v2.hide(d)},f=()=>{if(v2.isOpen(d)){let e=d.element;t2(e,"display"),p()?tX(e,"display","none"):(s.set(0),v2.reposition(d))}},b=t=>({dom:{tag:"div",classes:["tox-pop__dialog"]},components:[t],behaviours:c2([bD.config({mode:"acyclic"}),bG("pop-dialog-wrap-events",[iZ(t=>{e.shortcuts.add("ctrl+F9","focus statusbar",()=>bD.focusIn(t))}),iQ(t=>{e.shortcuts.remove("ctrl+F9")})])])}),v=oc(()=>zj(t,e=>{let t=S([e]);iI(d,zG,{forwardContents:b(t)})})),x=(t,o)=>VQ(e,{buttons:t,toolbar:o.items,allowToolbarGroups:!1},n.backstage,B.some(["form:"])),w=(e,t)=>zS.buildInitGroups(e,t),S=t=>{let{buttons:o}=e.ui.registry.getAll(),n=v(),r={...o,...n.formNavigators},i=yB(e)===nA.scrolling?nA.scrolling:nA.default,l=Z(U(t,e=>"contexttoolbar"===e.type?x(r,e):w(e,a.providers)));return RY({type:i,uid:lr("context-toolbar"),initGroups:l,onEscape:B.none,cyclicKeying:!0,providers:a.providers})},k=(t,n)=>{let r="node"===t?a.anchors.node(n):a.anchors.cursor(),c=zV(e,t,i(),{lastElement:l.get,isReposition:()=>e_(s.get(),0),getMode:()=>mI.getMode(o)});return rn(r,c)},C=(e,t)=>{if(_.cancel(),!m())return;let n=S(e),r=e[0].position,a=k(r,t);c.set(r),s.set(1);let i=d.element;t2(i,"display"),g(t)||(l6(i,zY),mI.reset(o,d)),v2.showWithinBounds(d,b(n),{anchor:a,transition:{classes:[zY],mode:"placement"}},()=>B.some(u())),t.fold(l.clear,l.set),p()&&tX(i,"display","none")},O=!1,_=AU(()=>{if(e.hasFocus()&&!e.removed&&!O){if(l8(d.element,zY))_.throttle();else{let t=v();zW(t,e).fold(h,e=>{C(e.toolbars,B.some(e.elem))})}}},17);e.on("init",()=>{e.on("remove",h),e.on("ScrollContent ScrollWindow ObjectResized ResizeEditor longpress",f),e.on("click keyup focus SetContent",_.throttle),e.on(zm,h),e.on("contexttoolbar-show",t=>{let o=v();ek(o.lookupTable,t.toolbarKey).each(o=>{C([o],eF(t.target!==e,t.target)),v2.getContent(d).each(bD.focusIn)})}),e.on("focusout",t=>{v3.setEditorTimeout(e,()=>{di(o.element).isNone()&&di(d.element).isNone()&&h()},0)}),e.on("SwitchMode",()=>{e.mode.isReadOnly()&&h()}),e.on("AfterProgressState",t=>{t.state?h():e.hasFocus()&&_.throttle()}),e.on("dragstart",()=>{O=!0}),e.on("dragend drop",()=>{O=!1}),e.on("NodeChange",e=>{di(d.element).fold(_.throttle,y)})})},zZ=e=>{W([{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}],t=>{e.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onAction:NG(e,t.cmd),onSetup:NU(e,t.name)})}),e.ui.registry.addButton("alignnone",{tooltip:"No alignment",icon:"align-none",onAction:NG(e,"JustifyNone")})},zQ=(e,t)=>{let o=()=>{let o=t.getOptions(e),n=t.getCurrent(e).map(t.hash),r=dR();return U(o,o=>({type:"togglemenuitem",text:t.display(o),onSetup:a=>{let i=e=>{e&&(r.on(e=>e.setActive(!1)),r.set(a)),a.setActive(e)};i(e_(n,t.hash(o)));let l=t.watcher(e,o,i);return()=>{r.clear(),l()}},onAction:()=>t.setCurrent(e,o)}))};e.ui.registry.addMenuButton(t.name,{tooltip:t.text,icon:t.icon,fetch:e=>e(o()),onSetup:t.onToolbarSetup}),e.ui.registry.addNestedMenuItem(t.name,{type:"nestedmenuitem",text:t.text,getSubmenuItems:o,onSetup:t.onMenuSetup})},z0={name:"lineheight",text:"Line height",icon:"line-height",getOptions:y9,hash:e=>Vs(e,["fixed","relative","empty"]).getOr(e),display:C,watcher:(e,t,o)=>e.formatter.formatChanged("lineheight",o,!1,{value:t}).unbind,getCurrent:e=>B.from(e.queryCommandValue("LineHeight")),setCurrent:(e,t)=>e.execCommand("LineHeight",!1,t)},z1=e=>{let t=B.from(yA(e));return t.map(t=>({name:"language",text:"Language",icon:"language",getOptions:k(t),hash:e=>g(e.customCode)?e.code:`${e.code}/${e.customCode}`,display:e=>e.title,watcher:(e,t,o)=>{var n;return e.formatter.formatChanged("lang",o,!1,{value:t.code,customValue:null!==(n=t.customCode)&&void 0!==n?n:null}).unbind},getCurrent:e=>{let t=eJ.fromDom(e.selection.getNode());return aH(t,e=>B.some(e).filter(te).bind(e=>{let t=tU(e,"lang");return t.map(t=>{let o=tU(e,"data-mce-lang").getOrUndefined();return{code:t,customCode:o,title:""}})}))},setCurrent:(e,t)=>e.execCommand("Lang",!1,t),onToolbarSetup:t=>{let o=dI();return t.setActive(e.formatter.match("lang",{},void 0,!0)),o.set(e.formatter.formatChanged("lang",t.setActive,!0)),o.clear}}))},z2=e=>{zQ(e,z0),z1(e).each(t=>zQ(e,t))},z3=(e,t)=>{N2(e,t),Vo(e,t),Vk(e,t),N4(e,t),Vx(e,t)},z5=e=>NW(e,"NodeChange",t=>{t.setEnabled(e.queryCommandState("outdent"))}),z9=e=>{e.ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:z5(e),onAction:NG(e,"outdent")}),e.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onAction:NG(e,"indent")})},z4=e=>{z9(e)},z6=(e,t)=>o=>{o.setActive(t.get());let n=e=>{t.set(e.state),o.setActive(e.state)};return e.on("PastePlainTextToggle",n),()=>e.off("PastePlainTextToggle",n)},z8=e=>{let t=aC(yQ(e)),o=()=>e.execCommand("mceTogglePlainTextPaste");e.ui.registry.addToggleButton("pastetext",{active:!1,icon:"paste-text",tooltip:"Paste as text",onAction:o,onSetup:z6(e,t)}),e.ui.registry.addToggleMenuItem("pastetext",{text:"Paste as text",icon:"paste-text",onAction:o,onSetup:z6(e,t)})},z7=(e,t)=>()=>{e.execCommand("mceToggleFormat",!1,t)},He=e=>{E3.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],(t,o)=>{e.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onSetup:NU(e,t.name),onAction:z7(e,t.name)})});for(let t=1;t<=6;t++){let o="h"+t;e.ui.registry.addToggleButton(o,{text:o.toUpperCase(),tooltip:"Heading "+t,onSetup:NU(e,o),onAction:z7(e,o)})}},Ht=e=>{E3.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"},{name:"print",text:"Print",action:"mcePrint",icon:"print"},{name:"hr",text:"Horizontal line",action:"InsertHorizontalRule",icon:"horizontal-rule"}],t=>{e.ui.registry.addButton(t.name,{tooltip:t.text,icon:t.icon,onAction:NG(e,t.action)})})},Ho=e=>{E3.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],t=>{e.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onAction:NG(e,t.action),onSetup:NU(e,t.name)})})},Hn=e=>{He(e),Ht(e),Ho(e)},Hr=e=>{E3.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"},{name:"print",text:"Print...",action:"mcePrint",icon:"print",shortcut:"Meta+P"},{name:"hr",text:"Horizontal line",action:"InsertHorizontalRule",icon:"horizontal-rule"}],t=>{e.ui.registry.addMenuItem(t.name,{text:t.text,icon:t.icon,shortcut:t.shortcut,onAction:NG(e,t.action)})}),e.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onAction:z7(e,"code")})},Ha=e=>{Hn(e),Hr(e)},Hi=(e,t)=>NW(e,"Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",o=>{o.setEnabled(!e.mode.isReadOnly()&&e.undoManager[t]())}),Hl=e=>{e.ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:Hi(e,"hasUndo"),onAction:NG(e,"undo")}),e.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:Hi(e,"hasRedo"),onAction:NG(e,"redo")})},Hs=e=>{e.ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",enabled:!1,onSetup:Hi(e,"hasUndo"),onAction:NG(e,"undo")}),e.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",enabled:!1,onSetup:Hi(e,"hasRedo"),onAction:NG(e,"redo")})},Hc=e=>{Hl(e),Hs(e)},Hd=e=>NW(e,"VisualAid",t=>{t.setActive(e.hasVisual)}),Hu=e=>{e.ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:Hd(e),onAction:NG(e,"mceToggleVisualAid")})},Hm=e=>{e.ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:NG(e,"mceToggleVisualAid")})},Hg=e=>{Hm(e),Hu(e)},Hp=(e,t)=>{zZ(e),Ha(e),z3(e,t),Hc(e),Ca(e),Hg(e),z4(e),z2(e),z8(e)},Hh=e=>l(e)?e.split(/[ ,]/):e,Hf=e=>t=>t.options.get(e),Hb=e=>{let t=e.options.register;t("contextmenu_avoid_overlap",{processor:"string",default:""}),t("contextmenu_never_use_native",{processor:"boolean",default:!1}),t("contextmenu",{processor:e=>!1===e?{value:[],valid:!0}:l(e)||v(e,l)?{value:Hh(e),valid:!0}:{valid:!1,message:"Must be false or a string."},default:"link linkchecker image editimage table spellchecker configurepermanentpen"})},Hv=Hf("contextmenu_never_use_native"),Hy=Hf("contextmenu_avoid_overlap"),Hx=e=>0===Hw(e).length,Hw=e=>{let t=e.ui.registry.getAll().contextMenus,o=e.options.get("contextmenu");return e.options.isSet("contextmenu")?o:$(o,e=>eC(t,e))},HS=(e,t)=>({type:"makeshift",x:e,y:t}),Hk=(e,t,o)=>HS(e.x+t,e.y+o),HC=e=>"longpress"===e.type||0===e.type.indexOf("touch"),HO=e=>{if(!HC(e))return HS(e.pageX,e.pageY);{let t=e.touches[0];return HS(t.pageX,t.pageY)}},H_=e=>{if(!HC(e))return HS(e.clientX,e.clientY);{let t=e.touches[0];return HS(t.clientX,t.clientY)}},HT=(e,t)=>{let o=yp.DOM.getPos(e);return Hk(t,o.x,o.y)},HE=(e,t)=>"contextmenu"!==t.type&&"longpress"!==t.type?HD(e):e.inline?HO(t):HT(e.getContentAreaContainer(),H_(t)),HD=e=>({type:"selection",root:eJ.fromDom(e.selection.getNode())}),HA=e=>({type:"node",node:B.some(eJ.fromDom(e.selection.getNode())),root:eJ.fromDom(e.getBody())}),HM=(e,t,o)=>{switch(o){case"node":return HA(e);case"point":return HE(e,t);case"selection":return HD(e)}},HB=(e,t,o,n,r,a)=>{let i=o(),l=HM(e,t,a);DF(i,xg.CLOSE_ON_EXECUTE,n,{isHorizontalMenu:!1,search:B.none()}).map(e=>{t.preventDefault(),v2.showMenuAt(r,{anchor:l},{menu:{markers:xE("normal")},data:e})})},HF={onLtr:()=>[cN,cM,cB,cF,cI,cR,MQ,M0,MZ,MY,MJ,MK],onRtl:()=>[cN,cB,cM,cI,cF,cR,MQ,M0,MJ,MK,MZ,MY]},HI={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},HR=(e,t)=>{let o=e.selection;if(o.isCollapsed()||t.touches.length<1)return!1;{let n=t.touches[0],r=o.getRng(),a=u8(e.getWin(),uL.domRange(r));return a.exists(e=>e.left<=n.clientX&&e.right>=n.clientX&&e.top<=n.clientY&&e.bottom>=n.clientY)}},HN=e=>{let t=e.selection.getRng(),o=()=>{v3.setEditorTimeout(e,()=>{e.selection.setRng(t)},10),a()};e.once("touchend",o);let n=e=>{e.preventDefault(),e.stopImmediatePropagation()};e.on("mousedown",n,!0);let r=()=>a();e.once("longpresscancel",r);let a=()=>{e.off("touchend",o),e.off("longpresscancel",r),e.off("mousedown",n)}},HV=(e,t,o)=>{let n=HM(e,t,o);return{bubble:d6(0,"point"===o?12:0,HI),layouts:HF,overrides:{maxWidthFunction:Rv(),maxHeightFunction:d2()},...n}},Hz=(e,t,o,n,r,a,i)=>{let l=HV(e,t,a);DF(o,xg.CLOSE_ON_EXECUTE,n,{isHorizontalMenu:!0,search:B.none()}).map(o=>{t.preventDefault();let s=i?nD.HighlightMenuAndItem:nD.HighlightNone;v2.showMenuWithinBounds(r,{anchor:l},{menu:{markers:xE("normal"),highlightOnOpen:s},data:o,type:"horizontal"},()=>B.some(zD(e,n.shared,"node"===a?"node":"selection"))),e.dispatch(zm)})},HH=(e,t,o,n,r,a)=>{let i=oX(),l=i.os.isiOS(),s=i.os.isMacOS(),c=i.os.isAndroid(),d=i.deviceType.isTouch(),u=()=>!(c||l||s&&d),m=()=>{let i=o();Hz(e,t,i,n,r,a,u())};if((s||l)&&"node"!==a){let o=()=>{HN(e),m()};HR(e,t)?o():(e.once("selectionchange",o),e.once("touchend",()=>e.off("selectionchange",o)))}else m()},HL=e=>l(e)?"|"===e:"separator"===e.type,HP={type:"separator"},HU=e=>{let t=e=>({text:e.text,icon:e.icon,enabled:e.enabled,shortcut:e.shortcut});if(l(e))return e;switch(e.type){case"separator":return HP;case"submenu":return{type:"nestedmenuitem",...t(e),getSubmenuItems:()=>{let t=e.getSubmenuItems();return l(t)?t:U(t,HU)}};default:return{type:"menuitem",...t(e),onAction:x(e.onAction)}}},HW=(e,t)=>{if(0===t.length)return e;let o=es(e).filter(e=>!HL(e)),n=o.fold(()=>[],e=>[HP]);return e.concat(n).concat(t).concat([HP])},Hj=(e,t,o)=>{let n=X(t,(t,n)=>ek(e,n.toLowerCase()).map(e=>{let n=e.update(o);if(l(n))return HW(t,n.split(" "));if(!(n.length>0))return t;{let e=U(n,HU);return HW(t,e)}}).getOrThunk(()=>t.concat([n])),[]);return n.length>0&&HL(n[n.length-1])&&n.pop(),n},HG=(e,t)=>t.ctrlKey&&!Hv(e),H$=e=>"longpress"===e.type||eC(e,"touches"),Hq=(e,t)=>!H$(t)&&(2!==t.button||t.target===e.getBody()&&""===t.pointerType),HX=(e,t)=>Hq(e,t)?e.selection.getStart(!0):t.target,HK=(e,t)=>{let o=Hy(e),n=Hq(e,t)?"selection":"point";if(!eW(o))return n;{let r=HX(e,t),a=Ob(eJ.fromDom(r),o);return a?"node":n}},HY=(e,t,o)=>{let n=oX(),r=n.deviceType.isTouch,a=sA(v2.sketch({dom:{tag:"div"},lazySink:t,onEscape:()=>e.focus(),onShow:()=>o.setContextMenuState(!0),onHide:()=>o.setContextMenuState(!1),fireDismissalEventInstead:{},inlineBehaviours:c2([bG("dismissContextMenu",[iW(iC(),(t,o)=>{gs.close(t),e.focus()})])])})),i=()=>v2.hide(a),l=t=>{if(Hv(e)&&t.preventDefault(),HG(e,t)||Hx(e))return;let n=HK(e,t),i=()=>{let o=HX(e,t),n=e.ui.registry.getAll(),r=Hw(e);return Hj(n.contextMenus,r,o)},l=r()?HH:HB;l(e,t,i,o,a,n)};e.on("init",()=>{let t="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(r()?"":" ResizeWindow");e.on(t,i),e.on("longpress contextmenu",l)})},HJ=a_.generate([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),HZ=e=>t=>t.translate(-e.left,-e.top),HQ=e=>t=>t.translate(e.left,e.top),H0=e=>(t,o)=>X(e,(e,t)=>t(e),t7(t,o)),H1=(e,t,o)=>e.fold(H0([HQ(o),HZ(t)]),H0([HZ(t)]),H0([])),H2=(e,t,o)=>e.fold(H0([HQ(o)]),H0([]),H0([HQ(t)])),H3=(e,t,o)=>e.fold(H0([]),H0([HZ(o)]),H0([HQ(t),HZ(o)])),H5=(e,t,o,n,r,a)=>{let i=H2(e,r,a),l=H2(t,r,a);return Math.abs(i.left-l.left)<=o&&Math.abs(i.top-l.top)<=n},H9=(e,t,o,n,r,a)=>{let i=H2(e,r,a),l=H2(t,r,a),s=Math.abs(i.left-l.left),c=Math.abs(i.top-l.top);return t7(s,c)},H4=(e,t,o)=>{let n=e.fold((e,t)=>({position:B.some("absolute"),left:B.some(e+"px"),top:B.some(t+"px")}),(e,t)=>({position:B.some("absolute"),left:B.some(e-o.left+"px"),top:B.some(t-o.top+"px")}),(e,t)=>({position:B.some("fixed"),left:B.some(e+"px"),top:B.some(t+"px")}));return{right:B.none(),bottom:B.none(),...n}},H6=(e,t,o)=>e.fold((e,n)=>H7(e+t,n+o),(e,n)=>Le(e+t,n+o),(e,n)=>Lt(e+t,n+o)),H8=(e,t,o,n)=>{let r=(e,r)=>(a,i)=>{let l=e(t,o,n);return r(a.getOr(l.left),i.getOr(l.top))};return e.fold(r(H3,H7),r(H2,Le),r(H1,Lt))},H7=HJ.offset,Le=HJ.absolute,Lt=HJ.fixed,Lo=(e,t)=>{let o=tP(e,t);return g(o)?NaN:parseInt(o,10)},Ln=(e,t)=>{let o=e.element,n=Lo(o,t.leftAttr),r=Lo(o,t.topAttr);return isNaN(n)||isNaN(r)?B.none():B.some(t7(n,r))},Lr=(e,t,o)=>{let n=e.element;tH(n,t.leftAttr,o.left+"px"),tH(n,t.topAttr,o.top+"px")},La=(e,t)=>{let o=e.element;tj(o,t.leftAttr),tj(o,t.topAttr)},Li=(e,t,o,n)=>Ln(e,t).fold(()=>o,e=>Lt(e.left+n.left,e.top+n.top)),Ll=(e,t,o,n,r,a)=>{let i=Li(e,t,o,n),l=t.mustSnap?Ld(e,t,i,r,a):Lu(e,t,i,r,a),s=H1(i,r,a);return Lr(e,t,s),l.fold(()=>({coord:Lt(s.left,s.top),extra:B.none()}),e=>({coord:e.output,extra:e.extra}))},Ls=(e,t)=>{La(e,t)},Lc=(e,t,o,n)=>ed(e,e=>{let r=e.sensor,a=H5(t,r,e.range.left,e.range.top,o,n);return a?B.some({output:H8(e.output,t,o,n),extra:e.extra}):B.none()}),Ld=(e,t,o,n,r)=>{let a=t.getSnapPoints(e),i=Lc(a,o,n,r);return i.orThunk(()=>{let e=X(a,(e,t)=>{let a=t.sensor,i=H9(o,a,t.range.left,t.range.top,n,r);return e.deltas.fold(()=>({deltas:B.some(i),snap:B.some(t)}),o=>{let n=(i.left+i.top)/2,r=(o.left+o.top)/2;return n<=r?{deltas:B.some(i),snap:B.some(t)}:e})},{deltas:B.none(),snap:B.none()});return e.snap.map(e=>({output:H8(e.output,o,n,r),extra:e.extra}))})},Lu=(e,t,o,n,r)=>{let a=t.getSnapPoints(e);return Lc(a,o,n,r)},Lm=(e,t,o)=>({coord:H8(e.output,e.output,t,o),extra:e.extra}),Lg=(e,t,o,n)=>{let r=t.getTarget(e.element);if(t.repositionTarget){let t=tu(e.element),o=ne(t),a=Fx(r),i=Lm(n,o,a),l=H4(i.coord,o,a);tY(r,l)}};var Lp=Object.freeze({__proto__:null,snapTo:Lg});let Lh="data-initial-z-index",Lf=e=>{th(e.element).filter(te).each(e=>{tU(e,Lh).fold(()=>t2(e,"z-index"),t=>tX(e,"z-index",t)),tj(e,Lh)})},Lb=e=>{th(e.element).filter(te).each(t=>{tQ(t,"z-index").each(e=>{tH(t,Lh,e)}),tX(t,"z-index",tJ(e.element,"z-index"))})},Lv=(e,t)=>{e.getSystem().addToGui(t),Lb(t)},Ly=e=>{Lf(e),e.getSystem().removeFromGui(e)},Lx=(e,t,o)=>e.getSystem().build(OH.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[t]},events:o}));var Lw=ag("snaps",[r4("getSnapPoints"),s6("onSensor"),r4("leftAttr"),r4("topAttr"),ah("lazyViewport",nG),ah("mustSnap",!1)]);let LS=[ah("useFixed",A),r4("blockerClass"),ah("getTarget",C),ah("onDrag",y),ah("repositionTarget",!0),ah("onDrop",y),aw("getBounds",nG),Lw],Lk=e=>eM(tQ(e,"left"),tQ(e,"top"),tQ(e,"position"),(e,t,o)=>("fixed"===o?Lt:H7)(parseInt(e,10),parseInt(t,10))).getOrThunk(()=>{let t=oo(e);return Le(t.left,t.top)}),LC=(e,t,o,n,r)=>{let a=r.bounds,i=H2(t,o,n),l=cv(i.left,a.x,a.x+a.width-r.width),s=cv(i.top,a.y,a.y+a.height-r.height),c=Le(l,s);return t.fold(()=>{let e=H3(c,o,n);return H7(e.left,e.top)},k(c),()=>{let e=H1(c,o,n);return Lt(e.left,e.top)})},LO=(e,t,o,n,r,a,i)=>{let l=t.fold(()=>{let e=H6(o,a.left,a.top),t=H1(e,n,r);return Lt(t.left,t.top)},t=>{let i=Ll(e,t,o,a,n,r);return i.extra.each(o=>{t.onSensor(e,o)}),i.coord});return LC(e,l,n,r,i)},L_=(e,t,o,n)=>{let r=t.getTarget(e.element);if(t.repositionTarget){let a=tu(e.element),i=ne(a),l=Fx(r),s=Lk(r),c=LO(e,t.snaps,s,i,l,n,o),d=H4(c,i,l);tY(r,d)}t.onDrag(e,r,n)},LT=(e,t)=>({bounds:e.getBounds(),height:t6(t.element),width:ol(t.element)}),LE=(e,t,o,n,r)=>{let a=o.update(n,r),i=o.getStartData().getOrThunk(()=>LT(t,e));a.each(o=>{L_(e,t,i,o)})},LD=(e,t,o,n)=>{t.each(Ly),o.snaps.each(t=>{Ls(e,t)});let r=o.getTarget(e.element);n.reset(),o.onDrop(e,r)},LA=e=>(t,o)=>{let n=e=>{o.setStartData(LT(t,e))};return iL([iW(ix(),e=>{o.getStartData().each(()=>n(e))}),...e(t,o,n)])},LM=e=>iL([iW(aJ(),e.forceDrop),iW(a0(),e.drop),iW(aZ(),(t,o)=>{e.move(o.event)}),iW(aQ(),e.delayDrop)]),LB=e=>B.from(t7(e.x,e.y)),LF=(e,t)=>t7(t.left-e.left,t.top-e.top);var LI=Object.freeze({__proto__:null,getData:LB,getDelta:LF});let LR=(e,t,o)=>[iW(aJ(),(n,r)=>{let a=r.event.raw;if(0!==a.button)return;r.stop();let i=()=>LD(n,B.some(c),e,t),l=Ov(i,200),s={drop:i,delayDrop:l.schedule,forceDrop:i,move:o=>{l.cancel(),LE(n,e,t,LI,o)}},c=Lx(n,e.blockerClass,LM(s));o(n),Lv(n,c)})],LN=[...LS,ct("dragger",{handlers:LA(LR)})],LV=e=>iL([iW(aq(),e.forceDrop),iW(aK(),e.drop),iW(aY(),e.drop),iW(aX(),(t,o)=>{e.move(o.event)})]),Lz=e=>{let t=e[0];return B.some(t7(t.clientX,t.clientY))},LH=e=>{let t=e.raw,o=t.touches;return 1===o.length?Lz(o):B.none()},LL=(e,t)=>t7(t.left-e.left,t.top-e.top);var LP=Object.freeze({__proto__:null,getData:LH,getDelta:LL});let LU=(e,t,o)=>{let n=dR(),r=o=>{LD(o,n.get(),e,t),n.clear()};return[iW(aq(),(a,i)=>{i.stop();let l=()=>r(a),s=Lx(a,e.blockerClass,LV({drop:l,delayDrop:y,forceDrop:l,move:o=>{LE(a,e,t,LP,o)}}));n.set(s),o(a),Lv(a,s)}),iW(aX(),(o,n)=>{n.stop(),LE(o,e,t,LP,n.event)}),iW(aK(),(e,t)=>{t.stop(),r(e)}),iW(aY(),r)]},LW=[...LS,ct("dragger",{handlers:LA(LU)})],Lj=(e,t,o)=>[...LR(e,t,o),...LU(e,t,o)],LG=[...LS,ct("dragger",{handlers:LA(Lj)})];var L$=Object.freeze({__proto__:null,mouse:LN,touch:LW,mouseOrTouch:LG});let Lq=()=>{let e=B.none(),t=B.none(),o=()=>{e=B.none(),t=B.none()},n=(t,o)=>{let n=e.map(e=>t.getDelta(e,o));return e=B.some(o),n},r=(e,t)=>e.getData(t).bind(t=>n(e,t)),a=e=>{t=B.some(e)},i=k({});return lO({readState:i,reset:o,update:r,getStartData:()=>t,setStartData:a})};var LX=Object.freeze({__proto__:null,init:Lq});let LK=c4({branchKey:"mode",branches:L$,name:"dragging",active:{events:(e,t)=>{let o=e.dragger;return o.handlers(e,t)}},extra:{snap:e=>({sensor:e.sensor,range:e.range,output:e.output,extra:B.from(e.extra)})},state:LX,apis:Lp}),LY=(e,t,o,n,r,a)=>e.fold(()=>LK.snap({sensor:Le(o-20,n-20),range:t7(r,a),output:Le(B.some(o),B.some(n)),extra:{td:t}}),e=>{let r=e.element.dom.getBoundingClientRect();return LK.snap({sensor:Le(o-20,n-20),range:t7(40,40),output:Le(B.some(o-r.width/2),B.some(n-r.height/2)),extra:{td:t}})}),LJ=(e,t,o)=>{let n=(e,t)=>e.exists(e=>tc(e,t));return{getSnapPoints:e,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:(e,r)=>{let a=r.td;n(t.get(),a)||(t.set(a),o(a))},mustSnap:!0}},LZ=e=>v4(v9.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:c2([LK.config({mode:"mouseOrTouch",blockerClass:"blocker",snaps:e}),_v.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}})),LQ=(e,t)=>{let o=aC([]),n=aC([]),r=aC(!1),a=dR(),i=dR(),l=e=>{let o=nU(e);return LY(g.getOpt(t),e,o.x,o.y,o.width,o.height)},s=()=>U(o.get(),e=>l(e)),c=e=>{let o=nU(e);return LY(p.getOpt(t),e,o.right,o.bottom,o.width,o.height)},d=()=>U(n.get(),e=>c(e)),u=LJ(s,a,t=>{i.get().each(o=>{e.dispatch("TableSelectorChange",{start:t,finish:o})})}),m=LJ(d,i,t=>{a.get().each(o=>{e.dispatch("TableSelectorChange",{start:o,finish:t})})}),g=LZ(u),p=LZ(m),h=sA(g.asSpec()),f=sA(p.asSpec()),b=(t,o,n,r)=>{let a=o.dom.getBoundingClientRect();t2(t.element,"display");let i=tp(eJ.fromDom(e.getBody())).dom.innerHeight,l=n(a),s=r(a,i);(l||s)&&tX(t.element,"display","none")},v=(e,t,o,n)=>{let r=o(t);LK.snapTo(e,r);let a=e=>e[n]<0,i=(e,t)=>e[n]>t;b(e,t,a,i)},y=e=>v(h,e,l,"top"),x=()=>a.get().each(y),w=e=>v(f,e,c,"bottom"),S=()=>i.get().each(w);oX().deviceType.isTouch()&&(e.on("TableSelectionChange",e=>{r.get()||(mj(t,h),mj(t,f),r.set(!0)),a.set(e.start),i.set(e.finish),e.otherCells.each(t=>{o.set(t.upOrLeftCells),n.set(t.downOrRightCells),y(e.start),w(e.finish)})}),e.on("ResizeEditor ResizeWindow ScrollContent",()=>{x(),S()}),e.on("TableSelectionClear",()=>{r.get()&&(mq(h),mq(f),r.set(!1)),a.clear(),i.clear()}))},L0=e=>"BR"===e.nodeName||!!e.getAttribute("data-mce-bogus")||"bookmark"===e.getAttribute("data-mce-type"),L1=(e,t,o)=>{var n;let r=null!==(n=t.delimiter)&&void 0!==n?n:"›",a=(t,n,r)=>v9.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{"data-index":r,"aria-level":r+1}},components:[s_(t)],action:t=>{e.focus(),e.selection.select(n),e.nodeChanged()},buttonBehaviours:c2([SA.button(o.isDisabled),SO()])}),i=()=>({dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0}},components:[s_(` ${r} `)]}),l=e=>X(e,(e,t,o)=>{let n=a(t.name,t.element,o);return 0===o?e.concat([n]):e.concat([i(),n])},[]),s=t=>{let o=[],n=t.length;for(;n-- >0;){let r=t[n];if(1===r.nodeType&&!L0(r)){let t=kT(e,r);if(t.isDefaultPrevented()||o.push({name:t.name,element:r}),t.isPropagationStopped())break}}return o};return{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:c2([bD.config({mode:"flow",selector:"div[role=button]"}),ha.config({disabled:o.isDisabled}),SO(),OK.config({}),bW.config({}),bG("elementPathEvents",[iZ((t,o)=>{e.shortcuts.add("alt+F11","focus statusbar elementpath",()=>bD.focusIn(t)),e.on("NodeChange",e=>{let o=s(e.parents),n=o.length>0?l(o):[];bW.set(t,n)})})])]),components:[]}};(nC=nR||(nR={}))[nC.None=0]="None",nC[nC.Both=1]="Both",nC[nC.Vertical=2]="Vertical";let L2=(e,t,o,n,r)=>{let a={height:V7(n+t.top,yC(e),y_(e))};return o===nR.Both&&(a.width=V7(r+t.left,yk(e),yO(e))),a},L3=(e,t,o)=>{let n=eJ.fromDom(e.getContainer()),r=L2(e,t,o,t4(n),oi(n));eg(r,(e,t)=>{b(e)&&tX(n,t,V8(e))}),kS(e)},L5=e=>{let t=yZ(e);return!1===t?nR.None:"both"===t?nR.Both:nR.Vertical},L9=(e,t,o,n)=>{let r=t7(20*o,20*n);return L3(e,r,t),B.some(!0)},L4=(e,t)=>{let o=L5(e);return o===nR.None?B.none():B.some(ys("resize-handle",{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:t.translate("Resize")},behaviours:[LK.config({mode:"mouse",repositionTarget:!1,onDrag:(t,n,r)=>L3(e,r,o),blockerClass:"tox-blocker"}),bD.config({mode:"special",onLeft:()=>L9(e,o,-1,0),onRight:()=>L9(e,o,1,0),onUp:()=>L9(e,o,0,-1),onDown:()=>L9(e,o,0,1)}),OK.config({}),b0.config({})]},t.icons))},L6=(e,t)=>{let o=(e,o,n)=>bW.set(e,[s_(t.translate(["{0} "+n,o[n]]))]);return v9.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:c2([SA.button(t.isDisabled),SO(),OK.config({}),bW.config({}),gU.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),bG("wordcount-events",[i1(e=>{let t=gU.getValue(e),n="words"===t.mode?"characters":"words";gU.setValue(e,{mode:n,count:t.count}),o(e,t.count,n)}),iZ(t=>{e.on("wordCountUpdate",e=>{let{mode:n}=gU.getValue(t);gU.setValue(t,{mode:n,count:e.wordCount}),o(t,e.wordCount,n)})})])]),eventOrder:{[id()]:["disabling","alloy.base.behaviour","wordcount-events"]}})},L8=(e,t)=>{let o=()=>({dom:{tag:"span",classes:["tox-statusbar__branding"]},components:[{dom:{tag:"a",attributes:{href:"https://www.tiny.cloud/powered-by-tiny?utm_campaign=editor_referral&utm_medium=poweredby&utm_source=tinymce&utm_content=v6",rel:"noopener",target:"_blank","aria-label":v6.translate(["Powered by {0}","Tiny"])},innerHtml:'<svg width="50px" height="16px" viewBox="0 0 50 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M10.143 0c2.608.015 5.186 2.178 5.186 5.331 0 0 .077 3.812-.084 4.87-.361 2.41-2.164 4.074-4.65 4.496-1.453.284-2.523.49-3.212.623-.373.071-.634.122-.785.152-.184.038-.997.145-1.35.145-2.732 0-5.21-2.04-5.248-5.33 0 0 0-3.514.03-4.442.093-2.4 1.758-4.342 4.926-4.963 0 0 3.875-.752 4.036-.782.368-.07.775-.1 1.15-.1Zm1.826 2.8L5.83 3.989v2.393l-2.455.475v5.968l6.137-1.189V9.243l2.456-.476V2.8ZM5.83 6.382l3.682-.713v3.574l-3.682.713V6.382Zm27.173-1.64-.084-1.066h-2.226v9.132h2.456V7.743c-.008-1.151.998-2.064 2.149-2.072 1.15-.008 1.987.92 1.995 2.072v5.065h2.455V7.359c-.015-2.18-1.657-3.929-3.837-3.913a3.993 3.993 0 0 0-2.908 1.296Zm-6.3-4.266L29.16 0v2.387l-2.456.475V.476Zm0 3.2v9.132h2.456V3.676h-2.456Zm18.179 11.787L49.11 3.676H46.58l-1.612 4.527-.46 1.382-.384-1.382-1.611-4.527H39.98l3.3 9.132L42.15 16l2.732-.537ZM22.867 9.738c0 .752.568 1.075.921 1.075.353 0 .668-.047.998-.154l.537 1.765c-.23.154-.92.537-2.225.537-1.305 0-2.655-.997-2.686-2.686a136.877 136.877 0 0 1 0-4.374H18.8V3.676h1.612v-1.98l2.455-.476v2.456h2.302V5.9h-2.302v3.837Z"/>\n</svg>\n'.trim()},behaviours:c2([b0.config({})])}]}),n=()=>{let n=[];return(yY(e)&&n.push(L1(e,{},t)),e.hasPlugin("wordcount")&&n.push(L6(e,t)),yJ(e)&&n.push(o()),n.length>0)?[{dom:{tag:"div",classes:["tox-statusbar__text-container"]},components:n}]:[]};return{dom:{tag:"div",classes:["tox-statusbar"]},components:(()=>{let o=n(),r=L4(e,t);return o.concat(r.toArray())})()}},L7=(e,t)=>t.get().getOrDie(`UI for ${e} has not been rendered`),Pe=(e,t)=>{let o=e.inline,n=o?zd:V4,r=xr(e)?Ib:Fv,a=zu(),i=dR(),l=dR(),s=dR(),c=oX(),d=c.deviceType.isTouch(),u=d?["tox-platform-touch"]:[],m=y7(e),g=yB(e),p=v4({dom:{tag:"div",classes:["tox-anchorbar"]}}),h=()=>a.mainUi.get().map(e=>e.outerContainer).bind(ND.getHeader),f=()=>nY.fromOption(a.dialogUi.get().map(e=>e.sink),"UI has not been rendered"),b=()=>nY.fromOption(a.popupUi.get().map(e=>e.sink),"(popup) UI has not been rendered"),v=a.lazyGetInOuterOrDie("anchor bar",p.getOpt),y=a.lazyGetInOuterOrDie("toolbar",ND.getToolbar),x=a.lazyGetInOuterOrDie("throbber",ND.getThrobber),w=Fn({popup:b,dialog:f},e,v),S=()=>{let t={attributes:{[ut]:m?nT.BottomToTop:nT.TopToBottom}},o=ND.parts.menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:w.popup,onEscape:()=>{e.focus()}}),n=ND.parts.toolbar({dom:{tag:"div",classes:["tox-toolbar"]},getSink:w.popup.shared.getSink,providers:w.popup.shared.providers,onEscape:()=>{e.focus()},onToolbarToggled:t=>{kE(e,t)},type:g,lazyToolbar:y,lazyHeader:()=>h().getOrDie("Could not find header element"),...t}),r=ND.parts["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},providers:w.popup.shared.providers,onEscape:()=>{e.focus()},type:g}),a=y8(e),i=y4(e),l=y3(e),s=y1(e),c=k();return ND.parts.header({dom:{tag:"div",classes:["tox-editor-header"].concat(a||i||l?[]:["tox-editor-header--empty"]),...t},components:Z([l?s?[c,o]:[o]:[],a?[r]:i?[n]:[],xt(e)?[]:[p.asSpec()]]),sticky:xr(e),editor:e,sharedBackstage:w.popup.shared})},k=()=>ND.parts.promotion({dom:{tag:"div",classes:["tox-promotion"]}}),C=()=>{let e=ND.parts.socket({dom:{tag:"div",classes:["tox-edit-area"]}}),t=ND.parts.sidebar({dom:{tag:"div",classes:["tox-sidebar"]}});return{dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[e,t]}},O=()=>{let t=xo(e),o=tc(tN(),t)&&"grid"===tJ(t,"display"),n={dom:{tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(u),attributes:{...v6.isRtl()?{dir:"rtl"}:{}}},behaviours:c2([mI.config({useFixed:()=>r.isDocked(h)})])},a={dom:{styles:{width:document.body.clientWidth+"px"}},events:iL([iW(iw(),e=>{tX(e.element,"width",document.body.clientWidth+"px")})])},i=sA(rn(n,o?a:{})),s=OL(i);return l.set(s),{sink:i,mothership:s}},_=()=>{let e={dom:{tag:"div",classes:["tox","tox-silver-sink","tox-silver-popup-sink","tox-tinymce-aux"].concat(u),attributes:{...v6.isRtl()?{dir:"rtl"}:{}}},behaviours:c2([mI.config({useFixed:()=>r.isDocked(h),getBounds:()=>t.getPopupSinkBounds()})])},o=sA(e),n=OL(o);return s.set(n),{sink:o,mothership:n}},T=()=>{let t=S(),n=C(),r=ND.parts.throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:w.popup}),a=ND.parts.viewWrapper({backstage:w.popup}),l=yK(e)&&!o?B.some(L8(e,w.popup.shared.providers)):B.none(),s=Z([m?[]:[t],o?[]:[n],m?[t]:[]]),c=ND.parts.editorContainer({components:Z([s,o?[]:l.toArray()])}),d=xn(e),g={role:"application",...v6.isRtl()?{dir:"rtl"}:{},...d?{"aria-hidden":"true"}:{}},p=sA(ND.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(o?["tox-tinymce-inline"]:[]).concat(m?["tox-tinymce--toolbar-bottom"]:[]).concat(u),styles:{visibility:"hidden",...d?{opacity:"0",border:"0"}:{}},attributes:g},components:[c,...o?[]:[a],r],behaviours:c2([SO(),ha.config({disableClass:"tox-tinymce--disabled"}),bD.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a, .tox-statusbar__resize-handle"})])})),h=OL(p);return i.set(h),{mothership:h,outerContainer:p}},E=t=>{let o=V8(zt(e)),n=V8(zn(e));return e.inline||(t1("div","width",n)&&tX(t.element,"width",n),t1("div","height",o)?tX(t.element,"height",o):tX(t.element,"height","400px")),o},D=t=>{e.addShortcut("alt+F9","focus menubar",()=>{ND.focusMenubar(t)}),e.addShortcut("alt+F10","focus toolbar",()=>{ND.focusToolbar(t)}),e.addCommand("ToggleToolbarDrawer",(e,o)=>{(null==o?void 0:o.skipFocus)?ND.toggleToolbarDrawerWithoutFocusing(t):ND.toggleToolbarDrawer(t)}),e.addQueryStateHandler("ToggleToolbarDrawer",()=>ND.isToolbarDrawerToggled(t))},A=t=>{let{mainUi:o,popupUi:a,uiMotherships:i}=t;ep(yF(e),(t,o)=>{e.ui.registry.addGroupToolbarButton(o,t)});let{buttons:l,menuItems:s,contextToolbars:c,sidebars:d,views:u}=e.ui.registry.getAll(),m=y6(e),p={menuItems:s,menus:xi(e),menubar:yH(e),toolbar:m.getOrThunk(()=>yL(e)),allowToolbarGroups:g===nA.floating,buttons:l,sidebar:d,views:u};D(o.outerContainer),Fr(e,o.mothership,i),r.setup(e,w.popup.shared,h),Hp(e,w.popup),HY(e,w.popup.shared.getSink,w.popup),Iz(e),Ro(e,x,w.popup.shared),zJ(e,c,a.sink,{backstage:w.popup}),LQ(e,a.sink);let f=e.getElement(),b=E(o.outerContainer);return n.render(e,t,p,w.popup,{targetNode:f,height:b})},M=e=>(s.set(e.mothership),e),F=()=>{let t=T(),o=O(),n=xa(e)?_():M(o);a.dialogUi.set(o),a.popupUi.set(n),a.mainUi.set(t);let r={popupUi:n,dialogUi:o,mainUi:t,uiMotherships:a.getUiMotherships()};return A(r)};return{popups:{backstage:w.popup,getMothership:()=>L7("popups",s)},dialogs:{backstage:w.dialog,getMothership:()=>L7("dialogs",l)},renderUI:F}},Pt=(e,t)=>{let o=B.from(tP(e,"id")).fold(()=>{let e=lr("dialog-describe");return tH(t,"id",e),e},C);tH(e,"aria-describedby",o)},Po=(e,t)=>{let o=tU(e,"id").fold(()=>{let e=lr("dialog-label");return tH(t,"id",e),e},C);tH(e,"aria-labelledby",o)},Pn=k([r4("lazySink"),ai("dragBlockClass"),aw("getBounds",nG),ah("useTabstopAt",M),ah("firstTabstop",0),ah("eventOrder",{}),gW("modalBehaviours",[bD]),s8("onExecute"),ce("onEscape")]),Pr={sketch:C},Pa=k([pg({name:"draghandle",overrides:(e,t)=>({behaviours:c2([LK.config({mode:"mouse",getTarget:e=>sV(e,'[role="dialog"]').getOr(e),blockerClass:e.dragBlockClass.getOrDie(Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+JSON.stringify(t,null,2)).message),getBounds:e.getDragBounds})])})}),pu({schema:[r4("dom")],name:"title"}),pu({factory:Pr,schema:[r4("dom")],name:"close"}),pu({factory:Pr,schema:[r4("dom")],name:"body"}),pg({factory:Pr,schema:[r4("dom")],name:"footer"}),pm({factory:{sketch:(e,t)=>({...e,dom:t.dom,components:t.components})},schema:[ah("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),ah("components",[])],name:"blocker"})]),Pi=(e,t,o,n)=>{let r=dR(),a=t=>{r.set(t);let o=e.lazySink(t).getOrDie(),a=n.blocker(),i=o.getSystem().build({...a,components:a.components.concat([lx(t)]),behaviours:c2([b0.config({}),bG("dialog-blocker-events",[iJ(a2(),()=>{bD.focusIn(t)})])])});mj(o,i),bD.focusIn(t)},i=e=>{r.clear(),th(e.element).each(t=>{e.getSystem().getByDom(t).each(e=>{mq(e)})})},l=t=>pT(t,e,"body"),s=t=>pT(t,e,"footer"),c=(e,t)=>{I1.block(e,t)},d=e=>{I1.unblock(e)},u=lr("modal-events"),m={...e.eventOrder,[iS()]:[u].concat(e.eventOrder["alloy.system.attached"]||[])};return{uid:e.uid,dom:e.dom,components:t,apis:{show:a,hide:i,getBody:l,getFooter:s,setIdle:d,setBusy:c},eventOrder:m,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:gG(e.modalBehaviours,[bW.config({}),bD.config({mode:"cyclic",onEnter:e.onExecute,onEscape:e.onEscape,useTabstopAt:e.useTabstopAt,firstTabstop:e.firstTabstop}),I1.config({getRoot:r.get}),bG(u,[iZ(t=>{Po(t.element,pT(t,e,"title").element),Pt(t.element,pT(t,e,"body").element)})])])}},Pl=pG({name:"ModalDialog",configFields:Pn(),partFields:Pa(),factory:Pi,apis:{show:(e,t)=>{e.show(t)},hide:(e,t)=>{e.hide(t)},getBody:(e,t)=>e.getBody(t),getFooter:(e,t)=>e.getFooter(t),setBusy:(e,t,o)=>{e.setBusy(t,o)},setIdle:(e,t)=>{e.setIdle(t)}}}),Ps=rI([x6,x8].concat(wZ)),Pc=[wC("button"),wu,ay("align","end",["start","end"]),wy,wv,ad("buttonType",["primary","secondary"])],Pd=[...Pc,we],Pu=[ae("type",["submit","cancel","custom"]),...Pd],Pm=[ae("type",["menu"]),wd,wm,wu,aa("items",Ps),...Pc],Pg=[...Pc,ae("type",["togglebutton"]),r7("tooltip"),wo,wd,ax("active",!1)],Pp=r3("type",{submit:Pu,cancel:Pu,custom:Pu,menu:Pm,togglebutton:Pg}),Ph=[x6,we,ae("level",["info","warn","error","success"]),wo,ah("url","")],Pf=rI(Ph),Pb=e=>[x6,e],Pv=[x6,we,wv,wC("button"),wu,wb,ad("buttonType",["primary","secondary","toolbar"]),wy],Py=rI(Pv),Px=[x6,x8],Pw=Px.concat([wg]),PS=Px.concat([x7,wv]),Pk=rI(PS),PC=Pw.concat([wx("auto")]),PO=rI(PC),P_=rH([wn,we,wo]),PT=Pw.concat([av("storageKey","default")]),PE=rI(PT),PD=rI(Pw),PA=Px.concat([av("tag","textarea"),r7("scriptId"),r7("scriptUrl"),af("settings",void 0,rq)]),PM=Px.concat([av("tag","textarea"),at("init")]),PB=rY(e=>rQ("customeditor.old",rF(PM),e).orThunk(()=>rQ("customeditor.new",rF(PA),e))),PF=rI(Pw),PI=rR(rC),PR=e=>[x6,r8("columns"),e],PN=[x6,r7("html"),ay("presets","presentation",["presentation","document"])],PV=rI(PN),Pz=Pw.concat([ax("sandboxed",!0),ax("transparent",!0)]),PH=rI(Pz),PL=rI(Px.concat([ac("height")])),PP=rI([r7("url"),as("zoom"),as("cachedWidth"),as("cachedHeight")]),PU=Pw.concat([ac("inputMode"),ac("placeholder"),ax("maximized",!1),wv]),PW=rI(PU),Pj=e=>[x6,x7,e],PG=[we,aa("items",r5("items",()=>P$))],P$=rN([rI([we,wn]),rI(PG)]),Pq=Pw.concat([aa("items",P$),wv]),PX=rI(Pq),PK=Pw.concat([ar("items",[we,wn]),ab("size",1),wv]),PY=rI(PK),PJ=Pw.concat([ax("constrain",!0),wv]),PZ=rI(PJ),PQ=rI([r7("width"),r7("height")]),P0=Px.concat([x7,ab("min",0),ab("max",0)]),P1=rI(P0),P2=[x6,aa("header",rW),aa("cells",rR(rW))],P3=rI(P2),P5=Pw.concat([ac("placeholder"),ax("maximized",!1),wv]),P9=rI(P5),P4=[ae("type",["directory","leaf"]),wt,r7("id"),al("menu",IS)],P6=rI(P4),P8=P4.concat([aa("children",r5("children",()=>rK("type",{directory:P7,leaf:P6})))]),P7=rI(P8),Ue=rK("type",{directory:P7,leaf:P6}),Ut=[x6,aa("items",Ue),au("onLeafAction")],Uo=rI(Ut),Un=Pw.concat([ay("filetype","file",["image","media","file"]),wv]),Ur=rI(Un),Ua=rI([wn,ww]),Ui=e=>n8("items","items",ra(),rR(rY(t=>rQ(`Checking item of ${e}`,Ul,t).fold(e=>nY.error(r2(e)),e=>nY.value(e))))),Ul=rM(()=>rK("type",{alertbanner:Pf,bar:rI(Pb(Ui("bar"))),button:Py,checkbox:Pk,colorinput:PE,colorpicker:PD,dropzone:PF,grid:rI(PR(Ui("grid"))),iframe:PH,input:PW,listbox:PX,selectbox:PY,sizeinput:PZ,slider:P1,textarea:P9,urlinput:Ur,customeditor:PB,htmlpanel:PV,imagepreview:PL,collection:PO,label:rI(Pj(Ui("label"))),table:P3,tree:Uo,panel:Uc})),Us=[x6,ah("classes",[]),aa("items",Ul)],Uc=rI(Us),Ud=[wC("tab"),wt,aa("items",Ul)],Uu=[x6,ar("tabs",Ud)],Um=rI(Uu),Ug=rI([r7("title"),r6("body",rK("type",{panel:Uc,tabpanel:Um})),av("size","normal"),aa("buttons",Pp),ah("initialData",{}),aw("onAction",y),aw("onChange",y),aw("onSubmit",y),aw("onClose",y),aw("onCancel",y),aw("onTabChange",y)]),Up=e=>rQ("dialog",Ug,e),Uh=rI([ae("type",["cancel","custom"]),...Pd]),Uf=rI([r7("title"),r7("url"),as("height"),as("width"),am("buttons",Uh),aw("onAction",y),aw("onCancel",y),aw("onClose",y),aw("onMessage",y)]),Ub=e=>rQ("dialog",Uf,e),Uv=e=>s(e)?[e].concat(Q(eS(e),Uv)):d(e)?Q(e,Uv):[],Uy=e=>l(e.type)&&l(e.name),Ux={checkbox:rj,colorinput:rW,colorpicker:rW,dropzone:PI,input:rW,iframe:rW,imagepreview:PP,selectbox:rW,sizeinput:PQ,slider:rU,listbox:rW,size:PQ,textarea:rW,urlinput:Ua,customeditor:rW,collection:P_,togglemenuitem:rj},Uw=e=>B.from(Ux[e.type]),US=e=>$(Uv(e),Uy),Uk=e=>{let t=US(e),o=Q(t,e=>Uw(e).fold(()=>[],t=>[r6(e.name,t)]));return rI(o)},UC=e=>{var t;let o=r0(Up(e)),n=Uk(e),r=null!==(t=e.initialData)&&void 0!==t?t:{};return{internalDialog:o,dataValidator:n,initialData:r}},UO={open:(e,t)=>{let o=UC(t);return e(o.internalDialog,o.initialData,o.dataValidator)},openUrl:(e,t)=>{let o=r0(Ub(t));return e(o)},redial:e=>UC(e)},U_=(e,t)=>{let o=(o,n)=>{e.updateState.each(e=>{let r=e(o,n);t.set(r)}),e.renderComponents.each(r=>{let a=r(n,t.get()),i=e.reuseDom?bM:bA;i(o,a)})};return iL([iW(ic(),(t,n)=>{if(!n.universal){let r=e.channel;z(n.channels,r)&&o(t,n.data)}}),iZ((t,n)=>{e.initialData.each(e=>{o(t,e)})})])};var UT=Object.freeze({__proto__:null,events:U_}),UE=Object.freeze({__proto__:null,getState:(e,t,o)=>o}),UD=[r4("channel"),ai("renderComponents"),ai("updateState"),ai("initialData"),ax("reuseDom",!0)];let UA=()=>{let e=aC(B.none()),t=()=>e.set(B.none()),o=()=>e.get().getOr("none");return{readState:o,get:e.get,set:e.set,clear:t}};var UM=Object.freeze({__proto__:null,init:UA});let UB=c5({fields:UD,name:"reflecting",active:UT,apis:UE,state:UM}),UF=e=>{let t=[],o={};return eg(e,(e,n)=>{e.fold(()=>{t.push(n)},e=>{o[n]=e})}),t.length>0?nY.error(t):nY.value(o)},UI=(e,t,o)=>{let n=v4(EM.sketch(n=>({dom:{tag:"div",classes:["tox-form"].concat(e.classes)},components:U(e.items,e=>MH(n,e,t,o))})));return{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[n.asSpec()]}],behaviours:c2([bD.config({mode:"acyclic",useTabstopAt:T(Dn)}),EU.memento(n),EY.memento(n,{postprocess:e=>UF(e).fold(e=>(console.error(e),{}),C)})])}},UR=(e,t)=>({uid:e.uid,dom:e.dom,components:e.components,events:vd(e.action),behaviours:gG(e.tabButtonBehaviours,[b0.config({}),bD.config({mode:"execution",useSpace:!0,useEnter:!0}),gU.config({store:{mode:"memory",initialValue:e.value}})]),domModification:e.domModification}),UN=pj({name:"TabButton",configFields:[ah("uid",void 0),r4("value"),n8("dom","dom",rc(()=>({attributes:{role:"tab",id:lr("aria"),"aria-selected":"false"}})),rL()),ai("action"),ah("domModification",{}),gW("tabButtonBehaviours",[b0,bD,gU]),r4("view")],factory:UR}),UV=k([r4("tabs"),r4("dom"),ah("clickToDismiss",!1),gW("tabbarBehaviours",[hO,bD]),s9(["tabClass","selectedClass"])]),Uz=pp({factory:UN,name:"tabs",unit:"tab",overrides:e=>{let t=(e,t)=>{hO.dehighlight(e,t),iI(e,iA(),{tabbar:e,button:t})},o=(e,t)=>{hO.highlight(e,t),iI(e,iD(),{tabbar:e,button:t})};return{action:n=>{let r=n.getSystem().getByUid(e.uid).getOrDie(),a=hO.isHighlighted(r,n),i=a&&e.clickToDismiss?t:a?y:o;i(r,n)},domModification:{classes:[e.markers.tabClass]}}}}),UH=k([Uz]),UL=(e,t,o,n)=>({uid:e.uid,dom:e.dom,components:t,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:gG(e.tabbarBehaviours,[hO.config({highlightClass:e.markers.selectedClass,itemClass:e.markers.tabClass,onHighlight:(e,t)=>{tH(t.element,"aria-selected","true")},onDehighlight:(e,t)=>{tH(t.element,"aria-selected","false")}}),bD.config({mode:"flow",getInitial:e=>hO.getHighlighted(e).map(e=>e.element),selector:"."+e.markers.tabClass,executeOnMove:!0})])}),UP=pG({name:"Tabbar",configFields:UV(),partFields:UH(),factory:UL}),UU=(e,t)=>({uid:e.uid,dom:e.dom,behaviours:gG(e.tabviewBehaviours,[bW.config({})]),domModification:{attributes:{role:"tabpanel"}}}),UW=pj({name:"Tabview",configFields:[gW("tabviewBehaviours",[bW])],factory:UU}),Uj=k([ah("selectFirst",!0),s6("onChangeTab"),s6("onDismissTab"),ah("tabs",[]),gW("tabSectionBehaviours",[])]),UG=pu({factory:UP,schema:[r4("dom"),an("markers",[r4("tabClass"),r4("selectedClass")])],name:"tabbar",defaults:e=>({tabs:e.tabs})}),U$=pu({factory:UW,name:"tabview"}),Uq=k([UG,U$]),UX=(e,t,o,n)=>{let r=t=>{let o=gU.getValue(t);p_(t,e,"tabview").each(n=>{let r=Y(e.tabs,e=>e.value===o);r.each(o=>{let r=o.view();tU(t.element,"id").each(e=>{tH(n.element,"aria-labelledby",e)}),bW.set(n,r),e.onChangeTab(n,t,r)})})},a=(t,o)=>{p_(t,e,"tabbar").each(e=>{o(e).each(iR)})};return{uid:e.uid,dom:e.dom,components:t,behaviours:gj(e.tabSectionBehaviours),events:iL(Z([e.selectFirst?[iZ((e,t)=>{a(e,hO.getFirst)})]:[],[iW(iD(),(e,t)=>{let o=t.event.button;r(o)}),iW(iA(),(t,o)=>{let n=o.event.button;e.onDismissTab(t,n)})]])),apis:{getViewItems:t=>p_(t,e,"tabview").map(e=>bW.contents(e)).getOr([]),showTab:(e,t)=>{let o=e=>{let o=hO.getCandidates(e),n=Y(o,e=>gU.getValue(e)===t);return n.filter(t=>!hO.isHighlighted(e,t))};a(e,o)}}}},UK=pG({name:"TabSection",configFields:Uj(),partFields:Uq(),factory:UX,apis:{getViewItems:(e,t)=>e.getViewItems(t),showTab:(e,t,o)=>{e.showTab(t,o)}}}),UY=(e,t,o)=>U(e,(n,r)=>{bW.set(o,e[r].view());let a=t.dom.getBoundingClientRect();return bW.set(o,[]),a.height}),UJ=e=>el(ea(e,(e,t)=>e>t?-1:e<t?1:0)),UZ=(e,t,o)=>{let n;let r=tg(e).dom,a=sV(e,".tox-dialog-wrap").getOr(e),i="fixed"===tJ(a,"position");n=i?Math.max(r.clientHeight,window.innerHeight):Math.max(r.offsetHeight,r.scrollHeight);let l=t4(t),s=t.dom.offsetLeft>=o.dom.offsetLeft+oi(o),c=s?Math.max(t4(o),l):l,d=parseInt(tJ(e,"margin-top"),10)||0,u=parseInt(tJ(e,"margin-bottom"),10)||0,m=t4(e)+d+u;return n-(m-c)},UQ=(e,t)=>{el(e).each(e=>UK.showTab(t,e.value))},U0=(e,t)=>{tX(e,"height",t+"px"),tX(e,"flex-basis",t+"px")},U1=(e,t,o)=>{sV(e,'[role="dialog"]').each(e=>{sH(e,'[role="tablist"]').each(n=>{o.get().map(o=>(tX(t,"height","0"),tX(t,"flex-basis","0"),Math.min(o,UZ(e,t,n)))).each(e=>{U0(t,e)})})})},U2=e=>sH(e,'[role="tabpanel"]'),U3=e=>{let t=dR(),o=[iZ(o=>{let n=o.element;U2(n).each(r=>{tX(r,"visibility","hidden"),o.getSystem().getByDom(r).toOptional().each(o=>{let n=UY(e,r,o),a=UJ(n);a.fold(t.clear,t.set)}),U1(n,r,t),t2(r,"visibility"),UQ(e,o),requestAnimationFrame(()=>{U1(n,r,t)})})}),iW(iw(),e=>{let o=e.element;U2(o).each(e=>{U1(o,e,t)})}),iW(_t,(e,o)=>{let n=e.element;U2(n).each(e=>{let o=da(tE(e));tX(e,"visibility","hidden");let r=tQ(e,"height").map(e=>parseInt(e,10));t2(e,"height"),t2(e,"flex-basis");let a=e.dom.getBoundingClientRect().height,i=r.forall(e=>a>e);i?(t.set(a),U1(n,e,t)):r.each(t=>{U0(e,t)}),t2(e,"visibility"),o.each(dt)})})];return{extraEvents:o,selectFirst:!1}},U5="send-data-to-section",U9="send-data-to-view",U4=(e,t,o)=>{let n=aC({}),r=e=>{let t=gU.getValue(e),o=UF(t).getOr({}),r=n.get(),a=rn(r,o);n.set(a)},a=e=>{let t=n.get();gU.setValue(e,t)},i=aC(null),l=U(e.tabs,e=>({value:e.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"]},components:[s_(o.shared.providers.translate(e.title))],view:()=>[EM.sketch(n=>({dom:{tag:"div",classes:["tox-form"]},components:U(e.items,e=>MH(n,e,t,o)),formBehaviours:c2([bD.config({mode:"acyclic",useTabstopAt:T(Dn)}),bG("TabView.form.events",[iZ(a),iQ(r)]),c8.config({channels:aF([{key:U5,value:{onReceive:r}},{key:U9,value:{onReceive:a}}])})])}))]})),s=U3(l);return UK.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:(e,t,o)=>{let n=gU.getValue(t);iI(e,_e,{name:n,oldName:i.get()}),i.set(n)},tabs:l,components:[UK.parts.tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[UP.parts.tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:c2([OK.config({})])}),UK.parts.tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:s.selectFirst,tabSectionBehaviours:c2([bG("tabpanel",s.extraEvents),bD.config({mode:"acyclic"}),pY.config({find:e=>el(UK.getViewItems(e))}),EY.withComp(B.none(),e=>(e.getSystem().broadcastOn([U5],{}),n.get()),(e,t)=>{n.set(t),e.getSystem().broadcastOn([U9],{})})])})},U6=lr("update-dialog"),U8=lr("update-title"),U7=lr("update-body"),We=lr("update-footer"),Wt=lr("body-send-message"),Wo=(e,t,o,n,r)=>{let a=e=>{let t=e.body;return"tabpanel"===t.type?[U4(t,e.initialData,n)]:[UI(t,e.initialData,n)]},i=(e,t)=>B.some({isTabPanel:()=>"tabpanel"===t.body.type});return{dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:{...o.map(e=>({id:e})).getOr({}),...r?{"aria-live":"polite"}:{}}},components:[],behaviours:c2([EU.childAt(0),UB.config({channel:`${U7}-${t}`,updateState:i,renderComponents:a,initialData:e})])}},Wn=(e,t,o,n,r)=>Wo(e,t,B.some(o),n,r),Wr=(e,t,o)=>{let n=Wo(e,t,B.none(),o,!1);return Pl.parts.body(n)},Wa=e=>{let t={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[De({dom:{tag:"iframe",attributes:{src:e.url}},behaviours:c2([OK.config({}),b0.config({})])})]}],behaviours:c2([bD.config({mode:"acyclic",useTabstopAt:T(Dn)})])};return Pl.parts.body(t)};function Wi(e){return(Wi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wl(e,t){return(Wl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ws(e,t,o){return(Ws=!function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}()?function(e,t,o){var n=[null];n.push.apply(n,t);var r=new(Function.bind.apply(e,n));return o&&Wl(r,o.prototype),r}:Reflect.construct).apply(null,arguments)}function Wc(e){return function(e){if(Array.isArray(e))return Wd(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Wd(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);if("Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o)return Array.from(e);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return Wd(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wd(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=Array(t);o<t;o++)n[o]=e[o];return n}var Wu=Object.hasOwnProperty,Wm=Object.setPrototypeOf,Wg=Object.isFrozen,Wp=Object.getPrototypeOf,Wh=Object.getOwnPropertyDescriptor,Wf=Object.freeze,Wb=Object.seal,Wv=Object.create,Wy="undefined"!=typeof Reflect&&Reflect,Wx=Wy.apply,Ww=Wy.construct;Wx||(Wx=function(e,t,o){return e.apply(t,o)}),Wf||(Wf=function(e){return e}),Wb||(Wb=function(e){return e}),Ww||(Ww=function(e,t){return Ws(e,Wc(t))});var WS=WB(Array.prototype.forEach),Wk=WB(Array.prototype.pop),WC=WB(Array.prototype.push),WO=WB(String.prototype.toLowerCase),W_=WB(String.prototype.match),WT=WB(String.prototype.replace),WE=WB(String.prototype.indexOf),WD=WB(String.prototype.trim),WA=WB(RegExp.prototype.test),WM=(nd=TypeError,function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return Ww(nd,t)});function WB(e){return function(t){for(var o=arguments.length,n=Array(o>1?o-1:0),r=1;r<o;r++)n[r-1]=arguments[r];return Wx(e,t,n)}}function WF(e,t){Wm&&Wm(e,null);for(var o=t.length;o--;){var n=t[o];if("string"==typeof n){var r=WO(n);r!==n&&(Wg(t)||(t[o]=r),n=r)}e[n]=!0}return e}function WI(e){var t,o=Wv(null);for(t in e)Wx(Wu,e,[t])&&(o[t]=e[t]);return o}function WR(e,t){for(;null!==e;){var o=Wh(e,t);if(o){if(o.get)return WB(o.get);if("function"==typeof o.value)return WB(o.value)}e=Wp(e)}return function(e){return console.warn("fallback value for",e),null}}var WN=Wf(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),WV=Wf(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Wz=Wf(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),WH=Wf(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),WL=Wf(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),WP=Wf(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),WU=Wf(["#text"]),WW=Wf(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Wj=Wf(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),WG=Wf(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),W$=Wf(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Wq=Wb(/\{\{[\w\W]*|[\w\W]*\}\}/gm),WX=Wb(/<%[\w\W]*|[\w\W]*%>/gm),WK=Wb(/^data-[\-\w.\u00B7-\uFFFF]/),WY=Wb(/^aria-[\-\w]+$/),WJ=Wb(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),WZ=Wb(/^(?:\w+script|data):/i),WQ=Wb(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),W0=Wb(/^html$/i),W1=function(e,t){if("object"!==Wi(e)||"function"!=typeof e.createPolicy)return null;var o=null,n="data-tt-policy-suffix";t.currentScript&&t.currentScript.hasAttribute(n)&&(o=t.currentScript.getAttribute(n));var r="dompurify"+(o?"#"+o:"");try{return e.createPolicy(r,{createHTML:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+r+" could not be created."),null}},W2=function e(){var t,o,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof window?null:window,r=function(t){return e(t)};if(r.version="2.3.8",r.removed=[],!n||!n.document||9!==n.document.nodeType)return r.isSupported=!1,r;var a=n.document,i=n.document,l=n.DocumentFragment,s=n.HTMLTemplateElement,c=n.Node,d=n.Element,u=n.NodeFilter,m=n.NamedNodeMap,g=void 0===m?n.NamedNodeMap||n.MozNamedAttrMap:m,p=n.HTMLFormElement,h=n.DOMParser,f=n.trustedTypes,b=d.prototype,v=WR(b,"cloneNode"),y=WR(b,"nextSibling"),x=WR(b,"childNodes"),w=WR(b,"parentNode");if("function"==typeof s){var S=i.createElement("template");S.content&&S.content.ownerDocument&&(i=S.content.ownerDocument)}var k=W1(f,a),C=k?k.createHTML(""):"",O=i,_=O.implementation,T=O.createNodeIterator,E=O.createDocumentFragment,D=O.getElementsByTagName,A=a.importNode,M={};try{M=WI(i).documentMode?i.documentMode:{}}catch(e){}var B={};r.isSupported="function"==typeof w&&_&&void 0!==_.createHTMLDocument&&9!==M;var F=WJ,I=null,R=WF({},[].concat(Wc(WN),Wc(WV),Wc(Wz),Wc(WL),Wc(WU))),N=null,V=WF({},[].concat(Wc(WW),Wc(Wj),Wc(WG),Wc(W$))),z=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),H=null,L=null,P=!0,U=!0,W=!1,j=!1,G=!1,$=!1,q=!1,X=!1,K=!1,Y=!1,J=!0,Z=!0,Q=!1,ee={},et=null,eo=WF({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),en=null,er=WF({},["audio","video","img","source","image","track"]),ea=null,ei=WF({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),el="http://www.w3.org/1998/Math/MathML",es="http://www.w3.org/2000/svg",ec="http://www.w3.org/1999/xhtml",ed=ec,eu=!1,em=["application/xhtml+xml","text/html"],eg=null,ep=i.createElement("form"),eh=function(e){return e instanceof RegExp||e instanceof Function},ef=function(e){eg&&eg===e||(e&&"object"===Wi(e)||(e={}),I="ALLOWED_TAGS"in(e=WI(e))?WF({},e.ALLOWED_TAGS):R,N="ALLOWED_ATTR"in e?WF({},e.ALLOWED_ATTR):V,ea="ADD_URI_SAFE_ATTR"in e?WF(WI(ei),e.ADD_URI_SAFE_ATTR):ei,en="ADD_DATA_URI_TAGS"in e?WF(WI(er),e.ADD_DATA_URI_TAGS):er,et="FORBID_CONTENTS"in e?WF({},e.FORBID_CONTENTS):eo,H="FORBID_TAGS"in e?WF({},e.FORBID_TAGS):{},L="FORBID_ATTR"in e?WF({},e.FORBID_ATTR):{},ee="USE_PROFILES"in e&&e.USE_PROFILES,P=!1!==e.ALLOW_ARIA_ATTR,U=!1!==e.ALLOW_DATA_ATTR,W=e.ALLOW_UNKNOWN_PROTOCOLS||!1,j=e.SAFE_FOR_TEMPLATES||!1,G=e.WHOLE_DOCUMENT||!1,X=e.RETURN_DOM||!1,K=e.RETURN_DOM_FRAGMENT||!1,Y=e.RETURN_TRUSTED_TYPE||!1,q=e.FORCE_BODY||!1,J=!1!==e.SANITIZE_DOM,Z=!1!==e.KEEP_CONTENT,Q=e.IN_PLACE||!1,F=e.ALLOWED_URI_REGEXP||F,ed=e.NAMESPACE||ec,e.CUSTOM_ELEMENT_HANDLING&&eh(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(z.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&eh(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(z.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(z.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),o="application/xhtml+xml"===(t=t=-1===em.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE)?function(e){return e}:WO,j&&(U=!1),K&&(X=!0),ee&&(I=WF({},Wc(WU)),N=[],!0===ee.html&&(WF(I,WN),WF(N,WW)),!0===ee.svg&&(WF(I,WV),WF(N,Wj),WF(N,W$)),!0===ee.svgFilters&&(WF(I,Wz),WF(N,Wj),WF(N,W$)),!0===ee.mathMl&&(WF(I,WL),WF(N,WG),WF(N,W$))),e.ADD_TAGS&&(I===R&&(I=WI(I)),WF(I,e.ADD_TAGS)),e.ADD_ATTR&&(N===V&&(N=WI(N)),WF(N,e.ADD_ATTR)),e.ADD_URI_SAFE_ATTR&&WF(ea,e.ADD_URI_SAFE_ATTR),e.FORBID_CONTENTS&&(et===eo&&(et=WI(et)),WF(et,e.FORBID_CONTENTS)),Z&&(I["#text"]=!0),G&&WF(I,["html","head","body"]),I.table&&(WF(I,["tbody"]),delete H.tbody),Wf&&Wf(e),eg=e)},eb=WF({},["mi","mo","mn","ms","mtext"]),ev=WF({},["foreignobject","desc","title","annotation-xml"]),ey=WF({},["title","style","font","a","script"]),ex=WF({},WV);WF(ex,Wz),WF(ex,WH);var ew=WF({},WL);WF(ew,WP);var eS=function(e){var t=w(e);t&&t.tagName||(t={namespaceURI:ec,tagName:"template"});var o=WO(e.tagName),n=WO(t.tagName);return e.namespaceURI===es?t.namespaceURI===ec?"svg"===o:t.namespaceURI===el?"svg"===o&&("annotation-xml"===n||eb[n]):Boolean(ex[o]):e.namespaceURI===el?t.namespaceURI===ec?"math"===o:t.namespaceURI===es?"math"===o&&ev[n]:Boolean(ew[o]):e.namespaceURI===ec&&(t.namespaceURI!==es||!!ev[n])&&(t.namespaceURI!==el||!!eb[n])&&!ew[o]&&(ey[o]||!ex[o])},ek=function(e){WC(r.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){try{e.outerHTML=C}catch(t){e.remove()}}},eC=function(e,t){try{WC(r.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){WC(r.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!N[e]){if(X||K)try{ek(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}}},eO=function(e){if(q)e="<remove></remove>"+e;else{var o,n,r=W_(e,/^[\r\n\t ]+/);n=r&&r[0]}"application/xhtml+xml"===t&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");var a=k?k.createHTML(e):e;if(ed===ec)try{o=new h().parseFromString(a,t)}catch(e){}if(!o||!o.documentElement){o=_.createDocument(ed,"template",null);try{o.documentElement.innerHTML=eu?"":a}catch(e){}}var l=o.body||o.documentElement;return(e&&n&&l.insertBefore(i.createTextNode(n),l.childNodes[0]||null),ed===ec)?D.call(o,G?"html":"body")[0]:G?o.documentElement:l},e_=function(e){return T.call(e.ownerDocument||e,e,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT,null,!1)},eT=function(e){return"object"===Wi(c)?e instanceof c:e&&"object"===Wi(e)&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},eE=function(e,t,o){B[e]&&WS(B[e],function(e){e.call(r,t,o,eg)})},eD=function(e){if(eE("beforeSanitizeElements",e,null),e instanceof p&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof g)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore)||WA(/[\u0080-\uFFFF]/,e.nodeName))return ek(e),!0;var t,n=o(e.nodeName);if(eE("uponSanitizeElement",e,{tagName:n,allowedTags:I}),e.hasChildNodes()&&!eT(e.firstElementChild)&&(!eT(e.content)||!eT(e.content.firstElementChild))&&WA(/<[/\w]/g,e.innerHTML)&&WA(/<[/\w]/g,e.textContent)||"select"===n&&WA(/<template/i,e.innerHTML))return ek(e),!0;if(!I[n]||H[n]){if(!H[n]&&eM(n)&&(z.tagNameCheck instanceof RegExp&&WA(z.tagNameCheck,n)||z.tagNameCheck instanceof Function&&z.tagNameCheck(n)))return!1;if(Z&&!et[n]){var a=w(e)||e.parentNode,i=x(e)||e.childNodes;if(i&&a)for(var l=i.length,s=l-1;s>=0;--s)a.insertBefore(v(i[s],!0),y(e))}return ek(e),!0}return e instanceof d&&!eS(e)||("noscript"===n||"noembed"===n)&&WA(/<\/no(script|embed)/i,e.innerHTML)?(ek(e),!0):(j&&3===e.nodeType&&(t=WT(t=e.textContent,Wq," "),t=WT(t,WX," "),e.textContent!==t&&(WC(r.removed,{element:e.cloneNode()}),e.textContent=t)),eE("afterSanitizeElements",e,null),!1)},eA=function(e,t,o){if(J&&("id"===t||"name"===t)&&(o in i||o in ep))return!1;if(U&&!L[t]&&WA(WK,t));else if(P&&WA(WY,t));else if(!N[t]||L[t]){if(!(eM(e)&&(z.tagNameCheck instanceof RegExp&&WA(z.tagNameCheck,e)||z.tagNameCheck instanceof Function&&z.tagNameCheck(e))&&(z.attributeNameCheck instanceof RegExp&&WA(z.attributeNameCheck,t)||z.attributeNameCheck instanceof Function&&z.attributeNameCheck(t))||"is"===t&&z.allowCustomizedBuiltInElements&&(z.tagNameCheck instanceof RegExp&&WA(z.tagNameCheck,o)||z.tagNameCheck instanceof Function&&z.tagNameCheck(o))))return!1}else if(ea[t]);else if(WA(F,WT(o,WQ,"")));else if(("src"===t||"xlink:href"===t||"href"===t)&&"script"!==e&&0===WE(o,"data:")&&en[e]);else if(W&&!WA(WZ,WT(o,WQ,"")));else if(o)return!1;return!0},eM=function(e){return e.indexOf("-")>0},eB=function(e){eE("beforeSanitizeAttributes",e,null);var t,n,r,a,i=e.attributes;if(i){var l={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:N};for(a=i.length;a--;){var s=(t=i[a]).name,c=t.namespaceURI;n="value"===s?t.value:WD(t.value),r=o(s);var d=n;if(l.attrName=r,l.attrValue=n,l.keepAttr=!0,l.forceKeepAttr=void 0,eE("uponSanitizeAttribute",e,l),n=l.attrValue,!l.forceKeepAttr){if(!l.keepAttr||WA(/\/>/i,n)||(j&&(n=WT(n,Wq," "),n=WT(n,WX," ")),!eA(o(e.nodeName),r,n))){eC(s,e);continue}if(n!==d)try{c?e.setAttributeNS(c,s,n):e.setAttribute(s,n)}catch(t){eC(s,e)}}}eE("afterSanitizeAttributes",e,null)}},eF=function e(t){var o,n=e_(t);for(eE("beforeSanitizeShadowDOM",t,null);o=n.nextNode();)eE("uponSanitizeShadowNode",o,null),eD(o)||(o.content instanceof l&&e(o.content),eB(o));eE("afterSanitizeShadowDOM",t,null)};return r.sanitize=function(e,t){if((eu=!e)&&(e="<!-->"),"string"!=typeof e&&!eT(e)){if("function"!=typeof e.toString)throw WM("toString is not a function");if("string"!=typeof(e=e.toString()))throw WM("dirty is not a string, aborting")}if(!r.isSupported){if("object"===Wi(n.toStaticHTML)||"function"==typeof n.toStaticHTML){if("string"==typeof e)return n.toStaticHTML(e);if(eT(e))return n.toStaticHTML(e.outerHTML)}return e}if($||ef(t),r.removed=[],"string"==typeof e&&(Q=!1),Q){if(e.nodeName){var i,s,d,u,m,g=o(e.nodeName);if(!I[g]||H[g])throw WM("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof c)1===(s=(i=eO("<!---->")).ownerDocument.importNode(e,!0)).nodeType&&"BODY"===s.nodeName?i=s:"HTML"===s.nodeName?i=s:i.appendChild(s);else{if(!X&&!j&&!G&&-1===e.indexOf("<"))return k&&Y?k.createHTML(e):e;if(!(i=eO(e)))return X?null:Y?C:""}i&&q&&ek(i.firstChild);for(var p=e_(Q?e:i);d=p.nextNode();)3===d.nodeType&&d===u||eD(d)||(d.content instanceof l&&eF(d.content),eB(d),u=d);if(u=null,Q)return e;if(X){if(K)for(m=E.call(i.ownerDocument);i.firstChild;)m.appendChild(i.firstChild);else m=i;return N.shadowroot&&(m=A.call(a,m,!0)),m}var h=G?i.outerHTML:i.innerHTML;return G&&I["!doctype"]&&i.ownerDocument&&i.ownerDocument.doctype&&i.ownerDocument.doctype.name&&WA(W0,i.ownerDocument.doctype.name)&&(h="<!DOCTYPE "+i.ownerDocument.doctype.name+">\n"+h),j&&(h=WT(h,Wq," "),h=WT(h,WX," ")),k&&Y?k.createHTML(h):h},r.setConfig=function(e){ef(e),$=!0},r.clearConfig=function(){eg=null,$=!1},r.isValidAttribute=function(e,t,n){return eg||ef({}),eA(o(e),o(t),n)},r.addHook=function(e,t){"function"==typeof t&&(B[e]=B[e]||[],WC(B[e],t))},r.removeHook=function(e){if(B[e])return Wk(B[e])},r.removeHooks=function(e){B[e]&&(B[e]=[])},r.removeAllHooks=function(){B={}},r}();let W3=e=>W2().sanitize(e),W5=yf.deviceType.isTouch(),W9=(e,t)=>({dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[e,t]}),W4=(e,t)=>Pl.parts.close(v9.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close")}},action:e,buttonBehaviours:c2([OK.config({})])})),W6=()=>Pl.parts.title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}}),W8=(e,t)=>Pl.parts.body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:I5(`<p>${W3(t.translate(e))}</p>`)}]}]}),W7=e=>Pl.parts.footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:e}),je=(e,t)=>[OH.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:e}),OH.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:t})],jt=e=>{let t="tox-dialog",o=t+"-wrap",n=o+"__backdrop",r=t+"__disable-scroll";return Pl.sketch({lazySink:e.lazySink,onEscape:t=>(e.onEscape(t),B.some(!0)),useTabstopAt:e=>!Dn(e),firstTabstop:e.firstTabstop,dom:{tag:"div",classes:[t].concat(e.extraClasses),styles:{position:"relative",...e.extraStyles}},components:[e.header,e.body,...e.footer.toArray()],parts:{blocker:{dom:I5(`<div class="${o}"></div>`),components:[{dom:{tag:"div",classes:W5?[n,n+"--opaque"]:[n]}}]}},dragBlockClass:o,modalBehaviours:c2([b0.config({}),bG("dialog-events",e.dialogEvents.concat([iJ(a2(),(e,t)=>{bD.focusIn(e)})])),bG("scroll-lock",[iZ(()=>{l9(tN(),r)}),iQ(()=>{l6(tN(),r)})]),...e.extraBehaviours]),eventOrder:{[id()]:["dialog-events"],[iS()]:["scroll-lock","dialog-events","alloy.base.behaviour"],[ik()]:["alloy.base.behaviour","dialog-events","scroll-lock"],...e.eventOrder}})},jo=e=>v9.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":e.translate("Close"),title:e.translate("Close")}},buttonBehaviours:c2([OK.config({})]),components:[ys("close",{tag:"div",classes:["tox-icon"]},e.icons)],action:e=>{iF(e,O9)}}),jn=(e,t,o,n)=>{let r=e=>[s_(n.translate(e.title))];return{dom:{tag:"div",classes:["tox-dialog__title"],attributes:{...o.map(e=>({id:e})).getOr({})}},components:[],behaviours:c2([UB.config({channel:`${U8}-${t}`,initialData:e,renderComponents:r})])}},jr=()=>({dom:I5('<div class="tox-dialog__draghandle"></div>')}),ja=(e,t,o,n)=>OH.sketch({dom:I5('<div class="tox-dialog__header"></div>'),components:[jn(e,t,B.some(o),n),jr(),jo(n)],containerBehaviours:c2([LK.config({mode:"mouse",blockerClass:"blocker",getTarget:e=>sL(e,'[role="dialog"]').getOrDie(),snaps:{getSnapPoints:()=>[],leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])}),ji=(e,t,o)=>{let n=Pl.parts.title(jn(e,t,B.none(),o)),r=Pl.parts.draghandle(jr()),a=Pl.parts.close(jo(o)),i=[n].concat(e.draggable?[r]:[]).concat([a]);return OH.sketch({dom:I5('<div class="tox-dialog__header"></div>'),components:i})},jl=(e,t,o)=>ji({title:o.shared.providers.translate(e),draggable:o.dialog.isDraggableModal()},t,o.shared.providers),js=(e,t,o)=>({dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":o.translate(e)},styles:{left:"0px",right:"0px",bottom:"0px",top:"0px",position:"absolute"}},behaviours:t,components:[{dom:I5('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}),jc=(e,t,o)=>({onClose:()=>o.closeWindow(),onBlock:o=>{Pl.setBusy(e(),(e,n)=>js(o.message,n,t))},onUnblock:()=>{Pl.setIdle(e())}}),jd=(e,t,o,n)=>{let r=(e,t)=>B.some(t);return sA(jt({...e,firstTabstop:1,lazySink:n.shared.getSink,extraBehaviours:[UB.config({channel:`${U6}-${e.id}`,updateState:r,initialData:t}),EY.memory({}),...e.extraBehaviours],onEscape:e=>{iF(e,O9)},dialogEvents:o,eventOrder:{[ic()]:[UB.name(),c8.name()],[iS()]:["scroll-lock",UB.name(),"messages","dialog-events","alloy.base.behaviour"],[ik()]:["alloy.base.behaviour","dialog-events","messages",UB.name(),"scroll-lock"]}}))},ju=(e,t={})=>{let o=e=>{let o=U(e.items,e=>{let o=ek(t,e.name).getOr(aC(!1));return{...e,storage:o}});return{...e,items:o}};return U(e,e=>"menu"===e.type?o(e):e)},jm=e=>X(e,(e,t)=>"menu"===t.type?X(t.items,(e,t)=>(e[t.name]=t.storage,e),e):e,{}),jg=(e,t)=>[iX(a2(),Do),e(O5,(e,o,n,r)=>{da(tE(r.element)).fold(y,dn),t.onClose(),o.onClose()}),e(O9,(e,t,o,n)=>{t.onCancel(e),iF(n,O5)}),iW(O7,(e,o)=>t.onUnblock()),iW(O8,(e,o)=>t.onBlock(o.event))],jp=(e,t)=>{let o=(t,o)=>iW(t,(t,r)=>{n(t,(n,a)=>{o(e(),n,r.event,t)})}),n=(e,t)=>{UB.getState(e).get().each(o=>{t(o,e)})};return[...jg(o,t),o(O4,(e,t,o)=>{t.onAction(e,{name:o.name})})]},jh=(e,t,o)=>{let n=(t,o)=>iW(t,(t,n)=>{r(t,(r,a)=>{o(e(),r,n.event,t)})}),r=(e,t)=>{UB.getState(e).get().each(o=>{t(o.internalDialog,e)})};return[...jg(n,t),n(O6,(e,t)=>t.onSubmit(e)),n(O3,(e,t,o)=>{t.onChange(e,{name:o.name})}),n(O4,(e,t,n,r)=>{let a=()=>bD.focusIn(r),i=e=>tW(e,"disabled")||tU(e,"aria-disabled").exists(e=>"true"===e),l=tE(r.element),s=da(l);t.onAction(e,{name:n.name,value:n.value}),da(l).fold(a,e=>{i(e)?a():s.exists(t=>td(e,t)&&i(t))?a():o().toOptional().filter(t=>!td(t.element,e)).each(a)})}),n(_e,(e,t,o)=>{t.onTabChange(e,{newTabName:o.name,oldTabName:o.oldName})}),iQ(t=>{let o=e();gU.setValue(t,o.getData())})]},jf={initUrlDialog:jp,initDialog:jh},jb=(e,t)=>Mg(e,e.type,t),jv=(e,t,o)=>Y(t,e=>e.name===o).bind(t=>t.memento.getOpt(e)),jy=(e,t)=>{let o=t.map(e=>e.footerButtons).getOr([]),n=G(o,e=>"start"===e.align),r=(e,t)=>OH.sketch({dom:{tag:"div",classes:[`tox-dialog__footer-${e}`]},components:U(t,e=>e.memento.asSpec())}),a=r("start",n.pass),i=r("end",n.fail);return[a,i]},jx=(e,t,o)=>{let n=(e,t)=>{let n=U(t.buttons,e=>{let t=v4(jb(e,o));return{name:e.name,align:e.align,memento:t}}),r=t=>jv(e,n,t);return B.some({lookupByName:r,footerButtons:n})};return{dom:I5('<div class="tox-dialog__footer"></div>'),components:[],behaviours:c2([UB.config({channel:`${We}-${t}`,initialData:e,updateState:n,renderComponents:jy})])}},jw=(e,t,o)=>jx(e,t,o),jS=(e,t,o)=>Pl.parts.footer(jx(e,t,o)),jk=(e,t)=>{let o=e.getRoot();if(!o.getSystem().isConnected())return B.none();{let o=pY.getCurrent(e.getFormWrapper()).getOr(e.getFormWrapper());return EM.getField(o,t).orThunk(()=>{let o=e.getFooter(),n=UB.getState(o).get();return n.bind(e=>e.lookupByName(t))})}},jC=(e,t)=>{let o=e.getRoot();return UB.getState(o).get().map(e=>r0(rQ("data",e.dataValidator,t))).getOr(t)},jO=(e,t,o)=>{let n=t=>{let o=e.getRoot();o.getSystem().isConnected()&&t(o)},r=()=>{let t=e.getRoot(),n=t.getSystem().isConnected()?e.getFormWrapper():t,r=gU.getValue(n),a=ep(o,e=>e.get());return{...r,...a}},a=t=>{n(n=>{let r=p.getData(),a=rn(r,t),i=jC(e,a),l=e.getFormWrapper();gU.setValue(l,i),eg(o,(e,t)=>{eC(a,t)&&e.set(a[t])})})},i=(t,o)=>{jk(e,t).each(o?ha.enable:ha.disable)},s=t=>{jk(e,t).each(b0.focus)},c=e=>{if(!l(e))throw Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");n(t=>{iI(t,O8,{message:e})})},d=()=>{n(e=>{iF(e,O7)})},u=t=>{n(o=>{let n=e.getBody(),r=UB.getState(n);r.get().exists(e=>e.isTabPanel())&&pY.getCurrent(n).each(e=>{UK.showTab(e,t)})})},m=r=>{n(n=>{let a=e.getId(),i=t(r),l=ju(i.internalDialog.buttons,o);n.getSystem().broadcastOn([`${U6}-${a}`],i),n.getSystem().broadcastOn([`${U8}-${a}`],i.internalDialog),n.getSystem().broadcastOn([`${U7}-${a}`],i.internalDialog),n.getSystem().broadcastOn([`${We}-${a}`],{...i.internalDialog,buttons:l}),p.setData(i.initialData)})},g=()=>{n(e=>{iF(e,O5)})},p={getData:r,setData:a,setEnabled:i,focus:s,block:c,unblock:d,showTab:u,redial:m,close:g,toggleFullscreen:e.toggleFullscreen};return p},j_=e=>{switch(e){case"large":return["tox-dialog--width-lg"];case"medium":return["tox-dialog--width-md"];default:return[]}},jT=(e,t,o)=>{let n=lr("dialog"),r=e.internalDialog,a=jl(r.title,n,o),i=Wr({body:r.body,initialData:r.initialData},n,o),l=ju(r.buttons),s=jm(l),c=jS({buttons:l},n,o),d=jf.initDialog(()=>h,jc(()=>g,o.shared.providers,t),o.shared.getSink),u=j_(r.size),m={id:n,header:a,body:i,footer:B.some(c),extraClasses:u,extraBehaviours:[],extraStyles:{}},g=jd(m,e,d,o),p=(()=>{let e=()=>{let e=Pl.getBody(g);return pY.getCurrent(e).getOr(e)},t=()=>{let e="tox-dialog--fullscreen",t=eJ.fromDom(g.element.dom);l8(t,e)?(l6(t,e),l7(t,u)):(se(t,u),l9(t,e))};return{getId:k(n),getRoot:k(g),getBody:()=>Pl.getBody(g),getFooter:()=>Pl.getFooter(g),getFormWrapper:e,toggleFullscreen:t}})(),h=jO(p,t.redial,s);return{dialog:g,instanceApi:h}},jE=(e,t,o,n)=>{let r=lr("dialog"),a=lr("dialog-label"),i=lr("dialog-content"),l=e.internalDialog,s=(e,t)=>B.some(t),c=v4(ja({title:l.title,draggable:!0},r,a,o.shared.providers)),d=v4(Wn({body:l.body,initialData:l.initialData},r,i,o,n)),u=ju(l.buttons),m=jm(u),g=v4(jw({buttons:u},r,o)),p=jf.initDialog(()=>v,{onBlock:e=>{I1.block(f,(t,n)=>js(e.message,n,o.shared.providers))},onUnblock:()=>{I1.unblock(f)},onClose:()=>t.closeWindow()},o.shared.getSink),h="tox-dialog-inline",f=sA({dom:{tag:"div",classes:["tox-dialog",h],attributes:{role:"dialog","aria-labelledby":a,"aria-describedby":i}},eventOrder:{[ic()]:[UB.name(),c8.name()],[id()]:["execute-on-form"],[iS()]:["reflecting","execute-on-form"]},behaviours:c2([bD.config({mode:"cyclic",onEscape:e=>(iF(e,O5),B.some(!0)),useTabstopAt:e=>!Dn(e)&&("button"!==e4(e)||"disabled"!==tP(e,"disabled")),firstTabstop:1}),UB.config({channel:`${U6}-${r}`,updateState:s,initialData:e}),b0.config({}),bG("execute-on-form",p.concat([iJ(a2(),(e,t)=>{bD.focusIn(e)})])),I1.config({getRoot:()=>B.some(f)}),bW.config({}),EY.memory({})]),components:[c.asSpec(),d.asSpec(),g.asSpec()]}),b=()=>{let e="tox-dialog--fullscreen",t=eJ.fromDom(f.element.dom);st(t,[e])?(se(t,[e]),l7(t,[h])):(se(t,[h]),l7(t,[e]))},v=jO({getId:k(r),getRoot:k(f),getFooter:()=>g.get(f),getBody:()=>d.get(f),getFormWrapper:()=>{let e=d.get(f);return pY.getCurrent(e).getOr(e)},toggleFullscreen:b},t.redial,m);return{dialog:f,instanceApi:v}};var jD=tinymce.util.Tools.resolve("tinymce.util.URI");let jA=e=>{let t=t=>{e.getSystem().isConnected()&&t(e)},o=e=>{if(!l(e))throw Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");t(t=>{iI(t,O8,{message:e})})},n=()=>{t(e=>{iF(e,O7)})},r=()=>{t(e=>{iF(e,O5)})},a=e=>{t(t=>{t.getSystem().broadcastOn([Wt],e)})};return{block:o,unblock:n,close:r,sendMessage:a}},jM=["insertContent","setContent","execCommand","close","block","unblock"],jB=e=>s(e)&&-1!==jM.indexOf(e.mceAction),jF=e=>!jB(e)&&s(e)&&eC(e,"mceAction"),jI=(e,t,o)=>{switch(o.mceAction){case"insertContent":e.insertContent(o.content);break;case"setContent":e.setContent(o.content);break;case"execCommand":let n=!!m(o.ui)&&o.ui;e.execCommand(o.cmd,n,o.value);break;case"close":t.close();break;case"block":t.block(o.message);break;case"unblock":t.unblock()}},jR=(e,t,o,n)=>{let r=lr("dialog"),a=jl(e.title,r,n),i=Wa(e),l=e.buttons.bind(e=>0===e.length?B.none():B.some(jS({buttons:e},r,n))),s=jf.initUrlDialog(()=>b,jc(()=>f,n.shared.providers,t)),c={...e.height.fold(()=>({}),e=>({height:e+"px","max-height":e+"px"})),...e.width.fold(()=>({}),e=>({width:e+"px","max-width":e+"px"}))},d=e.width.isNone()&&e.height.isNone()?["tox-dialog--width-lg"]:[],u=new jD(e.url,{base_uri:new jD(window.location.href)}),m=`${u.protocol}://${u.host}${u.port?":"+u.port:""}`,g=dI(),p=[bG("messages",[iZ(()=>{let t=dN(eJ.fromDom(window),"message",t=>{if(u.isSameOrigin(new jD(t.raw.origin))){let n=t.raw.data;jB(n)?jI(o,b,n):jF(n)&&e.onMessage(b,n)}});g.set(t)}),iQ(g.clear)]),c8.config({channels:{[Wt]:{onReceive:(e,t)=>{sH(e.element,"iframe").each(e=>{let o=e.dom.contentWindow;h(o)&&o.postMessage(t,m)})}}}})],f=jd({id:r,header:a,body:i,footer:l,extraClasses:d,extraBehaviours:p,extraStyles:c},e,s,n),b=jA(f);return{dialog:f,instanceApi:b}},jN=e=>{let t=e.shared,o=(o,n)=>{let r=()=>{Pl.hide(s),n()},a=v4(Mg({name:"close-alert",text:"OK",primary:!0,buttonType:B.some("primary"),align:"end",enabled:!0,icon:B.none()},"cancel",e)),i=W6(),l=W4(r,t.providers),s=sA(jt({lazySink:()=>t.getSink(),header:W9(i,l),body:W8(o,t.providers),footer:B.some(W7(je([],[a.asSpec()]))),onEscape:r,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[iW(O9,r)],eventOrder:{}}));Pl.show(s);let c=a.get(s);b0.focus(c)};return{open:o}},jV=e=>{let t=e.shared,o=(o,n)=>{let r=e=>{Pl.hide(c),n(e)},a=v4(Mg({name:"yes",text:"Yes",primary:!0,buttonType:B.some("primary"),align:"end",enabled:!0,icon:B.none()},"submit",e)),i=Mg({name:"no",text:"No",primary:!1,buttonType:B.some("secondary"),align:"end",enabled:!0,icon:B.none()},"cancel",e),l=W6(),s=W4(()=>r(!1),t.providers),c=sA(jt({lazySink:()=>t.getSink(),header:W9(l,s),body:W8(o,t.providers),footer:B.some(W7(je([],[i,a.asSpec()]))),onEscape:()=>r(!1),extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[iW(O9,()=>r(!1)),iW(O6,()=>r(!0))],eventOrder:{}}));Pl.show(c);let d=a.get(c);b0.focus(d)};return{open:o}},jz=(e,t)=>r0(rQ("data",t,e)),jH=e=>Ob(e,".tox-alert-dialog")||Ob(e,".tox-confirm-dialog"),jL=(e,t,o)=>t&&o?[]:[It.config({contextual:{lazyContext:()=>B.some(nP(eJ.fromDom(e.getContentAreaContainer()))),fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top"],lazyViewport:t=>{let o=Oh(e,t.element);return o.map(e=>{let t=Of(e);return{bounds:t,optScrollEnv:B.some({currentScrollTop:e.element.dom.scrollTop,scrollElmTop:oo(e.element).top})}}).getOrThunk(()=>({bounds:nG(),optScrollEnv:B.none()}))}})],jP=e=>{let t=e.editor,o=xr(t),n=jN(e.backstages.dialog),r=jV(e.backstages.dialog),a=(t,o,n)=>void 0!==o&&"toolbar"===o.inline?c(t,e.backstages.popup.shared.anchors.inlineDialog(),n,o.ariaAttrs):void 0!==o&&"cursor"===o.inline?c(t,e.backstages.popup.shared.anchors.cursor(),n,o.ariaAttrs):s(t,n),i=(e,t)=>l(e,t),l=(o,n)=>{let r=o=>{let r=jR(o,{closeWindow:()=>{Pl.hide(r.dialog),n(r.instanceApi)}},t,e.backstages.dialog);return Pl.show(r.dialog),r.instanceApi};return UO.openUrl(r,o)},s=(t,o)=>{let n=(t,n,r)=>{let a=jT({dataValidator:r,initialData:n,internalDialog:t},{redial:UO.redial,closeWindow:()=>{Pl.hide(a.dialog),o(a.instanceApi)}},e.backstages.dialog);return Pl.show(a.dialog),a.instanceApi.setData(n),a.instanceApi};return UO.open(n,t)},c=(n,r,a,i=!1)=>{let l=(n,l,s)=>{let c=jz(l,s),d=dR(),u=e.backstages.popup.shared.header.isPositionedAtTop(),m=()=>d.on(e=>{v2.reposition(e),It.refresh(e)}),g=jE({dataValidator:s,initialData:c,internalDialog:n},{redial:UO.redial,closeWindow:()=>{d.on(v2.hide),t.off("ResizeEditor",m),d.clear(),a(g.instanceApi)}},e.backstages.popup,i),p=sA(v2.sketch({lazySink:e.backstages.popup.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:{},...u?{}:{fireRepositionEventInstead:{}},inlineBehaviours:c2([bG("window-manager-inline-events",[iW(iC(),(e,t)=>{iF(g.dialog,O9)})]),...jL(t,o,u)]),isExtraPart:(e,t)=>jH(t)}));d.set(p);let h=()=>{let e=t.inline?tN():eJ.fromDom(t.getContainer()),o=nP(e);return B.some(o)};return v2.showWithinBounds(p,lx(g.dialog),{anchor:r},h),o&&u||(It.refresh(p),t.on("ResizeEditor",m)),g.instanceApi.setData(c),bD.focusIn(g.dialog),g.instanceApi};return UO.open(l,n)},d=(e,t)=>{r.open(e,t)},u=(e,t)=>{n.open(e,t)},m=e=>{e.close()};return{open:a,openUrl:i,alert:u,close:m,confirm:d}},jU=e=>{yy(e),kq(e),Hb(e)};n$.add("silver",e=>{jU(e);let t=()=>nG(),{dialogs:o,popups:n,renderUI:r}=Pe(e,{getPopupSinkBounds:()=>t()}),a=async()=>{let o=await r(),a=Oh(e,n.getMothership().element);return a.each(e=>{t=()=>Of(e)}),o};Ou.register(e,n.backstage.shared);let i=jP({editor:e,backstages:{popup:n.backstage,dialog:o.backstage}}),l=()=>yg(e,{backstage:n.backstage},n.getMothership());return{renderUI:a,getWindowManagerImpl:k(i),getNotificationManagerImpl:l}})}();