!function(){"use strict";let e=Object.getPrototypeOf,t=(e,t,o)=>{var n;return!!o(e,t.prototype)||(null===(n=e.constructor)||void 0===n?void 0:n.name)===t.name},o=e=>{let o=typeof e;return null===e?"null":"object"===o&&Array.isArray(e)?"array":"object"===o&&t(e,String,(e,t)=>t.isPrototypeOf(e))?"string":o},n=e=>t=>o(t)===e,r=e=>t=>typeof t===e,a=e=>t=>e===t,i=(o,n)=>s(o)&&t(o,n,(t,o)=>e(t)===o),l=n("string"),s=n("object"),c=e=>i(e,Object),d=n("array"),u=a(null),m=r("boolean"),g=a(void 0),p=e=>null==e,h=e=>!p(e),f=r("function"),b=r("number"),v=(e,t)=>{if(d(e)){for(let o=0,n=e.length;o<n;++o)if(!t(e[o]))return!1;return!0}return!1},y=()=>{},x=e=>()=>e(),w=(e,t)=>(...o)=>e(t.apply(null,o)),S=(e,t)=>o=>e(t(o)),k=e=>()=>e,C=e=>e,O=(e,t)=>e===t;function _(e,...t){return(...o)=>{let n=t.concat(o);return e.apply(null,n)}}let T=e=>t=>!e(t),E=e=>()=>{throw Error(e)},D=e=>e(),A=k(!1),M=k(!0);var B,F,I,R,N,V,H,z,L,P,U,W,j,G,$,q,X,K,Y,J,Z,Q,ee,et,eo,en,er=tinymce.util.Tools.resolve("tinymce.ThemeManager");class ea{constructor(e,t){this.tag=e,this.value=t}static some(e){return new ea(!0,e)}static none(){return ea.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?ea.some(e(this.value)):ea.none()}bind(e){return this.tag?e(this.value):ea.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:ea.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw Error(null!=e?e:"Called getOrDie on None")}static from(e){return h(e)?ea.some(e):ea.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}ea.singletonNone=new ea(!1);let ei=Array.prototype.slice,el=Array.prototype.indexOf,es=Array.prototype.push,ec=(e,t)=>el.call(e,t),ed=(e,t)=>{let o=ec(e,t);return -1===o?ea.none():ea.some(o)},eu=(e,t)=>ec(e,t)>-1,em=(e,t)=>{for(let o=0,n=e.length;o<n;o++){let n=e[o];if(t(n,o))return!0}return!1},eg=(e,t)=>{let o=[];for(let n=0;n<e;n++)o.push(t(n));return o},ep=(e,t)=>{let o=[];for(let n=0;n<e.length;n+=t){let r=ei.call(e,n,n+t);o.push(r)}return o},eh=(e,t)=>{let o=e.length,n=Array(o);for(let r=0;r<o;r++){let o=e[r];n[r]=t(o,r)}return n},ef=(e,t)=>{for(let o=0,n=e.length;o<n;o++){let n=e[o];t(n,o)}},eb=(e,t)=>{for(let o=e.length-1;o>=0;o--){let n=e[o];t(n,o)}},ev=(e,t)=>{let o=[],n=[];for(let r=0,a=e.length;r<a;r++){let a=e[r],i=t(a,r)?o:n;i.push(a)}return{pass:o,fail:n}},ey=(e,t)=>{let o=[];for(let n=0,r=e.length;n<r;n++){let r=e[n];t(r,n)&&o.push(r)}return o},ex=(e,t,o)=>(eb(e,(e,n)=>{o=t(o,e,n)}),o),ew=(e,t,o)=>(ef(e,(e,n)=>{o=t(o,e,n)}),o),eS=(e,t,o)=>{for(let n=0,r=e.length;n<r;n++){let r=e[n];if(t(r,n))return ea.some(r);if(o(r,n))break}return ea.none()},ek=(e,t)=>eS(e,t,A),eC=(e,t)=>{for(let o=0,n=e.length;o<n;o++){let n=e[o];if(t(n,o))return ea.some(o)}return ea.none()},eO=e=>{let t=[];for(let o=0,n=e.length;o<n;++o){if(!d(e[o]))throw Error("Arr.flatten item "+o+" was not an array, input: "+e);es.apply(t,e[o])}return t},e_=(e,t)=>eO(eh(e,t)),eT=(e,t)=>{for(let o=0,n=e.length;o<n;++o){let n=e[o];if(!0!==t(n,o))return!1}return!0},eE=e=>{let t=ei.call(e,0);return t.reverse(),t},eD=(e,t)=>ey(e,e=>!eu(t,e)),eA=(e,t)=>{let o={};for(let n=0,r=e.length;n<r;n++){let r=e[n];o[String(r)]=t(r,n)}return o},eM=e=>[e],eB=(e,t)=>{let o=ei.call(e,0);return o.sort(t),o},eF=(e,t)=>t>=0&&t<e.length?ea.some(e[t]):ea.none(),eI=e=>eF(e,0),eR=e=>eF(e,e.length-1),eN=f(Array.from)?Array.from:e=>ei.call(e),eV=(e,t)=>{for(let o=0;o<e.length;o++){let n=t(e[o],o);if(n.isSome())return n}return ea.none()},eH=Object.keys,ez=Object.hasOwnProperty,eL=(e,t)=>{let o=eH(e);for(let n=0,r=o.length;n<r;n++){let r=o[n],a=e[r];t(a,r)}},eP=(e,t)=>eU(e,(e,o)=>({k:o,v:t(e,o)})),eU=(e,t)=>{let o={};return eL(e,(e,n)=>{let r=t(e,n);o[r.k]=r.v}),o},eW=e=>(t,o)=>{e[o]=t},ej=(e,t,o,n)=>{eL(e,(e,r)=>{(t(e,r)?o:n)(e,r)})},eG=(e,t)=>{let o={},n={};return ej(e,t,eW(o),eW(n)),{t:o,f:n}},e$=(e,t)=>{let o={};return ej(e,t,eW(o),y),o},eq=(e,t)=>{let o=[];return eL(e,(e,n)=>{o.push(t(e,n))}),o},eX=(e,t)=>{let o=eH(e);for(let n=0,r=o.length;n<r;n++){let r=o[n],a=e[r];if(t(a,r,e))return ea.some(a)}return ea.none()},eK=e=>eq(e,C),eY=(e,t)=>eJ(e,t)?ea.from(e[t]):ea.none(),eJ=(e,t)=>ez.call(e,t),eZ=(e,t)=>eJ(e,t)&&void 0!==e[t]&&null!==e[t],eQ=(e,t,o=O)=>e.exists(e=>o(e,t)),e0=(e,t,o=O)=>e3(e,t,o).getOr(e.isNone()&&t.isNone()),e1=e=>{let t=[],o=e=>{t.push(e)};for(let t=0;t<e.length;t++)e[t].each(o);return t},e2=e=>{let t=[];for(let o=0;o<e.length;o++){let n=e[o];if(!n.isSome())return ea.none();t.push(n.getOrDie())}return ea.some(t)},e3=(e,t,o)=>e.isSome()&&t.isSome()?ea.some(o(e.getOrDie(),t.getOrDie())):ea.none(),e5=(e,t,o,n)=>e.isSome()&&t.isSome()&&o.isSome()?ea.some(n(e.getOrDie(),t.getOrDie(),o.getOrDie())):ea.none(),e9=(e,t)=>null!=e?ea.some(t(e)):ea.none(),e4=(e,t)=>e?ea.some(t):ea.none(),e6=(e,t)=>e+t,e8=(e,t)=>e.substring(t),e7=(e,t,o)=>""===t||e.length>=t.length&&e.substr(o,o+t.length)===t,te=(e,t)=>tn(e,t)?e8(e,t.length):e,tt=(e,t)=>tr(e,t)?e:e6(e,t),to=(e,t,o=0,n)=>{let r=e.indexOf(t,o);return -1!==r&&(!!g(n)||r+t.length<=n)},tn=(e,t)=>e7(e,t,0),tr=(e,t)=>e7(e,t,e.length-t.length),ta=e=>e.replace(/^\s+|\s+$/g,""),ti=e=>e.length>0,tl=e=>!ti(e),ts=e=>void 0!==e.style&&f(e.style.getPropertyValue),tc=(e,t)=>{let o=(t||document).createElement("div");if(o.innerHTML=e,!o.hasChildNodes()||o.childNodes.length>1){let t="HTML does not have a single root node";throw console.error(t,e),Error(t)}return tm(o.childNodes[0])},td=(e,t)=>{let o=(t||document).createElement(e);return tm(o)},tu=(e,t)=>{let o=(t||document).createTextNode(e);return tm(o)},tm=e=>{if(null==e)throw Error("Node cannot be null or undefined");return{dom:e}},tg=(e,t,o)=>ea.from(e.dom.elementFromPoint(t,o)).map(tm),tp={fromHtml:tc,fromTag:td,fromText:tu,fromDom:tm,fromPoint:tg},th="undefined"!=typeof window?window:Function("return this;")(),tf=(e,t)=>{let o=null!=t?t:th;for(let t=0;t<e.length&&null!=o;++t)o=o[e[t]];return o},tb=(e,t)=>{let o=e.split(".");return tf(o,t)},tv=(e,t)=>tb(e,t),ty=(e,t)=>{let o=tv(e,t);if(null==o)throw Error(e+" not available on this browser");return o},tx=Object.getPrototypeOf,tw=e=>ty("HTMLElement",e),tS=e=>{let t=tb("ownerDocument.defaultView",e);return s(e)&&(tw(t).prototype.isPrototypeOf(e)||/^HTML\w*Element$/.test(tx(e).constructor.name))},tk=e=>{let t=e.dom.nodeName;return t.toLowerCase()},tC=e=>e.dom.nodeType,tO=e=>t=>tC(t)===e,t_=e=>tT(e)&&tS(e.dom),tT=tO(1),tE=tO(3),tD=tO(9),tA=tO(11),tM=e=>t=>tT(t)&&tk(t)===e,tB=(e,t)=>{let o=e.dom;if(1!==o.nodeType)return!1;if(void 0!==o.matches)return o.matches(t);if(void 0!==o.msMatchesSelector)return o.msMatchesSelector(t);if(void 0!==o.webkitMatchesSelector)return o.webkitMatchesSelector(t);if(void 0!==o.mozMatchesSelector)return o.mozMatchesSelector(t);throw Error("Browser lacks native selectors")},tF=e=>1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount,tI=(e,t)=>{let o=void 0===t?document:t.dom;return tF(o)?[]:eh(o.querySelectorAll(e),tp.fromDom)},tR=(e,t)=>{let o=void 0===t?document:t.dom;return tF(o)?ea.none():ea.from(o.querySelector(e)).map(tp.fromDom)},tN=(e,t)=>e.dom===t.dom,tV=(e,t)=>{let o=e.dom,n=t.dom;return o!==n&&o.contains(n)},tH=e=>tp.fromDom(e.dom.ownerDocument),tz=e=>tD(e)?e:tH(e),tL=e=>tp.fromDom(tz(e).dom.documentElement),tP=e=>tp.fromDom(tz(e).dom.defaultView),tU=e=>ea.from(e.dom.parentNode).map(tp.fromDom),tW=e=>ea.from(e.dom.parentElement).map(tp.fromDom),tj=e=>ea.from(e.dom.offsetParent).map(tp.fromDom),tG=e=>ea.from(e.dom.nextSibling).map(tp.fromDom),t$=e=>eh(e.dom.childNodes,tp.fromDom),tq=(e,t)=>{let o=e.dom.childNodes;return ea.from(o[t]).map(tp.fromDom)},tX=e=>tq(e,0),tK=(e,t)=>({element:e,offset:t}),tY=(e,t)=>{let o=t$(e);return o.length>0&&t<o.length?tK(o[t],0):tK(e,t)},tJ=e=>tA(e)&&h(e.dom.host),tZ=f(Element.prototype.attachShadow)&&f(Node.prototype.getRootNode),tQ=k(tZ),t0=tZ?e=>tp.fromDom(e.dom.getRootNode()):tz,t1=e=>tJ(e)?e:tp.fromDom(tz(e).dom.body),t2=e=>t3(e).isSome(),t3=e=>{let t=t0(e);return tJ(t)?ea.some(t):ea.none()},t5=e=>tp.fromDom(e.dom.host),t9=e=>{if(tQ()&&h(e.target)){let t=tp.fromDom(e.target);if(tT(t)&&t4(t)&&e.composed&&e.composedPath){let t=e.composedPath();if(t)return eI(t)}}return ea.from(e.target)},t4=e=>h(e.dom.shadowRoot),t6=e=>{let t=tE(e)?e.dom.parentNode:e.dom;if(null==t||null===t.ownerDocument)return!1;let o=t.ownerDocument;return t3(tp.fromDom(t)).fold(()=>o.body.contains(t),S(t6,t5))},t8=()=>t7(tp.fromDom(document)),t7=e=>{let t=e.dom.body;if(null==t)throw Error("Body is not available yet");return tp.fromDom(t)},oe=(e,t,o)=>{if(l(o)||m(o)||b(o))e.setAttribute(t,o+"");else throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",o,":: Element ",e),Error("Attribute value was not simple")},ot=(e,t,o)=>{oe(e.dom,t,o)},oo=(e,t)=>{let o=e.dom;eL(t,(e,t)=>{oe(o,t,e)})},on=(e,t)=>{let o=e.dom.getAttribute(t);return null===o?void 0:o},or=(e,t)=>ea.from(on(e,t)),oa=(e,t)=>{let o=e.dom;return!!o&&!!o.hasAttribute&&o.hasAttribute(t)},oi=(e,t)=>{e.dom.removeAttribute(t)},ol=e=>ew(e.dom.attributes,(e,t)=>(e[t.name]=t.value,e),{}),os=(e,t,o)=>{if(!l(o))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",o,":: Element ",e),Error("CSS value must be a string: "+o);ts(e)&&e.style.setProperty(t,o)},oc=(e,t)=>{ts(e)&&e.style.removeProperty(t)},od=(e,t,o)=>{let n=e.dom;os(n,t,o)},ou=(e,t)=>{let o=e.dom;eL(t,(e,t)=>{os(o,t,e)})},om=(e,t)=>{let o=e.dom;eL(t,(e,t)=>{e.fold(()=>{oc(o,t)},e=>{os(o,t,e)})})},og=(e,t)=>{let o=e.dom,n=window.getComputedStyle(o),r=n.getPropertyValue(t);return""!==r||t6(e)?r:op(o,t)},op=(e,t)=>ts(e)?e.style.getPropertyValue(t):"",oh=(e,t)=>{let o=e.dom,n=op(o,t);return ea.from(n).filter(e=>e.length>0)},of=e=>{let t={},o=e.dom;if(ts(o))for(let e=0;e<o.style.length;e++){let n=o.style.item(e);t[n]=o.style[n]}return t},ob=(e,t,o)=>{let n=tp.fromTag(e);od(n,t,o);let r=oh(n,t);return r.isSome()},ov=(e,t)=>{let o=e.dom;oc(o,t),eQ(or(e,"style").map(ta),"")&&oi(e,"style")},oy=e=>e.dom.offsetWidth,ox=(e,t)=>{let o=(t,o)=>{if(!b(o)&&!o.match(/^[0-9]+$/))throw Error(e+".set accepts only positive integer values. Value was "+o);let n=t.dom;ts(n)&&(n.style[e]=o+"px")},n=o=>{let n=t(o);if(n<=0||null===n){let t=og(o,e);return parseFloat(t)||0}return n},r=(e,t)=>ew(t,(t,o)=>{let n=og(e,o),r=void 0===n?0:parseInt(n,10);return isNaN(r)?t:t+r},0),a=(e,t,o)=>{let n=r(e,o);return t>n?t-n:0};return{set:o,get:n,getOuter:n,aggregate:r,max:a}},ow=ox("height",e=>{let t=e.dom;return t6(e)?t.getBoundingClientRect().height:t.offsetHeight}),oS=e=>ow.get(e),ok=e=>ow.getOuter(e),oC=(e,t)=>{let o=ow.max(e,t,["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"]);od(e,"max-height",o+"px")},oO=(e,t)=>{let o=(o,n)=>oO(e+o,t+n);return{left:e,top:t,translate:o}},o_=e=>{let t=e.getBoundingClientRect();return oO(t.left,t.top)},oT=(e,t)=>void 0!==e?e:void 0!==t?t:0,oE=e=>{let t=e.dom.ownerDocument,o=t.body,n=t.defaultView,r=t.documentElement;if(o===e.dom)return oO(o.offsetLeft,o.offsetTop);let a=oT(null==n?void 0:n.pageYOffset,r.scrollTop),i=oT(null==n?void 0:n.pageXOffset,r.scrollLeft),l=oT(r.clientTop,o.clientTop),s=oT(r.clientLeft,o.clientLeft);return oD(e).translate(i-s,a-l)},oD=e=>{let t=e.dom,o=t.ownerDocument,n=o.body;return n===t?oO(n.offsetLeft,n.offsetTop):t6(e)?o_(t):oO(0,0)},oA=ox("width",e=>e.dom.offsetWidth),oM=(e,t)=>oA.set(e,t),oB=e=>oA.get(e),oF=e=>oA.getOuter(e),oI=(e,t)=>{let o=oA.max(e,t,["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"]);od(e,"max-width",o+"px")},oR=e=>{let t,o=!1;return(...n)=>(o||(o=!0,t=e.apply(null,n)),t)},oN=(e,t,o,n)=>{let r=e.isiOS()&&!0===/ipad/i.test(o),a=e.isiOS()&&!r,i=e.isiOS()||e.isAndroid(),l=i||n("(pointer:coarse)"),s=r||!a&&i&&n("(min-device-width:768px)"),c=a||i&&!s,d=t.isSafari()&&e.isiOS()&&!1===/safari/i.test(o);return{isiPad:k(r),isiPhone:k(a),isTablet:k(s),isPhone:k(c),isTouch:k(l),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:k(d),isDesktop:k(!c&&!s&&!d)}},oV=(e,t)=>{for(let o=0;o<e.length;o++){let n=e[o];if(n.test(t))return n}},oH=(e,t)=>{let o=oV(e,t);if(!o)return{major:0,minor:0};let n=e=>Number(t.replace(o,"$"+e));return oP(n(1),n(2))},oz=(e,t)=>{let o=String(t).toLowerCase();return 0===e.length?oL():oH(e,o)},oL=()=>oP(0,0),oP=(e,t)=>({major:e,minor:t}),oU={nu:oP,detect:oz,unknown:oL},oW=(e,t)=>eV(t.brands,t=>{let o=t.brand.toLowerCase();return ek(e,e=>{var t;return o===(null===(t=e.brand)||void 0===t?void 0:t.toLowerCase())}).map(e=>({current:e.name,version:oU.nu(parseInt(t.version,10),0)}))}),oj=(e,t)=>{let o=String(t).toLowerCase();return ek(e,e=>e.search(o))},oG=(e,t)=>oj(e,t).map(e=>{let o=oU.detect(e.versionRegexes,t);return{current:e.name,version:o}}),o$=(e,t)=>oj(e,t).map(e=>{let o=oU.detect(e.versionRegexes,t);return{current:e.name,version:o}}),oq=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,oX=e=>t=>to(t,e),oK=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:e=>to(e,"edge/")&&to(e,"chrome")&&to(e,"safari")&&to(e,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,oq],search:e=>to(e,"chrome")&&!to(e,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:e=>to(e,"msie")||to(e,"trident")},{name:"Opera",versionRegexes:[oq,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:oX("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:oX("firefox")},{name:"Safari",versionRegexes:[oq,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:e=>(to(e,"safari")||to(e,"mobile/"))&&to(e,"applewebkit")}],oY=[{name:"Windows",search:oX("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:e=>to(e,"iphone")||to(e,"ipad"),versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:oX("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:oX("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:oX("linux"),versionRegexes:[]},{name:"Solaris",search:oX("sunos"),versionRegexes:[]},{name:"FreeBSD",search:oX("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:oX("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],oJ={browsers:k(oK),oses:k(oY)},oZ="Edge",oQ="Chromium",o0="Opera",o1="Firefox",o2="Safari",o3=()=>o5({current:void 0,version:oU.unknown()}),o5=e=>{let t=e.current,o=e.version,n=e=>()=>t===e;return{current:t,version:o,isEdge:n(oZ),isChromium:n(oQ),isIE:n("IE"),isOpera:n(o0),isFirefox:n(o1),isSafari:n(o2)}},o9={unknown:o3,nu:o5,edge:k(oZ),chromium:k(oQ),ie:k("IE"),opera:k(o0),firefox:k(o1),safari:k(o2)},o4="Windows",o6="Android",o8="Linux",o7="macOS",ne="Solaris",nt="FreeBSD",no="ChromeOS",nn=()=>nr({current:void 0,version:oU.unknown()}),nr=e=>{let t=e.current,o=e.version,n=e=>()=>t===e;return{current:t,version:o,isWindows:n(o4),isiOS:n("iOS"),isAndroid:n(o6),isMacOS:n(o7),isLinux:n(o8),isSolaris:n(ne),isFreeBSD:n(nt),isChromeOS:n(no)}},na={unknown:nn,nu:nr,windows:k(o4),ios:k("iOS"),android:k(o6),linux:k(o8),macos:k(o7),solaris:k(ne),freebsd:k(nt),chromeos:k(no)},ni=(e,t,o)=>{let n=oJ.browsers(),r=oJ.oses(),a=t.bind(e=>oW(n,e)).orThunk(()=>oG(n,e)).fold(o9.unknown,o9.nu),i=o$(r,e).fold(na.unknown,na.nu),l=oN(i,a,e,o);return{browser:a,os:i,deviceType:l}},nl={detect:ni},ns=e=>window.matchMedia(e).matches,nc=oR(()=>nl.detect(navigator.userAgent,ea.from(navigator.userAgentData),ns)),nd=()=>nc(),nu=(e,t,o,n,r,a,i)=>({target:e,x:t,y:o,stop:n,prevent:r,kill:a,raw:i}),nm=e=>{let t=tp.fromDom(t9(e).getOr(e.target)),o=()=>e.stopPropagation(),n=()=>e.preventDefault(),r=w(n,o);return nu(t,e.clientX,e.clientY,o,n,r,e)},ng=(e,t)=>o=>{e(o)&&t(nm(o))},np=(e,t,o,n,r)=>{let a=ng(o,n);return e.dom.addEventListener(t,a,r),{unbind:_(nb,e,t,a,r)}},nh=(e,t,o,n)=>np(e,t,o,n,!1),nf=(e,t,o,n)=>np(e,t,o,n,!0),nb=(e,t,o,n)=>{e.dom.removeEventListener(t,o,n)},nv=(e,t)=>{let o=tU(e);o.each(o=>{o.dom.insertBefore(t.dom,e.dom)})},ny=(e,t)=>{let o=tG(e);o.fold(()=>{let o=tU(e);o.each(e=>{nw(e,t)})},e=>{nv(e,t)})},nx=(e,t)=>{let o=tX(e);o.fold(()=>{nw(e,t)},o=>{e.dom.insertBefore(t.dom,o.dom)})},nw=(e,t)=>{e.dom.appendChild(t.dom)},nS=(e,t,o)=>{tq(e,o).fold(()=>{nw(e,t)},e=>{nv(e,t)})},nk=(e,t)=>{ef(t,t=>{nw(e,t)})},nC=e=>{e.dom.textContent="",ef(t$(e),e=>{nO(e)})},nO=e=>{let t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},n_=e=>{let t=void 0!==e?e.dom:document,o=t.body.scrollLeft||t.documentElement.scrollLeft,n=t.body.scrollTop||t.documentElement.scrollTop;return oO(o,n)},nT=(e,t,o)=>{let n=void 0!==o?o.dom:document,r=n.defaultView;r&&r.scrollTo(e,t)},nE=e=>{let t=void 0===e?window:e;return nd().browser.isFirefox()?ea.none():ea.from(t.visualViewport)},nD=(e,t,o,n)=>({x:e,y:t,width:o,height:n,right:e+o,bottom:t+n}),nA=e=>{let t=void 0===e?window:e,o=t.document,n=n_(tp.fromDom(o));return nE(t).fold(()=>{let e=t.document.documentElement,o=e.clientWidth,r=e.clientHeight;return nD(n.left,n.top,o,r)},e=>nD(Math.max(e.pageLeft,n.left),Math.max(e.pageTop,n.top),e.width,e.height))},nM=()=>tp.fromDom(document),nB=(e,t)=>{let o=e.view(t);return o.fold(k([]),t=>{let o=e.owner(t),n=nB(e,o);return[t].concat(n)})},nF=(e,t)=>{let o=t.owner(e),n=nB(t,o);return ea.some(n)},nI=e=>{var t;let o=e.dom===document?ea.none():ea.from(null===(t=e.dom.defaultView)||void 0===t?void 0:t.frameElement);return o.map(tp.fromDom)},nR=e=>tH(e);var nN=Object.freeze({__proto__:null,view:nI,owner:nR});let nV=e=>{let t=nM(),o=n_(t),n=nF(e,nN);return n.fold(_(oE,e),t=>{let n=oD(e),r=ex(t,(e,t)=>{let o=oD(t);return{left:e.left+o.left,top:e.top+o.top}},{left:0,top:0});return oO(r.left+n.left+o.left,r.top+n.top+o.top)})},nH=(e,t,o)=>({point:e,width:t,height:o}),nz=(e,t,o,n)=>({x:e,y:t,width:o,height:n}),nL=(e,t,o,n)=>({x:e,y:t,width:o,height:n,right:e+o,bottom:t+n}),nP=e=>{let t=oE(e),o=oF(e),n=ok(e);return nL(t.left,t.top,o,n)},nU=e=>{let t=nV(e),o=oF(e),n=ok(e);return nL(t.left,t.top,o,n)},nW=()=>nA(window),nj=e=>{let t=t=>t(e),o=k(e),n={tag:!0,inner:e,fold:(t,o)=>o(e),isValue:M,isError:A,map:t=>nq.value(t(e)),mapError:()=>n,bind:t,exists:t,forall:t,getOr:o,or:()=>n,getOrThunk:o,orThunk:()=>n,getOrDie:o,each:t=>{t(e)},toOptional:()=>ea.some(e)};return n},nG=e=>{let t={tag:!1,inner:e,fold:(t,o)=>t(e),isValue:A,isError:M,map:()=>t,mapError:t=>nq.error(t(e)),bind:()=>t,exists:A,forall:M,getOr:C,or:C,getOrThunk:D,orThunk:D,getOrDie:E(String(e)),each:y,toOptional:ea.none};return t},n$=(e,t)=>e.fold(()=>nG(t),nj),nq={value:nj,error:nG,fromOption:n$};(F=q||(q={}))[F.Error=0]="Error",F[F.Value=1]="Value";let nX=(e,t,o)=>e.stype===q.Error?t(e.serror):o(e.svalue),nK=e=>{let t=[],o=[];return ef(e,e=>{nX(e,e=>o.push(e),e=>t.push(e))}),{values:t,errors:o}},nY=(e,t)=>e.stype===q.Error?{stype:q.Error,serror:t(e.serror)}:e,nJ=(e,t)=>e.stype===q.Value?{stype:q.Value,svalue:t(e.svalue)}:e,nZ=(e,t)=>e.stype===q.Value?t(e.svalue):e,nQ=(e,t)=>e.stype===q.Error?t(e.serror):e,n0=e=>({stype:q.Value,svalue:e}),n1=e=>({stype:q.Error,serror:e}),n2=e=>nX(e,nq.error,nq.value),n3=e=>e.fold(n1,n0),n5={fromResult:n3,toResult:n2,svalue:n0,partition:nK,serror:n1,bind:nZ,bindError:nQ,map:nJ,mapError:nY,fold:nX},n9=(e,t,o,n)=>({tag:"field",key:e,newKey:t,presence:o,prop:n}),n4=(e,t)=>({tag:"custom",newKey:e,instantiator:t}),n6=(e,t,o)=>{switch(e.tag){case"field":return t(e.key,e.newKey,e.presence,e.prop);case"custom":return o(e.newKey,e.instantiator)}},n8=(e,t)=>{let o=c(e)&&c(t);return o?re(e,t):t},n7=e=>(...t)=>{if(0===t.length)throw Error("Can't merge zero objects");let o={};for(let n=0;n<t.length;n++){let r=t[n];for(let t in r)eJ(r,t)&&(o[t]=e(o[t],r[t]))}return o},re=n7(n8),rt=n7((e,t)=>t),ro=()=>({tag:"required",process:{}}),rn=e=>({tag:"defaultedThunk",process:e}),rr=e=>rn(k(e)),ra=()=>({tag:"option",process:{}}),ri=e=>({tag:"mergeWithThunk",process:e}),rl=(e,t)=>e.length>0?n5.svalue(re(t,rt.apply(void 0,e))):n5.svalue(t),rs=e=>w(n5.serror,eO)(e),rc=(e,t)=>{let o=n5.partition(e);return o.errors.length>0?rs(o.errors):rl(o.values,t)},rd=e=>{let t=n5.partition(e);return t.errors.length>0?rs(t.errors):n5.svalue(t.values)},ru={consolidateObj:rc,consolidateArr:rd},rm=e=>s(e)&&eH(e).length>100?" removed due to size":JSON.stringify(e,null,2),rg=e=>{let t=e.length>10?e.slice(0,10).concat([{path:[],getErrorInfo:k("... (only showing first ten failures)")}]):e;return eh(t,e=>"Failed path: ("+e.path.join(" > ")+")\n"+e.getErrorInfo())},rp=(e,t)=>n5.serror([{path:e,getErrorInfo:t}]),rh=(e,t,o)=>rp(e,()=>'Could not find valid *required* value for "'+t+'" in '+rm(o)),rf=(e,t)=>rp(e,()=>'Choice schema did not contain choice key: "'+t+'"'),rb=(e,t,o)=>rp(e,()=>'The chosen schema: "'+o+'" did not exist in branches: '+rm(t)),rv=(e,t)=>rp(e,()=>"There are unsupported fields: ["+t.join(", ")+"] specified"),ry=(e,t)=>rp(e,k(t)),rx=e=>{let t=(t,o)=>n5.bindError(e(o),e=>ry(t,e)),o=k("val");return{extract:t,toString:o}},rw=rx(n5.svalue),rS=(e,t,o,n)=>eY(t,o).fold(()=>rh(e,o,t),n),rk=(e,t,o,n)=>{let r=eY(e,t).getOrThunk(()=>o(e));return n(r)},rC=(e,t,o)=>o(eY(e,t)),rO=(e,t,o,n)=>{let r=eY(e,t).map(t=>!0===t?o(e):t);return n(r)},r_=(e,t,o,n,r)=>{let a=e=>r.extract(t.concat([n]),e),i=e=>e.fold(()=>n5.svalue(ea.none()),e=>{let o=r.extract(t.concat([n]),e);return n5.map(o,ea.some)});switch(e.tag){case"required":return rS(t,o,n,a);case"defaultedThunk":return rk(o,n,e.process,a);case"option":return rC(o,n,i);case"defaultedOptionThunk":return rO(o,n,e.process,i);case"mergeWithThunk":return rk(o,n,k({}),t=>{let n=re(e.process(o),t);return a(n)})}},rT=(e,t,o)=>{let n={},r=[];for(let a of o)n6(a,(o,a,i,l)=>{let s=r_(i,e,t,o,l);n5.fold(s,e=>{r.push(...e)},e=>{n[a]=e})},(e,o)=>{n[e]=o(t)});return r.length>0?n5.serror(r):n5.svalue(n)},rE=e=>{let t=(t,o)=>e().extract(t,o),o=()=>e().toString();return{extract:t,toString:o}},rD=e=>eH(e$(e,h)),rA=e=>{let t=rM(e),o=ex(e,(e,t)=>n6(t,t=>re(e,{[t]:!0}),k(e)),{}),n=(e,n)=>{let r=m(n)?[]:rD(n),a=ey(r,e=>!eZ(o,e));return 0===a.length?t.extract(e,n):rv(e,a)};return{extract:n,toString:t.toString}},rM=e=>{let t=(t,o)=>rT(t,o,e),o=()=>{let t=eh(e,e=>n6(e,(e,t,o,n)=>e+" -> "+n.toString(),(e,t)=>"state("+e+")"));return"obj{\n"+t.join("\n")+"}"};return{extract:t,toString:o}},rB=e=>{let t=(t,o)=>{let n=eh(o,(o,n)=>e.extract(t.concat(["["+n+"]"]),o));return ru.consolidateArr(n)},o=()=>"array("+e.toString()+")";return{extract:t,toString:o}},rF=(e,t)=>{let o=void 0!==t?t:C,n=(t,n)=>{let r=[];for(let a of e){let e=a.extract(t,n);if(e.stype===q.Value)return{stype:q.Value,svalue:o(e.svalue)};r.push(e)}return ru.consolidateArr(r)},r=()=>"oneOf("+eh(e,e=>e.toString()).join(", ")+")";return{extract:n,toString:r}},rI=(e,t)=>{let o=(t,o)=>rB(rx(e)).extract(t,o),n=(e,n)=>{let r=eH(n),a=o(e,r);return n5.bind(a,o=>{let r=eh(o,e=>n9(e,e,ro(),t));return rM(r).extract(e,n)})},r=()=>"setOf("+t.toString()+")";return{extract:n,toString:r}},rR=w(rB,rM),rN=k(rw),rV=(e,t)=>rx(o=>e(o)?n5.svalue(o):n5.serror(`Expected type: ${t} but got: ${typeof o}`)),rH=rV(b,"number"),rz=rV(l,"string"),rL=rV(m,"boolean"),rP=rV(f,"function"),rU=e=>{if(Object(e)!==e)return!0;switch(({}).toString.call(e).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(e).every(t=>rU(e[t]));default:return!1}},rW=rx(e=>rU(e)?n5.svalue(e):n5.serror("Expected value to be acceptable for sending via postMessage")),rj=(e,t,o,n)=>{let r=eY(o,n);return r.fold(()=>rb(e,o,n),o=>o.extract(e.concat(["branch: "+n]),t))},rG=(e,t)=>{let o=(o,n)=>{let r=eY(n,e);return r.fold(()=>rf(o,e),e=>rj(o,n,t,e))},n=()=>"chooseOn("+e+"). Possible values: "+eH(t);return{extract:o,toString:n}},r$=e=>rx(t=>e(t).fold(n5.serror,n5.svalue)),rq=(e,t)=>rI(t=>n5.fromResult(e(t)),t),rX=(e,t,o)=>{let n=t.extract([e],o);return n5.mapError(n,e=>({input:o,errors:e}))},rK=(e,t,o)=>n5.toResult(rX(e,t,o)),rY=e=>e.fold(e=>{throw Error(rZ(e))},C),rJ=(e,t,o)=>rY(rK(e,t,o)),rZ=e=>"Errors: \n"+rg(e.errors).join("\n")+"\n\nInput object: "+rm(e.input),rQ=(e,t)=>rG(e,eP(t,rM)),r0=e=>r$(t=>eu(e,t)?nq.value(t):nq.error(`Unsupported value: "${t}", choose one of "${e.join(", ")}".`)),r1=e=>n9(e,e,ro(),rN()),r2=(e,t)=>n9(e,e,ro(),t),r3=e=>r2(e,rH),r5=e=>r2(e,rz),r9=(e,t)=>n9(e,e,ro(),r0(t)),r4=e=>r2(e,rP),r6=(e,t)=>n9(e,e,ra(),rx(o=>n5.serror("The field: "+e+" is forbidden. "+t))),r8=(e,t)=>n9(e,e,ro(),rM(t)),r7=(e,t)=>n9(e,e,ro(),rR(t)),ae=(e,t)=>n9(e,e,ro(),rB(t)),at=e=>n9(e,e,ra(),rN()),ao=(e,t)=>n9(e,e,ra(),t),an=e=>ao(e,rH),ar=e=>ao(e,rz),aa=(e,t)=>ao(e,r0(t)),ai=e=>ao(e,rP),al=(e,t)=>ao(e,rB(t)),as=(e,t)=>ao(e,rM(t)),ac=(e,t)=>ao(e,rA(t)),ad=(e,t)=>n9(e,e,rr(t),rN()),au=(e,t,o)=>n9(e,e,rr(t),o),am=(e,t)=>au(e,t,rH),ag=(e,t)=>au(e,t,rz),ap=(e,t,o)=>au(e,t,r0(o)),ah=(e,t)=>au(e,t,rL),af=(e,t)=>au(e,t,rP),ab=(e,t,o)=>au(e,t,rB(o)),av=(e,t,o)=>au(e,t,rM(o)),ay=e=>{let t=e,o=e=>{t=e};return{get:()=>t,set:o}},ax=e=>{if(!d(e))throw Error("cases must be an array");if(0===e.length)throw Error("there must be at least one case");let t=[],o={};return ef(e,(n,r)=>{let a=eH(n);if(1!==a.length)throw Error("one and only one name per case");let i=a[0],l=n[i];if(void 0!==o[i])throw Error("duplicate key detected:"+i);if("cata"===i)throw Error("cannot have a case named cata (sorry)");if(!d(l))throw Error("case arguments must be an array");t.push(i),o[i]=(...o)=>{let n=o.length;if(n!==l.length)throw Error("Wrong number of arguments to case "+i+". Expected "+l.length+" ("+l+"), got "+n);let a=e=>{let n=eH(e);if(t.length!==n.length)throw Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+n.join(","));let r=eT(t,e=>eu(n,e));if(!r)throw Error("Not all branches were specified when using match. Specified: "+n.join(", ")+"\nRequired: "+t.join(", "));return e[i].apply(null,o)};return{fold:(...t)=>{if(t.length!==e.length)throw Error("Wrong number of arguments to fold. Expected "+e.length+", got "+t.length);let n=t[r];return n.apply(null,o)},match:a,log:e=>{console.log(e,{constructors:t,constructor:i,params:o})}}}}),o},aw={generate:ax};aw.generate([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);let aS=e=>{let t=[],o=[];return ef(e,e=>{e.fold(e=>{t.push(e)},e=>{o.push(e)})}),{errors:t,values:o}},ak=(e,t)=>{let o={};return eL(e,(e,n)=>{eu(t,n)||(o[n]=e)}),o},aC=(e,t)=>({[e]:t}),aO=e=>{let t={};return ef(e,e=>{t[e.key]=e.value}),t},a_=(e,t)=>ak(e,t),aT=(e,t)=>aC(e,t),aE=e=>aO(e),aD=(e,t)=>0===e.length?nq.value(t):nq.value(re(t,rt.apply(void 0,e))),aA=e=>nq.error(eO(e)),aM=(e,t)=>{let o=aS(e);return o.errors.length>0?aA(o.errors):aD(o.values,t)},aB=e=>f(e)?e:A,aF=(e,t,o)=>{let n=e.dom,r=aB(o);for(;n.parentNode;){n=n.parentNode;let e=tp.fromDom(n),o=t(e);if(o.isSome())return o;if(r(e))break}return ea.none()},aI=(e,t,o)=>{let n=t(e),r=aB(o);return n.orThunk(()=>r(e)?ea.none():aF(e,t,r))},aR=(e,t)=>tN(e.element,t.event.target),aN={can:M,abort:A,run:y},aV=e=>{if(!eZ(e,"can")&&!eZ(e,"abort")&&!eZ(e,"run"))throw Error("EventHandler defined by: "+JSON.stringify(e,null,2)+" does not have can, abort, or run!");return{...aN,...e}},aH=(e,t)=>(...o)=>ew(e,(e,n)=>e&&t(n).apply(void 0,o),!0),az=(e,t)=>(...o)=>ew(e,(e,n)=>e||t(n).apply(void 0,o),!1),aL=e=>f(e)?{can:M,abort:A,run:e}:e,aP=e=>{let t=aH(e,e=>e.can),o=az(e,e=>e.abort),n=(...t)=>{ef(e,e=>{e.run.apply(void 0,t)})};return{can:t,abort:o,run:n}},aU=k("touchstart"),aW=k("touchmove"),aj=k("touchend"),aG=k("touchcancel"),a$=k("mousedown"),aq=k("mousemove"),aX=k("mouseout"),aK=k("mouseup"),aY=k("mouseover"),aJ=k("focusin"),aZ=k("focusout"),aQ=k("keydown"),a0=k("keyup"),a1=k("input"),a2=k("change"),a3=k("click"),a5=k("transitioncancel"),a9=k("transitionend"),a4=k("transitionstart"),a6=k("selectstart"),a8=e=>k("alloy."+e),a7={tap:a8("tap")},ie=a8("focus"),it=a8("blur.post"),io=a8("paste.post"),ir=a8("receive"),ia=a8("execute"),ii=a8("focus.item"),il=a7.tap,is=a8("longpress"),ic=a8("sandbox.close"),id=a8("typeahead.cancel"),iu=a8("system.init"),im=a8("system.touchmove"),ig=a8("system.touchend"),ip=a8("system.scroll"),ih=a8("system.resize"),ib=a8("system.attached"),iv=a8("system.detached"),iy=a8("system.dismissRequested"),ix=a8("system.repositionRequested"),iw=a8("focusmanager.shifted"),iS=a8("slotcontainer.visibility"),ik=a8("change.tab"),iC=a8("dismiss.tab"),iO=a8("highlight"),i_=a8("dehighlight"),iT=(e,t)=>{iM(e,e.element,t,{})},iE=(e,t,o)=>{iM(e,e.element,t,o)},iD=e=>{iT(e,ia())},iA=(e,t,o)=>{iM(e,t,o,{})},iM=(e,t,o,n)=>{let r={target:t,...n};e.getSystem().triggerEvent(o,t,r)},iB=(e,t,o,n)=>{let r={...n,target:t};e.getSystem().triggerEvent(o,t,r)},iF=(e,t,o,n)=>{e.getSystem().triggerEvent(o,t,n.event)},iI=e=>aE(e),iR=(e,t)=>({key:e,value:aV({abort:t})}),iN=e=>({key:e,value:aV({run:(e,t)=>{t.event.prevent()}})}),iV=(e,t)=>({key:e,value:aV({run:t})}),iH=(e,t,o)=>({key:e,value:aV({run:(e,n)=>{t.apply(void 0,[e,n].concat(o))}})}),iz=e=>t=>({key:e,value:aV({run:(e,o)=>{aR(e,o)&&t(e,o)}})}),iL=(e,t)=>iV(e,(o,n)=>{o.getSystem().getByUid(t).each(t=>{iF(t,t.element,e,n)})}),iP=(e,t,o)=>{let n=t.partUids[o];return iL(e,n)},iU=(e,t)=>iV(e,(e,o)=>{let n=o.event,r=e.getSystem().getByDom(n.target).getOrThunk(()=>{let t=aI(n.target,t=>e.getSystem().getByDom(t).toOptional(),A);return t.getOr(e)});t(e,r,o)}),iW=e=>iV(e,(e,t)=>{t.cut()}),ij=e=>iV(e,(e,t)=>{t.stop()}),iG=(e,t)=>iz(e)(t),i$=iz(ib()),iq=iz(iv()),iX=iz(iu()),iK=(I=ia(),e=>iV(I,e)),iY=(e,t)=>{let o=(t||document).createElement("div");return o.innerHTML=e,t$(tp.fromDom(o))},iJ=e=>e.dom.innerHTML,iZ=(e,t)=>{let o=tH(e),n=o.dom,r=tp.fromDom(n.createDocumentFragment()),a=iY(t,n);nk(r,a),nC(e),nw(e,r)},iQ=e=>{let t=tp.fromTag("div"),o=tp.fromDom(e.dom.cloneNode(!0));return nw(t,o),iJ(t)},i0=(e,t)=>tp.fromDom(e.dom.cloneNode(t)),i1=e=>i0(e,!1),i2=e=>{if(tJ(e))return"#shadow-root";{let t=i1(e);return iQ(t)}},i3=e=>i2(e),i5=(e,t,o)=>tN(t,e.element)&&!tN(t,o),i9=iI([{key:ie(),value:aV({can:(e,t)=>{let o=t.event,n=o.originator,r=o.target;return!i5(e,n,r)||(console.warn(ie()+" did not get interpreted by the desired target. \nOriginator: "+i3(n)+"\nTarget: "+i3(r)+"\nCheck the "+ie()+" event handlers"),!1)}})}]);var i4=Object.freeze({__proto__:null,events:i9});let i6=0,i8=e=>{let t=new Date,o=t.getTime();return e+"_"+Math.floor(1e9*Math.random())+ ++i6+String(o)},i7=k("alloy-id-"),le=k("data-alloy-id"),lt=i7(),lo=le(),ln=(e,t)=>{let o=i8(lt+e);return lr(t,o),o},lr=(e,t)=>{Object.defineProperty(e.dom,lo,{value:t,writable:!0})},la=e=>{let t=tT(e)?e.dom[lo]:null;return ea.from(t)},li=e=>i8(e),ll=e=>{let t=t=>`The component must be in a context to execute: ${t}`+(e?"\n"+i3(e().element)+" is not in context.":""),o=e=>()=>{throw Error(t(e))},n=e=>()=>{console.warn(t(e))};return{debugInfo:k("fake"),triggerEvent:n("triggerEvent"),triggerFocus:n("triggerFocus"),triggerEscape:n("triggerEscape"),broadcast:n("broadcast"),broadcastOn:n("broadcastOn"),broadcastEvent:n("broadcastEvent"),build:o("build"),buildOrPatch:o("buildOrPatch"),addToWorld:o("addToWorld"),removeFromWorld:o("removeFromWorld"),addToGui:o("addToGui"),removeFromGui:o("removeFromGui"),getByUid:o("getByUid"),getByDom:o("getByDom"),isConnected:A}},ls=ll(),lc=(e,t,o)=>{let n=o.toString(),r=n.indexOf(")")+1,a=n.indexOf("("),i=n.substring(a+1,r-1).split(/,\s*/);return e.toFunctionAnnotation=()=>({name:t,parameters:ld(i.slice(0,1).concat(i.slice(3)))}),e},ld=e=>eh(e,e=>tr(e,"/*")?e.substring(0,e.length-2):e),lu=(e,t)=>{let o=e.toString(),n=o.indexOf(")")+1,r=o.indexOf("("),a=o.substring(r+1,n-1).split(/,\s*/);return e.toFunctionAnnotation=()=>({name:t,parameters:ld(a)}),e},lm=(e,t)=>{let o=t.toString(),n=o.indexOf(")")+1,r=o.indexOf("("),a=o.substring(r+1,n-1).split(/,\s*/);return e.toFunctionAnnotation=()=>({name:"OVERRIDE",parameters:ld(a.slice(1))}),e},lg=i8("alloy-premade"),lp=e=>(Object.defineProperty(e.element.dom,lg,{value:e.uid,writable:!0}),aT(lg,e)),lh=e=>eJ(e.dom,lg),lf=e=>eY(e,lg),lb=e=>lm((t,...o)=>e(t.getApis(),t,...o),e),lv={init:()=>ly({readState:k("No State required")})},ly=e=>e,lx=(e,t)=>{let o=eh(t,e=>as(e.name(),[r1("config"),ad("state",lv)])),n=rK("component.behaviours",rM(o),e.behaviours).fold(t=>{throw Error(rZ(t)+"\nComplete spec:\n"+JSON.stringify(e,null,2))},C);return{list:t,data:eP(n,e=>{let t=e.map(e=>({config:e.config,state:e.state.init(e.config)}));return k(t)})}},lw=e=>e.list,lS=e=>e.data,lk=(e,t)=>{let o={};return eL(e,(e,n)=>{eL(e,(e,r)=>{let a=eY(o,r).getOr([]);o[r]=a.concat([t(n,e)])})}),o},lC=e=>({classes:g(e.classes)?[]:e.classes,attributes:g(e.attributes)?{}:e.attributes,styles:g(e.styles)?{}:e.styles}),lO=(e,t)=>({...e,attributes:{...e.attributes,...t.attributes},styles:{...e.styles,...t.styles},classes:e.classes.concat(t.classes)}),l_=(e,t,o,n)=>{let r={...t};ef(o,t=>{r[t.name()]=t.exhibit(e,n)});let a=lk(r,(e,t)=>({name:e,modification:t})),i=e=>ex(e,(e,t)=>({...t.modification,...e}),{}),l=ex(a.classes,(e,t)=>t.modification.concat(e),[]),s=i(a.attributes),c=i(a.styles);return lC({classes:l,attributes:s,styles:c})},lT=(e,t,o,n)=>{try{let r=eB(o,(o,r)=>{let a=o[t],i=r[t],l=n.indexOf(a),s=n.indexOf(i);if(-1===l)throw Error("The ordering for "+e+" does not have an entry for "+a+".\nOrder specified: "+JSON.stringify(n,null,2));if(-1===s)throw Error("The ordering for "+e+" does not have an entry for "+i+".\nOrder specified: "+JSON.stringify(n,null,2));return l<s?-1:s<l?1:0});return nq.value(r)}catch(e){return nq.error([e])}},lE=(e,t)=>({handler:e,purpose:t}),lD=(e,t)=>({cHandler:e,purpose:t}),lA=(e,t)=>lD(_.apply(void 0,[e.handler].concat(t)),e.purpose),lM=e=>e.cHandler,lB=(e,t)=>({name:e,handler:t}),lF=(e,t)=>{let o={};return ef(e,e=>{o[e.name()]=e.handlers(t)}),o},lI=(e,t,o)=>{let n={...o,...lF(t,e)};return lk(n,lB)},lR=(e,t,o,n)=>{let r=lI(e,o,n);return lz(r,t)},lN=e=>{let t=aL(e);return(e,o,...n)=>{let r=[e,o].concat(n);t.abort.apply(void 0,r)?o.stop():t.can.apply(void 0,r)&&t.run.apply(void 0,r)}},lV=(e,t)=>nq.error(["The event ("+e+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(eh(t,e=>e.name),null,2)]),lH=(e,t,o)=>{let n=t[o];return n?lT("Event: "+o,"name",e,n).map(e=>{let t=eh(e,e=>e.handler);return aP(t)}):lV(o,e)},lz=(e,t)=>{let o=eq(e,(e,o)=>{let n=1===e.length?nq.value(e[0].handler):lH(e,t,o);return n.map(n=>{let r=lN(n),a=e.length>1?ey(t[o],t=>em(e,e=>e.name===t)).join(" > "):e[0].name;return aT(o,lE(r,a))})});return aM(o,{})},lL="alloy.base.behaviour",lP=rM([n9("dom","dom",ro(),rM([r1("tag"),ad("styles",{}),ad("classes",[]),ad("attributes",{}),at("value"),at("innerHtml")])),r1("components"),r1("uid"),ad("events",{}),ad("apis",{}),n9("eventOrder","eventOrder",(R={[ia()]:["disabling",lL,"toggling","typeaheadevents"],[ie()]:[lL,"focusing","keying"],[iu()]:[lL,"disabling","toggling","representing"],[a1()]:[lL,"representing","streaming","invalidating"],[iv()]:[lL,"representing","item-events","tooltipping"],[a$()]:["focusing",lL,"item-type-events"],[aU()]:["focusing",lL,"item-type-events"],[aY()]:["item-type-events","tooltipping"],[ir()]:["receiving","reflecting","tooltipping"]},ri(k(R))),rN()),at("domModification")]),lU=e=>rK("custom.definition",lP,e),lW=e=>({...e.dom,uid:e.uid,domChildren:eh(e.components,e=>e.element)}),lj=e=>e.domModification.fold(()=>lC({}),lC),lG=e=>e.events,l$=(e,t)=>{let o=on(e,t);return void 0===o||""===o?[]:o.split(" ")},lq=(e,t,o)=>{let n=l$(e,t),r=n.concat([o]);return ot(e,t,r.join(" ")),!0},lX=(e,t,o)=>{let n=ey(l$(e,t),e=>e!==o);return n.length>0?ot(e,t,n.join(" ")):oi(e,t),!1},lK=e=>void 0!==e.dom.classList,lY=e=>l$(e,"class"),lJ=(e,t)=>lq(e,"class",t),lZ=(e,t)=>lX(e,"class",t),lQ=(e,t)=>{lK(e)?e.dom.classList.add(t):lJ(e,t)},l0=e=>{let t=lK(e)?e.dom.classList:lY(e);0===t.length&&oi(e,"class")},l1=(e,t)=>{if(lK(e)){let o=e.dom.classList;o.remove(t)}else lZ(e,t);l0(e)},l2=(e,t)=>lK(e)&&e.dom.classList.contains(t),l3=(e,t)=>{ef(t,t=>{lQ(e,t)})},l5=(e,t)=>{ef(t,t=>{l1(e,t)})},l9=(e,t)=>eT(t,t=>l2(e,t)),l4=e=>{let t=e.dom.classList,o=Array(t.length);for(let e=0;e<t.length;e++){let n=t.item(e);null!==n&&(o[e]=n)}return o},l6=e=>lK(e)?l4(e):lY(e),l8=e=>e.dom.value,l7=(e,t)=>{if(void 0===t)throw Error("Value.set was undefined");e.dom.value=t},se=(e,t,o)=>{let n=tq(e,t);return n.map(e=>{let t=o.exists(t=>!tN(t,e));if(!t)return e;{let t=o.map(tk).getOr("span"),n=tp.fromTag(t);return nv(e,n),n}})},st=(e,t,o)=>{o.fold(()=>nw(e,t),e=>{tN(e,t)||(nv(e,t),nO(e))})},so=(e,t,o)=>{let n=eh(t,o),r=t$(e);return ef(r.slice(n.length),nO),n},sn=(e,t,o,n)=>{let r=tq(e,t),a=n(o,r),i=se(e,t,r);return st(e,a.element,i),a},sr=(e,t,o)=>so(e,t,(t,n)=>sn(e,n,t,o)),sa=(e,t)=>so(e,t,(t,o)=>{let n=tq(e,o);return st(e,t,n),t}),si=(e,t)=>{let o=eH(e),n=eH(t),r=eD(n,o),a=eG(e,(e,o)=>!eJ(t,o)||e!==t[o]).t;return{toRemove:r,toSet:a}},sl=(e,t)=>{let{class:o,style:n,...r}=ol(t),{toSet:a,toRemove:i}=si(e.attributes,r),l=of(t),{toSet:s,toRemove:c}=si(e.styles,l),d=l6(t),u=eD(d,e.classes),m=eD(e.classes,d),g=e=>{iZ(t,e)},p=()=>{let o=e.domChildren;sa(t,o)};return ef(i,e=>oi(t,e)),oo(t,a),l3(t,m),l5(t,u),ef(c,e=>ov(t,e)),ou(t,s),e.innerHtml.fold(p,g),(()=>{let o=e.value.getOrUndefined();o!==l8(t)&&l7(t,null!=o?o:"")})(),t},ss=e=>{let t=tp.fromTag(e.tag);oo(t,e.attributes),l3(t,e.classes),ou(t,e.styles),e.innerHtml.each(e=>iZ(t,e));let o=e.domChildren;return nk(t,o),e.value.each(e=>{l7(t,e)}),t},sc=(e,t)=>{try{let o=sl(e,t);return ea.some(o)}catch(e){return ea.none()}},sd=e=>e.innerHtml.isSome()&&e.domChildren.length>0,su=(e,t)=>{let o=t=>tk(t)===e.tag&&!sd(e)&&!lh(t),n=t.filter(o).bind(t=>sc(e,t)).getOrThunk(()=>ss(e));return lr(n,e.uid),n},sm=e=>{let t=eY(e,"behaviours").getOr({});return e_(eH(t),e=>{let o=t[e];return h(o)?[o.me]:[]})},sg=(e,t)=>lx(e,t),sp=e=>{let t=sm(e);return sg(e,t)},sh=(e,t,o)=>{let n=lW(e),r=lj(e),a=t.length>0?l_(o,{"alloy.base.modification":r},t,n):r;return lO(n,a)},sf=(e,t,o)=>{let n={"alloy.base.behaviour":lG(e)};return lR(o,e.eventOrder,t,n).getOrDie()},sb=(e,t)=>{let o=()=>y,n=ay(ls),r=rY(lU(e)),a=sp(e),i=lw(a),l=lS(a),s=sh(r,i,l),c=su(s,t),d=sf(r,i,l),u=ay(r.components),m=e=>{n.set(e)},g=()=>{n.set(ll(o))},p=()=>{let e=t$(c),t=e_(e,e=>n.get().getByDom(e).fold(()=>[],eM));u.set(t)},h=t=>{let o=f(l[t.name()])?l[t.name()]:()=>{throw Error("Could not find "+t.name()+" in "+JSON.stringify(e,null,2))};return o()},b=e=>f(l[e.name()]),v=e=>l[e]().map(e=>e.state.readState()).getOr("not enabled"),y={uid:e.uid,getSystem:n.get,config:h,hasConfigured:b,spec:e,readState:v,getApis:()=>r.apis,connect:m,disconnect:g,element:c,syncComponents:p,components:u.get,events:d};return y},sv=(e,t)=>{let o=eY(e,"components").getOr([]);return t.fold(()=>eh(o,sC),e=>eh(o,(t,o)=>sk(t,tq(e,o))))},sy=(e,t)=>{let{events:o,...n}=C(e),r=sv(n,t),a={...n,events:{...i4,...o},components:r};return nq.value(sb(a,t))},sx=e=>{let t=tp.fromText(e);return sw({element:t})},sw=e=>{let t=rJ("external.component",rA([r1("element"),at("uid")]),e),o=ay(ll()),n=e=>{o.set(e)},r=()=>{o.set(ll(()=>i))},a=t.uid.getOrThunk(()=>li("external"));lr(t.element,a);let i={uid:a,getSystem:o.get,config:ea.none,hasConfigured:A,connect:n,disconnect:r,getApis:()=>({}),element:t.element,spec:e,readState:k("No state"),syncComponents:y,components:k([]),events:{}};return lp(i)},sS=e=>eJ(e,"uid"),sk=(e,t)=>lf(e).getOrThunk(()=>{let o=sS(e)?e:{uid:li(""),...e};return sy(o,t).getOrDie()}),sC=e=>sk(e,ea.none());var sO=(e,t,o,n,r)=>e(o,n)?ea.some(o):f(r)&&r(o)?ea.none():t(o,n,r);let s_=(e,t,o)=>{let n=e.dom,r=f(o)?o:A;for(;n.parentNode;){n=n.parentNode;let e=tp.fromDom(n);if(t(e))return ea.some(e);if(r(e))break}return ea.none()},sT=(e,t,o)=>{let n=(e,t)=>t(e);return sO(n,s_,e,t,o)},sE=(e,t)=>{let o=e=>t(tp.fromDom(e)),n=ek(e.dom.childNodes,o);return n.map(tp.fromDom)},sD=(e,t)=>{let o=e=>{for(let n=0;n<e.childNodes.length;n++){let r=tp.fromDom(e.childNodes[n]);if(t(r))return ea.some(r);let a=o(e.childNodes[n]);if(a.isSome())return a}return ea.none()};return o(e.dom)},sA=(e,t,o)=>sT(e,t,o).isSome(),sM=(e,t,o)=>s_(e,e=>tB(e,t),o),sB=(e,t)=>sE(e,e=>tB(e,t)),sF=(e,t)=>tR(t,e),sI=(e,t,o)=>{let n=(e,t)=>tB(e,t);return sO(n,sM,e,t,o)},sR="aria-controls",sN=e=>{let t=sT(e,e=>{if(!tT(e))return!1;let t=on(e,"id");return void 0!==t&&t.indexOf(sR)>-1});return t.bind(e=>{let t=on(e,"id"),o=t0(e);return sF(o,`[${sR}="${t}"]`)})},sV=()=>{let e=i8(sR),t=t=>{ot(t,sR,e)},o=e=>{oi(e,sR)};return{id:e,link:t,unlink:o}},sH=(e,t)=>sN(t).exists(t=>sz(e,t)),sz=(e,t)=>sA(t,t=>tN(t,e.element),A)||sH(e,t),sL="unknown";(N=X||(X={}))[N.STOP=0]="STOP",N[N.NORMAL=1]="NORMAL",N[N.LOGGING=2]="LOGGING";let sP=ay({}),sU=(e,t)=>{let o=[],n=new Date().getTime();return{logEventCut:(e,t,n)=>{o.push({outcome:"cut",target:t,purpose:n})},logEventStopped:(e,t,n)=>{o.push({outcome:"stopped",target:t,purpose:n})},logNoParent:(e,t,n)=>{o.push({outcome:"no-parent",target:t,purpose:n})},logEventNoHandlers:(e,t)=>{o.push({outcome:"no-handlers-left",target:t})},logEventResponse:(e,t,n)=>{o.push({outcome:"response",purpose:n,target:t})},write:()=>{let r=new Date().getTime();eu(["mousemove","mouseover","mouseout",iu()],e)||console.log(e,{event:e,time:r-n,target:t.dom,sequence:eh(o,e=>eu(["cut","stopped","response"],e.outcome)?"{"+e.purpose+"} "+e.outcome+" at ("+i3(e.target)+")":e.outcome)})}}},sW=(e,t,o)=>{let n=eY(sP.get(),e).orThunk(()=>{let t=eH(sP.get());return eV(t,t=>e.indexOf(t)>-1?ea.some(sP.get()[t]):ea.none())}).getOr(X.NORMAL);switch(n){case X.NORMAL:return o(sq());case X.LOGGING:{let n=sU(e,t),r=o(n);return n.write(),r}case X.STOP:return!0}},sj=["alloy/data/Fields","alloy/debugging/Debugging"],sG=()=>{let e=Error();if(void 0===e.stack)return sL;{let t=e.stack.split("\n");return ek(t,e=>e.indexOf("alloy")>0&&!em(sj,t=>e.indexOf(t)>-1)).getOr(sL)}},s$=(e,t,o)=>sW(e,t,o),sq=k({logEventCut:y,logEventStopped:y,logNoParent:y,logEventNoHandlers:y,logEventResponse:y,write:y}),sX=k([r1("menu"),r1("selectedMenu")]),sK=k([r1("item"),r1("selectedItem")]);k(rM(sK().concat(sX())));let sY=k(rM(sK())),sJ=r8("initSize",[r1("numColumns"),r1("numRows")]),sZ=()=>r8("markers",[r1("backgroundMenu")].concat(sX()).concat(sK())),sQ=e=>r8("markers",eh(e,r1)),s0=(e,t,o)=>(sG(),n9(t,t,o,r$(e=>nq.value((...t)=>e.apply(void 0,t))))),s1=e=>s0("onHandler",e,rr(y)),s2=e=>s0("onKeyboardHandler",e,rr(ea.none)),s3=e=>s0("onHandler",e,ro()),s5=e=>s0("onKeyboardHandler",e,ro()),s9=(e,t)=>n4(e,k(t)),s4=e=>n4(e,C),s6=k(sJ),s8=(e,t,o,n,r,a,i,l=!1)=>({x:e,y:t,bubble:o,direction:n,placement:r,restriction:a,label:`${i}-${r}`,alwaysFit:l}),s7=aw.generate([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),ce=(e,t,o,n,r,a,i,l,s)=>e.fold(t,o,n,r,a,i,l,s),ct=(e,t,o,n)=>e.fold(t,t,n,n,t,n,o,o),co=(e,t,o,n)=>e.fold(t,n,t,n,o,o,t,n),cn=s7.southeast,cr=s7.southwest,ca=s7.northeast,ci=s7.northwest,cl=s7.south,cs=s7.north,cc=s7.east,cd=s7.west,cu=(e,t,o,n)=>{let r=e+t;return r>n?o:r<o?n:r},cm=(e,t,o)=>Math.min(Math.max(e,t),o),cg=(e,t)=>{switch(t){case 1:return e.x;case 0:return e.x+e.width;case 2:return e.y;case 3:return e.y+e.height}},cp=(e,t)=>eA(["left","right","top","bottom"],o=>eY(t,o).map(t=>cg(e,t))),ch=(e,t,o)=>{let n=(n,r)=>t[n].map(t=>{let a="top"===n||"bottom"===n,i=a?o.top:o.left,l=("left"===n||"top"===n?Math.max:Math.min)(t,r)+i;return a?cm(l,e.y,e.bottom):cm(l,e.x,e.right)}).getOr(r),r=n("left",e.x),a=n("top",e.y),i=n("right",e.right),l=n("bottom",e.bottom);return nL(r,a,i-r,l-a)},cf="layout",cb=e=>e.x,cv=(e,t)=>e.x+e.width/2-t.width/2,cy=(e,t)=>e.x+e.width-t.width,cx=(e,t)=>e.y-t.height,cw=e=>e.y+e.height,cS=(e,t)=>e.y+e.height/2-t.height/2,ck=e=>e.x+e.width,cC=(e,t)=>e.x-t.width,cO=(e,t,o)=>s8(cb(e),cw(e),o.southeast(),cn(),"southeast",cp(e,{left:1,top:3}),cf),c_=(e,t,o)=>s8(cy(e,t),cw(e),o.southwest(),cr(),"southwest",cp(e,{right:0,top:3}),cf),cT=(e,t,o)=>s8(cb(e),cx(e,t),o.northeast(),ca(),"northeast",cp(e,{left:1,bottom:2}),cf),cE=(e,t,o)=>s8(cy(e,t),cx(e,t),o.northwest(),ci(),"northwest",cp(e,{right:0,bottom:2}),cf),cD=(e,t,o)=>s8(cv(e,t),cx(e,t),o.north(),cs(),"north",cp(e,{bottom:2}),cf),cA=(e,t,o)=>s8(cv(e,t),cw(e),o.south(),cl(),"south",cp(e,{top:3}),cf),cM=(e,t,o)=>s8(ck(e),cS(e,t),o.east(),cc(),"east",cp(e,{left:0}),cf),cB=(e,t,o)=>s8(cC(e,t),cS(e,t),o.west(),cd(),"west",cp(e,{right:1}),cf),cF=()=>[cO,c_,cT,cE,cA,cD,cM,cB],cI=()=>[c_,cO,cE,cT,cA,cD,cM,cB],cR=()=>[cT,cE,cO,c_,cD,cA],cN=()=>[cE,cT,c_,cO,cD,cA],cV=()=>[cO,c_,cT,cE,cA,cD],cH=()=>[c_,cO,cE,cT,cA,cD],cz=(e,t)=>t.universal?e:ey(e,e=>eu(t.channels,e)),cL=e=>iI([iV(ir(),(t,o)=>{let n=e.channels,r=eH(n),a=cz(r,o);ef(a,e=>{let r=n[e],a=r.schema,i=rJ("channel["+e+"] data\nReceiver: "+i3(t.element),a,o.data);r.onReceive(t,i)})})]);var cP=Object.freeze({__proto__:null,events:cL}),cU=[r2("channels",rq(nq.value,rA([s3("onReceive"),ad("schema",rN())])))];let cW=(e,t,o)=>iK(n=>{o(n,e,t)}),cj=(e,t,o)=>iX((n,r)=>{o(n,e,t)}),cG=(e,t,o,n,r,a)=>{let i=rA(e),l=as(t,[ac("config",e)]);return cK(i,l,t,o,n,r,a)},c$=(e,t,o,n,r,a)=>{let i=as(t,[ao("config",e)]);return cK(e,i,t,o,n,r,a)},cq=(e,t,o)=>{let n=(n,...r)=>{let a=[n].concat(r);return n.config({name:k(e)}).fold(()=>{throw Error("We could not find any behaviour configuration for: "+e+". Using API: "+o)},e=>{let o=Array.prototype.slice.call(a,1);return t.apply(void 0,[n,e.config,e.state].concat(o))})};return lc(n,o,t)},cX=e=>({key:e,value:void 0}),cK=(e,t,o,n,r,a,i)=>{let l=e=>eZ(e,o)?e[o]():ea.none(),s=eP(r,(e,t)=>cq(o,e,t)),c=eP(a,(e,t)=>lu(e,t)),d={...c,...s,revoke:_(cX,o),config:t=>{let n=rJ(o+"-config",e,t);return{key:o,value:{config:n,me:d,configAsRaw:oR(()=>rJ(o+"-config",e,t)),initialConfig:t,state:i}}},schema:k(t),exhibit:(e,t)=>e3(l(e),eY(n,"exhibit"),(e,o)=>o(t,e.config,e.state)).getOrThunk(()=>lC({})),name:k(o),handlers:e=>l(e).map(e=>{let t=eY(n,"events").getOr(()=>({}));return t(e.config,e.state)}).getOr({})};return d},cY=e=>aE(e),cJ=rA([r1("fields"),r1("name"),ad("active",{}),ad("apis",{}),ad("state",lv),ad("extra",{})]),cZ=e=>{let t=rJ("Creating behaviour: "+e.name,cJ,e);return cG(t.fields,t.name,t.active,t.apis,t.extra,t.state)},cQ=rA([r1("branchKey"),r1("branches"),r1("name"),ad("active",{}),ad("apis",{}),ad("state",lv),ad("extra",{})]),c0=e=>{let t=rJ("Creating behaviour: "+e.name,cQ,e);return c$(rQ(t.branchKey,t.branches),t.name,t.active,t.apis,t.extra,t.state)},c1=k(void 0),c2=cZ({fields:cU,name:"receiving",active:cP}),c3=(e,t)=>lC({classes:[],styles:t.useFixed()?{}:{position:"relative"}});var c5=Object.freeze({__proto__:null,exhibit:c3});let c9=e=>e.dom.focus(),c4=e=>e.dom.blur(),c6=e=>{let t=t0(e).dom;return e.dom===t.activeElement},c8=(e=nM())=>ea.from(e.dom.activeElement).map(tp.fromDom),c7=e=>c8(t0(e)).filter(t=>e.dom.contains(t.dom)),de=(e,t)=>{let o=t0(t),n=c8(o).bind(e=>{let o=t=>tN(e,t);return o(t)?ea.some(t):sD(t,o)}),r=e(t);return n.each(e=>{c8(o).filter(t=>tN(t,e)).fold(()=>{c9(e)},y)}),r},dt=(e,t,o,n,r)=>{let a=e=>e+"px";return{position:e,left:t.map(a),top:o.map(a),right:n.map(a),bottom:r.map(a)}},dn=e=>({...e,position:ea.some(e.position)}),dr=(e,t)=>{om(e,dn(t))},da=aw.generate([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),di=(e,t,o,n,r,a)=>{let i=t.rect,l=i.x-o,s=i.y-n,c=i.width,d=i.height,u=ea.some(l),m=ea.some(s),g=ea.some(r-(l+c)),p=ea.some(a-(s+d)),h=ea.none();return ce(t.direction,()=>dt(e,u,m,h,h),()=>dt(e,h,m,g,h),()=>dt(e,u,h,h,p),()=>dt(e,h,h,g,p),()=>dt(e,u,m,h,h),()=>dt(e,u,h,h,p),()=>dt(e,u,m,h,h),()=>dt(e,h,m,g,h))},dl=(e,t)=>e.fold(()=>{let e=t.rect;return dt("absolute",ea.some(e.x),ea.some(e.y),ea.none(),ea.none())},(e,o,n,r)=>di("absolute",t,e,o,n,r),(e,o,n,r)=>di("fixed",t,e,o,n,r)),ds=(e,t)=>{let o=_(nV,t),n=e.fold(o,o,()=>{let e=n_();return nV(t).translate(-e.left,-e.top)}),r=oF(t),a=ok(t);return nL(n.left,n.top,r,a)},dc=(e,t)=>t.fold(()=>e.fold(nW,nW,nL),t=>e.fold(t,t,()=>{let o=t(),n=dd(e,o.x,o.y);return nL(n.left,n.top,o.width,o.height)})),dd=(e,t,o)=>{let n=oO(t,o),r=()=>{let e=n_();return n.translate(-e.left,-e.top)};return e.fold(k(n),k(n),r)},du=(e,t,o,n)=>e.fold(t,o,n);da.none;let dm=da.relative,dg=da.fixed,dp=(e,t)=>({anchorBox:e,origin:t}),dh=(e,t)=>dp(e,t),df="data-alloy-placement",db=(e,t)=>{ot(e,df,t)},dv=e=>or(e,df),dy=e=>oi(e,df),dx=aw.generate([{fit:["reposition"]},{nofit:["reposition","visibleW","visibleH","isVisible"]}]),dw=(e,t)=>{let{x:o,y:n,right:r,bottom:a}=t,{x:i,y:l,right:s,bottom:c,width:d,height:u}=e;return{originInBounds:i>=o&&i<=r&&l>=n&&l<=a,sizeInBounds:s<=r&&s>=o&&c<=a&&c>=n,visibleW:Math.min(d,i>=o?r-i:s-o),visibleH:Math.min(u,l>=n?a-l:c-n)}},dS=(e,t)=>{let{x:o,y:n,right:r,bottom:a}=t,{x:i,y:l,width:s,height:c}=e,d=cm(i,o,Math.max(o,r-s)),u=cm(l,n,Math.max(n,a-c));return nL(d,u,Math.min(d+s,r)-d,Math.min(u+c,a)-u)},dk=(e,t,o)=>{let n=k(t.bottom-o.y),r=k(o.bottom-t.y),a=ct(e,r,r,n),i=k(t.right-o.x),l=k(o.right-t.x),s=co(e,l,l,i);return{maxWidth:s,maxHeight:a}},dC=(e,t,o,n)=>{let r=e.bubble,a=r.offset,i=ch(n,e.restriction,a),l=e.x+a.left,s=e.y+a.top,c=nL(l,s,t,o),{originInBounds:d,sizeInBounds:u,visibleW:m,visibleH:g}=dw(c,i),p=d&&u,h=p?c:dS(c,i),f=h.width>0&&h.height>0,{maxWidth:b,maxHeight:v}=dk(e.direction,h,n),y={rect:h,maxHeight:v,maxWidth:b,direction:e.direction,placement:e.placement,classes:{on:r.classesOn,off:r.classesOff},layout:e.label,testY:s};return p||e.alwaysFit?dx.fit(y):dx.nofit(y,m,g,f)},dO=(e,t,o,n,r,a)=>{let i=n.width,l=n.height,s=(t,s,c,d,u)=>{let m=t(o,n,r,e,a),g=dC(m,i,l,a);return g.fold(k(g),(e,t,o,n)=>(u===n?o>d||t>c:!u&&n)?g:dx.nofit(s,c,d,u))},c=ew(t,(e,t)=>{let o=_(s,t);return e.fold(k(e),o)},dx.nofit({rect:o,maxHeight:n.height,maxWidth:n.width,direction:cn(),placement:"southeast",classes:{on:[],off:[]},layout:"none",testY:o.y},-1,-1,!1));return c.fold(C,C)},d_=e=>{let t=ay(ea.none()),o=()=>t.get().each(e),n=()=>{o(),t.set(ea.none())},r=()=>t.get().isSome(),a=()=>t.get(),i=e=>{o(),t.set(ea.some(e))};return{clear:n,isSet:r,get:a,set:i}},dT=()=>d_(e=>e.destroy()),dE=()=>d_(e=>e.unbind()),dD=()=>{let e=d_(y),t=t=>e.get().each(t);return{...e,on:t}},dA=(e,t,o)=>nh(e,t,M,o),dM=(e,t,o)=>nf(e,t,M,o),dB=["top","bottom","right","left"],dF="data-alloy-transition-timer",dI=(e,t)=>l9(e,t.classes),dR=(e,t,o)=>o.exists(o=>{let n=e.mode;return"all"===n||o[n]!==t[n]}),dN=(e,t)=>{let o=e=>parseFloat(e).toFixed(3);return eX(t,(t,n)=>{let r=e[n].map(o),a=t.map(o);return!e0(r,a)}).isSome()},dV=e=>{let t=t=>{let o=og(e,t),n=o.split(/\s*,\s*/);return ey(n,ti)},o=e=>{if(!(l(e)&&/^[\d.]+/.test(e)))return 0;{let t=parseFloat(e);return tr(e,"ms")?t:1e3*t}},n=t("transition-delay"),r=t("transition-duration");return ew(r,(e,t,r)=>{let a=o(n[r])+o(t);return Math.max(e,a)},0)},dH=(e,t)=>{let o;let n=dE(),r=dE(),a=t=>{var o;let n=null!==(o=t.raw.pseudoElement)&&void 0!==o?o:"";return tN(t.target,e)&&tl(n)&&eu(dB,t.raw.propertyName)},i=i=>{if(p(i)||a(i)){n.clear(),r.clear();let a=null==i?void 0:i.raw.type;(p(a)||a===a9())&&(clearTimeout(o),oi(e,dF),l5(e,t.classes))}},l=dA(e,a4(),t=>{a(t)&&(l.unbind(),n.set(dA(e,a9(),i)),r.set(dA(e,a5(),i)))}),s=dV(e);requestAnimationFrame(()=>{o=setTimeout(i,s+17),ot(e,dF,o)})},dz=(e,t)=>{l3(e,t.classes),or(e,dF).each(t=>{clearTimeout(parseInt(t,10)),oi(e,dF)}),dH(e,t)},dL=(e,t,o,n,r,a)=>{let i=dR(n,r,a);if(i||dI(e,n)){od(e,"position",o.position);let a=ds(t,e),l=dl(t,{...r,rect:a}),s=eA(dB,e=>l[e]);dN(o,s)&&(om(e,s),i&&dz(e,n),oy(e))}else l5(e,n.classes)},dP=e=>({width:oF(e),height:ok(e)}),dU=(e,t,o,n)=>{ov(t,"max-height"),ov(t,"max-width");let r=dP(t);return dO(t,n.preference,e,r,o,n.bounds)},dW=(e,t)=>{let o=t.classes;l5(e,o.off),l3(e,o.on)},dj=(e,t,o)=>{let n=o.maxHeightFunction;n(e,t.maxHeight)},dG=(e,t,o)=>{let n=o.maxWidthFunction;n(e,t.maxWidth)},d$=(e,t,o)=>{let n=dl(o.origin,t);o.transition.each(r=>{dL(e,o.origin,n,r,t,o.lastPlacement)}),dr(e,n)},dq=(e,t)=>{db(e,t.placement)},dX=(e,t)=>{oC(e,Math.floor(t))},dK=k((e,t)=>{dX(e,t),ou(e,{"overflow-x":"hidden","overflow-y":"auto"})}),dY=k((e,t)=>{dX(e,t)}),dJ=(e,t,o)=>void 0===e[t]?o:e[t],dZ=(e,t,o,n,r,a,i,l)=>{let s=dJ(i,"maxHeightFunction",dK()),c=dJ(i,"maxWidthFunction",y),d=e.anchorBox,u=e.origin,m={bounds:dc(u,a),origin:u,preference:n,maxHeightFunction:s,maxWidthFunction:c,lastPlacement:r,transition:l};return dQ(d,t,o,m)},dQ=(e,t,o,n)=>{let r=dU(e,t,o,n);return d$(t,r,n),dq(t,r),dW(t,r),dj(t,r,n),dG(t,r,n),{layout:r.layout,placement:r.placement}},d0=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right","inset"],d1=(e,t,o,n=1)=>{let r=e*n,a=t*n,i=e=>eY(o,e).getOr([]),l=(e,t,o)=>{let n=eD(d0,o);return{offset:oO(e,t),classesOn:e_(o,i),classesOff:e_(n,i)}};return{southeast:()=>l(-e,t,["top","alignLeft"]),southwest:()=>l(e,t,["top","alignRight"]),south:()=>l(-e/2,t,["top","alignCentre"]),northeast:()=>l(-e,-t,["bottom","alignLeft"]),northwest:()=>l(e,-t,["bottom","alignRight"]),north:()=>l(-e/2,-t,["bottom","alignCentre"]),east:()=>l(e,-t/2,["valignCentre","left"]),west:()=>l(-e,-t/2,["valignCentre","right"]),insetNortheast:()=>l(r,a,["top","alignLeft","inset"]),insetNorthwest:()=>l(-r,a,["top","alignRight","inset"]),insetNorth:()=>l(-r/2,a,["top","alignCentre","inset"]),insetSoutheast:()=>l(r,-a,["bottom","alignLeft","inset"]),insetSouthwest:()=>l(-r,-a,["bottom","alignRight","inset"]),insetSouth:()=>l(-r/2,-a,["bottom","alignCentre","inset"]),insetEast:()=>l(-r,-a/2,["valignCentre","right","inset"]),insetWest:()=>l(r,-a/2,["valignCentre","left","inset"])}},d2=()=>d1(0,0,{}),d3=(e,t)=>o=>"rtl"===d5(o)?t:e,d5=e=>"rtl"===og(e,"direction")?"rtl":"ltr";(V=K||(K={})).TopToBottom="toptobottom",V.BottomToTop="bottomtotop";let d9="data-alloy-vertical-dir",d4=e=>sA(e,e=>tT(e)&&on(e,"data-alloy-vertical-dir")===K.BottomToTop),d6=()=>as("layouts",[r1("onLtr"),r1("onRtl"),at("onBottomLtr"),at("onBottomRtl")]),d8=(e,t,o,n,r,a,i)=>{let l=i.map(d4).getOr(!1),s=t.layouts.map(t=>t.onLtr(e)),c=t.layouts.map(t=>t.onRtl(e)),d=l?t.layouts.bind(t=>t.onBottomLtr.map(t=>t(e))).or(s).getOr(r):s.getOr(o),u=l?t.layouts.bind(t=>t.onBottomRtl.map(t=>t(e))).or(c).getOr(a):c.getOr(n),m=d3(d,u);return m(e)},d7=(e,t,o)=>{let n=t.hotspot,r=ds(o,n.element),a=d8(e.element,t,cV(),cH(),cR(),cN(),ea.some(t.hotspot.element));return ea.some(C({anchorBox:r,bubble:t.bubble.getOr(d2()),overrides:t.overrides,layouts:a,placer:ea.none()}))};var ue=[r1("hotspot"),at("bubble"),ad("overrides",{}),d6(),s9("placement",d7)];let ut=(e,t,o)=>{let n=dd(o,t.x,t.y),r=nL(n.left,n.top,t.width,t.height),a=d8(e.element,t,cF(),cI(),cF(),cI(),ea.none());return ea.some(C({anchorBox:r,bubble:t.bubble,overrides:t.overrides,layouts:a,placer:ea.none()}))};var uo=[r1("x"),r1("y"),ad("height",0),ad("width",0),ad("bubble",d2()),ad("overrides",{}),d6(),s9("placement",ut)];let un=aw.generate([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),ur=e=>e.fold(C,(e,t,o)=>e.translate(-t,-o)),ua=e=>e.fold(C,C),ui=e=>ew(e,(e,t)=>e.translate(t.left,t.top),oO(0,0)),ul=e=>{let t=eh(e,ur);return ui(t)},us=e=>{let t=eh(e,ua);return ui(t)},uc=un.screen,ud=un.absolute,uu=(e,t,o)=>{let n=tP(o.root).dom,r=t=>{let o=tH(t),n=tH(e.element);return tN(o,n)};return ea.from(n.frameElement).map(tp.fromDom).filter(r).map(oE)},um=(e,t,o)=>{let n=tH(e.element),r=n_(n),a=uu(e,t,o).getOr(r);return ud(a,r.left,r.top)},ug=(e,t,o,n)=>{let r=uc(oO(e,t));return ea.some(nH(r,o,n))},up=(e,t,o,n,r)=>e.map(e=>{let a=[t,e.point],i=du(n,()=>us(a),()=>us(a),()=>ul(a)),l=nz(i.left,i.top,e.width,e.height),s=o.showAbove?cR():cV(),c=o.showAbove?cN():cH(),d=d8(r,o,s,c,s,c,ea.none());return C({anchorBox:l,bubble:o.bubble.getOr(d2()),overrides:o.overrides,layouts:d,placer:ea.none()})}),uh=(e,t,o)=>{let n=um(e,o,t);return t.node.filter(t6).bind(r=>{let a=r.dom.getBoundingClientRect(),i=ug(a.left,a.top,a.width,a.height),l=t.node.getOr(e.element);return up(i,n,t,o,l)})};var uf=[r1("node"),r1("root"),at("bubble"),d6(),ad("overrides",{}),ad("showAbove",!1),s9("placement",uh)];let ub=(e,t,o,n)=>({start:e,soffset:t,finish:o,foffset:n}),uv={create:ub},uy=aw.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),ux=(e,t,o,n)=>e.fold(t,o,n),uw=e=>e.fold(C,C,C),uS=uy.before,uk=uy.on,uC=uy.after,uO={before:uS,on:uk,after:uC,cata:ux,getStart:uw},u_=aw.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),uT=e=>u_.exact(e.start,e.soffset,e.finish,e.foffset),uE=e=>e.match({domRange:e=>tp.fromDom(e.startContainer),relative:(e,t)=>uO.getStart(e),exact:(e,t,o,n)=>e}),uD=u_.domRange,uA=u_.relative,uM=u_.exact,uB=e=>{let t=uE(e);return tP(t)},uF=uv.create,uI={domRange:uD,relative:uA,exact:uM,exactFromRange:uT,getWin:uB,range:uF},uR=(e,t)=>{t.fold(t=>{e.setStartBefore(t.dom)},(t,o)=>{e.setStart(t.dom,o)},t=>{e.setStartAfter(t.dom)})},uN=(e,t)=>{t.fold(t=>{e.setEndBefore(t.dom)},(t,o)=>{e.setEnd(t.dom,o)},t=>{e.setEndAfter(t.dom)})},uV=(e,t,o)=>{let n=e.document.createRange();return uR(n,t),uN(n,o),n},uH=(e,t,o,n,r)=>{let a=e.document.createRange();return a.setStart(t.dom,o),a.setEnd(n.dom,r),a},uz=e=>({left:e.left,top:e.top,right:e.right,bottom:e.bottom,width:e.width,height:e.height}),uL=e=>{let t=e.getClientRects(),o=t.length>0?t[0]:e.getBoundingClientRect();return o.width>0||o.height>0?ea.some(o).map(uz):ea.none()},uP=e=>{let t=e.getBoundingClientRect();return t.width>0||t.height>0?ea.some(t).map(uz):ea.none()},uU=aw.generate([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),uW=(e,t,o)=>t(tp.fromDom(o.startContainer),o.startOffset,tp.fromDom(o.endContainer),o.endOffset),uj=(e,t)=>t.match({domRange:e=>({ltr:k(e),rtl:ea.none}),relative:(t,o)=>({ltr:oR(()=>uV(e,t,o)),rtl:oR(()=>ea.some(uV(e,o,t)))}),exact:(t,o,n,r)=>({ltr:oR(()=>uH(e,t,o,n,r)),rtl:oR(()=>ea.some(uH(e,n,r,t,o)))})}),uG=(e,t)=>{let o=t.ltr();if(!o.collapsed)return uW(e,uU.ltr,o);{let n=t.rtl().filter(e=>!1===e.collapsed);return n.map(e=>uU.rtl(tp.fromDom(e.endContainer),e.endOffset,tp.fromDom(e.startContainer),e.startOffset)).getOrThunk(()=>uW(e,uU.ltr,o))}},u$=(e,t)=>{let o=uj(e,t);return uG(e,o)},uq=(e,t)=>{let o=u$(e,t);return o.match({ltr:(t,o,n,r)=>{let a=e.document.createRange();return a.setStart(t.dom,o),a.setEnd(n.dom,r),a},rtl:(t,o,n,r)=>{let a=e.document.createRange();return a.setStart(n.dom,r),a.setEnd(t.dom,o),a}})};uU.ltr,uU.rtl;let uX=(e,t)=>tI(t,e),uK=(e,t,o,n)=>{let r=tH(e),a=r.dom.createRange();return a.setStart(e.dom,t),a.setEnd(o.dom,n),a},uY=(e,t,o,n)=>{let r=uK(e,t,o,n),a=tN(e,o)&&t===n;return r.collapsed&&!a},uJ=e=>ea.from(e.getSelection()),uZ=e=>{if(!(e.rangeCount>0))return ea.none();{let t=e.getRangeAt(0),o=e.getRangeAt(e.rangeCount-1);return ea.some(uv.create(tp.fromDom(t.startContainer),t.startOffset,tp.fromDom(o.endContainer),o.endOffset))}},uQ=e=>{if(null===e.anchorNode||null===e.focusNode)return uZ(e);{let t=tp.fromDom(e.anchorNode),o=tp.fromDom(e.focusNode);return uY(t,e.anchorOffset,o,e.focusOffset)?ea.some(uv.create(t,e.anchorOffset,o,e.focusOffset)):uZ(e)}},u0=e=>uJ(e).filter(e=>e.rangeCount>0).bind(uQ),u1=(e,t)=>{let o=uq(e,t);return uL(o)},u2=(e,t)=>{let o=uq(e,t);return uP(o)},u3=((e,t)=>{let o=o=>{if(!e(o))throw Error("Can only get "+t+" value of a "+t+" node");return n(o).getOr("")},n=t=>e(t)?ea.from(t.dom.nodeValue):ea.none(),r=(o,n)=>{if(!e(o))throw Error("Can only set raw "+t+" value of a "+t+" node");o.dom.nodeValue=n};return{get:o,getOption:n,set:r}})(tE,"text"),u5=e=>u3.get(e),u9=(e,t)=>({element:e,offset:t}),u4=(e,t)=>{let o=t$(e);if(0===o.length)return u9(e,t);if(t<o.length)return u9(o[t],0);{let e=o[o.length-1],t=tE(e)?u5(e).length:t$(e).length;return u9(e,t)}},u6=(e,t)=>tE(e)?u9(e,t):u4(e,t),u8=(e,t)=>{let o=t.getSelection.getOrThunk(()=>()=>u0(e));return o().map(e=>{let t=u6(e.start,e.soffset),o=u6(e.finish,e.foffset);return uI.range(t.element,t.offset,o.element,o.offset)})},u7=(e,t,o)=>{let n=tP(t.root).dom,r=um(e,o,t),a=u8(n,t).bind(e=>{let t=u2(n,uI.exactFromRange(e)).orThunk(()=>{let t=tp.fromText("\uFEFF");nv(e.start,t);let o=u1(n,uI.exact(t,0,t,1));return nO(t),o});return t.bind(e=>ug(e.left,e.top,e.width,e.height))}),i=u8(n,t).bind(e=>tT(e.start)?ea.some(e.start):tW(e.start)),l=i.getOr(e.element);return up(a,r,t,o,l)};var me=[at("getSelection"),r1("root"),at("bubble"),d6(),ad("overrides",{}),ad("showAbove",!1),s9("placement",u7)];let mt="link-layout",mo=e=>e.x+e.width,mn=(e,t)=>e.x-t.width,mr=(e,t)=>e.y-t.height+e.height,ma=e=>e.y,mi=(e,t,o)=>s8(mo(e),ma(e),o.southeast(),cn(),"southeast",cp(e,{left:0,top:2}),mt),ml=(e,t,o)=>s8(mn(e,t),ma(e),o.southwest(),cr(),"southwest",cp(e,{right:1,top:2}),mt),ms=(e,t,o)=>s8(mo(e),mr(e,t),o.northeast(),ca(),"northeast",cp(e,{left:0,bottom:3}),mt),mc=(e,t,o)=>s8(mn(e,t),mr(e,t),o.northwest(),ci(),"northwest",cp(e,{right:1,bottom:3}),mt),md=()=>[mi,ml,ms,mc],mu=()=>[ml,mi,mc,ms],mm=(e,t,o)=>{let n=ds(o,t.item.element),r=d8(e.element,t,md(),mu(),md(),mu(),ea.none());return ea.some(C({anchorBox:n,bubble:d2(),overrides:t.overrides,layouts:r,placer:ea.none()}))};var mg=rQ("type",{selection:me,node:uf,hotspot:ue,submenu:[r1("item"),d6(),ad("overrides",{}),s9("placement",mm)],makeshift:uo});let mp=[ae("classes",rz),ap("mode","all",["all","layout","placement"])],mh=[ad("useFixed",A),at("getBounds")],mf=[r2("anchor",mg),as("transition",mp)],mb=()=>{let e=document.documentElement;return dg(0,0,e.clientWidth,e.clientHeight)},mv=e=>{let t=oE(e.element),o=e.element.dom.getBoundingClientRect();return dm(t.left,t.top,o.width,o.height)},my=(e,t,o,n,r,a,i)=>{let l=dh(o.anchorBox,t);return dZ(l,r.element,o.bubble,o.layouts,a,n,o.overrides,i)},mx=(e,t,o,n,r)=>{mw(e,t,o,n,r,ea.none())},mw=(e,t,o,n,r,a)=>{let i=a.map(nP);return mS(e,t,o,n,r,i)},mS=(e,t,o,n,r,a)=>{let i=rJ("placement.info",rM(mf),r),l=i.anchor,s=n.element,c=o.get(n.uid);de(()=>{od(s,"position","fixed");let r=oh(s,"visibility");od(s,"visibility","hidden");let d=t.useFixed()?mb():mv(e),u=l.placement,m=a.map(k).or(t.getBounds);u(e,l,d).each(t=>{let r=t.placer.getOr(my),a=r(e,d,t,m,n,c,i.transition);o.set(n.uid,a)}),r.fold(()=>{ov(s,"visibility")},e=>{od(s,"visibility",e)}),oh(s,"left").isNone()&&oh(s,"top").isNone()&&oh(s,"right").isNone()&&oh(s,"bottom").isNone()&&eQ(oh(s,"position"),"fixed")&&ov(s,"position")},s)},mk=(e,t,o)=>t.useFixed()?"fixed":"absolute",mC=(e,t,o,n)=>{let r=n.element;ef(["position","left","right","top","bottom"],e=>ov(r,e)),dy(r),o.clear(n.uid)};var mO=Object.freeze({__proto__:null,position:mx,positionWithin:mw,positionWithinBounds:mS,getMode:mk,reset:mC});let m_=()=>{let e={},t=(t,o)=>{e[t]=o},o=t=>eY(e,t),n=t=>{h(t)?delete e[t]:e={}};return ly({readState:()=>e,clear:n,set:t,get:o})};var mT=Object.freeze({__proto__:null,init:m_});let mE=cZ({fields:mh,name:"positioning",active:c5,apis:mO,state:mT}),mD=e=>e.getSystem().isConnected(),mA=e=>{iT(e,iv());let t=e.components();ef(t,mA)},mM=e=>{let t=e.components();ef(t,mM),iT(e,ib())},mB=(e,t)=>{e.getSystem().addToWorld(t),t6(e.element)&&mM(t)},mF=e=>{mA(e),e.getSystem().removeFromWorld(e)},mI=(e,t)=>{nw(e.element,t.element)},mR=e=>{ef(e.components(),e=>nO(e.element)),nC(e.element),e.syncComponents()},mN=(e,t,o)=>{let n=e.components();mR(e);let r=o(t),a=eD(n,r);ef(a,t=>{mA(t),e.getSystem().removeFromWorld(t)}),ef(r,t=>{mD(t)?mI(e,t):(e.getSystem().addToWorld(t),mI(e,t),t6(e.element)&&mM(t))}),e.syncComponents()},mV=(e,t,o)=>{let n=e.components(),r=e_(t,e=>lf(e).toArray());ef(n,e=>{eu(r,e)||mF(e)});let a=o(t),i=eD(n,a);ef(i,e=>{mD(e)&&mF(e)}),ef(a,t=>{mD(t)||mB(e,t)}),e.syncComponents()},mH=(e,t)=>{mz(e,t,nw)},mz=(e,t,o)=>{e.getSystem().addToWorld(t),o(e.element,t.element),t6(e.element)&&mM(t),e.syncComponents()},mL=e=>{mA(e),nO(e.element),e.getSystem().removeFromWorld(e)},mP=e=>{let t=tU(e.element).bind(t=>e.getSystem().getByDom(t).toOptional());mL(e),t.each(e=>{e.syncComponents()})},mU=e=>{let t=e.components();ef(t,mL),nC(e.element),e.syncComponents()},mW=(e,t)=>{mG(e,t,nw)},mj=(e,t)=>{mG(e,t,ny)},mG=(e,t,o)=>{o(e,t.element);let n=t$(t.element);ef(n,e=>{t.getByDom(e).each(mM)})},m$=e=>{let t=t$(e.element);ef(t,t=>{e.getByDom(t).each(mA)}),nO(e.element)},mq=(e,t,o,n)=>{o.get().each(t=>{mU(e)});let r=t.getAttachPoint(e);mH(r,e);let a=e.getSystem().build(n);return mH(e,a),o.set(a),a},mX=(e,t,o,n)=>{let r=mq(e,t,o,n);return t.onOpen(e,r),r},mK=(e,t,o,n)=>o.get().map(()=>mq(e,t,o,n)),mY=(e,t,o,n,r)=>{m3(e,t),mX(e,t,o,n),r(),m9(e,t)},mJ=(e,t,o)=>{o.get().each(n=>{mU(e),mP(e),t.onClose(e,n),o.clear()})},mZ=(e,t,o)=>o.isOpen(),mQ=(e,t,o,n)=>mZ(e,t,o)&&o.get().exists(o=>t.isPartOf(e,o,n)),m0=(e,t,o)=>o.get(),m1=(e,t,o,n)=>{oh(e.element,t).fold(()=>{oi(e.element,o)},t=>{ot(e.element,o,t)}),od(e.element,t,n)},m2=(e,t,o)=>{or(e.element,o).fold(()=>ov(e.element,t),o=>od(e.element,t,o))},m3=(e,t,o)=>{let n=t.getAttachPoint(e);od(e.element,"position",mE.getMode(n)),m1(e,"visibility",t.cloakVisibilityAttr,"hidden")},m5=e=>em(["top","left","right","bottom"],t=>oh(e,t).isSome()),m9=(e,t,o)=>{m5(e.element)||ov(e.element,"position"),m2(e,"visibility",t.cloakVisibilityAttr)};var m4=Object.freeze({__proto__:null,cloak:m3,decloak:m9,open:mX,openWhileCloaked:mY,close:mJ,isOpen:mZ,isPartOf:mQ,getState:m0,setContent:mK});let m6=(e,t)=>iI([iV(ic(),(o,n)=>{mJ(o,e,t)})]);var m8=Object.freeze({__proto__:null,events:m6}),m7=[s1("onOpen"),s1("onClose"),r1("isPartOf"),r1("getAttachPoint"),ad("cloakVisibilityAttr","data-precloak-visibility")];let ge=()=>{let e=dD(),t=k("not-implemented");return ly({readState:t,isOpen:e.isSet,clear:e.clear,set:e.set,get:e.get})};var gt=Object.freeze({__proto__:null,init:ge});let go=cZ({fields:m7,name:"sandboxing",active:m8,apis:m4,state:gt}),gn=k("dismiss.popups"),gr=k("reposition.popups"),ga=k("mouse.released"),gi=rA([ad("isExtraPart",A),as("fireEventInstead",[ad("event",iy())])]),gl=e=>{let t=rJ("Dismissal",gi,e);return{[gn()]:{schema:rA([r1("target")]),onReceive:(e,o)=>{if(go.isOpen(e)){let n=go.isPartOf(e,o.target)||t.isExtraPart(e,o.target);n||t.fireEventInstead.fold(()=>go.close(e),t=>iT(e,t.event))}}}}},gs=rA([as("fireEventInstead",[ad("event",ix())]),r4("doReposition")]),gc=e=>{let t=rJ("Reposition",gs,e);return{[gr()]:{onReceive:e=>{go.isOpen(e)&&t.fireEventInstead.fold(()=>t.doReposition(e),t=>iT(e,t.event))}}}},gd=(e,t,o)=>{t.store.manager.onLoad(e,t,o)},gu=(e,t,o)=>{t.store.manager.onUnload(e,t,o)},gm=(e,t,o,n)=>{t.store.manager.setValue(e,t,o,n)},gg=(e,t,o)=>t.store.manager.getValue(e,t,o);var gp=Object.freeze({__proto__:null,onLoad:gd,onUnload:gu,setValue:gm,getValue:gg,getState:(e,t,o)=>o});let gh=(e,t)=>{let o=e.resetOnDom?[i$((o,n)=>{gd(o,e,t)}),iq((o,n)=>{gu(o,e,t)})]:[cj(e,t,gd)];return iI(o)};var gf=Object.freeze({__proto__:null,events:gh});let gb=()=>{let e=ay(null),t=()=>({mode:"memory",value:e.get()}),o=()=>null===e.get(),n=()=>{e.set(null)};return ly({set:e.set,get:e.get,isNotSet:o,clear:n,readState:t})},gv=()=>ly({readState:y}),gy=()=>{let e=ay({}),t=ay({}),o=()=>({mode:"dataset",dataByValue:e.get(),dataByText:t.get()}),n=()=>{e.set({}),t.set({})},r=o=>eY(e.get(),o).orThunk(()=>eY(t.get(),o)),a=o=>{let n=e.get(),r=t.get(),a={},i={};ef(o,e=>{a[e.value]=e,eY(e,"meta").each(t=>{eY(t,"text").each(t=>{i[t]=e})})}),e.set({...n,...a}),t.set({...r,...i})};return ly({readState:o,lookup:r,update:a,clear:n})},gx=e=>e.store.manager.state(e);var gw=Object.freeze({__proto__:null,memory:gb,dataset:gy,manual:gv,init:gx});let gS=(e,t,o,n)=>{let r=t.store;o.update([n]),r.setValue(e,n),t.onSetValue(e,n)},gk=(e,t,o)=>{let n=t.store,r=n.getDataKey(e);return o.lookup(r).getOrThunk(()=>n.getFallbackEntry(r))},gC=(e,t,o)=>{let n=t.store;n.initialValue.each(n=>{gS(e,t,o,n)})},gO=(e,t,o)=>{o.clear()};var g_=[at("initialValue"),r1("getFallbackEntry"),r1("getDataKey"),r1("setValue"),s9("manager",{setValue:gS,getValue:gk,onLoad:gC,onUnload:gO,state:gy})];let gT=(e,t,o)=>t.store.getValue(e),gE=(e,t,o,n)=>{t.store.setValue(e,n),t.onSetValue(e,n)},gD=(e,t,o)=>{t.store.initialValue.each(o=>{t.store.setValue(e,o)})};var gA=[r1("getValue"),ad("setValue",y),at("initialValue"),s9("manager",{setValue:gE,getValue:gT,onLoad:gD,onUnload:y,state:lv.init})];let gM=(e,t,o,n)=>{o.set(n),t.onSetValue(e,n)},gB=(e,t,o)=>o.get(),gF=(e,t,o)=>{t.store.initialValue.each(e=>{o.isNotSet()&&o.set(e)})},gI=(e,t,o)=>{o.clear()};var gR=[au("store",{mode:"memory"},rQ("mode",{memory:[at("initialValue"),s9("manager",{setValue:gM,getValue:gB,onLoad:gF,onUnload:gI,state:gb})],manual:gA,dataset:g_})),s1("onSetValue"),ad("resetOnDom",!1)];let gN=cZ({fields:gR,name:"representing",active:gf,apis:gp,extra:{setValueFrom:(e,t)=>{let o=gN.getValue(t);gN.setValue(e,o)}},state:gw}),gV=(e,t)=>av(e,{},eh(t,t=>r6(t.name(),"Cannot configure "+t.name()+" for "+e)).concat([n4("dump",C)])),gH=e=>e.dump,gz=(e,t)=>({...cY(t),...e.dump}),gL={field:gV,augment:gz,get:gH},gP="placeholder",gU=aw.generate([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),gW=e=>eJ(e,"uiType"),gj=(e,t,o,n)=>e.exists(e=>e!==o.owner)?gU.single(!0,k(o)):eY(n,o.name).fold(()=>{throw Error("Unknown placeholder component: "+o.name+"\nKnown: ["+eH(n)+"]\nNamespace: "+e.getOr("none")+"\nSpec: "+JSON.stringify(o,null,2))},e=>e.replace()),gG=(e,t,o,n)=>gW(o)&&o.uiType===gP?gj(e,t,o,n):gU.single(!1,k(o)),g$=(e,t,o,n)=>{let r=gG(e,t,o,n);return r.fold((r,a)=>{let i=gW(o)?a(t,o.config,o.validated):a(t),l=eY(i,"components").getOr([]),s=e_(l,o=>g$(e,t,o,n));return[{...i,components:s}]},(e,n)=>{if(!gW(o))return n(t);{let e=n(t,o.config,o.validated),r=o.validated.preprocess.getOr(C);return r(e)}})},gq=(e,t,o,n)=>e_(o,o=>g$(e,t,o,n)),gX=(e,t)=>{let o=!1,n=()=>{if(o)throw Error("Trying to use the same placeholder more than once: "+e);return o=!0,t},r=()=>t.fold((e,t)=>e,(e,t)=>e);return{name:k(e),required:r,used:()=>o,replace:n}},gK=(e,t,o,n)=>{let r=eP(n,(e,t)=>gX(t,e)),a=gq(e,t,o,r);return eL(r,o=>{if(!1===o.used()&&o.required())throw Error("Placeholder: "+o.name()+" was not found in components list\nNamespace: "+e.getOr("none")+"\nComponents: "+JSON.stringify(t.components,null,2))}),a},gY=gU.single,gJ=gU.multiple,gZ=k(gP),gQ=aw.generate([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),g0=ad("factory",{sketch:C}),g1=ad("schema",[]),g2=r1("name"),g3=n9("pname","pname",rn(e=>"<alloy."+i8(e.name)+">"),rN()),g5=n4("schema",()=>[at("preprocess")]),g9=ad("defaults",k({})),g4=ad("overrides",k({})),g6=rM([g0,g1,g2,g3,g9,g4]),g8=rM([g0,g1,g2,g9,g4]),g7=rM([g0,g1,g2,g3,g9,g4]),pe=rM([g0,g5,g2,r1("unit"),g3,g9,g4]),pt=e=>e.fold(ea.some,ea.none,ea.some,ea.some),po=e=>{let t=e=>e.name;return e.fold(t,t,t,t)},pn=e=>e.fold(C,C,C,C),pr=(e,t)=>o=>{let n=rJ("Converting part type",t,o);return e(n)},pa=pr(gQ.required,g6),pi=pr(gQ.external,g8),pl=pr(gQ.optional,g7),ps=pr(gQ.group,pe),pc=k("entirety");var pd=Object.freeze({__proto__:null,required:pa,external:pi,optional:pl,group:ps,asNamedPart:pt,name:po,asCommon:pn,original:pc});let pu=(e,t,o,n)=>re(t.defaults(e,o,n),o,{uid:e.partUids[t.name]},t.overrides(e,o,n)),pm=(e,t,o)=>{let n={},r={};return ef(o,e=>{e.fold(e=>{n[e.pname]=gY(!0,(t,o,n)=>e.factory.sketch(pu(t,e,o,n)))},e=>{let o=t.parts[e.name];r[e.name]=k(e.factory.sketch(pu(t,e,o[pc()]),o))},e=>{n[e.pname]=gY(!1,(t,o,n)=>e.factory.sketch(pu(t,e,o,n)))},e=>{n[e.pname]=gJ(!0,(t,o,n)=>{let r=t[e.name];return eh(r,o=>e.factory.sketch(re(e.defaults(t,o,n),o,e.overrides(t,o))))})})}),{internals:k(n),externals:k(r)}},pg=(e,t)=>{let o={};return ef(t,t=>{pt(t).each(t=>{let n=pp(e,t.pname);o[t.name]=o=>{let r=rJ("Part: "+t.name+" in "+e,rM(t.schema),o);return{...n,config:o,validated:r}}})}),o},pp=(e,t)=>({uiType:gZ(),owner:e,name:t}),ph=(e,t,o)=>({uiType:gZ(),owner:e,name:t,config:o,validated:{}}),pf=e=>e_(e,e=>e.fold(ea.none,ea.some,ea.none,ea.none).map(e=>r8(e.name,e.schema.concat([s4(pc())]))).toArray()),pb=e=>eh(e,po),pv=(e,t,o)=>pm(e,t,o),py=(e,t,o)=>gK(ea.some(e),t,t.components,o),px=(e,t,o)=>{let n=t.partUids[o];return e.getSystem().getByUid(n).toOptional()},pw=(e,t,o)=>px(e,t,o).getOrDie("Could not find part: "+o),pS=(e,t,o)=>{let n={},r=t.partUids,a=e.getSystem();return ef(o,e=>{n[e]=k(a.getByUid(r[e]))}),n},pk=(e,t)=>{let o=e.getSystem();return eP(t.partUids,(e,t)=>k(o.getByUid(e)))},pC=e=>eH(e.partUids),pO=(e,t,o)=>{let n={},r=t.partUids,a=e.getSystem();return ef(o,e=>{n[e]=k(a.getByUid(r[e]).getOrDie())}),n},p_=(e,t)=>{let o=pb(t);return aE(eh(o,t=>({key:t,value:e+"-"+t})))},pT=e=>n9("partUids","partUids",ri(t=>p_(t.uid,e)),rN());var pE=Object.freeze({__proto__:null,generate:pg,generateOne:ph,schemas:pf,names:pb,substitutes:pv,components:py,defaultUids:p_,defaultUidsSchema:pT,getAllParts:pk,getAllPartNames:pC,getPart:px,getPartOrDie:pw,getParts:pS,getPartsOrDie:pO});let pD=(e,t)=>{let o=e.length>0?[r8("parts",e)]:[];return o.concat([r1("uid"),ad("dom",{}),ad("components",[]),s4("originalSpec"),ad("debug.sketcher",{})]).concat(t)},pA=(e,t,o,n,r)=>{let a=pD(n,r);return rJ(e+" [SpecSchema]",rA(a.concat(t)),o)},pM=(e,t,o,n)=>{let r=pI(n),a=pA(e,t,r,[],[]);return o(a,r)},pB=(e,t,o,n,r)=>{let a=pI(r),i=pf(o),l=pT(o),s=pA(e,t,a,i,[l]),c=pv(e,s,o),d=py(e,s,c.internals());return n(s,d,a,c.externals())},pF=e=>eJ(e,"uid"),pI=e=>pF(e)?e:{...e,uid:li("uid")},pR=e=>void 0!==e.uid,pN=rA([r1("name"),r1("factory"),r1("configFields"),ad("apis",{}),ad("extraApis",{})]),pV=rA([r1("name"),r1("factory"),r1("configFields"),r1("partFields"),ad("apis",{}),ad("extraApis",{})]),pH=e=>{let t=rJ("Sketcher for "+e.name,pN,e),o=e=>pM(t.name,t.configFields,t.factory,e),n=eP(t.apis,lb),r=eP(t.extraApis,(e,t)=>lu(e,t));return{name:t.name,configFields:t.configFields,sketch:o,...n,...r}},pz=e=>{let t=rJ("Sketcher for "+e.name,pV,e),o=e=>pB(t.name,t.configFields,t.partFields,t.factory,e),n=pg(t.name,t.partFields),r=eP(t.apis,lb),a=eP(t.extraApis,(e,t)=>lu(e,t));return{name:t.name,partFields:t.partFields,configFields:t.configFields,sketch:o,parts:n,...r,...a}},pL=e=>tM("input")(e)&&"radio"!==on(e,"type")||tM("textarea")(e),pP=(e,t,o)=>t.find(e);var pU=Object.freeze({__proto__:null,getCurrent:pP});let pW=[r1("find")],pj=cZ({fields:pW,name:"composing",apis:pU}),pG=["input","button","textarea","select"],p$=(e,t,o)=>{let n=t.disabled()?p0:p1;n(e,t)},pq=(e,t)=>!0===t.useNative&&eu(pG,tk(e.element)),pX=e=>oa(e.element,"disabled"),pK=e=>{ot(e.element,"disabled","disabled")},pY=e=>{oi(e.element,"disabled")},pJ=e=>"true"===on(e.element,"aria-disabled"),pZ=e=>{ot(e.element,"aria-disabled","true")},pQ=e=>{ot(e.element,"aria-disabled","false")},p0=(e,t,o)=>{t.disableClass.each(t=>{lQ(e.element,t)});let n=pq(e,t)?pK:pZ;n(e),t.onDisabled(e)},p1=(e,t,o)=>{t.disableClass.each(t=>{l1(e.element,t)});let n=pq(e,t)?pY:pQ;n(e),t.onEnabled(e)},p2=(e,t)=>pq(e,t)?pX(e):pJ(e),p3=(e,t,o,n)=>{(n?p0:p1)(e,t)};var p5=Object.freeze({__proto__:null,enable:p1,disable:p0,isDisabled:p2,onLoad:p$,set:p3});let p9=(e,t)=>lC({classes:t.disabled()?t.disableClass.toArray():[]}),p4=(e,t)=>iI([iR(ia(),(t,o)=>p2(t,e)),cj(e,t,p$)]);var p6=Object.freeze({__proto__:null,exhibit:p9,events:p4}),p8=[af("disabled",A),ad("useNative",!0),at("disableClass"),s1("onDisabled"),s1("onEnabled")];let p7=cZ({fields:p8,name:"disabling",active:p6,apis:p5}),he=(e,t,o,n)=>{let r=uX(e.element,"."+t.highlightClass);ef(r,o=>{let r=em(n,e=>tN(e.element,o));r||(l1(o,t.highlightClass),e.getSystem().getByDom(o).each(o=>{t.onDehighlight(e,o),iT(o,i_())}))})},ht=(e,t,o)=>he(e,t,o,[]),ho=(e,t,o,n)=>{hs(e,t,o,n)&&(l1(n.element,t.highlightClass),t.onDehighlight(e,n),iT(n,i_()))},hn=(e,t,o,n)=>{he(e,t,o,[n]),hs(e,t,o,n)||(lQ(n.element,t.highlightClass),t.onHighlight(e,n),iT(n,iO()))},hr=(e,t,o)=>{hu(e,t).each(n=>{hn(e,t,o,n)})},ha=(e,t,o)=>{hm(e,t).each(n=>{hn(e,t,o,n)})},hi=(e,t,o,n)=>{hd(e,t,o,n).fold(e=>{throw e},n=>{hn(e,t,o,n)})},hl=(e,t,o,n)=>{let r=hf(e,t),a=ek(r,n);a.each(n=>{hn(e,t,o,n)})},hs=(e,t,o,n)=>l2(n.element,t.highlightClass),hc=(e,t,o)=>sF(e.element,"."+t.highlightClass).bind(t=>e.getSystem().getByDom(t).toOptional()),hd=(e,t,o,n)=>{let r=uX(e.element,"."+t.itemClass);return ea.from(r[n]).fold(()=>nq.error(Error("No element found with index "+n)),e.getSystem().getByDom)},hu=(e,t,o)=>sF(e.element,"."+t.itemClass).bind(t=>e.getSystem().getByDom(t).toOptional()),hm=(e,t,o)=>{let n=uX(e.element,"."+t.itemClass),r=n.length>0?ea.some(n[n.length-1]):ea.none();return r.bind(t=>e.getSystem().getByDom(t).toOptional())},hg=(e,t,o,n)=>{let r=uX(e.element,"."+t.itemClass),a=eC(r,e=>l2(e,t.highlightClass));return a.bind(t=>{let o=cu(t,n,0,r.length-1);return e.getSystem().getByDom(r[o]).toOptional()})},hp=(e,t,o)=>hg(e,t,o,-1),hh=(e,t,o)=>hg(e,t,o,1),hf=(e,t,o)=>{let n=uX(e.element,"."+t.itemClass);return e1(eh(n,t=>e.getSystem().getByDom(t).toOptional()))};var hb=Object.freeze({__proto__:null,dehighlightAll:ht,dehighlight:ho,highlight:hn,highlightFirst:hr,highlightLast:ha,highlightAt:hi,highlightBy:hl,isHighlighted:hs,getHighlighted:hc,getFirst:hu,getLast:hm,getPrevious:hp,getNext:hh,getCandidates:hf}),hv=[r1("highlightClass"),r1("itemClass"),s1("onHighlight"),s1("onDehighlight")];let hy=cZ({fields:hv,name:"highlighting",apis:hb}),hx=[9],hw=[13],hS=[27],hk=[32],hC=[37],hO=[38],h_=[39],hT=[40],hE=(e,t,o)=>{let n=eE(e.slice(0,t)),r=eE(e.slice(t+1));return ek(n.concat(r),o)},hD=(e,t,o)=>{let n=eE(e.slice(0,t));return ek(n,o)},hA=(e,t,o)=>{let n=e.slice(0,t),r=e.slice(t+1);return ek(r.concat(n),o)},hM=(e,t,o)=>{let n=e.slice(t+1);return ek(n,o)},hB=e=>t=>{let o=t.raw;return eu(e,o.which)},hF=e=>t=>eT(e,e=>e(t)),hI=e=>{let t=e.raw;return!0===t.shiftKey},hR=e=>{let t=e.raw;return!0===t.ctrlKey},hN=T(hI),hV=(e,t)=>({matches:e,classification:t}),hH=(e,t)=>{let o=ek(e,e=>e.matches(t));return o.map(e=>e.classification)},hz=(e,t,o)=>{let n=t.exists(e=>o.exists(t=>tN(t,e)));n||iE(e,iw(),{prevFocus:t,newFocus:o})},hL=()=>{let e=e=>c7(e.element),t=(t,o)=>{let n=e(t);t.getSystem().triggerFocus(o,t.element);let r=e(t);hz(t,n,r)};return{get:e,set:t}},hP=()=>{let e=e=>hy.getHighlighted(e).map(e=>e.element),t=(t,o)=>{let n=e(t);t.getSystem().getByDom(o).fold(y,e=>{hy.highlight(t,e)});let r=e(t);hz(t,n,r)};return{get:e,set:t}};(H=Y||(Y={})).OnFocusMode="onFocus",H.OnEnterOrSpaceMode="onEnterOrSpace",H.OnApiMode="onApi";let hU=(e,t,o,n,r)=>{let a=()=>e.concat([ad("focusManager",hL()),au("focusInside","onFocus",r$(e=>eu(["onFocus","onEnterOrSpace","onApi"],e)?nq.value(e):nq.error("Invalid value for focusInside"))),s9("handler",s),s9("state",t),s9("sendFocusIn",r)]),i=(e,t,o,n,r)=>{let a=o(e,t,n,r);return hH(a,t.event).bind(o=>o(e,t,n,r))},l=(e,t)=>{let a=e.focusInside!==Y.OnFocusMode?ea.none():r(e).map(o=>iV(ie(),(n,r)=>{o(n,e,t),r.stop()})),l=(o,n)=>{let a=hB(hk.concat(hw))(n.event);e.focusInside===Y.OnEnterOrSpaceMode&&a&&aR(o,n)&&r(e).each(r=>{r(o,e,t),n.stop()})},s=[iV(aQ(),(n,r)=>{i(n,r,o,e,t).fold(()=>{l(n,r)},e=>{r.stop()})}),iV(a0(),(o,r)=>{i(o,r,n,e,t).each(e=>{r.stop()})})];return iI(a.toArray().concat(s))},s={schema:a,processKey:i,toEvents:l};return s},hW=e=>{let t=[at("onEscape"),at("onEnter"),ad("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),ad("firstTabstop",0),ad("useTabstopAt",M),at("visibilitySelector")].concat([e]),o=(e,t)=>{let o=e.visibilitySelector.bind(e=>sI(t,e)).getOr(t);return oS(o)>0},n=(e,t)=>{let n=uX(e.element,t.selector),r=ey(n,e=>o(t,e));return ea.from(r[t.firstTabstop])},r=(e,t)=>t.focusManager.get(e).bind(e=>sI(e,t.selector)),a=(e,t)=>o(e,t)&&e.useTabstopAt(t),i=(e,t,o)=>{n(e,t).each(o=>{t.focusManager.set(e,o)})},l=(e,t,o,n,r)=>r(t,o,e=>a(n,e)).fold(()=>n.cyclic?ea.some(!0):ea.none(),t=>(n.focusManager.set(e,t),ea.some(!0))),s=(e,t,o,n)=>{let a=uX(e.element,o.selector);return r(e,o).bind(t=>{let r=eC(a,_(tN,t));return r.bind(t=>l(e,a,t,o,n))})},c=(e,t,o)=>{let n=o.cyclic?hE:hD;return s(e,t,o,n)},d=(e,t,o)=>{let n=o.cyclic?hA:hM;return s(e,t,o,n)},u=(e,t,o)=>o.onEnter.bind(o=>o(e,t)),m=(e,t,o)=>o.onEscape.bind(o=>o(e,t)),g=k([hV(hF([hI,hB(hx)]),c),hV(hB(hx),d),hV(hF([hN,hB(hw)]),u)]),p=k([hV(hB(hS),m)]);return hU(t,lv.init,g,p,()=>ea.some(i))};var hj=hW(n4("cyclic",A)),hG=hW(n4("cyclic",M));let h$=(e,t,o)=>(iA(e,o,ia()),ea.some(!0)),hq=(e,t,o)=>{let n=pL(o)&&hB(hk)(t.event);return n?ea.none():h$(e,t,o)},hX=(e,t)=>ea.some(!0),hK=[ad("execute",hq),ad("useSpace",!1),ad("useEnter",!0),ad("useControlEnter",!1),ad("useDown",!1)],hY=(e,t,o)=>o.execute(e,t,e.element),hJ=(e,t,o,n)=>{let r=o.useSpace&&!pL(e.element)?hk:[],a=o.useEnter?hw:[],i=o.useDown?hT:[],l=r.concat(a).concat(i);return[hV(hB(l),hY)].concat(o.useControlEnter?[hV(hF([hR,hB(hw)]),hY)]:[])},hZ=(e,t,o,n)=>o.useSpace&&!pL(e.element)?[hV(hB(hk),hX)]:[];var hQ=hU(hK,lv.init,hJ,hZ,()=>ea.none());let h0=()=>{let e=dD(),t=(t,o)=>{e.set({numRows:t,numColumns:o})},o=()=>e.get().map(e=>e.numRows),n=()=>e.get().map(e=>e.numColumns);return ly({readState:()=>e.get().map(e=>({numRows:String(e.numRows),numColumns:String(e.numColumns)})).getOr({numRows:"?",numColumns:"?"}),setGridSize:t,getNumRows:o,getNumColumns:n})},h1=e=>e.state(e);var h2=Object.freeze({__proto__:null,flatgrid:h0,init:h1});let h3=e=>(t,o,n,r)=>{let a=e(t.element);return h6(a,t,o,n,r)},h5=(e,t)=>{let o=d3(e,t);return h3(o)},h9=(e,t)=>{let o=d3(t,e);return h3(o)},h4=e=>(t,o,n,r)=>h6(e,t,o,n,r),h6=(e,t,o,n,r)=>{let a=n.focusManager.get(t).bind(o=>e(t.element,o,n,r));return a.map(e=>(n.focusManager.set(t,e),!0))},h8=e=>e.offsetWidth<=0&&e.offsetHeight<=0,h7=e=>!h8(e.dom),fe=(e,t)=>eC(e,t).map(t=>({index:t,candidates:e})),ft=(e,t,o)=>{let n=e=>tN(e,t),r=uX(e,o),a=ey(r,h7);return fe(a,n)},fo=(e,t)=>eC(e,e=>tN(t,e)),fn=(e,t,o,n)=>n(Math.floor(t/o),t%o).bind(t=>{let n=t.row*o+t.column;return n>=0&&n<e.length?ea.some(e[n]):ea.none()}),fr=(e,t,o,n,r)=>fn(e,t,n,(t,a)=>{let i=t===o-1?e.length-t*n:n,l=cu(a,r,0,i-1);return ea.some({row:t,column:l})}),fa=(e,t,o,n,r)=>fn(e,t,n,(t,a)=>{let i=cu(t,r,0,o-1),l=i===o-1?e.length-i*n:n,s=cm(a,0,l-1);return ea.some({row:i,column:s})}),fi=(e,t,o,n)=>fr(e,t,o,n,1),fl=(e,t,o,n)=>fr(e,t,o,n,-1),fs=(e,t,o,n)=>fa(e,t,o,n,-1),fc=(e,t,o,n)=>fa(e,t,o,n,1),fd=[r1("selector"),ad("execute",hq),s2("onEscape"),ad("captureTab",!1),s6()],fu=(e,t,o)=>{sF(e.element,t.selector).each(o=>{t.focusManager.set(e,o)})},fm=(e,t)=>t.focusManager.get(e).bind(e=>sI(e,t.selector)),fg=(e,t,o,n)=>fm(e,o).bind(n=>o.execute(e,t,n)),fp=e=>(t,o,n,r)=>ft(t,o,n.selector).bind(t=>e(t.candidates,t.index,r.getNumRows().getOr(n.initSize.numRows),r.getNumColumns().getOr(n.initSize.numColumns))),fh=(e,t,o)=>o.captureTab?ea.some(!0):ea.none(),ff=(e,t,o)=>o.onEscape(e,t),fb=fp(fl),fv=fp(fi),fy=fp(fs),fx=fp(fc),fw=k([hV(hB(hC),h5(fb,fv)),hV(hB(h_),h9(fb,fv)),hV(hB(hO),h4(fy)),hV(hB(hT),h4(fx)),hV(hF([hI,hB(hx)]),fh),hV(hF([hN,hB(hx)]),fh),hV(hB(hk.concat(hw)),fg)]),fS=k([hV(hB(hS),ff),hV(hB(hk),hX)]);var fk=hU(fd,h0,fw,fS,()=>ea.some(fu));let fC=(e,t,o,n)=>{let r=e=>"button"===tk(e)&&"disabled"===on(e,"disabled"),a=(e,t,o)=>{let i=cu(t,n,0,o.length-1);return i===e?ea.none():r(o[i])?a(e,i,o):ea.from(o[i])};return ft(e,o,t).bind(e=>{let t=e.index,o=e.candidates;return a(t,t,o)})},fO=[r1("selector"),ad("getInitial",ea.none),ad("execute",hq),s2("onEscape"),ad("executeOnMove",!1),ad("allowVertical",!0)],f_=(e,t)=>t.focusManager.get(e).bind(e=>sI(e,t.selector)),fT=(e,t,o)=>f_(e,o).bind(n=>o.execute(e,t,n)),fE=(e,t,o)=>{t.getInitial(e).orThunk(()=>sF(e.element,t.selector)).each(o=>{t.focusManager.set(e,o)})},fD=(e,t,o)=>fC(e,o.selector,t,-1),fA=(e,t,o)=>fC(e,o.selector,t,1),fM=e=>(t,o,n,r)=>e(t,o,n,r).bind(()=>n.executeOnMove?fT(t,o,n):ea.some(!0)),fB=(e,t,o)=>o.onEscape(e,t),fF=(e,t,o,n)=>{let r=hC.concat(o.allowVertical?hO:[]),a=h_.concat(o.allowVertical?hT:[]);return[hV(hB(r),fM(h5(fD,fA))),hV(hB(a),fM(h9(fD,fA))),hV(hB(hw),fT),hV(hB(hk),fT)]},fI=k([hV(hB(hk),hX),hV(hB(hS),fB)]);var fR=hU(fO,lv.init,fF,fI,()=>ea.some(fE));let fN=(e,t,o)=>ea.from(e[t]).bind(e=>ea.from(e[o]).map(e=>({rowIndex:t,columnIndex:o,cell:e}))),fV=(e,t,o,n)=>{let r=e[t],a=r.length,i=cu(o,n,0,a-1);return fN(e,t,i)},fH=(e,t,o,n)=>{let r=cu(o,n,0,e.length-1),a=e[r].length,i=cm(t,0,a-1);return fN(e,r,i)},fz=(e,t,o,n)=>{let r=e[t],a=r.length,i=cm(o+n,0,a-1);return fN(e,t,i)},fL=(e,t,o,n)=>{let r=cm(o+n,0,e.length-1),a=e[r].length,i=cm(t,0,a-1);return fN(e,r,i)},fP=(e,t,o)=>fV(e,t,o,1),fU=(e,t,o)=>fV(e,t,o,-1),fW=(e,t,o)=>fH(e,o,t,-1),fj=(e,t,o)=>fH(e,o,t,1),fG=(e,t,o)=>fz(e,t,o,-1),f$=(e,t,o)=>fz(e,t,o,1),fq=(e,t,o)=>fL(e,o,t,-1),fX=(e,t,o)=>fL(e,o,t,1),fK=[r8("selectors",[r1("row"),r1("cell")]),ad("cycles",!0),ad("previousSelector",ea.none),ad("execute",hq)],fY=(e,t,o)=>{let n=t.previousSelector(e).orThunk(()=>{let o=t.selectors;return sF(e.element,o.cell)});n.each(o=>{t.focusManager.set(e,o)})},fJ=(e,t,o)=>c7(e.element).bind(n=>o.execute(e,t,n)),fZ=(e,t)=>eh(e,e=>uX(e,t.selectors.cell)),fQ=(e,t)=>(o,n,r)=>{let a=r.cycles?e:t;return sI(n,r.selectors.row).bind(e=>{let t=uX(e,r.selectors.cell);return fo(t,n).bind(t=>{let n=uX(o,r.selectors.row);return fo(n,e).bind(e=>{let o=fZ(n,r);return a(o,e,t).map(e=>e.cell)})})})},f0=fQ(fU,fG),f1=fQ(fP,f$),f2=fQ(fW,fq),f3=fQ(fj,fX),f5=k([hV(hB(hC),h5(f0,f1)),hV(hB(h_),h9(f0,f1)),hV(hB(hO),h4(f2)),hV(hB(hT),h4(f3)),hV(hB(hk.concat(hw)),fJ)]),f9=k([hV(hB(hk),hX)]);var f4=hU(fK,lv.init,f5,f9,()=>ea.some(fY));let f6=[r1("selector"),ad("execute",hq),ad("moveOnTab",!1)],f8=(e,t,o)=>o.focusManager.get(e).bind(n=>o.execute(e,t,n)),f7=(e,t,o)=>{sF(e.element,t.selector).each(o=>{t.focusManager.set(e,o)})},be=(e,t,o)=>fC(e,o.selector,t,-1),bt=(e,t,o)=>fC(e,o.selector,t,1),bo=(e,t,o,n)=>o.moveOnTab?h4(be)(e,t,o,n):ea.none(),bn=(e,t,o,n)=>o.moveOnTab?h4(bt)(e,t,o,n):ea.none(),br=k([hV(hB(hO),h4(be)),hV(hB(hT),h4(bt)),hV(hF([hI,hB(hx)]),bo),hV(hF([hN,hB(hx)]),bn),hV(hB(hw),f8),hV(hB(hk),f8)]),ba=k([hV(hB(hk),hX)]);var bi=hU(f6,lv.init,br,ba,()=>ea.some(f7));let bl=[s2("onSpace"),s2("onEnter"),s2("onShiftEnter"),s2("onLeft"),s2("onRight"),s2("onTab"),s2("onShiftTab"),s2("onUp"),s2("onDown"),s2("onEscape"),ad("stopSpaceKeyup",!1),at("focusIn")],bs=(e,t,o)=>[hV(hB(hk),o.onSpace),hV(hF([hN,hB(hw)]),o.onEnter),hV(hF([hI,hB(hw)]),o.onShiftEnter),hV(hF([hI,hB(hx)]),o.onShiftTab),hV(hF([hN,hB(hx)]),o.onTab),hV(hB(hO),o.onUp),hV(hB(hT),o.onDown),hV(hB(hC),o.onLeft),hV(hB(h_),o.onRight),hV(hB(hk),o.onSpace)],bc=(e,t,o)=>[...o.stopSpaceKeyup?[hV(hB(hk),hX)]:[],hV(hB(hS),o.onEscape)];var bd=hU(bl,lv.init,bs,bc,e=>e.focusIn);let bu=hj.schema(),bm=hG.schema(),bg=fR.schema(),bp=fk.schema(),bh=f4.schema(),bf=hQ.schema(),bb=bi.schema(),bv=bd.schema();var by=Object.freeze({__proto__:null,acyclic:bu,cyclic:bm,flow:bg,flatgrid:bp,matrix:bh,execution:bf,menu:bb,special:bv});let bx=e=>eZ(e,"setGridSize"),bw=c0({branchKey:"mode",branches:by,name:"keying",active:{events:(e,t)=>{let o=e.handler;return o.toEvents(e,t)}},apis:{focusIn:(e,t,o)=>{t.sendFocusIn(t).fold(()=>{e.getSystem().triggerFocus(e.element,e.element)},n=>{n(e,t,o)})},setGridSize:(e,t,o,n,r)=>{bx(o)?o.setGridSize(n,r):console.error("Layout does not support setGridSize")}},state:h2}),bS=(e,t)=>{de(()=>{mN(e,t,()=>eh(t,e.getSystem().build))},e.element)},bk=(e,t)=>{de(()=>{mV(e,t,()=>sr(e.element,t,e.getSystem().buildOrPatch))},e.element)},bC=(e,t,o,n)=>{mF(t);let r=sn(e.element,o,n,e.getSystem().buildOrPatch);mB(e,r),e.syncComponents()},bO=(e,t,o)=>{let n=e.getSystem().build(o);mz(e,n,t)},b_=(e,t,o,n)=>{mP(t),bO(e,(e,t)=>nS(e,t,o),n)},bT=(e,t,o,n)=>{let r=t.reuseDom?bk:bS;return r(e,n)},bE=(e,t,o,n)=>{bO(e,nw,n)},bD=(e,t,o,n)=>{bO(e,nx,n)},bA=(e,t,o,n)=>{let r=bM(e),a=ek(r,e=>tN(n.element,e.element));a.each(mP)},bM=(e,t)=>e.components(),bB=(e,t,o,n,r)=>{let a=bM(e);return ea.from(a[n]).map(o=>(r.fold(()=>mP(o),r=>{let a=t.reuseDom?bC:b_;a(e,o,n,r)}),o))},bF=(e,t,o,n,r)=>{let a=bM(e);return eC(a,n).bind(n=>bB(e,t,o,n,r))};var bI=Object.freeze({__proto__:null,append:bE,prepend:bD,remove:bA,replaceAt:bB,replaceBy:bF,set:bT,contents:bM});let bR=cZ({fields:[ah("reuseDom",!0)],name:"replacing",apis:bI}),bN=(e,t)=>{let o=iI(t);return cZ({fields:[r1("enabled")],name:e,active:{events:k(o)}})},bV=(e,t)=>{let o=bN(e,t);return{key:e,value:{config:{},me:o,configAsRaw:k({}),initialConfig:{},state:lv}}},bH=(e,t)=>{t.ignore||(c9(e.element),t.onFocus(e))},bz=(e,t)=>{t.ignore||c4(e.element)},bL=e=>c6(e.element);var bP=Object.freeze({__proto__:null,focus:bH,blur:bz,isFocused:bL});let bU=(e,t)=>{let o=t.ignore?{}:{attributes:{tabindex:"-1"}};return lC(o)},bW=e=>iI([iV(ie(),(t,o)=>{bH(t,e),o.stop()})].concat(e.stopMousedown?[iV(a$(),(e,t)=>{t.event.prevent()})]:[]));var bj=Object.freeze({__proto__:null,exhibit:bU,events:bW}),bG=[s1("onFocus"),ad("stopMousedown",!1),ad("ignore",!1)];let b$=cZ({fields:bG,name:"focusing",active:bj,apis:bP}),bq=(e,t,o)=>{let n=t.aria;n.update(e,n,o.get())},bX=(e,t,o)=>{t.toggleClass.each(t=>{o.get()?lQ(e.element,t):l1(e.element,t)})},bK=(e,t,o,n)=>{let r=o.get();o.set(n),bX(e,t,o),bq(e,t,o),r!==n&&t.onToggled(e,n)},bY=(e,t,o)=>{bK(e,t,o,!o.get())},bJ=(e,t,o)=>{bK(e,t,o,!0)},bZ=(e,t,o)=>{bK(e,t,o,!1)},bQ=(e,t,o)=>o.get(),b0=(e,t,o)=>{bK(e,t,o,t.selected)};var b1=Object.freeze({__proto__:null,onLoad:b0,toggle:bY,isOn:bQ,on:bJ,off:bZ,set:bK});let b2=()=>lC({}),b3=(e,t)=>{let o=cW(e,t,bY),n=cj(e,t,b0);return iI(eO([e.toggleOnExecute?[o]:[],[n]]))};var b5=Object.freeze({__proto__:null,exhibit:b2,events:b3});let b9=(e,t,o)=>{ot(e.element,"aria-pressed",o),t.syncWithExpanded&&b8(e,t,o)},b4=(e,t,o)=>{ot(e.element,"aria-selected",o)},b6=(e,t,o)=>{ot(e.element,"aria-checked",o)},b8=(e,t,o)=>{ot(e.element,"aria-expanded",o)};var b7=[ad("selected",!1),at("toggleClass"),ad("toggleOnExecute",!0),s1("onToggled"),au("aria",{mode:"none"},rQ("mode",{pressed:[ad("syncWithExpanded",!1),s9("update",b9)],checked:[s9("update",b6)],expanded:[s9("update",b8)],selected:[s9("update",b4)],none:[s9("update",y)]}))];let ve=cZ({fields:b7,name:"toggling",active:b5,apis:b1,state:(e=>{let t=()=>{let t=ay(e),o=()=>t.get(),n=e=>t.set(e),r=()=>t.set(e),a=()=>t.get();return{get:o,set:n,clear:r,readState:a}};return{init:t}})(!1)}),vt=()=>{let e=(e,t)=>{t.stop(),iD(e)};return[iV(a3(),e),iV(il(),e),iW(aU()),iW(a$())]},vo=e=>{let t=e=>iK((t,o)=>{e(t),o.stop()});return iI(eO([e.map(t).toArray(),vt()]))},vn="alloy.item-hover",vr="alloy.item-focus",va="alloy.item-toggled",vi=e=>{(c7(e.element).isNone()||b$.isFocused(e))&&(b$.isFocused(e)||b$.focus(e),iE(e,vn,{item:e}))},vl=e=>{iE(e,vr,{item:e})},vs=(e,t)=>{iE(e,va,{item:e,state:t})},vc=k(vn),vd=k(vr),vu=k(va),vm=e=>e.toggling.map(e=>e.exclusive?"menuitemradio":"menuitemcheckbox").getOr("menuitem"),vg=e=>({aria:{mode:"checked"},...e$(e,(e,t)=>"exclusive"!==t),onToggled:(t,o)=>{f(e.onToggled)&&e.onToggled(t,o),vs(t,o)}}),vp=e=>({dom:e.dom,domModification:{...e.domModification,attributes:{role:vm(e),...e.domModification.attributes,"aria-haspopup":e.hasSubmenu,...e.hasSubmenu?{"aria-expanded":!1}:{}}},behaviours:gL.augment(e.itemBehaviours,[e.toggling.fold(ve.revoke,e=>ve.config(vg(e))),b$.config({ignore:e.ignoreFocus,stopMousedown:e.ignoreFocus,onFocus:e=>{vl(e)}}),bw.config({mode:"execution"}),gN.config({store:{mode:"memory",initialValue:e.data}}),bV("item-type-events",[...vt(),iV(aY(),vi),iV(ii(),b$.focus)])]),components:e.components,eventOrder:e.eventOrder}),vh=[r1("data"),r1("components"),r1("dom"),ad("hasSubmenu",!1),at("toggling"),gL.field("itemBehaviours",[ve,b$,bw,gN]),ad("ignoreFocus",!1),ad("domModification",{}),s9("builder",vp),ad("eventOrder",{})],vf=e=>({dom:e.dom,components:e.components,events:iI([ij(ii())])}),vb=[r1("dom"),r1("components"),s9("builder",vf)],vv=k("item-widget"),vy=k([pa({name:"widget",overrides:e=>({behaviours:cY([gN.config({store:{mode:"manual",getValue:t=>e.data,setValue:y}})])})})]),vx=e=>{let t=pv(vv(),e,vy()),o=py(vv(),e,t.internals()),n=t=>px(t,e,"widget").map(e=>(bw.focusIn(e),e)),r=(t,o)=>(pL(o.event.target)||e.autofocus&&o.setSource(t.element),ea.none());return{dom:e.dom,components:o,domModification:e.domModification,events:iI([iK((e,t)=>{n(e).each(e=>{t.stop()})}),iV(aY(),vi),iV(ii(),(t,o)=>{e.autofocus?n(t):b$.focus(t)})]),behaviours:gL.augment(e.widgetBehaviours,[gN.config({store:{mode:"memory",initialValue:e.data}}),b$.config({ignore:e.ignoreFocus,onFocus:e=>{vl(e)}}),bw.config({mode:"special",focusIn:e.autofocus?e=>{n(e)}:c1(),onLeft:r,onRight:r,onEscape:(t,o)=>b$.isFocused(t)||e.autofocus?(e.autofocus&&o.setSource(t.element),ea.none()):(b$.focus(t),ea.some(!0))})])}},vw=[r1("uid"),r1("data"),r1("components"),r1("dom"),ad("autofocus",!1),ad("ignoreFocus",!1),gL.field("widgetBehaviours",[gN,b$,bw]),ad("domModification",{}),pT(vy()),s9("builder",vx)],vS=rQ("type",{widget:vw,item:vh,separator:vb}),vk=(e,t)=>({mode:"flatgrid",selector:"."+e.markers.item,initSize:{numColumns:t.initSize.numColumns,numRows:t.initSize.numRows},focusManager:e.focusManager}),vC=(e,t)=>({mode:"matrix",selectors:{row:t.rowSelector,cell:"."+e.markers.item},previousSelector:t.previousSelector,focusManager:e.focusManager}),vO=(e,t)=>({mode:"menu",selector:"."+e.markers.item,moveOnTab:t.moveOnTab,focusManager:e.focusManager}),v_=k([ps({factory:{sketch:e=>{let t=rJ("menu.spec item",vS,e);return t.builder(t)}},name:"items",unit:"item",defaults:(e,t)=>eJ(t,"uid")?t:{...t,uid:li("item")},overrides:(e,t)=>({type:t.type,ignoreFocus:e.fakeFocus,domModification:{classes:[e.markers.item]}})})]),vT=k([r1("value"),r1("items"),r1("dom"),r1("components"),ad("eventOrder",{}),gV("menuBehaviours",[hy,gN,pj,bw]),au("movement",{mode:"menu",moveOnTab:!0},rQ("mode",{grid:[s6(),s9("config",vk)],matrix:[s9("config",vC),r1("rowSelector"),ad("previousSelector",ea.none)],menu:[ad("moveOnTab",!0),s9("config",vO)]})),r2("markers",sY()),ad("fakeFocus",!1),ad("focusManager",hL()),s1("onHighlight"),s1("onDehighlight")]),vE=k("alloy.menu-focus"),vD=(e,t)=>{let o=uX(e.element,'[role="menuitemradio"][aria-checked="true"]');ef(o,o=>{tN(o,t.element)||e.getSystem().getByDom(o).each(e=>{ve.off(e)})})},vA=(e,t,o,n)=>({uid:e.uid,dom:e.dom,markers:e.markers,behaviours:gz(e.menuBehaviours,[hy.config({highlightClass:e.markers.selectedItem,itemClass:e.markers.item,onHighlight:e.onHighlight,onDehighlight:e.onDehighlight}),gN.config({store:{mode:"memory",initialValue:e.value}}),pj.config({find:ea.some}),bw.config(e.movement.config(e,e.movement))]),events:iI([iV(vd(),(e,t)=>{let o=t.event;e.getSystem().getByDom(o.target).each(o=>{hy.highlight(e,o),t.stop(),iE(e,vE(),{menu:e,item:o})})}),iV(vc(),(e,t)=>{let o=t.event.item;hy.highlight(e,o)}),iV(vu(),(e,t)=>{let{item:o,state:n}=t.event;n&&"menuitemradio"===on(o.element,"role")&&vD(e,o)})]),components:t,eventOrder:e.eventOrder,domModification:{attributes:{role:"menu"}}}),vM=pz({name:"Menu",configFields:vT(),partFields:v_(),factory:vA}),vB=e=>eU(e,(e,t)=>({k:e,v:t})),vF=(e,t,o,n)=>eY(o,n).bind(n=>eY(e,n).bind(n=>{let r=vF(e,t,o,n);return ea.some([n].concat(r))})).getOr([]),vI=(e,t)=>{let o={};eL(e,(e,t)=>{ef(e,e=>{o[e]=t})});let n=vB(t),r=eP(n,(e,r)=>[r].concat(vF(o,t,n,r)));return eP(o,e=>eY(r,e).getOr([e]))},vR=()=>{let e=ay({}),t=ay({}),o=ay({}),n=dD(),r=ay({}),a=()=>{e.set({}),t.set({}),o.set({}),n.clear()},i=()=>n.get().isNone(),l=(e,o)=>{t.set({...t.get(),[e]:{type:"prepared",menu:o}})},s=(a,i,l,s)=>{n.set(a),e.set(l),t.set(i),r.set(s);let c=vI(s,l);o.set(c)},c=t=>eX(e.get(),(e,o)=>e===t),d=(e,t,o)=>h(e).bind(n=>c(e).bind(e=>t(e).map(e=>({triggeredMenu:n,triggeringItem:e,triggeringPath:o})))),u=(e,t)=>{let r=ey(b(e).toArray(),e=>h(e).isSome());return eY(o.get(),e).bind(e=>{let o=eE(r.concat(e)),a=e_(o,(e,r)=>d(e,t,o.slice(0,r+1)).fold(()=>eQ(n.get(),e)?[]:[ea.none()],e=>[ea.some(e)]));return e2(a)})},m=t=>eY(e.get(),t).map(e=>{let n=eY(o.get(),t).getOr([]);return[e].concat(n)}),g=e=>eY(o.get(),e).bind(e=>e.length>1?ea.some(e.slice(1)):ea.none()),p=e=>eY(o.get(),e),h=e=>f(e).bind(vN),f=e=>eY(t.get(),e),b=t=>eY(e.get(),t),v=e=>{let t=r.get();return eD(eH(t),e)},y=()=>n.get().bind(h),x=()=>t.get();return{setMenuBuilt:l,setContents:s,expand:m,refresh:p,collapse:g,lookupMenu:f,lookupItem:b,otherMenus:v,getPrimary:y,getMenus:x,clear:a,isClear:i,getTriggeringPath:u}},vN=e=>"prepared"===e.type?ea.some(e.menu):ea.none(),vV={init:vR,extractPreparedMenu:vN},vH=i8("tiered-menu-item-highlight"),vz=i8("tiered-menu-item-dehighlight");(z=J||(J={}))[z.HighlightMenuAndItem=0]="HighlightMenuAndItem",z[z.HighlightJustMenu=1]="HighlightJustMenu",z[z.HighlightNone=2]="HighlightNone";let vL=(e,t)=>{var o;let n;let r=dD(),a=(t,o,n)=>eP(n,(n,r)=>{let a=()=>vM.sketch({...n,value:r,markers:e.markers,fakeFocus:e.fakeFocus,onHighlight:(e,t)=>{iE(e,vH,{menuComp:e,itemComp:t})},onDehighlight:(e,t)=>{iE(e,vz,{menuComp:e,itemComp:t})},focusManager:e.fakeFocus?hP():hL()});return r===o?{type:"prepared",menu:t.getSystem().build(a())}:{type:"notbuilt",nbMenu:a}}),i=vV.init(),l=t=>{let o=a(t,e.data.primary,e.data.menus),n=d();return i.setContents(e.data.primary,o,e.data.expansions,n),i.getPrimary()},s=e=>gN.getValue(e).value,c=(e,t,o)=>eV(t,e=>{if(!e.getSystem().isConnected())return ea.none();let t=hy.getCandidates(e);return ek(t,e=>s(e)===o)}),d=t=>eP(e.data.menus,(e,t)=>e_(e.items,e=>"separator"===e.type?[]:[e.data.value])),u=hy.highlight,m=(t,o)=>{u(t,o),hy.getHighlighted(o).orThunk(()=>hy.getFirst(o)).each(n=>{e.fakeFocus?hy.highlight(o,n):iA(t,n.element,ii())})},g=(e,t)=>e1(eh(t,t=>e.lookupMenu(t).bind(e=>"prepared"===e.type?ea.some(e.menu):ea.none()))),p=(t,o,n)=>{let r=g(o,o.otherMenus(n));ef(r,o=>{l5(o.element,[e.markers.backgroundMenu]),e.stayInDom||bR.remove(t,o)})},h=t=>r.get().getOrThunk(()=>{let o={},n=uX(t.element,`.${e.markers.item}`),a=ey(n,e=>"true"===on(e,"aria-haspopup"));return ef(a,e=>{t.getSystem().getByDom(e).each(e=>{let t=s(e);o[t]=e})}),r.set(o),o}),f=(e,t)=>{let o=h(e);eL(o,(e,o)=>{let n=eu(t,o);ot(e.element,"aria-expanded",n)})},b=(t,o,n)=>ea.from(n[0]).bind(r=>o.lookupMenu(r).bind(r=>{if("notbuilt"===r.type)return ea.none();{let a=r.menu,i=g(o,n.slice(1));return ef(i,t=>{lQ(t.element,e.markers.backgroundMenu)}),t6(a.element)||bR.append(t,lp(a)),l5(a.element,[e.markers.backgroundMenu]),m(t,a),p(t,o,n),ea.some(a)}}));(o=n||(n={}))[o.HighlightSubmenu=0]="HighlightSubmenu",o[o.HighlightParent=1]="HighlightParent";let v=(e,t,o)=>{if("notbuilt"!==o.type)return o.menu;{let n=e.getSystem().build(o.nbMenu());return i.setMenuBuilt(t,n),n}},x=(t,o,r=n.HighlightSubmenu)=>{if(o.hasConfigured(p7)&&p7.isDisabled(o))return ea.some(o);{let a=s(o);return i.expand(a).bind(a=>(f(t,a),ea.from(a[0]).bind(l=>i.lookupMenu(l).bind(s=>{let c=v(t,l,s);return(t6(c.element)||bR.append(t,lp(c)),e.onOpenSubmenu(t,o,c,eE(a)),r===n.HighlightSubmenu)?(hy.highlightFirst(c),b(t,i,a)):(hy.dehighlightAll(c),ea.some(o))}))))}},w=(t,o)=>{let n=s(o);return i.collapse(n).bind(n=>(f(t,n),b(t,i,n).map(n=>(e.onCollapseMenu(t,o,n),n))))},S=(e,t)=>{let o=s(t);return i.refresh(o).bind(t=>(f(e,t),b(e,i,t)))},k=(e,t)=>pL(t.element)?ea.none():x(e,t,n.HighlightSubmenu),C=(e,t)=>pL(t.element)?ea.none():w(e,t),O=(t,o)=>w(t,o).orThunk(()=>e.onEscape(t,o).map(()=>t)),_=t=>(o,n)=>sI(n.getSource(),`.${e.markers.item}`).bind(e=>o.getSystem().getByDom(e).toOptional().bind(e=>t(o,e).map(M))),T=iI([iV(vE(),(e,t)=>{let o=t.event.item;i.lookupItem(s(o)).each(()=>{let o=t.event.menu;hy.highlight(e,o);let n=s(t.event.item);i.refresh(n).each(t=>p(e,i,t))})}),iK((t,o)=>{let r=o.event.target;t.getSystem().getByDom(r).each(o=>{let r=s(o);0===r.indexOf("collapse-item")&&w(t,o),x(t,o,n.HighlightSubmenu).fold(()=>{e.onExecute(t,o)},y)})}),i$((t,o)=>{l(t).each(o=>{bR.append(t,lp(o)),e.onOpenMenu(t,o),e.highlightOnOpen===J.HighlightMenuAndItem?m(t,o):e.highlightOnOpen===J.HighlightJustMenu&&u(t,o)})}),iV(vH,(t,o)=>{e.onHighlightItem(t,o.event.menuComp,o.event.itemComp)}),iV(vz,(t,o)=>{e.onDehighlightItem(t,o.event.menuComp,o.event.itemComp)}),...e.navigateOnHover?[iV(vc(),(t,o)=>{let r=o.event.item;S(t,r),x(t,r,n.HighlightParent),e.onHover(t,r)})]:[]]),E=e=>hy.getHighlighted(e).bind(hy.getHighlighted),D=e=>{E(e).each(t=>{w(e,t)})},A=e=>{i.getPrimary().each(t=>{m(e,t)})},B=e=>ea.from(e.components()[0]).filter(e=>"menu"===on(e.element,"role")),F=t=>{let o=i.getPrimary().bind(e=>E(t).bind(e=>{let o=s(e),n=eK(i.getMenus()),r=e1(eh(n,vV.extractPreparedMenu));return i.getTriggeringPath(o,e=>c(t,r,e))}).map(t=>({primary:e,triggeringPath:t})));o.fold(()=>{B(t).each(o=>{e.onRepositionMenu(t,o,[])})},({primary:o,triggeringPath:n})=>{e.onRepositionMenu(t,o,n)})};return{uid:e.uid,dom:e.dom,markers:e.markers,behaviours:gz(e.tmenuBehaviours,[bw.config({mode:"special",onRight:_(k),onLeft:_(C),onEscape:_(O),focusIn:(e,t)=>{i.getPrimary().each(t=>{iA(e,t.element,ii())})}}),hy.config({highlightClass:e.markers.selectedMenu,itemClass:e.markers.menu}),pj.config({find:e=>hy.getHighlighted(e)}),bR.config({})]),eventOrder:e.eventOrder,apis:{collapseMenu:D,highlightPrimary:A,repositionMenus:F},events:T}},vP=k("collapse-item"),vU=(e,t,o)=>({primary:e,menus:t,expansions:o}),vW=(e,t)=>({primary:e,menus:aT(e,t),expansions:{}}),vj=e=>({value:i8(vP()),meta:{text:e}}),vG=pH({name:"TieredMenu",configFields:[s5("onExecute"),s5("onEscape"),s3("onOpenMenu"),s3("onOpenSubmenu"),s1("onRepositionMenu"),s1("onCollapseMenu"),ad("highlightOnOpen",J.HighlightMenuAndItem),r8("data",[r1("primary"),r1("menus"),r1("expansions")]),ad("fakeFocus",!1),s1("onHighlightItem"),s1("onDehighlightItem"),s1("onHover"),sZ(),r1("dom"),ad("navigateOnHover",!0),ad("stayInDom",!1),gV("tmenuBehaviours",[bw,hy,pj,bR]),ad("eventOrder",{})],apis:{collapseMenu:(e,t)=>{e.collapseMenu(t)},highlightPrimary:(e,t)=>{e.highlightPrimary(t)},repositionMenus:(e,t)=>{e.repositionMenus(t)}},factory:vL,extraApis:{tieredData:vU,singleData:vW,collapseItem:vj}}),v$=(e,t,o,n,r)=>{let a=()=>e.lazySink(t),i="horizontal"===n.type?{layouts:{onLtr:()=>cV(),onRtl:()=>cH()}}:{},l=e=>2===e.length,s=e=>l(e)?i:{};return vG.sketch({dom:{tag:"div"},data:n.data,markers:n.menu.markers,highlightOnOpen:n.menu.highlightOnOpen,fakeFocus:n.menu.fakeFocus,onEscape:()=>(go.close(t),e.onEscape.map(e=>e(t)),ea.some(!0)),onExecute:()=>ea.some(!0),onOpenMenu:(e,t)=>{mE.positionWithinBounds(a().getOrDie(),t,o,r())},onOpenSubmenu:(e,t,o,n)=>{let r=a().getOrDie();mE.position(r,o,{anchor:{type:"submenu",item:t,...s(n)}})},onRepositionMenu:(e,t,n)=>{let i=a().getOrDie();mE.positionWithinBounds(i,t,o,r()),ef(n,e=>{let t=s(e.triggeringPath);mE.position(i,e.triggeredMenu,{anchor:{type:"submenu",item:e.triggeringItem,...t}})})}})},vq=(e,t)=>{let o=(t,o)=>{let n=e.getRelated(t);return n.exists(e=>sz(e,o))},n=(e,t)=>{go.setContent(e,t)},r=(e,t,o)=>{a(e,t,o,ea.none())},a=(e,t,o,n)=>{i(e,t,o,()=>n.map(e=>nP(e)))},i=(t,o,n,r)=>{let a=e.lazySink(t).getOrDie();go.openWhileCloaked(t,o,()=>mE.positionWithinBounds(a,t,n,r())),gN.setValue(t,ea.some({mode:"position",config:n,getBounds:r}))},l=(e,t,o)=>{s(e,t,o,ea.none)},s=(t,o,n,r)=>{let a=v$(e,t,o,n,r);go.open(t,a),gN.setValue(t,ea.some({mode:"menu",menu:a}))},c=e=>{go.isOpen(e)&&(gN.setValue(e,ea.none()),go.close(e))},d=e=>go.getState(e),u=t=>{go.isOpen(t)&&gN.getValue(t).each(o=>{switch(o.mode){case"menu":go.getState(t).each(vG.repositionMenus);break;case"position":let n=e.lazySink(t).getOrDie();mE.positionWithinBounds(n,t,o.config,o.getBounds())}})},m={setContent:n,showAt:r,showWithin:a,showWithinBounds:i,showMenuAt:l,showMenuWithinBounds:s,hide:c,getContent:d,reposition:u,isOpen:go.isOpen};return{uid:e.uid,dom:e.dom,behaviours:gz(e.inlineBehaviours,[go.config({isPartOf:(e,t,n)=>sz(t,n)||o(e,n),getAttachPoint:t=>e.lazySink(t).getOrDie(),onOpen:t=>{e.onShow(t)},onClose:t=>{e.onHide(t)}}),gN.config({store:{mode:"memory",initialValue:ea.none()}}),c2.config({channels:{...gl({isExtraPart:t.isExtraPart,...e.fireDismissalEventInstead.map(e=>({fireEventInstead:{event:e.event}})).getOr({})}),...gc({...e.fireRepositionEventInstead.map(e=>({fireEventInstead:{event:e.event}})).getOr({}),doReposition:u})}})]),eventOrder:e.eventOrder,apis:m}},vX=pH({name:"InlineView",configFields:[r1("lazySink"),s1("onShow"),s1("onHide"),ai("onEscape"),gV("inlineBehaviours",[go,gN,c2]),as("fireDismissalEventInstead",[ad("event",iy())]),as("fireRepositionEventInstead",[ad("event",ix())]),ad("getRelated",ea.none),ad("isExtraPart",A),ad("eventOrder",ea.none)],factory:vq,apis:{showAt:(e,t,o,n)=>{e.showAt(t,o,n)},showWithin:(e,t,o,n,r)=>{e.showWithin(t,o,n,r)},showWithinBounds:(e,t,o,n,r)=>{e.showWithinBounds(t,o,n,r)},showMenuAt:(e,t,o,n)=>{e.showMenuAt(t,o,n)},showMenuWithinBounds:(e,t,o,n,r)=>{e.showMenuWithinBounds(t,o,n,r)},hide:(e,t)=>{e.hide(t)},isOpen:(e,t)=>e.isOpen(t),getContent:(e,t)=>e.getContent(t),setContent:(e,t,o)=>{e.setContent(t,o)},reposition:(e,t)=>{e.reposition(t)}}});var vK=tinymce.util.Tools.resolve("tinymce.util.Delay");let vY=e=>{let t=vo(e.action),o=e.dom.tag,n=t=>eY(e.dom,"attributes").bind(e=>eY(e,t));return{uid:e.uid,dom:e.dom,components:e.components,events:t,behaviours:gL.augment(e.buttonBehaviours,[b$.config({}),bw.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:(()=>{if("button"===o){let e=n("type").getOr("button"),t=n("role").map(e=>({role:e})).getOr({});return{type:e,...t}}{let e=n("role").getOr("button");return{role:e}}})()},eventOrder:e.eventOrder}},vJ=pH({name:"Button",factory:vY,configFields:[ad("uid",void 0),r1("dom"),ad("components",[]),gL.field("buttonBehaviours",[b$,bw]),at("action"),at("role"),ad("eventOrder",{})]}),vZ=e=>{let t=pR(e)&&eZ(e,"uid")?e.uid:li("memento"),o=e=>e.getSystem().getByUid(t).getOrDie(),n=e=>e.getSystem().getByUid(t).toOptional(),r=()=>({...e,uid:t});return{get:o,getOpt:n,asSpec:r}};var vQ=tinymce.util.Tools.resolve("tinymce.util.I18n");let v0={indent:!0,outdent:!0,"table-insert-column-after":!0,"table-insert-column-before":!0,"paste-column-after":!0,"paste-column-before":!0,"unordered-list":!0,"list-bull-circle":!0,"list-bull-default":!0,"list-bull-square":!0},v1="temporary-placeholder",v2=e=>()=>eY(e,v1).getOr("!not found!"),v3=(e,t)=>{let o=e.toLowerCase();if(!vQ.isRtl())return o;{let e=tt(o,"-rtl");return eJ(t,e)?e:o}},v5=(e,t)=>eY(t,v3(e,t)),v9=(e,t)=>{let o=t();return v5(e,o).getOrThunk(v2(o))},v4=(e,t,o)=>{let n=t();return v5(e,n).or(o).getOrThunk(v2(n))},v6=e=>!!vQ.isRtl()&&eJ(v0,e),v8=()=>bV("add-focusable",[i$(e=>{sB(e.element,"svg").each(e=>ot(e,"focusable","false"))})]),v7=(e,t,o,n)=>{var r,a;let i=v6(t)?["tox-icon--flip"]:[],l=eY(o,v3(t,o)).or(n).getOrThunk(v2(o));return{dom:{tag:e.tag,attributes:null!==(r=e.attributes)&&void 0!==r?r:{},classes:e.classes.concat(i),innerHtml:l},behaviours:cY([...null!==(a=e.behaviours)&&void 0!==a?a:[],v8()])}},ye=(e,t,o,n=ea.none())=>v7(t,e,o(),n),yt=(e,t,o)=>{let n=o(),r=ek(e,e=>eJ(n,v3(e,n)));return v7(t,r.getOr(v1),n,ea.none())},yo={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},yn=e=>{let t=vZ({dom:{tag:"p",innerHtml:e.translationProvider(e.text)},behaviours:cY([bR.config({})])}),o=e=>({dom:{tag:"div",classes:["tox-bar"],styles:{width:`${e}%`}}}),n=e=>({dom:{tag:"div",classes:["tox-text"],innerHtml:`${e}%`}}),r=vZ({dom:{tag:"div",classes:e.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[o(0)]},n(0)],behaviours:cY([bR.config({})])}),a=(e,t)=>{e.getSystem().isConnected()&&r.getOpt(e).each(e=>{bR.set(e,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[o(t)]},n(t)])})},i=(e,o)=>{if(e.getSystem().isConnected()){let n=t.get(e);bR.set(n,[sx(o)])}},l=eO([e.icon.toArray(),e.level.toArray(),e.level.bind(e=>ea.from(yo[e])).toArray()]),s=vZ(vJ.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[ye("close",{tag:"div",classes:["tox-icon"],attributes:{"aria-label":e.translationProvider("Close")}},e.iconProvider)],action:t=>{e.onAction(t)}})),c=yt(l,{tag:"div",classes:["tox-notification__icon"]},e.iconProvider),d={dom:{tag:"div",classes:["tox-notification__body"]},components:[t.asSpec()],behaviours:cY([bR.config({})])};return{uid:e.uid,dom:{tag:"div",attributes:{role:"alert"},classes:e.level.map(e=>["tox-notification","tox-notification--in",`tox-notification--${e}`]).getOr(["tox-notification","tox-notification--in"])},behaviours:cY([b$.config({}),bV("notification-events",[iV(aJ(),e=>{s.getOpt(e).each(b$.focus)})])]),components:[c,d].concat(e.progress?[r.asSpec()]:[]).concat(e.closeButton?[s.asSpec()]:[]),apis:{updateProgress:a,updateText:i}}},yr=pH({name:"Notification",factory:yn,configFields:[at("level"),r1("progress"),at("icon"),r1("onAction"),r1("text"),r1("iconProvider"),r1("translationProvider"),ah("closeButton",!0)],apis:{updateProgress:(e,t,o)=>{e.updateProgress(t,o)},updateText:(e,t,o)=>{e.updateText(t,o)}}});var ya=(e,t,o)=>{let n=t.backstage.shared,r=()=>{let t=nP(tp.fromDom(e.getContentAreaContainer())),o=nW(),n=cm(o.x,t.x,t.right),r=cm(o.y,t.y,t.bottom),a=Math.max(t.right,o.right),i=Math.max(t.bottom,o.bottom);return ea.some(nL(n,r,a-n,i-r))},a=(t,a)=>{let i=()=>{a(),vX.hide(s)},l=sC(yr.sketch({text:t.text,level:eu(["success","error","warning","warn","info"],t.type)?t.type:void 0,progress:!0===t.progressBar,icon:t.icon,closeButton:t.closeButton,onAction:i,iconProvider:n.providers.icons,translationProvider:n.providers.translate})),s=sC(vX.sketch({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:n.getSink,fireDismissalEventInstead:{},...n.header.isPositionedAtTop()?{}:{fireRepositionEventInstead:{}}}));o.add(s),b(t.timeout)&&t.timeout>0&&vK.setEditorTimeout(e,()=>{i()},t.timeout);let c=()=>{let t=lp(l),o={maxHeightFunction:dY()},a=e.notificationManager.getNotifications();if(a[0]===d){let e={...n.anchors.banner(),overrides:o};vX.showWithinBounds(s,t,{anchor:e},r)}else ed(a,d).each(e=>{let n=a[e-1].getEl(),i={type:"node",root:t8(),node:ea.some(tp.fromDom(n)),overrides:o,layouts:{onRtl:()=>[cA],onLtr:()=>[cA]}};vX.showWithinBounds(s,t,{anchor:i},r)})},d={close:i,reposition:c,text:e=>{yr.updateText(l,e)},settings:t,getEl:()=>l.element.dom,progressBar:{value:e=>{yr.updateProgress(l,e)}}};return d},i=e=>{e.close()};return{open:a,close:i,getArgs:e=>e.settings}},yi=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),yl=tinymce.util.Tools.resolve("tinymce.EditorManager"),ys=tinymce.util.Tools.resolve("tinymce.Env");(L=Z||(Z={})).default="wrap",L.floating="floating",L.sliding="sliding",L.scrolling="scrolling",(P=Q||(Q={})).auto="auto",P.top="top",P.bottom="bottom";let yc=e=>t=>t.options.get(e),yd=e=>t=>ea.from(e(t)),yu=e=>{let t=ys.deviceType.isPhone(),o=ys.deviceType.isTablet()||t,n=e.options.register,r=e=>l(e)||!1===e,a=e=>l(e)||b(e);n("skin",{processor:e=>l(e)||!1===e,default:"oxide"}),n("skin_url",{processor:"string"}),n("height",{processor:a,default:Math.max(e.getElement().offsetHeight,400)}),n("width",{processor:a,default:yi.DOM.getStyle(e.getElement(),"width")}),n("min_height",{processor:"number",default:100}),n("min_width",{processor:"number"}),n("max_height",{processor:"number"}),n("max_width",{processor:"number"}),n("style_formats",{processor:"object[]"}),n("style_formats_merge",{processor:"boolean",default:!1}),n("style_formats_autohide",{processor:"boolean",default:!1}),n("line_height_formats",{processor:"string",default:"1 1.1 1.2 1.3 1.4 1.5 2"}),n("font_family_formats",{processor:"string",default:"Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats"}),n("font_size_formats",{processor:"string",default:"8pt 10pt 12pt 14pt 18pt 24pt 36pt"}),n("block_formats",{processor:"string",default:"Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre"}),n("content_langs",{processor:"object[]"}),n("removed_menuitems",{processor:"string",default:""}),n("menubar",{processor:e=>l(e)||m(e),default:!t}),n("menu",{processor:"object",default:{}}),n("toolbar",{processor:e=>m(e)||l(e)||d(e)?{value:e,valid:!0}:{valid:!1,message:"Must be a boolean, string or array."},default:!0}),eg(9,e=>{n("toolbar"+(e+1),{processor:"string"})}),n("toolbar_mode",{processor:"string",default:o?"scrolling":"floating"}),n("toolbar_groups",{processor:"object",default:{}}),n("toolbar_location",{processor:"string",default:Q.auto}),n("toolbar_persist",{processor:"boolean",default:!1}),n("toolbar_sticky",{processor:"boolean",default:e.inline}),n("toolbar_sticky_offset",{processor:"number",default:0}),n("fixed_toolbar_container",{processor:"string",default:""}),n("fixed_toolbar_container_target",{processor:"object"}),n("file_picker_callback",{processor:"function"}),n("file_picker_validator_handler",{processor:"function"}),n("file_picker_types",{processor:"string"}),n("typeahead_urls",{processor:"boolean",default:!0}),n("anchor_top",{processor:r,default:"#top"}),n("anchor_bottom",{processor:r,default:"#bottom"}),n("draggable_modal",{processor:"boolean",default:!1}),n("statusbar",{processor:"boolean",default:!0}),n("elementpath",{processor:"boolean",default:!0}),n("branding",{processor:"boolean",default:!0}),n("promotion",{processor:"boolean",default:!0}),n("resize",{processor:e=>"both"===e||m(e),default:!ys.deviceType.isTouch()}),n("sidebar_show",{processor:"string"})},ym=yc("readonly"),yg=yc("height"),yp=yc("width"),yh=yd(yc("min_width")),yf=yd(yc("min_height")),yb=yd(yc("max_width")),yv=yd(yc("max_height")),yy=yd(yc("style_formats")),yx=yc("style_formats_merge"),yw=yc("style_formats_autohide"),yS=yc("content_langs"),yk=yc("removed_menuitems"),yC=yc("toolbar_mode"),yO=yc("toolbar_groups"),y_=yc("toolbar_location"),yT=yc("fixed_toolbar_container"),yE=yc("fixed_toolbar_container_target"),yD=yc("toolbar_persist"),yA=yc("toolbar_sticky_offset"),yM=yc("menubar"),yB=yc("toolbar"),yF=yc("file_picker_callback"),yI=yc("file_picker_validator_handler"),yR=yc("file_picker_types"),yN=yc("typeahead_urls"),yV=yc("anchor_top"),yH=yc("anchor_bottom"),yz=yc("draggable_modal"),yL=yc("statusbar"),yP=yc("elementpath"),yU=yc("branding"),yW=yc("resize"),yj=yc("paste_as_text"),yG=yc("sidebar_show"),y$=yc("promotion"),yq=e=>!1===e.options.get("skin"),yX=e=>!1!==e.options.get("menubar"),yK=e=>{let t=e.options.get("skin_url");if(yq(e))return t;if(t)return e.documentBaseURI.toAbsolute(t);{let t=e.options.get("skin");return yl.baseURL+"/skins/ui/"+t}},yY=e=>e.options.get("line_height_formats").split(" "),yJ=e=>{let t=yB(e),o=l(t),n=d(t)&&t.length>0;return!yQ(e)&&(n||o||!0===t)},yZ=e=>{let t=eg(9,t=>e.options.get("toolbar"+(t+1))),o=ey(t,l);return e4(o.length>0,o)},yQ=e=>yZ(e).fold(()=>{let t=yB(e);return v(t,l)&&t.length>0},M),y0=e=>y_(e)===Q.bottom,y1=e=>{var t;if(!e.inline)return ea.none();let o=null!==(t=yT(e))&&void 0!==t?t:"";if(o.length>0)return sF(t8(),o);let n=yE(e);return h(n)?ea.some(tp.fromDom(n)):ea.none()},y2=e=>e.inline&&y1(e).isSome(),y3=e=>{let t=y1(e);return t.getOrThunk(()=>t1(t0(tp.fromDom(e.getElement()))))},y5=e=>e.inline&&!yX(e)&&!yJ(e)&&!yQ(e),y9=e=>{let t=e.options.get("toolbar_sticky");return(t||e.inline)&&!y2(e)&&!y5(e)},y4=e=>{let t=e.options.get("menu");return eP(t,e=>({...e,items:e.items}))};var y6=Object.freeze({__proto__:null,get ToolbarMode(){return Z},get ToolbarLocation(){return Q},register:yu,getSkinUrl:yK,isReadOnly:ym,isSkinDisabled:yq,getHeightOption:yg,getWidthOption:yp,getMinWidthOption:yh,getMinHeightOption:yf,getMaxWidthOption:yb,getMaxHeightOption:yv,getUserStyleFormats:yy,shouldMergeStyleFormats:yx,shouldAutoHideStyleFormats:yw,getLineHeightFormats:yY,getContentLanguages:yS,getRemovedMenuItems:yk,isMenubarEnabled:yX,isMultipleToolbars:yQ,isToolbarEnabled:yJ,isToolbarPersist:yD,getMultipleToolbarsOption:yZ,getUiContainer:y3,useFixedContainer:y2,getToolbarMode:yC,isDraggableModal:yz,isDistractionFree:y5,isStickyToolbar:y9,getStickyToolbarOffset:yA,getToolbarLocation:y_,isToolbarLocationBottom:y0,getToolbarGroups:yO,getMenus:y4,getMenubar:yM,getToolbar:yB,getFilePickerCallback:yF,getFilePickerTypes:yR,useTypeaheadUrls:yN,getAnchorTop:yV,getAnchorBottom:yH,getFilePickerValidatorHandler:yI,useStatusBar:yL,useElementPath:yP,promotionEnabled:y$,useBranding:yU,getResize:yW,getPasteAsText:yj,getSidebarShow:yG});let y8="[data-mce-autocompleter]",y7=e=>sI(e,y8),xe=e=>sF(e,y8),xt=(e,t)=>{let o=(e,t)=>{iE(e,aQ(),{raw:t})},n=()=>e.getMenu().bind(hy.getHighlighted);t.on("keydown",t=>{let r=t.which;e.isActive()&&(e.isMenuOpen()?13===r?(n().each(iD),t.preventDefault()):40===r?(n().fold(()=>{e.getMenu().each(hy.highlightFirst)},e=>{o(e,t)}),t.preventDefault(),t.stopImmediatePropagation()):(37===r||38===r||39===r)&&n().each(e=>{o(e,t),t.preventDefault(),t.stopImmediatePropagation()}):(13===r||38===r||40===r)&&e.cancelIfNecessary())}),t.on("NodeChange",t=>{e.isActive()&&!e.isProcessingAction()&&y7(tp.fromDom(t.element)).isNone()&&e.cancelIfNecessary()})},xo={setup:xt};(U=ee||(ee={}))[U.CLOSE_ON_EXECUTE=0]="CLOSE_ON_EXECUTE",U[U.BUBBLE_TO_SANDBOX=1]="BUBBLE_TO_SANDBOX";var xn=ee;let xr="tox-menu-nav__js",xa="tox-collection__item",xi="tox-swatch",xl={normal:xr,color:xi},xs="tox-collection__item--enabled",xc="tox-collection__item-icon",xd="tox-collection__item-label",xu="tox-collection__item-caret",xm="tox-collection__item--active",xg="tox-collection__item-container",xp="tox-collection__item-container--row",xh=e=>eY(xl,e).getOr(xr),xf=e=>"color"===e?"tox-swatches":"tox-menu",xb=e=>({backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:xf(e),tieredMenu:"tox-tiered-menu"}),xv=e=>{let t=xb(e);return{backgroundMenu:t.backgroundMenu,selectedMenu:t.selectedMenu,menu:t.menu,selectedItem:t.selectedItem,item:xh(e)}},xy=(e,t,o)=>{let n=xb(o);return{tag:"div",classes:eO([[n.menu,`tox-menu-${t}-column`],e?[n.hasIcons]:[]])}},xx=[vM.parts.items({})],xw=(e,t,o)=>{let n=xb(o),r={tag:"div",classes:eO([[n.tieredMenu]])};return{dom:r,markers:xv(o)}},xS=k([at("data"),ad("inputAttributes",{}),ad("inputStyles",{}),ad("tag","input"),ad("inputClasses",[]),s1("onSetValue"),ad("styles",{}),ad("eventOrder",{}),gV("inputBehaviours",[gN,b$]),ad("selectOnFocus",!0)]),xk=e=>cY([b$.config({onFocus:e.selectOnFocus?e=>{let t=e.element,o=l8(t);t.dom.setSelectionRange(0,o.length)}:y})]),xC=e=>({...xk(e),...gz(e.inputBehaviours,[gN.config({store:{mode:"manual",...e.data.map(e=>({initialValue:e})).getOr({}),getValue:e=>l8(e.element),setValue:(e,t)=>{let o=l8(e.element);o!==t&&l7(e.element,t)}},onSetValue:e.onSetValue})])}),xO=e=>({tag:e.tag,attributes:{type:"text",...e.inputAttributes},styles:e.inputStyles,classes:e.inputClasses}),x_=(e,t)=>({uid:e.uid,dom:xO(e),components:[],behaviours:xC(e),eventOrder:e.eventOrder}),xT=pH({name:"Input",configFields:xS(),factory:x_}),xE=i8("refetch-trigger-event"),xD=i8("redirect-menu-item-interaction"),xA="tox-menu__searcher",xM=e=>sF(e.element,`.${xA}`).bind(t=>e.getSystem().getByDom(t).toOptional()),xB=(e,t)=>{gN.setValue(e,t.fetchPattern),e.element.dom.selectionStart=t.selectionStart,e.element.dom.selectionEnd=t.selectionEnd},xF=e=>{let t=gN.getValue(e),o=e.element.dom.selectionStart,n=e.element.dom.selectionEnd;return{fetchPattern:t,selectionStart:o,selectionEnd:n}},xI=(e,t)=>{or(t.element,"id").each(t=>ot(e.element,"aria-activedescendant",t))},xR=e=>{let t=(e,t)=>(t.cut(),ea.none()),o=(e,t)=>{let o={interactionEvent:t.event,eventType:t.event.raw.type};return iE(e,xD,o),ea.some(!0)},n="searcher-events";return{dom:{tag:"div",classes:[xa]},components:[xT.sketch({inputClasses:[xA,"tox-textfield"],inputAttributes:{...e.placeholder.map(t=>({placeholder:e.i18n(t)})).getOr({}),type:"search","aria-autocomplete":"list"},inputBehaviours:cY([bV(n,[iV(a1(),e=>{iT(e,xE)}),iV(aQ(),(e,t)=>{"Escape"===t.event.raw.key&&t.stop()})]),bw.config({mode:"special",onLeft:t,onRight:t,onSpace:t,onEnter:o,onEscape:o,onUp:o,onDown:o})]),eventOrder:{keydown:[n,bw.name()]}})]}},xN="tox-collection--results__js",xV=e=>{var t;return e.dom?{...e,dom:{...e.dom,attributes:{...null!==(t=e.dom.attributes)&&void 0!==t?t:{},id:i8("aria-item-search-result-id"),"aria-selected":"false"}}}:e},xH=(e,t)=>o=>{let n=ep(o,t);return eh(n,t=>({dom:e,components:t}))},xz=e=>({dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[vM.parts.items({preprocess:"auto"!==e?xH({tag:"div",classes:["tox-swatches__row"]},e):C})]}]}),xL=e=>({dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[vM.parts.items({preprocess:xH({tag:"div",classes:["tox-collection__group"]},e)})]}),xP=(e,t)=>{let o=[],n=[];return ef(e,(e,r)=>{t(e,r)?(n.length>0&&o.push(n),n=[],(eJ(e.dom,"innerHtml")||e.components&&e.components.length>0)&&n.push(e)):n.push(e)}),n.length>0&&o.push(n),eh(o,e=>({dom:{tag:"div",classes:["tox-collection__group"]},components:e}))},xU=(e,t,o)=>vM.parts.items({preprocess:n=>{let r=eh(n,o);return"auto"!==e&&e>1?xH({tag:"div",classes:["tox-collection__group"]},e)(r):xP(r,(e,o)=>"separator"===t[o].type)}}),xW=(e,t,o=!0)=>({dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===e?["tox-collection--list"]:["tox-collection--grid"])},components:[xU(e,t,C)]}),xj=(e,t,o=!0)=>{let n=i8("aria-controls-search-results");return{dom:{tag:"div",classes:["tox-menu","tox-collection",xN].concat(1===e?["tox-collection--list"]:["tox-collection--grid"]),attributes:{id:n}},components:[xU(e,t,xV)]}},xG=(e,t,o)=>{let n=i8("aria-controls-search-results");return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===e?["tox-collection--list"]:["tox-collection--grid"])},components:[xR({i18n:vQ.translate,placeholder:o.placeholder}),{dom:{tag:"div",classes:[...1===e?["tox-collection--list"]:["tox-collection--grid"],xN],attributes:{id:n}},components:[xU(e,t,xV)]}]}},x$=(e,t=!0)=>({dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[vM.parts.items({preprocess:t=>xP(t,(t,o)=>"separator"===e[o].type)})]}),xq=e=>em(e,e=>"icon"in e&&void 0!==e.icon),xX=e=>(console.error(rZ(e)),console.log(e),ea.none()),xK=(e,t,o,n,r)=>{let a=x$(o);return{value:e,dom:a.dom,components:a.components,items:o}},xY=(e,t,o,n,r)=>{if("color"===r.menuType){let t=xz(n);return{value:e,dom:t.dom,components:t.components,items:o}}if("normal"===r.menuType&&"auto"===n){let t=xW(n,o);return{value:e,dom:t.dom,components:t.components,items:o}}if("normal"===r.menuType||"searchable"===r.menuType){let t="searchable"!==r.menuType?xW(n,o):"search-with-field"===r.searchMode.searchMode?xG(n,o,r.searchMode):xj(n,o);return{value:e,dom:t.dom,components:t.components,items:o}}{if("listpreview"!==r.menuType||"auto"===n)return{value:e,dom:xy(t,n,r.menuType),components:xx,items:o};let a=xL(n);return{value:e,dom:a.dom,components:a.components,items:o}}},xJ=r5("type"),xZ=r5("name"),xQ=r5("label"),x0=r5("text"),x1=r5("title"),x2=r5("icon"),x3=r5("value"),x5=r4("fetch"),x9=r4("getSubmenuItems"),x4=r4("onAction"),x6=r4("onItemAction"),x8=af("onSetup",()=>y),x7=ar("name"),we=ar("text"),wt=ar("icon"),wo=ar("tooltip"),wn=ar("label"),wr=ar("shortcut"),wa=ai("select"),wi=ah("active",!1),wl=ah("borderless",!1),ws=ah("enabled",!0),wc=ah("primary",!1),wd=e=>ad("columns",e),wu=ad("meta",{}),wm=af("onAction",y),wg=e=>ag("type",e),wp=e=>n9("name","name",rn(()=>i8(`${e}-name`)),rz),wh=rM([xJ,we]),wf=e=>rK("separatormenuitem",wh,e),wb=rM([wg("autocompleteitem"),wi,ws,wu,x3,we,wt]),wv=e=>rK("Autocompleter.Separator",wh,e),wy=e=>rK("Autocompleter.Item",wb,e),wx=[ws,wo,wt,we,x8],ww=rM([xJ,x4].concat(wx)),wS=e=>rK("toolbarbutton",ww,e),wk=[wi].concat(wx),wC=rM(wk.concat([xJ,x4])),wO=e=>rK("ToggleButton",wC,e),w_=[af("predicate",A),ap("scope","node",["node","editor"]),ap("position","selection",["node","selection","line"])],wT=wx.concat([wg("contextformbutton"),wc,x4,n4("original",C)]),wE=wk.concat([wg("contextformbutton"),wc,x4,n4("original",C)]),wD=wx.concat([wg("contextformbutton")]),wA=wk.concat([wg("contextformtogglebutton")]),wM=rQ("type",{contextformbutton:wT,contextformtogglebutton:wE}),wB=rM([wg("contextform"),af("initValue",k("")),wn,ae("commands",wM),ao("launch",rQ("type",{contextformbutton:wD,contextformtogglebutton:wA}))].concat(w_)),wF=e=>rK("ContextForm",wB,e),wI=rM([wg("contexttoolbar"),r5("items")].concat(w_)),wR=e=>rK("ContextToolbar",wI,e),wN=[xJ,r5("src"),ar("alt"),ab("classes",[],rz)],wV=rM(wN),wH=[xJ,x0,x7,ab("classes",["tox-collection__item-label"],rz)],wz=rM(wH),wL=rE(()=>rG("type",{cardimage:wV,cardtext:wz,cardcontainer:wP})),wP=rM([xJ,ag("direction","horizontal"),ag("align","left"),ag("valign","middle"),ae("items",wL)]),wU=[ws,we,wr,n9("value","value",rn(()=>i8("menuitem-value")),rN()),wu],wW=rM([xJ,wn,ae("items",wL),x8,wm].concat(wU)),wj=e=>rK("cardmenuitem",wW,e),wG=rM([xJ,wi,wt].concat(wU)),w$=e=>rK("choicemenuitem",wG,e),wq=[xJ,r5("fancytype"),wm],wX=[ad("initData",{})].concat(wq),wK=[av("initData",{},[ah("allowCustomColors",!0),ag("storageKey","default"),al("colors",rN())])].concat(wq),wY=rQ("fancytype",{inserttable:wX,colorswatch:wK}),wJ=e=>rK("fancymenuitem",wY,e),wZ=rM([xJ,x8,wm,wt].concat(wU)),wQ=e=>rK("menuitem",wZ,e),w0=rM([xJ,x9,x8,wt].concat(wU)),w1=e=>rK("nestedmenuitem",w0,e),w2=rM([xJ,wt,wi,x8,x4].concat(wU)),w3=e=>rK("togglemenuitem",w2,e),w5=(e,t,o)=>{let n=uX(e.element,"."+o);if(!(n.length>0))return ea.none();{let e=eC(n,e=>{let o=e.dom.getBoundingClientRect().top,r=n[0].dom.getBoundingClientRect().top;return Math.abs(o-r)>t}).getOr(n.length);return ea.some({numColumns:e,numRows:Math.ceil(n.length/e)})}},w9=(e,t)=>cY([bV(e,t)]),w4=e=>w9(i8("unnamed-events"),e),w6={namedEvents:w9,unnamedEvents:w4},w8=i8("tooltip.exclusive"),w7=i8("tooltip.show"),Se=i8("tooltip.hide"),St=(e,t,o)=>{e.getSystem().broadcastOn([w8],{})},So=(e,t,o,n)=>{o.getTooltip().each(e=>{e.getSystem().isConnected()&&bR.set(e,n)})};var Sn=Object.freeze({__proto__:null,hideAllExclusive:St,setComponents:So});let Sr=(e,t)=>{let o=o=>{t.getTooltip().each(n=>{mP(n),e.onHide(o,n),t.clearTooltip()}),t.clearTimer()},n=o=>{if(!t.isShowing()){St(o);let n=e.lazySink(o).getOrDie(),r=o.getSystem().build({dom:e.tooltipDom,components:e.tooltipComponents,events:iI("normal"===e.mode?[iV(aY(),e=>{iT(o,w7)}),iV(aX(),e=>{iT(o,Se)})]:[]),behaviours:cY([bR.config({})])});t.setTooltip(r),mH(n,r),e.onShow(o,r),mE.position(n,r,{anchor:e.anchor(o)})}};return iI(eO([[iV(w7,o=>{t.resetTimer(()=>{n(o)},e.delay)}),iV(Se,n=>{t.resetTimer(()=>{o(n)},e.delay)}),iV(ir(),(e,t)=>{!t.universal&&eu(t.channels,w8)&&o(e)}),iq(e=>{o(e)})],"normal"===e.mode?[iV(aJ(),e=>{iT(e,w7)}),iV(it(),e=>{iT(e,Se)}),iV(aY(),e=>{iT(e,w7)}),iV(aX(),e=>{iT(e,Se)})]:[iV(iO(),(e,t)=>{iT(e,w7)}),iV(i_(),e=>{iT(e,Se)})]]))};var Sa=Object.freeze({__proto__:null,events:Sr}),Si=[r1("lazySink"),r1("tooltipDom"),ad("exclusive",!0),ad("tooltipComponents",[]),ad("delay",300),ap("mode","normal",["normal","follow-highlight"]),ad("anchor",e=>({type:"hotspot",hotspot:e,layouts:{onLtr:k([cA,cD,cO,cT,c_,cE]),onRtl:k([cA,cD,cO,cT,c_,cE])}})),s1("onHide"),s1("onShow")];let Sl=()=>{let e=dD(),t=dD(),o=()=>{e.on(clearTimeout)},n=(t,n)=>{o(),e.set(setTimeout(t,n))},r=k("not-implemented");return ly({getTooltip:t.get,isShowing:t.isSet,setTooltip:t.set,clearTooltip:t.clear,clearTimer:o,resetTimer:n,readState:r})};var Ss=Object.freeze({__proto__:null,init:Sl});let Sc=cZ({fields:Si,name:"tooltipping",active:Sa,state:Ss,apis:Sn}),Sd=e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),Su="silver.readonly",Sm=rM([r2("readonly",rL)]),Sg=(e,t)=>{let o=e.mainUi.outerContainer,n=o.element,r=[e.mainUi.mothership,...e.uiMotherships];t&&ef(r,e=>{e.broadcastOn([gn()],{target:n})}),ef(r,e=>{e.broadcastOn([Su],{readonly:t})})},Sp=(e,t)=>{e.on("init",()=>{e.mode.isReadOnly()&&Sg(t,!0)}),e.on("SwitchMode",()=>Sg(t,e.mode.isReadOnly())),ym(e)&&e.mode.set("readonly")},Sh=()=>c2.config({channels:{[Su]:{schema:Sm,onReceive:(e,t)=>{p7.set(e,t.readonly)}}}}),Sf=e=>p7.config({disabled:e,disableClass:"tox-collection__item--state-disabled"}),Sb=e=>p7.config({disabled:e}),Sv=e=>p7.config({disabled:e,disableClass:"tox-tbtn--disabled"}),Sy=e=>p7.config({disabled:e,disableClass:"tox-tbtn--disabled",useNative:!1}),Sx={item:Sf,button:Sb,splitButton:Sv,toolbarButton:Sy},Sw=(e,t)=>{let o=e.getApi(t);return e=>{e(o)}},SS=(e,t)=>i$(o=>{let n=Sw(e,o);n(o=>{let n=e.onSetup(o);f(n)&&t.set(n)})}),Sk=(e,t)=>iq(o=>Sw(e,o)(t.get())),SC=(e,t)=>iK((o,n)=>{Sw(e,o)(e.onAction),e.triggersSubmenu||t!==xn.CLOSE_ON_EXECUTE||(o.getSystem().isConnected()&&iT(o,ic()),n.stop())}),SO={[ia()]:["disabling","alloy.base.behaviour","toggling","item-events"]},S_=(e,t,o,n)=>{let r=ay(y);return{type:"item",dom:t.dom,components:e1(t.optComponents),data:e.data,eventOrder:SO,hasSubmenu:e.triggersSubmenu,itemBehaviours:cY([bV("item-events",[SC(e,o),SS(e,r),Sk(e,r)]),Sx.item(()=>!e.enabled||n.isDisabled()),Sh(),bR.config({})].concat(e.itemBehaviours))}},ST=e=>({value:e.value,meta:{text:e.text.getOr(""),...e.meta}}),SE=e=>{let t=ys.os.isMacOS()||ys.os.isiOS(),o=t?{alt:"",ctrl:"",shift:"",meta:"",access:""}:{meta:"Ctrl",access:"Shift+Alt"},n=e.split("+"),r=eh(n,e=>{let t=e.toLowerCase().trim();return eJ(o,t)?o[t]:e});return t?r.join(""):r.join("+")},SD=(e,t,o=[xc])=>ye(e,{tag:"div",classes:o},t),SA=e=>({dom:{tag:"div",classes:[xd]},components:[sx(vQ.translate(e))]}),SM=(e,t)=>({dom:{tag:"div",classes:t,innerHtml:e}}),SB=(e,t)=>({dom:{tag:"div",classes:[xd]},components:[{dom:{tag:e.tag,styles:e.styles},components:[sx(vQ.translate(t))]}]}),SF=e=>({dom:{tag:"div",classes:["tox-collection__item-accessory"]},components:[sx(SE(e))]}),SI=e=>SD("checkmark",e,["tox-collection__item-checkmark"]),SR=e=>SD("chevron-right",e,[xu]),SN=e=>SD("chevron-down",e,[xu]),SV=(e,t)=>{let o="vertical"===e.direction?"tox-collection__item-container--column":xp,n="left"===e.align?"tox-collection__item-container--align-left":"tox-collection__item-container--align-right";return{dom:{tag:"div",classes:[xg,o,n,(()=>{switch(e.valign){case"top":return"tox-collection__item-container--valign-top";case"middle":return"tox-collection__item-container--valign-middle";case"bottom":return"tox-collection__item-container--valign-bottom"}})()]},components:t}},SH=(e,t,o)=>({dom:{tag:"img",classes:t,attributes:{src:e,alt:o.getOr("")}}}),Sz=(e,t,o)=>{let n=e.ariaLabel,r=e.value,a=e.iconContent.map(e=>v4(e,t.icons,o));return{dom:(()=>{let e=a.getOr(""),o=n.map(e=>({title:t.translate(e)})).getOr({}),i={tag:"div",attributes:o,classes:[xi]};return"custom"===r?{...i,tag:"button",classes:[...i.classes,"tox-swatches__picker-btn"],innerHtml:e}:"remove"===r?{...i,classes:[...i.classes,"tox-swatch--remove"],innerHtml:e}:h(r)?{...i,attributes:{...i.attributes,"data-mce-color":r},styles:{"background-color":r},innerHtml:e}:i})(),optComponents:[]}},SL=e=>{let t=e.map(e=>({attributes:{title:vQ.translate(e)}})).getOr({});return{tag:"div",classes:[xr,xa],...t}},SP=(e,t,o,n)=>{let r={tag:"div",classes:[xc]},a=e=>ye(e,r,t.icons,n),i=()=>ea.some({dom:r}),l=o?e.iconContent.map(a).orThunk(i):ea.none(),s=e.checkMark,c=ea.from(e.meta).fold(()=>SA,e=>eJ(e,"style")?_(SB,e.style):SA),d=e.htmlContent.fold(()=>e.textContent.map(c),e=>ea.some(SM(e,[xd]))),u={dom:SL(e.ariaLabel),optComponents:[l,d,e.shortcutContent.map(SF),s,e.caret]};return u},SU=(e,t,o,n=ea.none())=>"color"===e.presets?Sz(e,t,n):SP(e,t,o,n),SW=(e,t)=>eY(e,"tooltipWorker").map(e=>[Sc.config({lazySink:t.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:e=>({type:"submenu",item:e,overrides:{maxHeightFunction:dY}}),mode:"follow-highlight",onShow:(t,o)=>{e(e=>{Sc.setComponents(t,[sw({element:tp.fromDom(e)})])})}})]).getOr([]),Sj=e=>yi.DOM.encode(e),SG=(e,t)=>{let o=vQ.translate(e),n=Sj(o);if(!(t.length>0))return n;{let e=RegExp(Sd(t),"gi");return n.replace(e,e=>`<span class="tox-autocompleter-highlight">${e}</span>`)}},S$=(e,t,o,n,r,a,i,l=!0)=>{let s=SU({presets:n,textContent:ea.none(),htmlContent:o?e.text.map(e=>SG(e,t)):ea.none(),ariaLabel:e.text,iconContent:e.icon,shortcutContent:ea.none(),checkMark:ea.none(),caret:ea.none(),value:e.value},i.providers,l,e.icon);return S_({data:ST(e),enabled:e.enabled,getApi:k({}),onAction:t=>r(e.value,e.meta),onSetup:k(y),triggersSubmenu:!1,itemBehaviours:SW(e.meta,i)},s,a,i.providers)},Sq=(e,t)=>eh(e,e=>{switch(e.type){case"cardcontainer":return SV(e,Sq(e.items,t));case"cardimage":return SH(e.src,e.classes,e.alt);case"cardtext":let o=e.name.exists(e=>eu(t.cardText.highlightOn,e)),n=o?ea.from(t.cardText.matchText).getOr(""):"";return SM(SG(e.text,n),e.classes)}}),SX=(e,t,o,n)=>{let r=e=>({isEnabled:()=>!p7.isDisabled(e),setEnabled:t=>{p7.set(e,!t),ef(uX(e.element,"*"),o=>{e.getSystem().getByDom(o).each(e=>{e.hasConfigured(p7)&&p7.set(e,!t)})})}}),a={dom:SL(e.label),optComponents:[ea.some({dom:{tag:"div",classes:[xg,xp]},components:Sq(e.items,n)})]};return S_({data:ST({text:ea.none(),...e}),enabled:e.enabled,getApi:r,onAction:e.onAction,onSetup:e.onSetup,triggersSubmenu:!1,itemBehaviours:ea.from(n.itemBehaviours).getOr([])},a,t,o.providers)},SK=(e,t,o,n,r,a,i,l=!0)=>{let s=e=>({setActive:t=>{ve.set(e,t)},isActive:()=>ve.isOn(e),isEnabled:()=>!p7.isDisabled(e),setEnabled:t=>p7.set(e,!t)}),c=SU({presets:o,textContent:t?e.text:ea.none(),htmlContent:ea.none(),ariaLabel:e.text,iconContent:e.icon,shortcutContent:t?e.shortcut:ea.none(),checkMark:t?ea.some(SI(i.icons)):ea.none(),caret:ea.none(),value:e.value},i,l);return re(S_({data:ST(e),enabled:e.enabled,getApi:s,onAction:t=>n(e.value),onSetup:e=>(e.setActive(r),y),triggersSubmenu:!1,itemBehaviours:[]},c,a,i),{toggling:{toggleClass:xs,toggleOnExecute:!1,selected:e.active,exclusive:!0}})},SY=pg(vv(),vy()),SJ=e=>({value:e}),SZ=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,SQ=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,S0=e=>SZ.test(e)||SQ.test(e),S1=e=>te(e,"#").toUpperCase(),S2=e=>S0(e)?ea.some({value:S1(e)}):ea.none(),S3=e=>{let t=e.value.replace(SZ,(e,t,o,n)=>t+t+o+o+n+n);return{value:t}},S5=e=>{let t=S3(e),o=SQ.exec(t.value);return null===o?["FFFFFF","FF","FF","FF"]:o},S9=e=>{let t=e.toString(16);return(1===t.length?"0"+t:t).toUpperCase()},S4=e=>{let t=S9(e.red)+S9(e.green)+S9(e.blue);return SJ(t)},S6=Math.min,S8=Math.max,S7=Math.round,ke=/^\s*rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/i,kt=/^\s*rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?(?:\.\d+)?)\s*\)\s*$/i,ko=(e,t,o,n)=>({red:e,green:t,blue:o,alpha:n}),kn=e=>{let t=parseInt(e,10);return t.toString()===e&&t>=0&&t<=255},kr=e=>{let t,o,n;let r=(e.hue||0)%360,a=e.saturation/100,i=e.value/100;if(a=S8(0,S6(a,1)),i=S8(0,S6(i,1)),0===a)return ko(t=o=n=S7(255*i),o,n,1);let l=r/60,s=i*a,c=s*(1-Math.abs(l%2-1)),d=i-s;switch(Math.floor(l)){case 0:t=s,o=c,n=0;break;case 1:t=c,o=s,n=0;break;case 2:t=0,o=s,n=c;break;case 3:t=0,o=c,n=s;break;case 4:t=c,o=0,n=s;break;case 5:t=s,o=0,n=c;break;default:t=o=n=0}return ko(t=S7(255*(t+d)),o=S7(255*(o+d)),n=S7(255*(n+d)),1)},ka=e=>{let t=S5(e),o=parseInt(t[1],16),n=parseInt(t[2],16),r=parseInt(t[3],16);return ko(o,n,r,1)},ki=(e,t,o,n)=>{let r=parseInt(e,10),a=parseInt(t,10),i=parseInt(o,10),l=parseFloat(n);return ko(r,a,i,l)},kl=e=>{if("transparent"===e)return ea.some(ko(0,0,0,0));let t=ke.exec(e);if(null!==t)return ea.some(ki(t[1],t[2],t[3],"1"));let o=kt.exec(e);return null!==o?ea.some(ki(o[1],o[2],o[3],o[4])):ea.none()},ks=e=>`rgba(${e.red},${e.green},${e.blue},${e.alpha})`,kc=ko(255,0,0,1),kd=e=>{e.dispatch("SkinLoaded")},ku=(e,t)=>{e.dispatch("SkinLoadError",t)},km=e=>{e.dispatch("ResizeEditor")},kg=(e,t)=>{e.dispatch("ResizeContent",t)},kp=(e,t)=>{e.dispatch("ScrollContent",t)},kh=(e,t)=>{e.dispatch("TextColorChange",t)},kf=(e,t)=>{e.dispatch("AfterProgressState",{state:t})},kb=(e,t)=>e.dispatch("ResolveName",{name:t.nodeName.toLowerCase(),target:t}),kv=(e,t)=>{e.dispatch("ToggleToolbarDrawer",{state:t})};var ky=tinymce.util.Tools.resolve("tinymce.util.LocalStorage");let kx={},kw=(e,t=10)=>{let o=ky.getItem(e),n=l(o)?JSON.parse(o):[],r=(e=>{let o=t-e.length;return o<0?e.slice(0,t):e})(n),a=o=>{ed(r,o).each(i),r.unshift(o),r.length>t&&r.pop(),ky.setItem(e,JSON.stringify(r))},i=e=>{r.splice(e,1)},s=()=>r.slice(0);return{add:a,state:s}},kS=e=>eY(kx,e).getOrThunk(()=>{let t=`tinymce-custom-colors-${e}`,o=ky.getItem(t);if(p(o)){let e=ky.getItem("tinymce-custom-colors");ky.setItem(t,h(e)?e:"[]")}let n=kw(t,10);return kx[e]=n,n}),kk=e=>eh(kS(e).state(),e=>({type:"choiceitem",text:e,icon:"checkmark",value:e})),kC=(e,t)=>{kS(e).add(t)},kO=(e,t,o)=>({hue:e,saturation:t,value:o}),k_=e=>{let t=0,o=e.red/255,n=e.green/255,r=e.blue/255,a=Math.min(o,Math.min(n,r)),i=Math.max(o,Math.max(n,r));return a===i?kO(0,0,100*a):kO(Math.round(60*((o===a?3:r===a?1:5)-(o===a?n-r:r===a?o-n:r-o)/(i-a))),Math.round(100*((i-a)/i)),Math.round(100*i))},kT=e=>k_(ka(e)),kE=e=>S4(kr(e)),kD=e=>S2(e).orThunk(()=>kl(e).map(S4)).getOrThunk(()=>{let t=document.createElement("canvas");t.height=1,t.width=1;let o=t.getContext("2d");o.clearRect(0,0,t.width,t.height),o.fillStyle="#FFFFFF",o.fillStyle=e,o.fillRect(0,0,1,1);let n=o.getImageData(0,0,1,1).data,r=n[0],a=n[1],i=n[2],l=n[3];return S4(ko(r,a,i,l))}),kA="forecolor",kM="hilitecolor",kB=e=>Math.max(5,Math.ceil(Math.sqrt(e))),kF=e=>{let t=[];for(let o=0;o<e.length;o+=2)t.push({text:e[o+1],value:"#"+kD(e[o]).value,icon:"checkmark",type:"choiceitem"});return t},kI=e=>t=>t.options.get(e),kR="#000000",kN=e=>{let t=e.options.register,o=e=>v(e,l)?{value:kF(e),valid:!0}:{valid:!1,message:"Must be an array of strings."};t("color_map",{processor:o,default:["#BFEDD2","Light Green","#FBEEB8","Light Yellow","#F8CAC6","Light Red","#ECCAFA","Light Purple","#C2E0F4","Light Blue","#2DC26B","Green","#F1C40F","Yellow","#E03E2D","Red","#B96AD9","Purple","#3598DB","Blue","#169179","Dark Turquoise","#E67E23","Orange","#BA372A","Dark Red","#843FA1","Dark Purple","#236FA1","Dark Blue","#ECF0F1","Light Gray","#CED4D9","Medium Gray","#95A5A6","Gray","#7E8C8D","Dark Gray","#34495E","Navy Blue","#000000","Black","#ffffff","White"]}),t("color_map_background",{processor:o}),t("color_map_foreground",{processor:o}),t("color_cols",{processor:"number",default:kB(kz(e,"default").length)}),t("color_cols_foreground",{processor:"number",default:kB(kz(e,kA).length)}),t("color_cols_background",{processor:"number",default:kB(kz(e,kM).length)}),t("custom_colors",{processor:"boolean",default:!0}),t("color_default_foreground",{processor:"string",default:kR}),t("color_default_background",{processor:"string",default:kR})},kV=(e,t)=>t===kA?kI("color_cols_foreground")(e):t===kM?kI("color_cols_background")(e):kI("color_cols")(e),kH=kI("custom_colors"),kz=(e,t)=>t===kA&&e.options.isSet("color_map_foreground")?kI("color_map_foreground")(e):t===kM&&e.options.isSet("color_map_background")?kI("color_map_background")(e):kI("color_map")(e),kL=kI("color_default_foreground"),kP=kI("color_default_background"),kU=(e,t)=>{let o=og(tp.fromDom(e.selection.getStart()),"hilitecolor"===t?"background-color":"color");return kl(o).map(e=>"#"+S4(e).value)},kW=(e,t,o)=>{e.undoManager.transact(()=>{e.focus(),e.formatter.apply(t,{value:o}),e.nodeChanged()})},kj=(e,t)=>{e.undoManager.transact(()=>{e.focus(),e.formatter.remove(t,{value:null},void 0,!0),e.nodeChanged()})},kG=e=>{e.addCommand("mceApplyTextcolor",(t,o)=>{kW(e,t,o)}),e.addCommand("mceRemoveTextcolor",t=>{kj(e,t)})},k$=e=>{let t="choiceitem",o={type:t,text:"Remove color",icon:"color-swatch-remove-color",value:"remove"};return e?[o,{type:t,text:"Custom color",icon:"color-picker",value:"custom"}]:[o]},kq=(e,t,o,n)=>{if("custom"===o){let o=kQ(e);o(o=>{o.each(o=>{kC(t,o),e.execCommand("mceApplyTextcolor",t,o),n(o)})},kU(e,t).getOr(kR))}else"remove"===o?(n(""),e.execCommand("mceRemoveTextcolor",t)):(n(o),e.execCommand("mceApplyTextcolor",t,o))},kX=(e,t,o)=>e.concat(kk(t).concat(k$(o))),kK=(e,t,o)=>n=>{n(kX(e,t,o))},kY=(e,t,o)=>{e.setIconFill("forecolor"===t?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color",o)},kJ=(e,t,o,n,r)=>{e.ui.registry.addSplitButton(t,{tooltip:n,presets:"color",icon:"forecolor"===t?"text-color":"highlight-bg-color",select:t=>{let n=kU(e,o);return eQ(n,t.toUpperCase())},columns:kV(e,o),fetch:kK(kz(e,o),o,kH(e)),onAction:t=>{kq(e,o,r.get(),y)},onItemAction:(n,a)=>{kq(e,o,a,o=>{r.set(o),kh(e,{name:t,color:o})})},onSetup:o=>{kY(o,t,r.get());let n=e=>{e.name===t&&kY(o,e.name,e.color)};return e.on("TextColorChange",n),()=>{e.off("TextColorChange",n)}}})},kZ=(e,t,o,n)=>{e.ui.registry.addNestedMenuItem(t,{text:n,icon:"forecolor"===t?"text-color":"highlight-bg-color",getSubmenuItems:()=>[{type:"fancymenuitem",fancytype:"colorswatch",initData:{storageKey:o},onAction:t=>{kq(e,o,t.value,y)}}]})},kQ=e=>(t,o)=>{let n=!1,r=o=>{let r=o.getData(),a=r.colorpicker;n?(t(ea.from(a)),o.close()):e.windowManager.alert(e.translate(["Invalid hex color code: {0}",a]))},a=(e,t)=>{"hex-valid"===t.name&&(n=t.value)};e.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:{colorpicker:o},onAction:a,onSubmit:r,onClose:y,onCancel:()=>{t(ea.none())}})},k0=e=>{kG(e);let t=kL(e),o=kP(e),n=ay(t),r=ay(o);kJ(e,"forecolor","forecolor","Text color",n),kJ(e,"backcolor","hilitecolor","Background color",r),kZ(e,"forecolor","forecolor","Text color"),kZ(e,"backcolor","hilitecolor","Background color")},k1=(e,t,o,n,r,a,i,l)=>{let s=xq(t),c=k2(t,o,n,"color"!==r?"normal":"color",a,i,l);return xY(e,s,c,n,{menuType:r})},k2=(e,t,o,n,r,a,i)=>e1(eh(e,l=>"choiceitem"===l.type?w$(l).fold(xX,l=>ea.some(SK(l,1===o,n,t,a(l.value),r,i,xq(e)))):ea.none())),k3=(e,t)=>{let o=xv(t);return 1===e?{mode:"menu",moveOnTab:!0}:"auto"===e?{mode:"grid",selector:"."+o.item,initSize:{numColumns:1,numRows:1}}:{mode:"matrix",rowSelector:"."+("color"===t?"tox-swatches__row":"tox-collection__group"),previousSelector:e=>"color"===t?sF(e.element,"[aria-checked=true]"):ea.none()}},k5=(e,t)=>1===e?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===e?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:"color"===t?".tox-swatches__row":".tox-collection__group",cell:"color"===t?`.${xi}`:`.${xa}`}},k9=(e,t)=>{let o=k4(e,t),n=t.colorinput.getColorCols(e.initData.storageKey),r="color",a=k1(i8("menu-value"),o,t=>{e.onAction({value:t})},n,r,xn.CLOSE_ON_EXECUTE,A,t.shared.providers),i={...a,markers:xv(r),movement:k3(n,r)};return{type:"widget",data:{value:i8("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[SY.widget(vM.sketch(i))]}},k4=(e,t)=>{let o=e.initData.allowCustomColors&&t.colorinput.hasCustomColors();return e.initData.colors.fold(()=>kX(t.colorinput.getColors(e.initData.storageKey),e.initData.storageKey,o),e=>e.concat(k$(o)))},k6=i8("cell-over"),k8=i8("cell-execute"),k7=(e,t,o)=>{let n=o=>iE(o,k6,{row:e,col:t}),r=o=>iE(o,k8,{row:e,col:t}),a=(e,t)=>{t.stop(),r(e)};return sC({dom:{tag:"div",attributes:{role:"button","aria-labelledby":o}},behaviours:cY([bV("insert-table-picker-cell",[iV(aY(),b$.focus),iV(ia(),r),iV(a3(),a),iV(il(),a)]),ve.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),b$.config({onFocus:n})])})},Ce=(e,t,o)=>{let n=[];for(let r=0;r<t;r++){let t=[];for(let n=0;n<o;n++)t.push(k7(r,n,e));n.push(t)}return n},Ct=(e,t,o,n,r)=>{for(let a=0;a<n;a++)for(let n=0;n<r;n++)ve.set(e[a][n],a<=t&&n<=o)},Co=e=>e_(e,e=>eh(e,lp)),Cn=(e,t)=>sx(`${t}x${e}`),Cr=e=>{let t=i8("size-label"),o=Ce(t,10,10),n=Cn(0,0),r=vZ({dom:{tag:"span",classes:["tox-insert-table-picker__label"],attributes:{id:t}},components:[n],behaviours:cY([bR.config({})])});return{type:"widget",data:{value:i8("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[SY.widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:Co(o).concat(r.asSpec()),behaviours:cY([bV("insert-table-picker",[i$(e=>{bR.set(r.get(e),[n])}),iU(k6,(e,t,n)=>{let{row:a,col:i}=n.event;Ct(o,a,i,10,10),bR.set(r.get(e),[Cn(a+1,i+1)])}),iU(k8,(t,o,n)=>{let{row:r,col:a}=n.event;e.onAction({numRows:r+1,numColumns:a+1}),iT(t,ic())})]),bw.config({initSize:{numRows:10,numColumns:10},mode:"flatgrid",selector:'[role="button"]'})])})]}},Ca={inserttable:Cr,colorswatch:k9},Ci=(e,t)=>eY(Ca,e.fancytype).map(o=>o(e,t)),Cl=(e,t,o,n=!0,r=!1)=>{let a=r?SN(o.icons):SR(o.icons),i=e=>({isEnabled:()=>!p7.isDisabled(e),setEnabled:t=>p7.set(e,!t)}),l=SU({presets:"normal",iconContent:e.icon,textContent:e.text,htmlContent:ea.none(),ariaLabel:e.text,caret:ea.some(a),checkMark:ea.none(),shortcutContent:e.shortcut},o,n);return S_({data:ST(e),getApi:i,enabled:e.enabled,onAction:y,onSetup:e.onSetup,triggersSubmenu:!0,itemBehaviours:[]},l,t,o)},Cs=(e,t,o,n=!0)=>{let r=e=>({isEnabled:()=>!p7.isDisabled(e),setEnabled:t=>p7.set(e,!t)}),a=SU({presets:"normal",iconContent:e.icon,textContent:e.text,htmlContent:ea.none(),ariaLabel:e.text,caret:ea.none(),checkMark:ea.none(),shortcutContent:e.shortcut},o,n);return S_({data:ST(e),getApi:r,enabled:e.enabled,onAction:e.onAction,onSetup:e.onSetup,triggersSubmenu:!1,itemBehaviours:[]},a,t,o)},Cc=e=>({type:"separator",dom:{tag:"div",classes:[xa,"tox-collection__group-heading"]},components:e.text.map(sx).toArray()}),Cd=(e,t,o,n=!0)=>{let r=e=>({setActive:t=>{ve.set(e,t)},isActive:()=>ve.isOn(e),isEnabled:()=>!p7.isDisabled(e),setEnabled:t=>p7.set(e,!t)}),a=SU({iconContent:e.icon,textContent:e.text,htmlContent:ea.none(),ariaLabel:e.text,checkMark:ea.some(SI(o.icons)),caret:ea.none(),shortcutContent:e.shortcut,presets:"normal",meta:e.meta},o,n);return re(S_({data:ST(e),enabled:e.enabled,getApi:r,onAction:e.onAction,onSetup:e.onSetup,triggersSubmenu:!1,itemBehaviours:[]},a,t,o),{toggling:{toggleClass:xs,toggleOnExecute:!1,selected:e.active}})},Cu=(e,t,o,n)=>o.getOrCreate(e,t,n),Cm=(e,t,o,n)=>o.getExisting(e,t,n);var Cg=Object.freeze({__proto__:null,getCoupled:Cu,getExistingCoupled:Cm}),Cp=[r2("others",rq(nq.value,rN()))];let Ch=()=>{let e={},t=(t,o)=>{let n=eH(t.others);if(0!==n.length)return eY(e,o);throw Error("Cannot find any known coupled components")},o=(o,n,r)=>t(n,r).getOrThunk(()=>{let t=eY(n.others,r).getOrDie("No information found for coupled component: "+r),a=t(o),i=o.getSystem().build(a);return e[r]=i,i}),n=(e,o,n)=>t(o,n).orThunk(()=>(eY(o.others,n).getOrDie("No information found for coupled component: "+n),ea.none())),r=k({});return ly({readState:r,getExisting:n,getOrCreate:o})};var Cf=Object.freeze({__proto__:null,init:Ch});let Cb=cZ({fields:Cp,name:"coupling",apis:Cg,state:Cf}),Cv=e=>{let t=ea.none(),o=[],n=e=>Cv(t=>{r(o=>{t(e(o))})}),r=e=>{i()?s(e):o.push(e)},a=e=>{i()||(t=ea.some(e),l(o),o=[])},i=()=>t.isSome(),l=e=>{ef(e,s)},s=e=>{t.each(t=>{setTimeout(()=>{e(t)},0)})};return e(a),{get:r,map:n,isReady:i}},Cy=e=>Cv(t=>{t(e)}),Cx={nu:Cv,pure:Cy},Cw=e=>{setTimeout(()=>{throw e},0)},CS=e=>{let t=t=>{e().then(t,Cw)},o=t=>CS(()=>e().then(t)),n=t=>CS(()=>e().then(e=>t(e).toPromise())),r=t=>CS(()=>e().then(()=>t.toPromise())),a=()=>Cx.nu(t),i=()=>{let t=null;return CS(()=>(null===t&&(t=e()),t))};return{map:o,bind:n,anonBind:r,toLazy:a,toCached:i,toPromise:e,get:t}},Ck=e=>CS(()=>new Promise(e)),CC=e=>CS(()=>Promise.resolve(e)),CO={nu:Ck,pure:CC},C_=k("sink"),CT=k(pl({name:C_(),overrides:k({dom:{tag:"div"},behaviours:cY([mE.config({useFixed:M})]),events:iI([iW(aQ()),iW(a$()),iW(a3())])})})),CE=(e,t)=>{let o=e.getHotspot(t).getOr(t),n="hotspot",r=e.getAnchorOverrides();return e.layouts.fold(()=>({type:n,hotspot:o,overrides:r}),e=>({type:n,hotspot:o,overrides:r,layouts:e}))},CD=(e,t,o)=>{let n=e.fetch;return n(o).map(t)},CA=(e,t,o,n,r,a,i)=>{let l=CD(e,t,n),s=CR(n,e);return l.map(e=>e.bind(e=>ea.from(vG.sketch({...a.menu(),uid:li(""),data:e,highlightOnOpen:i,onOpenMenu:(e,t)=>{let n=s().getOrDie();mE.position(n,t,{anchor:o}),go.decloak(r)},onOpenSubmenu:(e,t,o)=>{let n=s().getOrDie();mE.position(n,o,{anchor:{type:"submenu",item:t}}),go.decloak(r)},onRepositionMenu:(e,t,n)=>{let r=s().getOrDie();mE.position(r,t,{anchor:o}),ef(n,e=>{mE.position(r,e.triggeredMenu,{anchor:{type:"submenu",item:e.triggeringItem}})})},onEscape:()=>(b$.focus(n),go.close(r),ea.some(!0))}))))},CM=(e,t,o,n,r,a,i)=>{let l=CE(e,o),s=CA(e,t,l,o,n,r,i);return s.map(e=>(e.fold(()=>{go.isOpen(n)&&go.close(n)},e=>{go.cloak(n),go.open(n,e),a(n)}),n))},CB=(e,t,o,n,r,a,i)=>(go.close(n),CO.pure(n)),CF=(e,t,o,n,r,a)=>{let i=Cb.getCoupled(o,"sandbox"),l=go.isOpen(i);return(l?CB:CM)(e,t,o,i,n,r,a)},CI=(e,t,o)=>{let n=pj.getCurrent(t).getOr(t),r=oB(e.element);o?od(n.element,"min-width",r+"px"):oM(n.element,r)},CR=(e,t)=>e.getSystem().getByUid(t.uid+"-"+C_()).map(e=>()=>nq.value(e)).getOrThunk(()=>t.lazySink.fold(()=>()=>nq.error(Error("No internal sink is specified, nor could an external sink be found")),t=>()=>t(e))),CN=e=>{go.getState(e).each(e=>{vG.repositionMenus(e)})},CV=(e,t,o)=>{let n=sV(),r=(r,a)=>{let i=CE(e,t);n.link(t.element),e.matchWidth&&CI(i.hotspot,a,e.useMinWidth),e.onOpen(i,r,a),void 0!==o&&void 0!==o.onOpen&&o.onOpen(r,a)},a=(e,r)=>{n.unlink(t.element),void 0!==o&&void 0!==o.onClose&&o.onClose(e,r)},i=CR(t,e);return{dom:{tag:"div",classes:e.sandboxClasses,attributes:{id:n.id,role:"listbox"}},behaviours:gL.augment(e.sandboxBehaviours,[gN.config({store:{mode:"memory",initialValue:t}}),go.config({onOpen:r,onClose:a,isPartOf:(e,o,n)=>sz(o,n)||sz(t,n),getAttachPoint:()=>i().getOrDie()}),pj.config({find:e=>go.getState(e).bind(e=>pj.getCurrent(e))}),c2.config({channels:{...gl({isExtraPart:A}),...gc({doReposition:CN})}})])}},CH=e=>{let t=Cb.getCoupled(e,"sandbox");CN(t)},Cz=()=>[ad("sandboxClasses",[]),gL.field("sandboxBehaviours",[pj,c2,go,gN])],CL=k([r1("dom"),r1("fetch"),s1("onOpen"),s2("onExecute"),ad("getHotspot",ea.some),ad("getAnchorOverrides",k({})),d6(),gV("dropdownBehaviours",[ve,Cb,bw,b$]),r1("toggleClass"),ad("eventOrder",{}),at("lazySink"),ad("matchWidth",!1),ad("useMinWidth",!1),at("role")].concat(Cz())),CP=k([pi({schema:[sZ(),ad("fakeFocus",!1)],name:"menu",defaults:e=>({onExecute:e.onExecute})}),CT()]),CU=(e,t,o,n)=>{let r=e=>{go.getState(e).each(e=>{vG.highlightPrimary(e)})},a=(t,o,r)=>CF(e,C,t,n,o,r),i=e=>{a(e,r,J.HighlightMenuAndItem).get(y)},l={expand:e=>{ve.isOn(e)||a(e,y,J.HighlightNone).get(y)},open:e=>{ve.isOn(e)||a(e,y,J.HighlightMenuAndItem).get(y)},refetch:t=>{let o=Cb.getExistingCoupled(t,"sandbox");return o.fold(()=>a(t,y,J.HighlightMenuAndItem).map(y),o=>CM(e,C,t,o,n,y,J.HighlightMenuAndItem).map(y))},isOpen:ve.isOn,close:e=>{ve.isOn(e)&&a(e,y,J.HighlightMenuAndItem).get(y)},repositionMenus:e=>{ve.isOn(e)&&CH(e)}},s=(e,t)=>(iD(e),ea.some(!0));return{uid:e.uid,dom:e.dom,components:t,behaviours:gz(e.dropdownBehaviours,[ve.config({toggleClass:e.toggleClass,aria:{mode:"expanded"}}),Cb.config({others:{sandbox:t=>CV(e,t,{onOpen:()=>ve.on(t),onClose:()=>ve.off(t)})}}),bw.config({mode:"special",onSpace:s,onEnter:s,onDown:(e,t)=>{if(CW.isOpen(e)){let t=Cb.getCoupled(e,"sandbox");r(t)}else CW.open(e);return ea.some(!0)},onEscape:(e,t)=>CW.isOpen(e)?(CW.close(e),ea.some(!0)):ea.none()}),b$.config({})]),events:vo(ea.some(i)),eventOrder:{...e.eventOrder,[ia()]:["disabling","toggling","alloy.base.behaviour"]},apis:l,domModification:{attributes:{"aria-haspopup":"true",...e.role.fold(()=>({}),e=>({role:e})),..."button"===e.dom.tag?{type:eY(e.dom,"attributes").bind(e=>eY(e,"type")).getOr("button")}:{}}}}},CW=pz({name:"Dropdown",configFields:CL(),partFields:CP(),factory:CU,apis:{open:(e,t)=>e.open(t),refetch:(e,t)=>e.refetch(t),expand:(e,t)=>e.expand(t),close:(e,t)=>e.close(t),isOpen:(e,t)=>e.isOpen(t),repositionMenus:(e,t)=>e.repositionMenus(t)}}),Cj=e=>"no-search"===e.searchMode?{menuType:"normal"}:{menuType:"searchable",searchMode:e},CG=e=>{let t=gN.getValue(e),o=xM(e).map(xF);CW.refetch(t).get(()=>{let e=Cb.getCoupled(t,"sandbox");o.each(t=>xM(e).each(e=>xB(e,t)))})},C$=(e,t)=>{Cq(e).each(o=>{iB(e,o.element,t.event.eventType,t.event.interactionEvent)})},Cq=e=>go.getState(e).bind(hy.getHighlighted).bind(hy.getHighlighted),CX=e=>l2(e.element,xN)?ea.some(e.element):sF(e.element,"."+xN),CK=(e,t,o)=>{xM(e).each(e=>{xI(e,o);let n=CX(t);n.each(t=>{or(t,"id").each(t=>ot(e.element,"aria-controls",t))})}),ot(o.element,"aria-selected","true")},CY=(e,t,o)=>{ot(o.element,"aria-selected","false")},CJ=e=>{xM(e).each(e=>b$.focus(e))},CZ=e=>{let t=Cb.getExistingCoupled(e,"sandbox");return t.bind(xM).map(xF).map(e=>e.fetchPattern).getOr("")};(W=et||(et={}))[W.ContentFocus=0]="ContentFocus",W[W.UiFocus=1]="UiFocus";let CQ=(e,t,o,n,r)=>{let a=o.shared.providers,i=e=>r?{...e,shortcut:ea.none(),icon:e.text.isSome()?ea.none():e.icon}:e;switch(e.type){case"menuitem":return wQ(e).fold(xX,e=>ea.some(Cs(i(e),t,a,n)));case"nestedmenuitem":return w1(e).fold(xX,e=>ea.some(Cl(i(e),t,a,n,r)));case"togglemenuitem":return w3(e).fold(xX,e=>ea.some(Cd(i(e),t,a,n)));case"separator":return wf(e).fold(xX,e=>ea.some(Cc(e)));case"fancymenuitem":return wJ(e).fold(xX,e=>Ci(e,o));default:return console.error("Unknown item in general menu",e),ea.none()}},C0=(e,t,o,n,r,a,i)=>{let l=1===n,s=!l||xq(e);return e1(eh(e,e=>{switch(e.type){case"separator":return wv(e).fold(xX,e=>ea.some(Cc(e)));case"cardmenuitem":return wj(e).fold(xX,e=>ea.some(SX({...e,onAction:t=>{e.onAction(t),o(e.value,e.meta)}},r,a,{itemBehaviours:SW(e.meta,a),cardText:{matchText:t,highlightOn:i}})));default:return wy(e).fold(xX,e=>ea.some(S$(e,t,l,"normal",o,r,a,s)))}}))},C1=(e,t,o,n,r,a)=>{let i=xq(t),l=e1(eh(t,e=>{var t;let a=e=>r?!eJ(e,"text"):i;return CQ(t="nestedmenuitem"===e.type&&e.getSubmenuItems().length<=0?{...e,enabled:!1}:e,o,n,a(t),r)})),s=Cj(a);return(r?xK:xY)(e,i,l,1,s)},C2=e=>vG.singleData(e.value,e),C3=(e,t,o,n)=>{let r=k3(t,n),a=xv(n);return{data:C2({...e,movement:r,menuBehaviours:w6.unnamedEvents("auto"!==t?[]:[i$((e,t)=>{w5(e,4,a.item).each(({numColumns:t,numRows:o})=>{bw.setGridSize(e,o,t)})})])}),menu:{markers:xv(n),fakeFocus:o===et.ContentFocus}}},C5=(e,t)=>y7(tp.fromDom(t.startContainer)).map(t=>{let o=e.createRng();return o.selectNode(t.dom),o}),C9=(e,t)=>{let o=ay(!1),n=ay(!1),r=sC(vX.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:cY([bV("dismissAutocompleter",[iV(iy(),()=>c())])]),lazySink:t.getSink})),a=()=>vX.isOpen(r),i=n.get,l=()=>{a()&&vX.hide(r)},s=()=>vX.getContent(r).bind(e=>eF(e.components(),0)),c=()=>e.execCommand("mceAutocompleterClose"),d=n=>{let r=eV(n,e=>ea.from(e.columns)).getOr(1);return e_(n,n=>{let a=n.items;return C0(a,n.matchText,(t,r)=>{let a=e.selection.getRng();C5(e.dom,a).each(a=>{o.set(!0),n.onAction({hide:()=>c(),reload:t=>{l(),e.execCommand("mceAutocompleterReload",!1,{fetchOptions:t})}},a,t,r),o.set(!1)})},r,xn.BUBBLE_TO_SANDBOX,t,n.highlightOn)})},u=(t,o)=>{xe(tp.fromDom(e.getBody())).each(n=>{let a=eV(t,e=>ea.from(e.columns)).getOr(1);vX.showMenuAt(r,{anchor:{type:"node",root:tp.fromDom(e.getBody()),node:ea.from(n)}},C3(xY("autocompleter-value",!0,o,a,{menuType:"normal"}),a,et.ContentFocus,"normal"))}),s().each(hy.highlightFirst)},m=e=>{let t=d(e);t.length>0?u(e,t):l()};e.on("AutocompleterStart",({lookupData:e})=>{n.set(!0),o.set(!1),m(e)}),e.on("AutocompleterUpdate",({lookupData:e})=>m(e)),e.on("AutocompleterEnd",()=>{l(),n.set(!1),o.set(!1)});let g={cancelIfNecessary:c,isMenuOpen:a,isActive:i,isProcessingAction:o.get,getMenu:s};xo.setup(g,e)},C4={register:C9},C6=(e,t,o)=>sI(e,t,o).isSome(),C8=(e,t)=>{let o=null,n=(...n)=>{o=setTimeout(()=>{e.apply(null,n),o=null},t)},r=()=>{null!==o&&(clearTimeout(o),o=null)};return{cancel:r,schedule:n}},C7=e=>{let t=e.raw;return void 0===t.touches||1!==t.touches.length?ea.none():ea.some(t.touches[0])},Oe=(e,t)=>{let o=Math.abs(e.clientX-t.x),n=Math.abs(e.clientY-t.y);return o>5||n>5},Ot=e=>{let t=dD(),o=ay(!1),n=C8(t=>{e.triggerEvent(is(),t),o.set(!0)},400),r=e=>(C7(e).each(r=>{n.cancel();let a={x:r.clientX,y:r.clientY,target:e.target};n.schedule(e),o.set(!1),t.set(a)}),ea.none()),a=e=>(n.cancel(),C7(e).each(e=>{t.on(o=>{Oe(e,o)&&t.clear()})}),ea.none()),i=r=>{n.cancel();let a=e=>tN(e.target,r.target);return t.get().filter(a).map(t=>o.get()?(r.prevent(),!1):e.triggerEvent(il(),r))},l=aE([{key:aU(),value:r},{key:aW(),value:a},{key:aj(),value:i}]),s=(e,t)=>eY(l,t).bind(t=>t(e));return{fireIfReady:s}},Oo=e=>{let t=e.raw;return 8===t.which&&!eu(["input","textarea"],tk(e.target))&&!C6(e.target,'[contenteditable="true"]')},On=(e,t)=>{let o={stopBackspace:!0,...t},n=Ot(o),r=eh(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","transitioncancel","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),t=>dA(e,t,e=>{n.fireIfReady(e,t).each(t=>{t&&e.kill()});let r=o.triggerEvent(t,e);r&&e.kill()})),a=dD(),i=dA(e,"paste",e=>{n.fireIfReady(e,"paste").each(t=>{t&&e.kill()});let t=o.triggerEvent("paste",e);t&&e.kill(),a.set(setTimeout(()=>{o.triggerEvent(io(),e)},0))}),l=dA(e,"keydown",e=>{let t=o.triggerEvent("keydown",e);t?e.kill():o.stopBackspace&&Oo(e)&&e.prevent()}),s=dA(e,"focusin",e=>{let t=o.triggerEvent("focusin",e);t&&e.kill()}),c=dD(),d=dA(e,"focusout",e=>{let t=o.triggerEvent("focusout",e);t&&e.kill(),c.set(setTimeout(()=>{o.triggerEvent(it(),e)},0))}),u=()=>{ef(r,e=>{e.unbind()}),l.unbind(),s.unbind(),d.unbind(),i.unbind(),a.on(clearTimeout),c.on(clearTimeout)};return{unbind:u}},Or=(e,t)=>{let o=eY(e,"target").getOr(t);return ay(o)},Oa=(e,t)=>{let o=ay(!1),n=ay(!1),r=()=>{o.set(!0)},a=()=>{n.set(!0)};return{stop:r,cut:a,isStopped:o.get,isCut:n.get,event:e,setSource:t.set,getSource:t.get}},Oi=e=>{let t=ay(!1),o=()=>{t.set(!0)};return{stop:o,cut:y,isStopped:t.get,isCut:A,event:e,setSource:E("Cannot set source of a broadcasted event"),getSource:E("Cannot get source of a broadcasted event")}},Ol=aw.generate([{stopped:[]},{resume:["element"]},{complete:[]}]),Os=(e,t,o,n,r,a)=>{let i=e(t,n),l=Oa(o,r);return i.fold(()=>(a.logEventNoHandlers(t,n),Ol.complete()),e=>{let o=e.descHandler,n=lM(o);return(n(l),l.isStopped())?(a.logEventStopped(t,e.element,o.purpose),Ol.stopped()):l.isCut()?(a.logEventCut(t,e.element,o.purpose),Ol.complete()):tU(e.element).fold(()=>(a.logNoParent(t,e.element,o.purpose),Ol.complete()),n=>(a.logEventResponse(t,e.element,o.purpose),Ol.resume(n)))})},Oc=(e,t,o,n,r,a)=>Os(e,t,o,n,r,a).fold(M,n=>Oc(e,t,o,n,r,a),A),Od=(e,t,o,n,r)=>{let a=Or(o,n);return Os(e,t,o,n,a,r)},Ou=(e,t,o)=>{let n=Oi(t);return ef(e,e=>{let t=e.descHandler,o=lM(t);o(n)}),n.isStopped()},Om=(e,t,o,n)=>Og(e,t,o,o.target,n),Og=(e,t,o,n,r)=>{let a=Or(o,n);return Oc(e,t,o,n,a,r)},Op=(e,t)=>({element:e,descHandler:t}),Oh=(e,t)=>({id:e,descHandler:t}),Of=()=>{let e={},t=(t,o,n)=>{eL(n,(n,r)=>{let a=void 0!==e[r]?e[r]:{};a[o]=lA(n,t),e[r]=a})},o=(e,t)=>la(t).bind(t=>eY(e,t)).map(e=>Op(t,e)),n=t=>eY(e,t).map(e=>eq(e,(e,t)=>Oh(t,e))).getOr([]),r=(t,n,r)=>eY(e,n).bind(e=>aI(r,t=>o(e,t),t)),a=t=>{eL(e,(e,o)=>{eJ(e,t)&&delete e[t]})};return{registerId:t,unregisterId:a,filterByType:n,find:r}},Ob=()=>{let e=Of(),t={},o=e=>{let t=e.element;return la(t).getOrThunk(()=>ln("uid-",e.element))},n=(e,o)=>{let n=t[o];if(n===e)a(e);else throw Error('The tagId "'+o+'" is already used by: '+i3(n.element)+"\nCannot use it for: "+i3(e.element)+"\nThe conflicting element is"+(t6(n.element)?" ":" not ")+"already in the DOM")},r=r=>{let a=o(r);eZ(t,a)&&n(r,a),e.registerId([r],a,r.events),t[a]=r},a=o=>{la(o.element).each(o=>{delete t[o],e.unregisterId(o)})},i=t=>e.filterByType(t),l=(t,o,n)=>e.find(t,o,n),s=e=>eY(t,e);return{find:l,filter:i,register:r,unregister:a,getById:s}},Ov=e=>{let{attributes:t,...o}=e.dom;return{uid:e.uid,dom:{tag:"div",attributes:{role:"presentation",...t},...o},components:e.components,behaviours:gH(e.containerBehaviours),events:e.events,domModification:e.domModification,eventOrder:e.eventOrder}},Oy=pH({name:"Container",factory:Ov,configFields:[ad("components",[]),gV("containerBehaviours",[]),ad("events",{}),ad("domModification",{}),ad("eventOrder",{})]}),Ox=e=>{let t=t=>tU(e.element).fold(M,e=>tN(t,e)),o=Ob(),n=(e,n)=>o.find(t,e,n),r=On(e.element,{triggerEvent:(e,t)=>s$(e,t.target,o=>Om(n,e,t,o))}),a={debugInfo:k("real"),triggerEvent:(e,t,o)=>{s$(e,t,r=>Og(n,e,o,t,r))},triggerFocus:(e,t)=>{la(e).fold(()=>{c9(e)},o=>{s$(ie(),e,o=>(Od(n,ie(),{originator:t,kill:y,prevent:y,target:e},e,o),!1))})},triggerEscape:(e,t)=>{a.triggerEvent("keydown",e.element,t.event)},getByUid:e=>h(e),getByDom:e=>f(e),build:sC,buildOrPatch:sk,addToGui:e=>{s(e)},removeFromGui:e=>{c(e)},addToWorld:e=>{i(e)},removeFromWorld:e=>{l(e)},broadcast:e=>{m(e)},broadcastOn:(e,t)=>{g(e,t)},broadcastEvent:(e,t)=>{p(e,t)},isConnected:M},i=e=>{e.connect(a),tE(e.element)||(o.register(e),ef(e.components(),i),a.triggerEvent(iu(),e.element,{target:e.element}))},l=e=>{tE(e.element)||(ef(e.components(),l),o.unregister(e)),e.disconnect()},s=t=>{mH(e,t)},c=e=>{mP(e)},d=()=>{r.unbind(),nO(e.element)},u=e=>{let t=o.filter(ir());ef(t,t=>{let o=t.descHandler,n=lM(o);n(e)})},m=e=>{u({universal:!0,data:e})},g=(e,t)=>{u({universal:!1,channels:e,data:t})},p=(e,t)=>{let n=o.filter(e);return Ou(n,t)},h=e=>o.getById(e).fold(()=>nq.error(Error('Could not find component with uid: "'+e+'" in system.')),nq.value),f=e=>{let t=la(e).getOr("not found");return h(t)};return i(e),{root:e,element:e.element,destroy:d,add:s,remove:c,getByUid:h,getByDom:f,addToWorld:i,removeFromWorld:l,broadcast:m,broadcastOn:g,broadcastEvent:p}},Ow=(e,t)=>({dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:eh(e.items,t.interpreter)}),OS=k([ad("prefix","form-field"),gV("fieldBehaviours",[pj,gN])]),Ok=k([pl({schema:[r1("dom")],name:"label"}),pl({factory:{sketch:e=>({uid:e.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:e.text}})},schema:[r1("text")],name:"aria-descriptor"}),pa({factory:{sketch:e=>{let t=a_(e,["factory"]);return e.factory.sketch(t)}},schema:[r1("factory")],name:"field"})]),OC=(e,t,o,n)=>{let r=gz(e.fieldBehaviours,[pj.config({find:t=>px(t,e,"field")}),gN.config({store:{mode:"manual",getValue:e=>pj.getCurrent(e).bind(gN.getValue),setValue:(e,t)=>{pj.getCurrent(e).each(e=>{gN.setValue(e,t)})}}})]),a=iI([i$((t,o)=>{let n=pS(t,e,["label","field","aria-descriptor"]);n.field().each(t=>{let o=i8(e.prefix);n.label().each(e=>{ot(e.element,"for",o),ot(t.element,"id",o)}),n["aria-descriptor"]().each(o=>{let n=i8(e.prefix);ot(o.element,"id",n),ot(t.element,"aria-describedby",n)})})})]);return{uid:e.uid,dom:e.dom,components:t,behaviours:r,events:a,apis:{getField:t=>px(t,e,"field"),getLabel:t=>px(t,e,"label")}}},OO=pz({name:"FormField",configFields:OS(),partFields:Ok(),factory:OC,apis:{getField:(e,t)=>e.getField(t),getLabel:(e,t)=>e.getLabel(t)}}),O_=(e,t)=>lC({attributes:aE([{key:t.tabAttr,value:"true"}])});var OT=Object.freeze({__proto__:null,exhibit:O_}),OE=[ad("tabAttr","data-alloy-tabstop")];let OD=cZ({fields:OE,name:"tabstopping",active:OT});var OA=tinymce.util.Tools.resolve("tinymce.html.Entities");let OM=(e,t,o,n)=>{let r=OF(e,t,o,n);return OO.sketch(r)},OB=(e,t)=>OM(e,t,[],[]),OF=(e,t,o,n)=>({dom:OR(o),components:e.toArray().concat([t]),fieldBehaviours:cY(n)}),OI=()=>OR([]),OR=e=>({tag:"div",classes:["tox-form__group"].concat(e)}),ON=(e,t)=>OO.parts.label({dom:{tag:"label",classes:["tox-label"]},components:[sx(t.translate(e))]}),OV=i8("form-component-change"),OH=i8("form-close"),Oz=i8("form-cancel"),OL=i8("form-action"),OP=i8("form-submit"),OU=i8("form-block"),OW=i8("form-unblock"),Oj=i8("form-tabchange"),OG=i8("form-resize"),O$=(e,t,o)=>{let n=e.label.map(e=>ON(e,t)),r=e=>(t,o)=>{sI(o.event.target,"[data-collection-item-value]").each(n=>{e(t,o,n,on(n,"data-collection-item-value"))})},a=(o,n)=>{let r=eh(n,o=>{let n=vQ.translate(o.text),r=1===e.columns?`<div class="tox-collection__item-label">${n}</div>`:"",a=`<div class="tox-collection__item-icon">${o.icon}</div>`,i={_:" "," - ":" ","-":" "},l=n.replace(/\_| \- |\-/g,e=>i[e]),s=t.isDisabled()?" tox-collection__item--state-disabled":"";return`<div class="tox-collection__item${s}" tabindex="-1" data-collection-item-value="${OA.encodeAllRaw(o.value)}" title="${l}" aria-label="${l}">${a}${r}</div>`}),a="auto"!==e.columns&&e.columns>1?ep(r,e.columns):[r],i=eh(a,e=>`<div class="tox-collection__group">${e.join("")}</div>`);iZ(o.element,i.join(""))},i=r((o,n,r,a)=>{n.stop(),t.isDisabled()||iE(o,OL,{name:e.name,value:a})}),l=[iV(aY(),r((e,t,o)=>{c9(o)})),iV(a3(),i),iV(il(),i),iV(aJ(),r((e,t,o)=>{sF(e.element,"."+xm).each(e=>{l1(e,xm)}),lQ(o,xm)})),iV(aZ(),r(e=>{sF(e.element,"."+xm).each(e=>{l1(e,xm)})})),iK(r((t,o,n,r)=>{iE(t,OL,{name:e.name,value:r})}))],s=(e,t)=>eh(uX(e.element,".tox-collection__item"),t),c=OO.parts.field({dom:{tag:"div",classes:["tox-collection"].concat(1!==e.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:C},behaviours:cY([p7.config({disabled:t.isDisabled,onDisabled:e=>{s(e,e=>{lQ(e,"tox-collection__item--state-disabled"),ot(e,"aria-disabled",!0)})},onEnabled:e=>{s(e,e=>{l1(e,"tox-collection__item--state-disabled"),oi(e,"aria-disabled")})}}),Sh(),bR.config({}),gN.config({store:{mode:"memory",initialValue:o.getOr([])},onSetValue:(t,o)=>{a(t,o),"auto"===e.columns&&w5(t,5,"tox-collection__item").each(({numRows:e,numColumns:o})=>{bw.setGridSize(t,e,o)}),iT(t,OG)}}),OD.config({}),bw.config(k5(e.columns,"normal")),bV("collection-events",l)]),eventOrder:{[ia()]:["disabling","alloy.base.behaviour","collection-events"]}});return OM(n,c,["tox-form__group--collection"],[])},Oq=["input","textarea"],OX=e=>{let t=tk(e);return eu(Oq,t)},OK=(e,t)=>{let o=t.getRoot(e).getOr(e.element);l1(o,t.invalidClass),t.notify.each(t=>{OX(e.element)&&ot(e.element,"aria-invalid",!1),t.getContainer(e).each(e=>{iZ(e,t.validHtml)}),t.onValid(e)})},OY=(e,t,o,n)=>{let r=t.getRoot(e).getOr(e.element);lQ(r,t.invalidClass),t.notify.each(t=>{OX(e.element)&&ot(e.element,"aria-invalid",!0),t.getContainer(e).each(e=>{iZ(e,n)}),t.onInvalid(e,n)})},OJ=(e,t,o)=>t.validator.fold(()=>CO.pure(nq.value(!0)),t=>t.validate(e)),OZ=(e,t,o)=>(t.notify.each(t=>{t.onValidate(e)}),OJ(e,t).map(n=>e.getSystem().isConnected()?n.fold(n=>(OY(e,t,o,n),nq.error(n)),o=>(OK(e,t),nq.value(o))):nq.error("No longer in system"))),OQ=(e,t)=>{let o=t.getRoot(e).getOr(e.element);return l2(o,t.invalidClass)};var O0=Object.freeze({__proto__:null,markValid:OK,markInvalid:OY,query:OJ,run:OZ,isInvalid:OQ});let O1=(e,t)=>e.validator.map(o=>iI([iV(o.onEvent,o=>{OZ(o,e,t).get(C)})].concat(o.validateOnLoad?[i$(o=>{OZ(o,e,t).get(y)})]:[]))).getOr({});var O2=Object.freeze({__proto__:null,events:O1}),O3=[r1("invalidClass"),ad("getRoot",ea.none),as("notify",[ad("aria","alert"),ad("getContainer",ea.none),ad("validHtml",""),s1("onValid"),s1("onInvalid"),s1("onValidate")]),as("validator",[r1("validate"),ad("onEvent","input"),ad("validateOnLoad",!0)])];let O5=cZ({fields:O3,name:"invalidating",active:O2,apis:O0,extra:{validation:e=>t=>{let o=gN.getValue(t);return CO.pure(e(o))}}}),O9=()=>lC({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}}),O4=()=>iI([iR(a6(),M)]);var O6=Object.freeze({__proto__:null,events:O4,exhibit:O9});let O8=cZ({fields:[],name:"unselecting",active:O6}),O7=(e,t)=>CW.sketch({dom:e.dom,components:e.components,toggleClass:"mce-active",dropdownBehaviours:cY([Sx.button(t.providers.isDisabled),Sh(),O8.config({}),OD.config({})]),layouts:e.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:t.getSink,fetch:o=>CO.nu(t=>e.fetch(t)).map(n=>ea.from(C2(re(k1(i8("menu-value"),n,t=>{e.onItemAction(o,t)},e.columns,e.presets,xn.CLOSE_ON_EXECUTE,A,t.providers),{movement:k3(e.columns,e.presets)})))),parts:{menu:xw(!1,1,e.presets)}}),_e=i8("color-input-change"),_t=i8("color-swatch-change"),_o=i8("color-picker-cancel"),_n=(e,t,o,n)=>{let r=OO.parts.field({factory:xT,inputClasses:["tox-textfield"],data:n,onSetValue:e=>O5.run(e).get(y),inputBehaviours:cY([p7.config({disabled:t.providers.isDisabled}),Sh(),OD.config({}),O5.config({invalidClass:"tox-textbox-field-invalid",getRoot:e=>tW(e.element),notify:{onValid:e=>{let t=gN.getValue(e);iE(e,_e,{color:t})}},validator:{validateOnLoad:!1,validate:e=>{let t=gN.getValue(e);if(0===t.length)return CO.pure(nq.value(!0));{let e=tp.fromTag("span");od(e,"background-color",t);let o=oh(e,"background-color").fold(()=>nq.error("blah"),e=>nq.value(t));return CO.pure(o)}}}})]),selectOnFocus:!1}),a=e.label.map(e=>ON(e,t.providers)),i=(e,t)=>{iE(e,_t,{value:t})},l=(t,n)=>{s.getOpt(t).each(t=>{"custom"===n?o.colorPicker(o=>{o.fold(()=>iT(t,_o),o=>{i(t,o),kC(e.storageKey,o)})},"#ffffff"):"remove"===n?i(t,""):i(t,n)})},s=vZ(O7({dom:{tag:"span",attributes:{"aria-label":t.providers.translate("Color swatch")}},layouts:{onRtl:()=>[c_,cO,cA],onLtr:()=>[cO,c_,cA]},components:[],fetch:kK(o.getColors(e.storageKey),e.storageKey,o.hasCustomColors()),columns:o.getColorCols(e.storageKey),presets:"color",onItemAction:l},t));return OO.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:a.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[r,s.asSpec()]}]),fieldBehaviours:cY([bV("form-field-events",[iV(_e,(t,o)=>{s.getOpt(t).each(e=>{od(e.element,"background-color",o.event.color)}),iE(t,OV,{name:e.name})}),iV(_t,(e,t)=>{OO.getField(e).each(o=>{gN.setValue(o,t.event.value),pj.getCurrent(e).each(b$.focus)})}),iV(_o,(e,t)=>{OO.getField(e).each(t=>{pj.getCurrent(e).each(b$.focus)})})])])})},_r=pl({schema:[r1("dom")],name:"label"}),_a=e=>pl({name:""+e+"-edge",overrides:t=>{let o=t.model.manager.edgeActions[e];return o.fold(()=>({}),e=>({events:iI([iH(aU(),(t,o,n)=>e(t,n),[t]),iH(a$(),(t,o,n)=>e(t,n),[t]),iH(aq(),(t,o,n)=>{n.mouseIsDown.get()&&e(t,n)},[t])])}))}}),_i=_a("top-left"),_l=_a("top"),_s=_a("top-right"),_c=_a("right"),_d=_a("bottom-right"),_u=_a("bottom"),_m=_a("bottom-left"),_g=_a("left"),_p=pa({name:"thumb",defaults:k({dom:{styles:{position:"absolute"}}}),overrides:e=>({events:iI([iP(aU(),e,"spectrum"),iP(aW(),e,"spectrum"),iP(aj(),e,"spectrum"),iP(a$(),e,"spectrum"),iP(aq(),e,"spectrum"),iP(aK(),e,"spectrum")])})}),_h=pa({schema:[n4("mouseIsDown",()=>ay(!1))],name:"spectrum",overrides:e=>{let t=e.model,o=t.manager,n=(t,n)=>o.getValueFromEvent(n).map(n=>o.setValueFrom(t,e,n));return{behaviours:cY([bw.config({mode:"special",onLeft:t=>o.onLeft(t,e),onRight:t=>o.onRight(t,e),onUp:t=>o.onUp(t,e),onDown:t=>o.onDown(t,e)}),b$.config({})]),events:iI([iV(aU(),n),iV(aW(),n),iV(a$(),n),iV(aq(),(t,o)=>{e.mouseIsDown.get()&&n(t,o)})])}}}),_f=k("slider.change.value"),_b=e=>-1!==e.type.indexOf("touch"),_v=e=>{let t=e.event.raw;return _b(t)?void 0!==t.touches&&1===t.touches.length?ea.some(t.touches[0]).map(e=>oO(e.clientX,e.clientY)):ea.none():void 0!==t.clientX?ea.some(t).map(e=>oO(e.clientX,e.clientY)):ea.none()},_y=e=>e.model.minX,_x=e=>e.model.minY,_w=e=>e.model.minX-1,_S=e=>e.model.minY-1,_k=e=>e.model.maxX,_C=e=>e.model.maxY,_O=e=>e.model.maxX+1,__=e=>e.model.maxY+1,_T=(e,t,o)=>t(e)-o(e),_E=e=>_T(e,_k,_y),_D=e=>_T(e,_C,_x),_A=e=>_E(e)/2,_M=e=>_D(e)/2,_B=e=>e.stepSize,_F=e=>e.snapToGrid,_I=e=>e.snapStart,_R=e=>e.rounded,_N=(e,t)=>void 0!==e[t+"-edge"],_V=e=>_N(e,"left"),_H=e=>_N(e,"right"),_z=e=>_N(e,"top"),_L=e=>_N(e,"bottom"),_P=e=>e.model.value.get(),_U=(e,t)=>({x:e,y:t}),_W=(e,t)=>{iE(e,_f(),{value:t})},_j=(e,t)=>{_W(e,_U(_w(t),_S(t)))},_G=(e,t)=>{_W(e,_S(t))},_$=(e,t)=>{_W(e,_U(_A(t),_S(t)))},_q=(e,t)=>{_W(e,_U(_O(t),_S(t)))},_X=(e,t)=>{_W(e,_O(t))},_K=(e,t)=>{_W(e,_U(_O(t),_M(t)))},_Y=(e,t)=>{_W(e,_U(_O(t),__(t)))},_J=(e,t)=>{_W(e,__(t))},_Z=(e,t)=>{_W(e,_U(_A(t),__(t)))},_Q=(e,t)=>{_W(e,_U(_w(t),__(t)))},_0=(e,t)=>{_W(e,_w(t))},_1=(e,t)=>{_W(e,_U(_w(t),_M(t)))},_2=(e,t,o,n)=>e<t?e:e>o?o:e===t?t-1:Math.max(t,e-n),_3=(e,t,o,n)=>e>o?e:e<t?t:e===o?o+1:Math.min(o,e+n),_5=(e,t,o)=>Math.max(t,Math.min(o,e)),_9=(e,t,o,n,r)=>r.fold(()=>_5(t+Math.round((e-t)/n)*n,t-1,o+1),t=>Math.max(t,t+Math.min(Math.floor((o-t)/n),Math.floor((e-t)/n)+Math.round((e-t)%n/n))*n)),_4=(e,t,o)=>Math.min(o,Math.max(e,t))-t,_6=e=>{let{min:t,max:o,range:n,value:r,step:a,snap:i,snapStart:l,rounded:s,hasMinEdge:c,hasMaxEdge:d,minBound:u,maxBound:m,screenRange:g}=e,p=c?t-1:t,h=d?o+1:o;if(r<u)return p;if(r>m)return h;{let e=_4(r,u,m),c=_5(e/g*n+t,p,h);return i&&c>=t&&c<=o?_9(c,t,o,a,l):s?Math.round(c):c}},_8=e=>{let{min:t,max:o,range:n,value:r,hasMinEdge:a,hasMaxEdge:i,maxBound:l,maxOffset:s,centerMinEdge:c,centerMaxEdge:d}=e;return r<t?a?0:c:r>o?i?l:d:(r-t)/n*s},_7="right",Te="bottom",Tt="left",To=e=>e.element.dom.getBoundingClientRect(),Tn=(e,t)=>e[t],Tr=e=>{let t=To(e);return Tn(t,Tt)},Ta=e=>{let t=To(e);return Tn(t,_7)},Ti=e=>{let t=To(e);return Tn(t,"top")},Tl=e=>{let t=To(e);return Tn(t,Te)},Ts=e=>{let t=To(e);return Tn(t,"width")},Tc=e=>{let t=To(e);return Tn(t,"height")},Td=(e,t,o)=>(e+t)/2-o,Tu=(e,t)=>{let o=To(e),n=To(t),r=Tn(o,Tt),a=Tn(o,_7),i=Tn(n,Tt);return Td(r,a,i)},Tm=(e,t)=>{let o=To(e),n=To(t),r=Tn(o,"top"),a=Tn(o,Te),i=Tn(n,"top");return Td(r,a,i)},Tg=(e,t)=>{iE(e,_f(),{value:t})},Tp=(e,t,o)=>{let n={min:_y(t),max:_k(t),range:_E(t),value:o,step:_B(t),snap:_F(t),snapStart:_I(t),rounded:_R(t),hasMinEdge:_V(t),hasMaxEdge:_H(t),minBound:Tr(e),maxBound:Ta(e),screenRange:Ts(e)};return _6(n)},Th=(e,t,o)=>{let n=Tp(e,t,o);return Tg(e,n),n},Tf=(e,t)=>{let o=_y(t);Tg(e,o)},Tb=(e,t)=>{let o=_k(t);Tg(e,o)},Tv=(e,t,o)=>{let n=(e>0?_3:_2)(_P(o),_y(o),_k(o),_B(o));return Tg(t,n),ea.some(n)},Ty=e=>(t,o)=>Tv(e,t,o).map(M),Tx=e=>{let t=_v(e);return t.map(e=>e.left)},Tw=(e,t,o,n,r)=>{let a=Ts(e),i=n.bind(t=>ea.some(Tu(t,e))).getOr(0),l=r.bind(t=>ea.some(Tu(t,e))).getOr(a),s={min:_y(t),max:_k(t),range:_E(t),value:o,hasMinEdge:_V(t),hasMaxEdge:_H(t),minBound:Tr(e),minOffset:0,maxBound:Ta(e),maxOffset:a,centerMinEdge:i,centerMaxEdge:l};return _8(s)},TS=(e,t,o,n,r,a)=>{let i=Tw(t,a,o,n,r);return Tr(t)-Tr(e)+i},Tk=(e,t,o,n)=>{let r=_P(o),a=TS(e,n.getSpectrum(e),r,n.getLeftEdge(e),n.getRightEdge(e),o),i=oB(t.element)/2;od(t.element,"left",a-i+"px")},TC=Ty(-1),TO=Ty(1),T_=ea.none,TT=ea.none,TE={"top-left":ea.none(),top:ea.none(),"top-right":ea.none(),right:ea.some(_X),"bottom-right":ea.none(),bottom:ea.none(),"bottom-left":ea.none(),left:ea.some(_0)};var TD=Object.freeze({__proto__:null,setValueFrom:Th,setToMin:Tf,setToMax:Tb,findValueOfOffset:Tp,getValueFromEvent:Tx,findPositionOfValue:TS,setPositionFromValue:Tk,onLeft:TC,onRight:TO,onUp:T_,onDown:TT,edgeActions:TE});let TA=(e,t)=>{iE(e,_f(),{value:t})},TM=(e,t,o)=>{let n={min:_x(t),max:_C(t),range:_D(t),value:o,step:_B(t),snap:_F(t),snapStart:_I(t),rounded:_R(t),hasMinEdge:_z(t),hasMaxEdge:_L(t),minBound:Ti(e),maxBound:Tl(e),screenRange:Tc(e)};return _6(n)},TB=(e,t,o)=>{let n=TM(e,t,o);return TA(e,n),n},TF=(e,t)=>{let o=_x(t);TA(e,o)},TI=(e,t)=>{let o=_C(t);TA(e,o)},TR=(e,t,o)=>{let n=(e>0?_3:_2)(_P(o),_x(o),_C(o),_B(o));return TA(t,n),ea.some(n)},TN=e=>(t,o)=>TR(e,t,o).map(M),TV=e=>{let t=_v(e);return t.map(e=>e.top)},TH=(e,t,o,n,r)=>{let a=Tc(e),i=n.bind(t=>ea.some(Tm(t,e))).getOr(0),l=r.bind(t=>ea.some(Tm(t,e))).getOr(a),s={min:_x(t),max:_C(t),range:_D(t),value:o,hasMinEdge:_z(t),hasMaxEdge:_L(t),minBound:Ti(e),minOffset:0,maxBound:Tl(e),maxOffset:a,centerMinEdge:i,centerMaxEdge:l};return _8(s)},Tz=(e,t,o,n,r,a)=>{let i=TH(t,a,o,n,r);return Ti(t)-Ti(e)+i},TL=(e,t,o,n)=>{let r=_P(o),a=Tz(e,n.getSpectrum(e),r,n.getTopEdge(e),n.getBottomEdge(e),o),i=oS(t.element)/2;od(t.element,"top",a-i+"px")},TP=ea.none,TU=ea.none,TW=TN(-1),Tj=TN(1),TG={"top-left":ea.none(),top:ea.some(_G),"top-right":ea.none(),right:ea.none(),"bottom-right":ea.none(),bottom:ea.some(_J),"bottom-left":ea.none(),left:ea.none()};var T$=Object.freeze({__proto__:null,setValueFrom:TB,setToMin:TF,setToMax:TI,findValueOfOffset:TM,getValueFromEvent:TV,findPositionOfValue:Tz,setPositionFromValue:TL,onLeft:TP,onRight:TU,onUp:TW,onDown:Tj,edgeActions:TG});let Tq=(e,t)=>{iE(e,_f(),{value:t})},TX=(e,t)=>({x:e,y:t}),TK=(e,t,o)=>{let n=Tp(e,t,o.left),r=TM(e,t,o.top),a=TX(n,r);return Tq(e,a),a},TY=(e,t,o,n)=>{let r=e>0?_3:_2,a=t?_P(n).x:r(_P(n).x,_y(n),_k(n),_B(n)),i=t?r(_P(n).y,_x(n),_C(n),_B(n)):_P(n).y;return Tq(o,TX(a,i)),ea.some(a)},TJ=(e,t)=>(o,n)=>TY(e,t,o,n).map(M),TZ=(e,t)=>{let o=_y(t),n=_x(t);Tq(e,TX(o,n))},TQ=(e,t)=>{let o=_k(t),n=_C(t);Tq(e,TX(o,n))},T0=e=>_v(e),T1=(e,t,o,n)=>{let r=_P(o),a=TS(e,n.getSpectrum(e),r.x,n.getLeftEdge(e),n.getRightEdge(e),o),i=Tz(e,n.getSpectrum(e),r.y,n.getTopEdge(e),n.getBottomEdge(e),o),l=oB(t.element)/2,s=oS(t.element)/2;od(t.element,"left",a-l+"px"),od(t.element,"top",i-s+"px")},T2=TJ(-1,!1),T3=TJ(1,!1),T5=TJ(-1,!0),T9=TJ(1,!0),T4={"top-left":ea.some(_j),top:ea.some(_$),"top-right":ea.some(_q),right:ea.some(_K),"bottom-right":ea.some(_Y),bottom:ea.some(_Z),"bottom-left":ea.some(_Q),left:ea.some(_1)};var T6=Object.freeze({__proto__:null,setValueFrom:TK,setToMin:TZ,setToMax:TQ,getValueFromEvent:T0,setPositionFromValue:T1,onLeft:T2,onRight:T3,onUp:T5,onDown:T9,edgeActions:T4});let T8=[ad("stepSize",1),ad("onChange",y),ad("onChoose",y),ad("onInit",y),ad("onDragStart",y),ad("onDragEnd",y),ad("snapToGrid",!1),ad("rounded",!0),at("snapStart"),r2("model",rQ("mode",{x:[ad("minX",0),ad("maxX",100),n4("value",e=>ay(e.mode.minX)),r1("getInitialValue"),s9("manager",TD)],y:[ad("minY",0),ad("maxY",100),n4("value",e=>ay(e.mode.minY)),r1("getInitialValue"),s9("manager",T$)],xy:[ad("minX",0),ad("maxX",100),ad("minY",0),ad("maxY",100),n4("value",e=>ay({x:e.mode.minX,y:e.mode.minY})),r1("getInitialValue"),s9("manager",T6)]})),gV("sliderBehaviours",[bw,gN]),n4("mouseIsDown",()=>ay(!1))],T7=(e,t,o,n)=>{let r=t=>pw(t,e,"thumb"),a=t=>pw(t,e,"spectrum"),i=t=>px(t,e,"left-edge"),l=t=>px(t,e,"right-edge"),s=t=>px(t,e,"top-edge"),c=t=>px(t,e,"bottom-edge"),d=e.model,u=d.manager,m=(t,o)=>{u.setPositionFromValue(t,o,e,{getLeftEdge:i,getRightEdge:l,getTopEdge:s,getBottomEdge:c,getSpectrum:a})},g=(e,t)=>{d.value.set(t);let o=r(e);m(e,o)},p=(t,o)=>{g(t,o);let n=r(t);return e.onChange(t,n,o),ea.some(!0)},h=t=>{u.setToMin(t,e)},f=t=>{u.setToMax(t,e)},b=t=>{let o=e.mouseIsDown.get();e.mouseIsDown.set(!1),o&&px(t,e,"thumb").each(o=>{let n=d.value.get();e.onChoose(t,o,n)})},v=(t,o)=>{o.stop(),e.mouseIsDown.set(!0),e.onDragStart(t,r(t))},y=(t,o)=>{o.stop(),e.onDragEnd(t,r(t)),b(t)};return{uid:e.uid,dom:e.dom,components:t,behaviours:gz(e.sliderBehaviours,[bw.config({mode:"special",focusIn:t=>px(t,e,"spectrum").map(bw.focusIn).map(M)}),gN.config({store:{mode:"manual",getValue:e=>d.value.get(),setValue:g}}),c2.config({channels:{[ga()]:{onReceive:b}}})]),events:iI([iV(_f(),(e,t)=>{p(e,t.event.value)}),i$((t,o)=>{let n=d.getInitialValue();d.value.set(n);let i=r(t);m(t,i);let l=a(t);e.onInit(t,i,l,d.value.get())}),iV(aU(),v),iV(aj(),y),iV(a$(),v),iV(aK(),y)]),apis:{resetToMin:h,resetToMax:f,setValue:g,refresh:m},domModification:{styles:{position:"relative"}}}},Ee=pz({name:"Slider",configFields:T8,partFields:[_r,_g,_c,_l,_u,_i,_s,_m,_d,_p,_h],factory:T7,apis:{setValue:(e,t,o)=>{e.setValue(t,o)},resetToMin:(e,t)=>{e.resetToMin(t)},resetToMax:(e,t)=>{e.resetToMax(t)},refresh:(e,t)=>{e.refresh(t)}}}),Et=i8("rgb-hex-update"),Eo=i8("slider-update"),En=i8("palette-update"),Er=(e,t)=>{let o=Ee.parts.spectrum({dom:{tag:"div",classes:[t("hue-slider-spectrum")],attributes:{role:"presentation"}}}),n=Ee.parts.thumb({dom:{tag:"div",classes:[t("hue-slider-thumb")],attributes:{role:"presentation"}}});return Ee.sketch({dom:{tag:"div",classes:[t("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:k(0)},components:[o,n],sliderBehaviours:cY([b$.config({})]),onChange:(e,t,o)=>{iE(e,Eo,{value:o})}})},Ea="form",Ei=[gV("formBehaviours",[gN])],El=e=>"<alloy.field."+e+">",Es=e=>{let t=(()=>{let e=[],t=(t,o)=>(e.push(t),ph(Ea,El(t),o));return{field:t,record:k(e)}})(),o=e(t),n=t.record(),r=eh(n,e=>pa({name:e,pname:El(e)}));return pB(Ea,Ei,r,Ed,o)},Ec=(e,t)=>e.fold(()=>nq.error(t),nq.value),Ed=(e,t)=>({uid:e.uid,dom:e.dom,components:t,behaviours:gz(e.formBehaviours,[gN.config({store:{mode:"manual",getValue:t=>{let o=pk(t,e);return eP(o,(e,t)=>e().bind(e=>{let o=pj.getCurrent(e);return Ec(o,Error(`Cannot find a current component to extract the value from for form part '${t}': `+i3(e.element)))}).map(gN.getValue))},setValue:(t,o)=>{eL(o,(o,n)=>{px(t,e,n).each(e=>{pj.getCurrent(e).each(e=>{gN.setValue(e,o)})})})}}})]),apis:{getField:(t,o)=>px(t,e,o).bind(pj.getCurrent)}}),Eu={getField:lb((e,t,o)=>e.getField(t,o)),sketch:Es},Em=i8("valid-input"),Eg=i8("invalid-input"),Ep=i8("validating-input"),Eh="colorcustom.rgb.",Ef=(e,t,o,n)=>{let r=(o,n)=>O5.config({invalidClass:t("invalid"),notify:{onValidate:e=>{iE(e,Ep,{type:o})},onValid:e=>{iE(e,Em,{type:o,value:gN.getValue(e)})},onInvalid:e=>{iE(e,Eg,{type:o,value:gN.getValue(e)})}},validator:{validate:t=>{let o=gN.getValue(t),r=n(o)?nq.value(!0):nq.error(e("aria.input.invalid"));return CO.pure(r)},validateOnLoad:!1}}),a=(o,n,a,i,l)=>{let s=e(Eh+"range"),c=OO.parts.label({dom:{tag:"label",attributes:{"aria-label":i}},components:[sx(a)]}),d=OO.parts.field({data:l,factory:xT,inputAttributes:{type:"text",..."hex"===n?{"aria-live":"polite"}:{}},inputClasses:[t("textfield")],inputBehaviours:cY([r(n,o),OD.config({})]),onSetValue:e=>{if(O5.isInvalid(e)){let t=O5.run(e);t.get(y)}}}),u="hex"!==n?[OO.parts["aria-descriptor"]({text:s})]:[],m=[c,d].concat(u);return{dom:{tag:"div",attributes:{role:"presentation"}},components:m}},i=(e,t)=>{let o=S4(t);return Eu.getField(e,"hex").each(t=>{b$.isFocused(t)||gN.setValue(e,{hex:o.value})}),o},l=(e,t)=>{let o=t.red,n=t.green,r=t.blue;gN.setValue(e,{red:o,green:n,blue:r})},s=vZ({dom:{tag:"div",classes:[t("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}}),c=(e,t)=>{s.getOpt(e).each(e=>{od(e.element,"background-color","#"+t.value)})},d=()=>{let r={red:ay(ea.some(255)),green:ay(ea.some(255)),blue:ay(ea.some(255)),hex:ay(ea.some("ffffff"))},d=(e,t)=>{let o=ka(t);l(e,o),p(o)},u=e=>r[e].get(),m=(e,t)=>{r[e].set(t)},g=()=>u("red").bind(e=>u("green").bind(t=>u("blue").map(o=>ko(e,t,o,1)))),p=e=>{let t=e.red,o=e.green,n=e.blue;m("red",ea.some(t)),m("green",ea.some(o)),m("blue",ea.some(n))},h=(e,t)=>{let o=t.event;"hex"!==o.type?m(o.type,ea.none()):n(e)},f=(e,t)=>{o(e);let n=SJ(t);m("hex",ea.some(t));let r=ka(n);l(e,r),p(r),iE(e,Et,{hex:n}),c(e,n)},b=(e,t,o)=>{let n=parseInt(o,10);m(t,ea.some(n)),g().each(t=>{let o=i(e,t);iE(e,Et,{hex:o}),c(e,o)})},v=e=>"hex"===e.type,y=(e,t)=>{let o=t.event;v(o)?f(e,o.value):b(e,o.type,o.value)},x=t=>({label:e(Eh+t+".label"),description:e(Eh+t+".description")}),w=x("red"),S=x("green"),k=x("blue"),C=x("hex");return re(Eu.sketch(o=>({dom:{tag:"form",classes:[t("rgb-form")],attributes:{"aria-label":e("aria.color.picker")}},components:[o.field("red",OO.sketch(a(kn,"red",w.label,w.description,255))),o.field("green",OO.sketch(a(kn,"green",S.label,S.description,255))),o.field("blue",OO.sketch(a(kn,"blue",k.label,k.description,255))),o.field("hex",OO.sketch(a(S0,"hex",C.label,C.description,"ffffff"))),s.asSpec()],formBehaviours:cY([O5.config({invalidClass:t("form-invalid")}),bV("rgb-form-events",[iV(Em,y),iV(Eg,h),iV(Ep,h)])])})),{apis:{updateHex:(e,t)=>{gN.setValue(e,{hex:t.value}),d(e,t),c(e,t)}}})},u=pH({factory:d,name:"RgbForm",configFields:[],apis:{updateHex:(e,t,o)=>{e.updateHex(t,o)}},extraApis:{}});return u},Eb=(e,t)=>{let o=Ee.parts.spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[t("sv-palette-spectrum")]}}),n=Ee.parts.thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[t("sv-palette-thumb")],innerHtml:`<div class=${t("sv-palette-inner-thumb")} role="presentation"></div>`}}),r=(e,t)=>{let{width:o,height:n}=e,r=e.getContext("2d");if(null===r)return;r.fillStyle=t,r.fillRect(0,0,o,n);let a=r.createLinearGradient(0,0,o,0);a.addColorStop(0,"rgba(255,255,255,1)"),a.addColorStop(1,"rgba(255,255,255,0)"),r.fillStyle=a,r.fillRect(0,0,o,n);let i=r.createLinearGradient(0,0,0,n);i.addColorStop(0,"rgba(0,0,0,0)"),i.addColorStop(1,"rgba(0,0,0,1)"),r.fillStyle=i,r.fillRect(0,0,o,n)},a=(e,t)=>{let o=e.components()[0].element.dom,n=kO(t,100,100),a=kr(n);r(o,ks(a))},i=(e,t)=>{let o=k_(ka(t));Ee.setValue(e,{x:o.saturation,y:100-o.value})},l=e=>{let a=k({x:0,y:0}),i=(e,t,o)=>{iE(e,En,{value:o})},l=(e,t,o,n)=>{r(o.element.dom,ks(kc))},s=cY([pj.config({find:ea.some}),b$.config({})]);return Ee.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[t("sv-palette")]},model:{mode:"xy",getInitialValue:a},rounded:!1,components:[o,n],onChange:i,onInit:l,sliderBehaviours:s})},s=pH({factory:l,name:"SaturationBrightnessPalette",configFields:[],apis:{setHue:(e,t,o)=>{a(t,o)},setThumb:(e,t,o)=>{i(t,o)}},extraApis:{}});return s},Ev=(e,t)=>{let o=o=>{let n=Ef(e,t,o.onValidHex,o.onInvalidHex),r=Eb(e,t),a=e=>(100-e)/100*360,i=e=>100-e/360*100,l={paletteRgba:ay(kc),paletteHue:ay(0)},s=vZ(Er(e,t)),c=vZ(r.sketch({})),d=vZ(n.sketch({})),u=(e,t,o)=>{c.getOpt(e).each(e=>{r.setHue(e,o)})},m=(e,t)=>{d.getOpt(e).each(e=>{n.updateHex(e,t)})},g=(e,t,o)=>{s.getOpt(e).each(e=>{Ee.setValue(e,i(o))})},p=(e,t)=>{c.getOpt(e).each(e=>{r.setThumb(e,t)})},h=(e,t)=>{let o=ka(e);l.paletteRgba.set(o),l.paletteHue.set(t)},f=(e,t,o,n)=>{h(t,o),ef(n,n=>{n(e,t,o)})};return{uid:o.uid,dom:o.dom,components:[c.asSpec(),s.asSpec(),d.asSpec()],behaviours:cY([bV("colour-picker-events",[iV(Et,(()=>{let e=[u,g,p];return(t,o)=>{let n=o.event.hex,r=kT(n);f(t,n,r.hue,e)}})()),iV(En,(()=>{let e=[m];return(t,o)=>{let n=o.event.value,r=l.paletteHue.get(),a=kO(r,n.x,100-n.y),i=kE(a);f(t,i,r,e)}})()),iV(Eo,(()=>{let e=[u,m];return(t,o)=>{let n=a(o.event.value),r=l.paletteRgba.get(),i=k_(r),s=kO(n,i.saturation,i.value),c=kE(s);f(t,c,n,e)}})())]),pj.config({find:e=>d.getOpt(e)}),bw.config({mode:"acyclic"})])}},n=pH({name:"ColourPicker",configFields:[r1("dom"),ad("onValidHex",y),ad("onInvalidHex",y)],factory:o});return n},Ey=()=>pj.config({find:ea.some}),Ex=e=>pj.config({find:e.getOpt}),Ew=e=>pj.config({find:t=>tq(t.element,e).bind(e=>t.getSystem().getByDom(e).toOptional())}),ES={self:Ey,memento:Ex,childAt:Ew},Ek=rM([ad("preprocess",C),ad("postprocess",C)]),EC=(e,t)=>{let o=rJ("RepresentingConfigs.memento processors",Ek,t);return gN.config({store:{mode:"manual",getValue:t=>{let n=e.get(t),r=gN.getValue(n);return o.postprocess(r)},setValue:(t,n)=>{let r=o.preprocess(n),a=e.get(t);gN.setValue(a,r)}}})},EO=(e,t,o)=>gN.config({store:{mode:"manual",...e.map(e=>({initialValue:e})).getOr({}),getValue:t,setValue:o}}),E_=(e,t,o)=>EO(e,e=>t(e.element),(e,t)=>o(e.element,t)),ET=e=>E_(e,l8,l7),EE=e=>E_(e,iJ,iZ),ED=e=>gN.config({store:{mode:"memory",initialValue:e}}),EA={memento:EC,withElement:E_,withComp:EO,domValue:ET,domHtml:EE,memory:ED},EM={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"},EB=e=>t=>e.translate(EM[t]),EF=(e,t,o)=>{let n=e=>"tox-"+e,r=Ev(EB(t),n),a=e=>{iE(e,OL,{name:"hex-valid",value:!0})},i=e=>{iE(e,OL,{name:"hex-valid",value:!1})},l=vZ(r.sketch({dom:{tag:"div",classes:[n("color-picker-container")],attributes:{role:"presentation"}},onValidHex:a,onInvalidHex:i}));return{dom:{tag:"div"},components:[l.asSpec()],behaviours:cY([EA.withComp(o,e=>{let t=l.get(e),o=pj.getCurrent(t),n=o.bind(e=>{let t=gN.getValue(e);return t.hex});return n.map(e=>"#"+e).getOr("")},(e,t)=>{let o=ea.from(/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/.exec(t)).bind(e=>eF(e,1)),n=l.get(e),r=pj.getCurrent(n);r.fold(()=>{console.log("Can not find form")},e=>{gN.setValue(e,{hex:o.getOr("")}),Eu.getField(e,"hex").each(e=>{iT(e,a1())})})}),ES.self()])}};var EI=tinymce.util.Tools.resolve("tinymce.Resource");let ER=e=>eJ(e,"init"),EN=e=>{let t=dD(),o=vZ({dom:{tag:e.tag}}),n=dD();return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:cY([bV("custom-editor-events",[i$(r=>{o.getOpt(r).each(o=>{(ER(e)?e.init(o.element.dom):EI.load(e.scriptId,e.scriptUrl).then(t=>t(o.element.dom,e.settings))).then(e=>{n.on(t=>{e.setValue(t)}),n.clear(),t.set(e)})})})]),EA.withComp(ea.none(),()=>t.get().fold(()=>n.get().getOr(""),e=>e.getValue()),(e,o)=>{t.get().fold(()=>n.set(o),e=>e.setValue(o))}),ES.self()]),components:[o.asSpec()]}};var EV=tinymce.util.Tools.resolve("tinymce.util.Tools");let EH=(e,t)=>{let o=EV.explode(t.getOption("images_file_types")),n=e=>em(o,t=>tr(e.name.toLowerCase(),`.${t.toLowerCase()}`));return ey(eN(e),n)},Ez=(e,t,o)=>{let n=(e,t)=>{t.stop()},r=e=>(t,o)=>{ef(e,e=>{e(t,o)})},a=(e,t)=>{var o;if(!p7.isDisabled(e)){let n=t.event.raw;l(e,null===(o=n.dataTransfer)||void 0===o?void 0:o.files)}},i=(e,t)=>{let o=t.event.raw.target;l(e,o.files)},l=(o,n)=>{n&&(gN.setValue(o,EH(n,t)),iE(o,OV,{name:e.name}))},s=vZ({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:cY([bV("input-file-events",[iW(a3()),iW(il())])])}),c=e=>({uid:e.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:cY([EA.memory(o.getOr([])),ES.self(),p7.config({}),ve.config({toggleClass:"dragenter",toggleOnExecute:!1}),bV("dropzone-events",[iV("dragenter",r([n,ve.toggle])),iV("dragleave",r([n,ve.toggle])),iV("dragover",n),iV("drop",r([n,a])),iV(a2(),i)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p"},components:[sx(t.translate("Drop an image here"))]},vJ.sketch({dom:{tag:"button",styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[sx(t.translate("Browse for an image")),s.asSpec()],action:e=>{let t=s.get(e);t.element.dom.click()},buttonBehaviours:cY([OD.config({}),Sx.button(t.isDisabled),Sh()])})]}]}),d=e.label.map(e=>ON(e,t)),u=OO.parts.field({factory:{sketch:c}});return OM(d,u,["tox-form__group--stretched"],[])},EL=(e,t)=>({dom:{tag:"div",classes:["tox-form__grid",`tox-form__grid--${e.columns}col`]},components:eh(e.items,t.interpreter)}),EP=i8("alloy-fake-before-tabstop"),EU=i8("alloy-fake-after-tabstop"),EW=e=>({dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:e},behaviours:cY([b$.config({ignore:!0}),OD.config({})])}),Ej=e=>({dom:{tag:"div",classes:["tox-navobj"]},components:[EW([EP]),e,EW([EU])],behaviours:cY([ES.childAt(1)])}),EG=(e,t)=>{iE(e,aQ(),{raw:{which:9,shiftKey:t}})},E$=(e,t)=>{let o=t.element;l2(o,EP)?EG(e,!0):l2(o,EU)&&EG(e,!1)},Eq=e=>C6(e,["."+EP,"."+EU].join(","),A),EX=e=>{let t=ay(e.getOr(""));return{getValue:e=>t.get(),setValue:(e,o)=>{t.get()!==o&&ot(e.element,"srcdoc",o),t.set(o)}}},EK=(e,t,o)=>{let n=e.sandboxed,r=e.transparent,a="tox-dialog__iframe",i={...e.label.map(e=>({title:e})).getOr({}),...o.map(e=>({srcdoc:e})).getOr({}),...n?{sandbox:"allow-scripts allow-same-origin"}:{}},l=EX(o),s=e.label.map(e=>ON(e,t)),c=e=>Ej({uid:e.uid,dom:{tag:"iframe",attributes:i,classes:r?[a]:[a,`${a}--opaque`]},behaviours:cY([OD.config({}),b$.config({}),EA.withComp(o,l.getValue,l.setValue)])}),d=OO.parts.field({factory:{sketch:c}});return OM(s,d,["tox-form__group--stretched"],[])},EY=e=>new Promise((t,o)=>{let n=()=>{a(),t(e)},r=[dA(e,"load",n),dA(e,"error",()=>{a(),o("Unable to load data from image: "+e.dom.src)})],a=()=>ef(r,e=>e.unbind());e.dom.complete&&n()}),EJ=(e,t,o,n,r)=>{let a=o*r,i=n*r;return{left:Math.max(0,e/2-a/2).toString()+"px",top:Math.max(0,t/2-i/2).toString()+"px",width:a.toString()+"px",height:i.toString()+"px"}},EZ=(e,t,o)=>{let n=oB(e),r=oS(e);return Math.min(n/t,r/o,1)},EQ=(e,t)=>{let o=ay(t.getOr({url:""})),n=vZ({dom:{tag:"img",classes:["tox-imagepreview__image"],attributes:t.map(e=>({src:e.url})).getOr({})}}),r=vZ({dom:{tag:"div",classes:["tox-imagepreview__container"],attributes:{role:"presentation"}},components:[n.asSpec()]}),a=(e,t)=>{let a={url:t.url};t.zoom.each(e=>a.zoom=e),t.cachedWidth.each(e=>a.cachedWidth=e),t.cachedHeight.each(e=>a.cachedHeight=e),o.set(a);let i=()=>{let{cachedWidth:t,cachedHeight:o,zoom:n}=a;if(!g(t)&&!g(o)){if(g(n)){let n=EZ(e.element,t,o);a.zoom=n}let i=EJ(oB(e.element),oS(e.element),t,o,a.zoom);r.getOpt(e).each(e=>{ou(e.element,i)})}};n.getOpt(e).each(o=>{let n=o.element;t.url!==on(n,"src")&&(ot(n,"src",t.url),l1(e.element,"tox-imagepreview__loaded")),i(),EY(n).then(t=>{e.getSystem().isConnected()&&(lQ(e.element,"tox-imagepreview__loaded"),a.cachedWidth=t.dom.naturalWidth,a.cachedHeight=t.dom.naturalHeight,i())})})},i={};e.height.each(e=>i.height=e);let l=t.map(e=>({url:e.url,zoom:ea.from(e.zoom),cachedWidth:ea.from(e.cachedWidth),cachedHeight:ea.from(e.cachedHeight)}));return{dom:{tag:"div",classes:["tox-imagepreview"],styles:i,attributes:{role:"presentation"}},components:[r.asSpec()],behaviours:cY([ES.self(),EA.withComp(l,()=>o.get(),a)])}},E0=(e,t)=>{let o={dom:{tag:"label",classes:["tox-label"]},components:[sx(t.providers.translate(e.label))]},n=eh(e.items,t.interpreter);return{dom:{tag:"div",classes:["tox-form__group"]},components:[o,...n],behaviours:cY([ES.self(),bR.config({}),EA.domHtml(ea.none()),bw.config({mode:"acyclic"})])}},E1=i8("toolbar.button.execute"),E2=e=>iK((t,o)=>{Sw(e,t)(o=>{iE(t,E1,{buttonApi:o}),e.onAction(o)})}),E3={[ia()]:["disabling","alloy.base.behaviour","toggling","toolbar-button-events"]},E5=(e,t,o)=>ye(e,{tag:"span",classes:["tox-icon","tox-tbtn__icon-wrap"],behaviours:o},t),E9=(e,t)=>E5(e,t,[]),E4=(e,t)=>E5(e,t,[bR.config({})]),E6=(e,t,o)=>({dom:{tag:"span",classes:[`${t}__select-label`]},components:[sx(o.translate(e))],behaviours:cY([bR.config({})])}),E8=i8("update-menu-text"),E7=i8("update-menu-icon"),De=(e,t,o)=>{let n=ay(y),r=e.text.map(e=>vZ(E6(e,t,o.providers))),a=e.icon.map(e=>vZ(E4(e,o.providers.icons))),i=(e,t)=>{let o=gN.getValue(e);return b$.focus(o),iE(o,"keydown",{raw:t.event.raw}),CW.close(o),ea.some(!0)},l=e.role.fold(()=>({}),e=>({role:e})),s=e.tooltip.fold(()=>({}),e=>{let t=o.providers.translate(e);return{title:t,"aria-label":t}}),c=ye("chevron-down",{tag:"div",classes:[`${t}__select-chevron`]},o.providers.icons),d=vZ(CW.sketch({...e.uid?{uid:e.uid}:{},...l,dom:{tag:"button",classes:[t,`${t}--select`].concat(eh(e.classes,e=>`${t}--${e}`)),attributes:{...s}},components:e1([a.map(e=>e.asSpec()),r.map(e=>e.asSpec()),ea.some(c)]),matchWidth:!0,useMinWidth:!0,onOpen:(t,o,n)=>{e.searchable&&CJ(n)},dropdownBehaviours:cY([...e.dropdownBehaviours,Sx.button(()=>e.disabled||o.providers.isDisabled()),Sh(),O8.config({}),bR.config({}),bV("dropdown-events",[SS(e,n),Sk(e,n)]),bV("menubutton-update-display-text",[iV(E8,(e,t)=>{r.bind(t=>t.getOpt(e)).each(e=>{bR.set(e,[sx(o.providers.translate(t.event.text))])})}),iV(E7,(e,t)=>{a.bind(t=>t.getOpt(e)).each(e=>{bR.set(e,[E4(t.event.icon,o.providers.icons)])})})])]),eventOrder:re(E3,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"]}),sandboxBehaviours:cY([bw.config({mode:"special",onLeft:i,onRight:i}),bV("dropdown-sandbox-events",[iV(xE,(e,t)=>{CG(e),t.stop()}),iV(xD,(e,t)=>{C$(e,t),t.stop()})])]),lazySink:o.getSink,toggleClass:`${t}--active`,parts:{menu:{...xw(!1,e.columns,e.presets),fakeFocus:e.searchable,onHighlightItem:CK,onCollapseMenu:(e,t,o)=>{hy.getHighlighted(o).each(t=>{CK(e,o,t)})},onDehighlightItem:CY}},fetch:t=>CO.nu(_(e.fetch,t))}));return d.asSpec()},Dt=e=>l(e),Do=e=>"separator"===e.type,Dn=e=>eJ(e,"getSubmenuItems"),Dr={type:"separator"},Da=(e,t)=>{let o=ew(e,(e,o)=>Dt(o)?""===o?e:"|"===o?e.length>0&&!Do(e[e.length-1])?e.concat([Dr]):e:eJ(t,o.toLowerCase())?e.concat([t[o.toLowerCase()]]):e:e.concat([o]),[]);return o.length>0&&Do(o[o.length-1])&&o.pop(),o},Di=(e,t)=>{let o=e.getSubmenuItems(),n=Ds(o,t),r=re(n.menus,{[e.value]:n.items}),a=re(n.expansions,{[e.value]:e.value});return{item:e,menus:r,expansions:a}},Dl=e=>{let t=eY(e,"value").getOrThunk(()=>i8("generated-menu-item"));return re({value:t},e)},Ds=(e,t)=>{let o=Da(l(e)?e.split(" "):e,t);return ex(o,(e,o)=>{if(!Dn(o))return{...e,items:[o,...e.items]};{let n=Dl(o),r=Di(n,t);return{menus:re(e.menus,r.menus),items:[r.item,...e.items],expansions:re(e.expansions,r.expansions)}}},{menus:{},expansions:{},items:[]})},Dc=e=>e.search.fold(()=>({searchMode:"no-search"}),e=>({searchMode:"search-with-field",placeholder:e.placeholder})),Dd=e=>e.search.fold(()=>({searchMode:"no-search"}),e=>({searchMode:"search-with-results"})),Du=(e,t,o,n)=>{let r=i8("primary-menu"),a=Ds(e,o.shared.providers.menuItems());if(0===a.items.length)return ea.none();let i=Dc(n),l=C1(r,a.items,t,o,n.isHorizontalMenu,i),s=Dd(n),c=eP(a.menus,(e,n)=>C1(n,e,t,o,!1,s)),d=re(c,aT(r,l));return ea.from(vG.tieredData(r,d,a.expansions))},Dm=e=>!eJ(e,"items"),Dg="data-value",Dp=(e,t,o,n)=>eh(o,o=>Dm(o)?{type:"togglemenuitem",text:o.text,value:o.value,active:o.value===n,onAction:()=>{gN.setValue(e,o.value),iE(e,OV,{name:t}),b$.focus(e)}}:{type:"nestedmenuitem",text:o.text,getSubmenuItems:()=>Dp(e,t,o.items,n)}),Dh=(e,t)=>eV(e,e=>Dm(e)?e4(e.value===t,e):Dh(e.items,t)),Df=(e,t,o)=>{let n=t.shared.providers,r=o.bind(t=>Dh(e.items,t)).orThunk(()=>eI(e.items).filter(Dm)),a=e.label.map(e=>ON(e,n)),i=OO.parts.field({dom:{},factory:{sketch:o=>De({uid:o.uid,text:r.map(e=>e.text),icon:ea.none(),tooltip:e.label,role:ea.none(),fetch:(o,n)=>{let r=Dp(o,e.name,e.items,gN.getValue(o));n(Du(r,xn.CLOSE_ON_EXECUTE,t,{isHorizontalMenu:!1,search:ea.none()}))},onSetup:k(y),getApi:k({}),columns:1,presets:"normal",classes:[],dropdownBehaviours:[OD.config({}),EA.withComp(r.map(e=>e.value),e=>on(e.element,Dg),(t,o)=>{Dh(e.items,o).each(e=>{ot(t.element,Dg,e.value),iE(t,E8,{text:e.text})})})]},"tox-listbox",t.shared)}});return OO.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:eO([a.toArray(),[{dom:{tag:"div",classes:["tox-listboxfield"]},components:[i]}]]),fieldBehaviours:cY([p7.config({disabled:k(!e.enabled),onDisabled:e=>{OO.getField(e).each(p7.disable)},onEnabled:e=>{OO.getField(e).each(p7.enable)}})])})},Db=(e,t)=>({dom:{tag:"div",classes:e.classes},components:eh(e.items,t.shared.interpreter)}),Dv=(e,t)=>{let o=eh(e.options,e=>({dom:{tag:"option",value:e.value,innerHtml:e.text}})),n=e.data.map(e=>aT("initialValue",e)).getOr({});return{uid:e.uid,dom:{tag:"select",classes:e.selectClasses,attributes:e.selectAttributes},components:o,behaviours:gz(e.selectBehaviours,[b$.config({}),gN.config({store:{mode:"manual",getValue:e=>l8(e.element),setValue:(t,o)=>{let n=ek(e.options,e=>e.value===o);n.isSome()&&l7(t.element,o)},...n}})])}},Dy=pH({name:"HtmlSelect",configFields:[r1("options"),gV("selectBehaviours",[b$,gN]),ad("selectClasses",[]),ad("selectAttributes",{}),at("data")],factory:Dv}),Dx=(e,t,o)=>{let n=eh(e.items,e=>({text:t.translate(e.text),value:e.value})),r=e.label.map(e=>ON(e,t)),a=OO.parts.field({dom:{},...o.map(e=>({data:e})).getOr({}),selectAttributes:{size:e.size},options:n,factory:Dy,selectBehaviours:cY([p7.config({disabled:()=>!e.enabled||t.isDisabled()}),OD.config({}),bV("selectbox-change",[iV(a2(),(t,o)=>{iE(t,OV,{name:e.name})})])])}),i=e.size>1?ea.none():ea.some(ye("chevron-down",{tag:"div",classes:["tox-selectfield__icon-js"]},t.icons)),l={dom:{tag:"div",classes:["tox-selectfield"]},components:eO([[a],i.toArray()])};return OO.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:eO([r.toArray(),[l]]),fieldBehaviours:cY([p7.config({disabled:()=>!e.enabled||t.isDisabled(),onDisabled:e=>{OO.getField(e).each(p7.disable)},onEnabled:e=>{OO.getField(e).each(p7.enable)}}),Sh()])})},Dw=k([ad("field1Name","field1"),ad("field2Name","field2"),s3("onLockedChange"),sQ(["lockClass"]),ad("locked",!1),gL.field("coupledFieldBehaviours",[pj,gN])]),DS=(e,t,o)=>px(e,t,o).bind(pj.getCurrent),Dk=(e,t)=>pa({factory:OO,name:e,overrides:e=>({fieldBehaviours:cY([bV("coupled-input-behaviour",[iV(a1(),o=>{DS(o,e,t).each(t=>{px(o,e,"lock").each(n=>{ve.isOn(n)&&e.onLockedChange(o,t,n)})})})])])})}),DC=k([Dk("field1","field2"),Dk("field2","field1"),pa({factory:vJ,schema:[r1("dom")],name:"lock",overrides:e=>({buttonBehaviours:cY([ve.config({selected:e.locked,toggleClass:e.markers.lockClass,aria:{mode:"pressed"}})])})})]),DO=(e,t,o,n)=>({uid:e.uid,dom:e.dom,components:t,behaviours:gL.augment(e.coupledFieldBehaviours,[pj.config({find:ea.some}),gN.config({store:{mode:"manual",getValue:t=>{let o=pO(t,e,["field1","field2"]);return{[e.field1Name]:gN.getValue(o.field1()),[e.field2Name]:gN.getValue(o.field2())}},setValue:(t,o)=>{let n=pO(t,e,["field1","field2"]);eZ(o,e.field1Name)&&gN.setValue(n.field1(),o[e.field1Name]),eZ(o,e.field2Name)&&gN.setValue(n.field2(),o[e.field2Name])}}})]),apis:{getField1:t=>px(t,e,"field1"),getField2:t=>px(t,e,"field2"),getLock:t=>px(t,e,"lock")}}),D_=pz({name:"FormCoupledInputs",configFields:Dw(),partFields:DC(),factory:DO,apis:{getField1:(e,t)=>e.getField1(t),getField2:(e,t)=>e.getField2(t),getLock:(e,t)=>e.getLock(t)}}),DT=e=>{var t;let o={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,in:4,"%":4},n=e.value.toFixed((t=e.unit)in o?o[t]:1);return -1!==n.indexOf(".")&&(n=n.replace(/\.?0*$/,"")),n+e.unit},DE=e=>{let t=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/.exec(e);if(null===t)return nq.error(e);{let e=parseFloat(t[1]),o=t[2];return nq.value({value:e,unit:o})}},DD=(e,t)=>{let o={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,in:1},n=e=>eJ(o,e);return e.unit===t?ea.some(e.value):n(e.unit)&&n(t)?o[e.unit]===o[t]?ea.some(e.value):ea.some(e.value/o[e.unit]*o[t]):ea.none()},DA=e=>ea.none(),DM=(e,t)=>o=>DD(o,t).map(o=>({value:o*e,unit:t})),DB=(e,t)=>{let o=DE(e).toOptional(),n=DE(t).toOptional();return e3(o,n,(e,t)=>DD(e,t.unit).map(e=>t.value/e).map(e=>DM(e,t.unit)).getOr(DA)).getOr(DA)},DF=(e,t)=>{let o=DA,n=i8("ratio-event"),r=e=>ye(e,{tag:"span",classes:["tox-icon","tox-lock-icon__"+e]},t.icons),a=D_.parts.lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:t.translate(e.label.getOr("Constrain proportions"))}},components:[r("lock"),r("unlock")],buttonBehaviours:cY([p7.config({disabled:()=>!e.enabled||t.isDisabled()}),Sh(),OD.config({})])}),i=e=>({dom:{tag:"div",classes:["tox-form__group"]},components:e}),l=o=>OO.parts.field({factory:xT,inputClasses:["tox-textfield"],inputBehaviours:cY([p7.config({disabled:()=>!e.enabled||t.isDisabled()}),Sh(),OD.config({}),bV("size-input-events",[iV(aJ(),(e,t)=>{iE(e,n,{isField1:o})}),iV(a2(),(t,o)=>{iE(t,OV,{name:e.name})})])]),selectOnFocus:!1}),s=e=>({dom:{tag:"label",classes:["tox-label"]},components:[sx(t.translate(e))]}),c=D_.parts.field1(i([OO.parts.label(s("Width")),l(!0)])),d=D_.parts.field2(i([OO.parts.label(s("Height")),l(!1)]));return D_.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[c,d,i([s("\xa0"),a])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:(e,t,n)=>{DE(gN.getValue(e)).each(e=>{o(e).each(e=>{gN.setValue(t,DT(e))})})},coupledFieldBehaviours:cY([p7.config({disabled:()=>!e.enabled||t.isDisabled(),onDisabled:e=>{D_.getField1(e).bind(OO.getField).each(p7.disable),D_.getField2(e).bind(OO.getField).each(p7.disable),D_.getLock(e).each(p7.disable)},onEnabled:e=>{D_.getField1(e).bind(OO.getField).each(p7.enable),D_.getField2(e).bind(OO.getField).each(p7.enable),D_.getLock(e).each(p7.enable)}}),Sh(),bV("size-input-events2",[iV(n,(e,t)=>{let n=t.event.isField1,r=n?D_.getField1(e):D_.getField2(e),a=n?D_.getField2(e):D_.getField1(e),i=r.map(gN.getValue).getOr(""),l=a.map(gN.getValue).getOr("");o=DB(i,l)})])])})},DI=(e,t,o)=>{let n=Ee.parts.label({dom:{tag:"label",classes:["tox-label"]},components:[sx(t.translate(e.label))]}),r=Ee.parts.spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),a=Ee.parts.thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}});return Ee.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:e.min,maxX:e.max,getInitialValue:k(o.getOrThunk(()=>(Math.abs(e.max)-Math.abs(e.min))/2))},components:[n,r,a],sliderBehaviours:cY([ES.self(),b$.config({})]),onChoose:(t,o,n)=>{iE(t,OV,{name:e.name,value:n})}})},DR=(e,t)=>{let o=e=>({dom:{tag:"th",innerHtml:t.translate(e)}}),n=e=>({dom:{tag:"td",innerHtml:t.translate(e)}}),r=e=>({dom:{tag:"tr"},components:eh(e,n)});return{dom:{tag:"table",classes:["tox-dialog__table"]},components:[{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:eh(e.header,o)}]},{dom:{tag:"tbody"},components:eh(e.cells,r)}],behaviours:cY([OD.config({}),b$.config({})])}},DN=(e,t)=>{let o=e.label.map(e=>ON(e,t)),n=[p7.config({disabled:()=>e.disabled||t.isDisabled()}),Sh(),bw.config({mode:"execution",useEnter:!0!==e.multiline,useControlEnter:!0===e.multiline,execute:e=>(iT(e,OP),ea.some(!0))}),bV("textfield-change",[iV(a1(),(t,o)=>{iE(t,OV,{name:e.name})}),iV(io(),(t,o)=>{iE(t,OV,{name:e.name})})]),OD.config({})],r=e.validation.map(e=>O5.config({getRoot:e=>tW(e.element),invalidClass:"tox-invalid",validator:{validate:t=>{let o=gN.getValue(t),n=e.validator(o);return CO.pure(!0===n?nq.value(o):nq.error(n))},validateOnLoad:e.validateOnLoad}})).toArray(),a=e.placeholder.fold(k({}),e=>({placeholder:t.translate(e)})),i=e.inputMode.fold(k({}),e=>({inputmode:e})),l={...a,...i},s=OO.parts.field({tag:!0===e.multiline?"textarea":"input",...e.data.map(e=>({data:e})).getOr({}),inputAttributes:l,inputClasses:[e.classname],inputBehaviours:cY(eO([n,r])),selectOnFocus:!1,factory:xT}),c=e.flex?["tox-form__group--stretched"]:[],d=c.concat(e.maximized?["tox-form-group--maximize"]:[]),u=[p7.config({disabled:()=>e.disabled||t.isDisabled(),onDisabled:e=>{OO.getField(e).each(p7.disable)},onEnabled:e=>{OO.getField(e).each(p7.enable)}}),Sh()];return OM(o,s,d,u)},DV=(e,t,o)=>DN({name:e.name,multiline:!1,label:e.label,inputMode:e.inputMode,placeholder:e.placeholder,flex:!1,disabled:!e.enabled,classname:"tox-textfield",validation:ea.none(),maximized:e.maximized,data:o},t),DH=(e,t,o)=>DN({name:e.name,multiline:!0,label:e.label,inputMode:ea.none(),placeholder:e.placeholder,flex:!0,disabled:!e.enabled,classname:"tox-textarea",validation:ea.none(),maximized:e.maximized,data:o},t),Dz=(e,t)=>{let o=e.stream.streams,n=o.setup(e,t);return iI([iV(e.event,n),iq(()=>t.cancel())].concat(e.cancelEvent.map(e=>[iV(e,()=>t.cancel())]).getOr([])))};var DL=Object.freeze({__proto__:null,events:Dz});let DP=(e,t)=>{let o=null,n=()=>{u(o)||(clearTimeout(o),o=null)},r=(...n)=>{u(o)&&(o=setTimeout(()=>{o=null,e.apply(null,n)},t))};return{cancel:n,throttle:r}},DU=(e,t)=>{let o=null,n=()=>{u(o)||(clearTimeout(o),o=null)},r=(...r)=>{n(),o=setTimeout(()=>{o=null,e.apply(null,r)},t)};return{cancel:n,throttle:r}},DW=e=>{let t=ay(null),o=()=>({timer:null!==t.get()?"set":"unset"}),n=e=>{t.set(e)},r=()=>{let e=t.get();null!==e&&e.cancel()};return ly({readState:o,setTimer:n,cancel:r})},Dj=e=>e.stream.streams.state(e);var DG=Object.freeze({__proto__:null,throttle:DW,init:Dj});let D$=(e,t)=>{let o=e.stream,n=DU(e.onStream,o.delay);return t.setTimer(n),(e,t)=>{n.throttle(e,t),o.stopEvent&&t.stop()}};var Dq=[r2("stream",rQ("mode",{throttle:[r1("delay"),ad("stopEvent",!0),s9("streams",{setup:D$,state:DW})]})),ad("event","input"),at("cancelEvent"),s3("onStream")];let DX=cZ({fields:Dq,name:"streaming",active:DL,state:DG}),DK=(e,t,o)=>{let n=gN.getValue(o);gN.setValue(t,n),DJ(t)},DY=(e,t)=>{let o=e.element,n=l8(o),r=o.dom;"number"!==on(o,"type")&&t(r,n)},DJ=e=>{DY(e,(e,t)=>e.setSelectionRange(t.length,t.length))},DZ=(e,t)=>{DY(e,(e,o)=>e.setSelectionRange(t,o.length))},DQ=(e,t,o)=>{if(!e.selectsOver)return ea.none();{let n=gN.getValue(t),r=e.getDisplayText(n),a=gN.getValue(o),i=e.getDisplayText(a);return 0===i.indexOf(r)?ea.some(()=>{DK(e,t,o),DZ(t,r.length)}):ea.none()}},D0=k("alloy.typeahead.itemexecute"),D1=(e,t,o,n)=>{let r=(t,o,r)=>{e.previewing.set(!1);let a=Cb.getCoupled(t,"sandbox");if(go.isOpen(a))pj.getCurrent(a).each(e=>{hy.getHighlighted(e).fold(()=>{r(e)},()=>{iF(a,e.element,"keydown",o)})});else{let o=e=>{pj.getCurrent(e).each(r)};CM(e,i(t),t,a,n,o,J.HighlightMenuAndItem).get(y)}},a=xk(e),i=e=>t=>t.map(t=>{let o=eK(t.menus),n=e_(o,e=>ey(e.items,e=>"item"===e.type)),r=gN.getState(e);return r.update(eh(n,e=>e.data)),t}),l=e=>pj.getCurrent(e),s="typeaheadevents",c=[b$.config({}),gN.config({onSetValue:e.onSetValue,store:{mode:"dataset",getDataKey:e=>l8(e.element),getFallbackEntry:e=>({value:e,meta:{}}),setValue:(t,o)=>{l7(t.element,e.model.getDisplayText(o))},...e.initialData.map(e=>aT("initialValue",e)).getOr({})}}),DX.config({stream:{mode:"throttle",delay:e.responseTime,stopEvent:!1},onStream:(t,o)=>{let r=Cb.getCoupled(t,"sandbox"),a=b$.isFocused(t);if(a&&l8(t.element).length>=e.minChars){let o=l(r).bind(e=>hy.getHighlighted(e).map(gN.getValue));e.previewing.set(!0);let a=t=>{l(r).each(t=>{o.fold(()=>{e.model.selectsOver&&hy.highlightFirst(t)},e=>{hy.highlightBy(t,t=>{let o=gN.getValue(t);return o.value===e.value}),hy.getHighlighted(t).orThunk(()=>(hy.highlightFirst(t),ea.none()))})})};CM(e,i(t),t,r,n,a,J.HighlightJustMenu).get(y)}},cancelEvent:id()}),bw.config({mode:"special",onDown:(e,t)=>(r(e,t,hy.highlightFirst),ea.some(!0)),onEscape:e=>{let t=Cb.getCoupled(e,"sandbox");return go.isOpen(t)?(go.close(t),ea.some(!0)):ea.none()},onUp:(e,t)=>(r(e,t,hy.highlightLast),ea.some(!0)),onEnter:t=>{let o=Cb.getCoupled(t,"sandbox"),n=go.isOpen(o);if(n&&!e.previewing.get())return l(o).bind(e=>hy.getHighlighted(e)).map(e=>(iE(t,D0(),{item:e}),!0));{let r=gN.getValue(t);return iT(t,id()),e.onExecute(o,t,r),n&&go.close(o),ea.some(!0)}}}),ve.config({toggleClass:e.markers.openClass,aria:{mode:"expanded"}}),Cb.config({others:{sandbox:t=>CV(e,t,{onOpen:()=>ve.on(t),onClose:()=>ve.off(t)})}}),bV(s,[i$(t=>{e.lazyTypeaheadComp.set(ea.some(t))}),iq(t=>{e.lazyTypeaheadComp.set(ea.none())}),iK(t=>{CF(e,i(t),t,n,y,J.HighlightMenuAndItem).get(y)}),iV(D0(),(t,o)=>{let n=Cb.getCoupled(t,"sandbox");DK(e.model,t,o.event.item),iT(t,id()),e.onItemExecute(t,n,o.event.item,gN.getValue(t)),go.close(n),DJ(t)})].concat(e.dismissOnBlur?[iV(it(),e=>{let t=Cb.getCoupled(e,"sandbox");c7(t.element).isNone()&&go.close(t)})]:[]))],d={[iv()]:[gN.name(),DX.name(),s],...e.eventOrder};return{uid:e.uid,dom:xO(re(e,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:{...a,...gz(e.typeaheadBehaviours,c)},eventOrder:d}},D2=k([at("lazySink"),r1("fetch"),ad("minChars",5),ad("responseTime",1e3),s1("onOpen"),ad("getHotspot",ea.some),ad("getAnchorOverrides",k({})),ad("layouts",ea.none()),ad("eventOrder",{}),av("model",{},[ad("getDisplayText",e=>void 0!==e.meta&&void 0!==e.meta.text?e.meta.text:e.value),ad("selectsOver",!0),ad("populateFromBrowse",!0)]),s1("onSetValue"),s2("onExecute"),s1("onItemExecute"),ad("inputClasses",[]),ad("inputAttributes",{}),ad("inputStyles",{}),ad("matchWidth",!0),ad("useMinWidth",!1),ad("dismissOnBlur",!0),sQ(["openClass"]),at("initialData"),gV("typeaheadBehaviours",[b$,gN,DX,bw,ve,Cb]),n4("lazyTypeaheadComp",()=>ay(ea.none)),n4("previewing",()=>ay(!0))].concat(xS()).concat(Cz())),D3=k([pi({schema:[sZ()],name:"menu",overrides:e=>({fakeFocus:!0,onHighlightItem:(t,o,n)=>{e.previewing.get()?e.lazyTypeaheadComp.get().each(t=>{DQ(e.model,t,n).fold(()=>{e.model.selectsOver?(hy.dehighlight(o,n),e.previewing.set(!0)):e.previewing.set(!1)},t=>{t(),e.previewing.set(!1)})}):e.lazyTypeaheadComp.get().each(t=>{e.model.populateFromBrowse&&DK(e.model,t,n)})},onExecute:(t,o)=>e.lazyTypeaheadComp.get().map(e=>(iE(e,D0(),{item:o}),!0)),onHover:(t,o)=>{e.previewing.set(!1),e.lazyTypeaheadComp.get().each(t=>{e.model.populateFromBrowse&&DK(e.model,t,o)})}})})]),D5=pz({name:"Typeahead",configFields:D2(),partFields:D3(),factory:D1}),D9=e=>{let t=()=>D9(e.toCached()),o=t=>D9(e.bind(e=>e.fold(e=>CO.pure(nq.error(e)),e=>t(e)))),n=t=>D9(e.map(e=>e.bind(t))),r=t=>D9(e.map(e=>e.map(t))),a=t=>D9(e.map(e=>e.mapError(t))),i=(t,o)=>e.map(e=>e.fold(t,o)),l=(t,o)=>D9(CO.nu(n=>{let r=!1,a=setTimeout(()=>{r=!0,n(nq.error(o()))},t);e.get(e=>{r||(clearTimeout(a),n(e))})}));return{...e,toCached:t,bindFuture:o,bindResult:n,mapResult:r,mapError:a,foldResult:i,withTimeout:l}},D4=e=>D9(CO.nu(e)),D6=e=>D9(CO.pure(nq.value(e))),D8=e=>D9(CO.pure(nq.error(e))),D7=e=>D9(CO.pure(e)),Ae=e=>D9(e.map(nq.value)),At=e=>D4(t=>{e.then(e=>{t(nq.value(e))},e=>{t(nq.error(e))})}),Ao={nu:D4,wrap:D9,pure:D6,value:D6,error:D8,fromResult:D7,fromFuture:Ae,fromPromise:At},An=e=>({isEnabled:()=>!p7.isDisabled(e),setEnabled:t=>p7.set(e,!t),setActive:t=>{let o=e.element;t?(lQ(o,"tox-tbtn--enabled"),ot(o,"aria-pressed",!0)):(l1(o,"tox-tbtn--enabled"),oi(o,"aria-pressed"))},isActive:()=>l2(e.element,"tox-tbtn--enabled")}),Ar=(e,t,o,n)=>De({text:e.text,icon:e.icon,tooltip:e.tooltip,searchable:e.search.isSome(),role:n,fetch:(t,n)=>{let r={pattern:e.search.isSome()?CZ(t):""};e.fetch(t=>{n(Du(t,xn.CLOSE_ON_EXECUTE,o,{isHorizontalMenu:!1,search:e.search}))},r)},onSetup:e.onSetup,getApi:An,columns:1,presets:"normal",classes:[],dropdownBehaviours:[OD.config({})]},t,o.shared),Aa=(e,t,o)=>{let n=e=>n=>{let r=!n.isActive();n.setActive(r),e.storage.set(r),o.shared.getSink().each(o=>{t().getOpt(o).each(t=>{c9(t.element),iE(t,OL,{name:e.name,value:e.storage.get()})})})},r=e=>t=>{t.setActive(e.storage.get())};return t=>{t(eh(e,e=>{let t=e.text.fold(()=>({}),e=>({text:e}));return{type:e.type,active:!1,...t,onAction:n(e),onSetup:r(e)}}))}},Ai=(e,t,o=[],n,r,a)=>{let i=t.fold(()=>({}),e=>({action:e})),l={buttonBehaviours:cY([Sx.button(()=>!e.enabled||a.isDisabled()),Sh(),OD.config({}),bV("button press",[iN("click"),iN("mousedown")])].concat(o)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]},...i},s=re(l,{dom:n});return re(s,{components:r})},Al=(e,t,o,n=[])=>{let r=e.tooltip.map(e=>({"aria-label":o.translate(e),title:o.translate(e)})).getOr({}),a=e.icon.map(e=>E9(e,o.icons)),i=e1([a]);return Ai(e,t,n,{tag:"button",classes:["tox-tbtn"],attributes:r},i,o)},As=e=>{switch(e){case"primary":return["tox-button"];case"toolbar":return["tox-tbtn"];default:return["tox-button","tox-button--secondary"]}},Ac=(e,t,o,n=[],r=[])=>{let a=o.translate(e.text),i=e.icon.map(e=>E9(e,o.icons)),l=[i.getOrThunk(()=>sx(a))],s=e.buttonType.getOr(e.primary||e.borderless?"primary":"secondary"),c=As(s),d=[...c,...i.isSome()?["tox-button--icon"]:[],...e.borderless?["tox-button--naked"]:[],...r];return Ai(e,t,n,{tag:"button",classes:d,attributes:{title:a}},l,o)},Ad=(e,t,o,n=[],r=[])=>{let a=Ac(e,ea.some(t),o,n,r);return vJ.sketch(a)},Au=(e,t)=>o=>{"custom"===t?iE(o,OL,{name:e,value:{}}):"submit"===t?iT(o,OP):"cancel"===t?iT(o,Oz):console.error("Unknown button type: ",t)},Am=(e,t)=>"menu"===t,Ag=(e,t)=>"custom"===t||"cancel"===t||"submit"===t,Ap=(e,t,o)=>{if(Am(e,t)){let t={...e,type:"menubutton",search:ea.none(),onSetup:t=>(t.setEnabled(e.enabled),y),fetch:Aa(e.items,()=>n,o)},n=vZ(Ar(t,"tox-tbtn",o,ea.none()));return n.asSpec()}if(Ag(e,t)){let n=Au(e.name,t),r={...e,borderless:!1};return Ad(r,n,o.shared.providers,[])}throw console.error("Unknown footer button type: ",t),Error("Unknown footer button type")},Ah=(e,t)=>{let o=Au(e.name,"custom");return OB(ea.none(),OO.parts.field({factory:vJ,...Ac(e,ea.some(o),t,[EA.memory(""),ES.self()])}))},Af={type:"separator"},Ab=e=>({type:"menuitem",value:e.url,text:e.title,meta:{attach:e.attach},onAction:y}),Av=(e,t)=>({type:"menuitem",value:t,text:e,meta:{attach:void 0},onAction:y}),Ay=e=>eh(e,Ab),Ax=(e,t)=>ey(t,t=>t.type===e),Aw=(e,t)=>Ay(Ax(e,t)),AS=e=>Aw("header",e.targets),Ak=e=>Aw("anchor",e.targets),AC=e=>ea.from(e.anchorTop).map(e=>Av("<top>",e)).toArray(),AO=e=>ea.from(e.anchorBottom).map(e=>Av("<bottom>",e)).toArray(),A_=e=>eh(e,e=>Av(e,e)),AT=e=>ew(e,(e,t)=>{let o=0===e.length||0===t.length;return o?e.concat(t):e.concat(Af,t)},[]),AE=(e,t)=>{let o=e.toLowerCase();return ey(t,e=>{var t;let n=void 0!==e.meta&&void 0!==e.meta.text?e.meta.text:e.text,r=null!==(t=e.value)&&void 0!==t?t:"";return to(n.toLowerCase(),o)||to(r.toLowerCase(),o)})},AD=(e,t,o)=>{let n=gN.getValue(t),r=void 0!==n.meta.text?n.meta.text:n.value,a=o.getLinkInformation();return a.fold(()=>[],t=>{let n=AE(r,A_(o.getHistory(e)));return"file"===e?AT([n,AE(r,AS(t)),AE(r,eO([AC(t),Ak(t),AO(t)]))]):n})},AA=i8("aria-invalid"),AM=(e,t,o,n)=>{let r=t.shared.providers,a=t=>{let n=gN.getValue(t);o.addToHistory(n.value,e.filetype)},i={...n.map(e=>({initialData:e})).getOr({}),dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":AA,type:"url"},minChars:0,responseTime:0,fetch:n=>{let r=AD(e.filetype,n,o),a=Du(r,xn.BUBBLE_TO_SANDBOX,t,{isHorizontalMenu:!1,search:ea.none()});return CO.pure(a)},getHotspot:e=>g.getOpt(e),onSetValue:(e,t)=>{e.hasConfigured(O5)&&O5.run(e).get(y)},typeaheadBehaviours:cY([...o.getValidationHandler().map(t=>O5.config({getRoot:e=>tW(e.element),invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:(e,t)=>{c.getOpt(e).each(e=>{ot(e.element,"title",r.translate(t))})}},validator:{validate:o=>{let n=gN.getValue(o);return Ao.nu(o=>{t({type:e.filetype,url:n.value},e=>{if("invalid"===e.status){let t=nq.error(e.message);o(t)}else{let t=nq.value(e.message);o(t)}})})},validateOnLoad:!1}})).toArray(),p7.config({disabled:()=>!e.enabled||r.isDisabled()}),OD.config({}),bV("urlinput-events",[iV(a1(),t=>{let o=l8(t.element),n=o.trim();n!==o&&l7(t.element,n),"file"===e.filetype&&iE(t,OV,{name:e.name})}),iV(a2(),t=>{iE(t,OV,{name:e.name}),a(t)}),iV(io(),t=>{iE(t,OV,{name:e.name}),a(t)})])]),eventOrder:{[a1()]:["streaming","urlinput-events","invalidating"]},model:{getDisplayText:e=>e.value,selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:t.shared.getSink,parts:{menu:xw(!1,1,"normal")},onExecute:(e,t,o)=>{iE(t,OP,{})},onItemExecute:(t,o,n,r)=>{a(t),iE(t,OV,{name:e.name})}},l=OO.parts.field({...i,factory:D5}),s=e.label.map(e=>ON(e,r)),c=vZ(((e,t,o=e,n=e)=>ye(o,{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+e],attributes:{title:r.translate(n),"aria-live":"polite",...t.fold(()=>({}),e=>({id:e}))}},r.icons))("invalid",ea.some(AA),"warning")),d=vZ({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[c.asSpec()]}),u=o.getUrlPicker(e.filetype),m=i8("browser.url.event"),g=vZ({dom:{tag:"div",classes:["tox-control-wrap"]},components:[l,d.asSpec()],behaviours:cY([p7.config({disabled:()=>!e.enabled||r.isDisabled()})])}),p=vZ(Ad({name:e.name,icon:ea.some("browse"),text:e.label.getOr(""),enabled:e.enabled,primary:!1,buttonType:ea.none(),borderless:!0},e=>iT(e,m),r,[],["tox-browse-url"])),h=t=>{pj.getCurrent(t).each(o=>{let n=gN.getValue(o),r={fieldname:e.name,...n};u.each(n=>{n(r).get(n=>{gN.setValue(o,n),iE(t,OV,{name:e.name})})})})};return OO.sketch({dom:OI(),components:s.toArray().concat([{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:eO([[g.asSpec()],u.map(()=>p.asSpec()).toArray()])}]),fieldBehaviours:cY([p7.config({disabled:()=>!e.enabled||r.isDisabled(),onDisabled:e=>{OO.getField(e).each(p7.disable),p.getOpt(e).each(p7.disable)},onEnabled:e=>{OO.getField(e).each(p7.enable),p.getOpt(e).each(p7.enable)}}),Sh(),bV("url-input-events",[iV(m,h)])])})},AB=(e,t)=>Oy.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in",`tox-notification--${e.level}`]},components:[{dom:{tag:"div",classes:["tox-notification__icon"]},components:[vJ.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:v9(e.icon,t.icons),attributes:{title:t.translate(e.iconTooltip)}},action:t=>{iE(t,OL,{name:"alert-banner",value:e.url})},buttonBehaviours:cY([v8()])})]},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:t.translate(e.text)}}]}),AF=(e,t)=>{e.dom.checked=t},AI=e=>e.dom.checked,AR=(e,t,o)=>{let n=e=>(e.element.dom.click(),ea.some(!0)),r=OO.parts.field({factory:{sketch:C},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:cY([ES.self(),p7.config({disabled:()=>!e.enabled||t.isDisabled()}),OD.config({}),b$.config({}),EA.withElement(o,AI,AF),bw.config({mode:"special",onEnter:n,onSpace:n,stopSpaceKeyup:!0}),bV("checkbox-events",[iV(a2(),(t,o)=>{iE(t,OV,{name:e.name})})])])}),a=OO.parts.label({dom:{tag:"span",classes:["tox-checkbox__label"]},components:[sx(t.translate(e.label))],behaviours:cY([O8.config({})])}),i=e=>ye("checked"===e?"selected":"unselected",{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+e]},t.icons),l=vZ({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[i("checked"),i("unchecked")]});return OO.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[r,l.asSpec(),a],fieldBehaviours:cY([p7.config({disabled:()=>!e.enabled||t.isDisabled(),disableClass:"tox-checkbox--disabled",onDisabled:e=>{OO.getField(e).each(p7.disable)},onEnabled:e=>{OO.getField(e).each(p7.enable)}}),Sh()])})},AN=e=>"presentation"===e.presets?Oy.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:e.html}}):Oy.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:e.html,attributes:{role:"document"}},containerBehaviours:cY([OD.config({}),b$.config({})])}),AV=e=>(t,o,n,r)=>eY(o,"name").fold(()=>e(o,r,ea.none()),a=>t.field(a,e(o,r,eY(n,a)))),AH={bar:AV((e,t)=>Ow(e,t.shared)),collection:AV((e,t,o)=>O$(e,t.shared.providers,o)),alertbanner:AV((e,t)=>AB(e,t.shared.providers)),input:AV((e,t,o)=>DV(e,t.shared.providers,o)),textarea:AV((e,t,o)=>DH(e,t.shared.providers,o)),label:AV((e,t)=>E0(e,t.shared)),iframe:(j=(e,t,o)=>EK(e,t.shared.providers,o),(e,t,o,n)=>{let r=re(t,{source:"dynamic"});return AV(j)(e,r,o,n)}),button:AV((e,t)=>Ah(e,t.shared.providers)),checkbox:AV((e,t,o)=>AR(e,t.shared.providers,o)),colorinput:AV((e,t,o)=>_n(e,t.shared,t.colorinput,o)),colorpicker:AV((e,t,o)=>EF(e,t.shared.providers,o)),dropzone:AV((e,t,o)=>Ez(e,t.shared.providers,o)),grid:AV((e,t)=>EL(e,t.shared)),listbox:AV((e,t,o)=>Df(e,t,o)),selectbox:AV((e,t,o)=>Dx(e,t.shared.providers,o)),sizeinput:AV((e,t)=>DF(e,t.shared.providers)),slider:AV((e,t,o)=>DI(e,t.shared.providers,o)),urlinput:AV((e,t,o)=>AM(e,t,t.urlinput,o)),customeditor:AV(EN),htmlpanel:AV(AN),imagepreview:AV((e,t,o)=>EQ(e,o)),table:AV((e,t)=>DR(e,t.shared.providers)),panel:AV((e,t)=>Db(e,t))},Az={field:(e,t)=>t,record:k([])},AL=(e,t,o,n)=>{let r=re(n,{shared:{interpreter:t=>AP(e,t,o,r)}});return AP(e,t,o,r)},AP=(e,t,o,n)=>eY(AH,t.type).fold(()=>(console.error(`Unknown factory type "${t.type}", defaulting to container: `,t),t),r=>r(e,t,o,n)),AU=(e,t,o)=>AP(Az,e,t,o),AW="layout-inset",Aj=e=>e.x,AG=(e,t)=>e.x+e.width/2-t.width/2,A$=(e,t)=>e.x+e.width-t.width,Aq=e=>e.y,AX=(e,t)=>e.y+e.height-t.height,AK=(e,t)=>e.y+e.height/2-t.height/2,AY=(e,t,o)=>s8(A$(e,t),AX(e,t),o.insetSouthwest(),ci(),"southwest",cp(e,{right:0,bottom:3}),AW),AJ=(e,t,o)=>s8(Aj(e),AX(e,t),o.insetSoutheast(),ca(),"southeast",cp(e,{left:1,bottom:3}),AW),AZ=(e,t,o)=>s8(A$(e,t),Aq(e),o.insetNorthwest(),cr(),"northwest",cp(e,{right:0,top:2}),AW),AQ=(e,t,o)=>s8(Aj(e),Aq(e),o.insetNortheast(),cn(),"northeast",cp(e,{left:1,top:2}),AW),A0=(e,t,o)=>s8(AG(e,t),Aq(e),o.insetNorth(),cl(),"north",cp(e,{top:2}),AW),A1=(e,t,o)=>s8(AG(e,t),AX(e,t),o.insetSouth(),cs(),"south",cp(e,{bottom:3}),AW),A2=(e,t,o)=>s8(A$(e,t),AK(e,t),o.insetEast(),cd(),"east",cp(e,{right:0}),AW),A3=(e,t,o)=>s8(Aj(e),AK(e,t),o.insetWest(),cc(),"west",cp(e,{left:1}),AW),A5=e=>{switch(e){case"north":return A0;case"northeast":return AQ;case"northwest":return AZ;case"south":return A1;case"southeast":return AJ;case"southwest":return AY;case"east":return A2;case"west":return A3}},A9=(e,t,o,n,r)=>{let a=dv(n).map(A5).getOr(A0);return a(e,t,o,n,r)},A4=e=>{switch(e){case"north":return A1;case"northeast":return AJ;case"northwest":return AY;case"south":return A0;case"southeast":return AQ;case"southwest":return AZ;case"east":return A3;case"west":return A2}},A6=(e,t,o,n,r)=>{let a=dv(n).map(A4).getOr(A0);return a(e,t,o,n,r)},A8={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},A7=(e,t,o)=>{let n={maxHeightFunction:dY()},r=()=>({type:"node",root:t1(t0(e())),node:ea.from(e()),bubble:d1(12,12,A8),layouts:{onRtl:()=>[AQ],onLtr:()=>[AZ]},overrides:n}),a=()=>({type:"hotspot",hotspot:t(),bubble:d1(-12,12,A8),layouts:{onRtl:()=>[cO],onLtr:()=>[c_]},overrides:n});return()=>o()?r():a()},Me=(e,t,o)=>{let n=()=>({type:"node",root:t1(t0(e())),node:ea.from(e()),layouts:{onRtl:()=>[A0],onLtr:()=>[A0]}}),r=()=>({type:"hotspot",hotspot:t(),layouts:{onRtl:()=>[cA],onLtr:()=>[cA]}});return()=>o()?n():r()},Mt=(e,t)=>()=>({type:"selection",root:t(),getSelection:()=>{let t=e.selection.getRng();return ea.some(uI.range(tp.fromDom(t.startContainer),t.startOffset,tp.fromDom(t.endContainer),t.endOffset))}}),Mo=e=>t=>({type:"node",root:e(),node:t}),Mn=(e,t,o)=>{let n=y2(e),r=()=>tp.fromDom(e.getBody()),a=()=>tp.fromDom(e.getContentAreaContainer()),i=()=>n||!o();return{inlineDialog:A7(a,t,i),banner:Me(a,t,i),cursor:Mt(e,r),node:Mo(r)}},Mr=e=>(t,o)=>{let n=kQ(e);n(t,o)},Ma=e=>()=>kH(e),Mi=e=>t=>kz(e,t),Ml=e=>t=>kV(e,t),Ms=e=>({colorPicker:Mr(e),hasCustomColors:Ma(e),getColors:Mi(e),getColorCols:Ml(e)}),Mc=e=>()=>yz(e),Md=e=>({isDraggableModal:Mc(e)}),Mu=e=>{let t=ay(y0(e)?"bottom":"top");return{isPositionedAtTop:()=>"top"===t.get(),getDockingMode:t.get,setDockingMode:t.set}},Mm=e=>eZ(e,"items"),Mg=e=>eZ(e,"format"),Mp=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",format:"bold"},{title:"Italic",format:"italic"},{title:"Underline",format:"underline"},{title:"Strikethrough",format:"strikethrough"},{title:"Superscript",format:"superscript"},{title:"Subscript",format:"subscript"},{title:"Code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",format:"alignleft"},{title:"Center",format:"aligncenter"},{title:"Right",format:"alignright"},{title:"Justify",format:"alignjustify"}]}],Mh=e=>eJ(e,"items"),Mf=e=>eJ(e,"block"),Mb=e=>eJ(e,"inline"),Mv=e=>eJ(e,"selector"),My=e=>ew(e,(e,t)=>{if(Mh(t)){let o=My(t.items);return{customFormats:e.customFormats.concat(o.customFormats),formats:e.formats.concat([{title:t.title,items:o.formats}])}}if(!(Mb(t)||Mf(t)||Mv(t)))return{...e,formats:e.formats.concat(t)};{let o=l(t.name)?t.name:t.title.toLowerCase(),n=`custom-${o}`;return{customFormats:e.customFormats.concat([{name:n,format:t}]),formats:e.formats.concat([{title:t.title,format:n,icon:t.icon}])}}},{customFormats:[],formats:[]}),Mx=(e,t)=>{let o=My(t),n=t=>{ef(t,t=>{e.formatter.has(t.name)||e.formatter.register(t.name,t.format)})};return e.formatter?n(o.customFormats):e.on("init",()=>{n(o.customFormats)}),o.formats},Mw=e=>yy(e).map(t=>{let o=Mx(e,t);return yx(e)?Mp.concat(o):o}).getOr(Mp),MS=e=>{let t=eH(e);return 1===t.length&&eu(t,"title")},Mk=(e,t,o)=>({...e,type:"formatter",isSelected:t(e.format),getStylePreview:o(e.format)}),MC=(e,t,o,n)=>{let r=e=>Mk(e,o,n),a=e=>{let t=s(e.items);return{...e,type:"submenu",getStyleItems:k(t)}},i=t=>{let r=l(t.name)?t.name:i8(t.title),a=`custom-${r}`,i={...t,type:"formatter",format:a,isSelected:o(a),getStylePreview:n(a)};return e.formatter.register(r,i),i},s=e=>eh(e,e=>Mm(e)?a(e):Mg(e)?r(e):MS(e)?{...e,type:"separator"}:i(e));return s(t)},MO=e=>{let t=t=>()=>e.formatter.match(t),o=t=>()=>{let o=e.formatter.get(t);return void 0!==o?ea.some({tag:o.length>0&&(o[0].inline||o[0].block)||"div",styles:e.dom.parseStyle(e.formatter.getCssText(t))}):ea.none()},n=ay([]),r=ay([]),a=ay(!1);e.on("PreInit",r=>{let a=Mw(e),i=MC(e,a,t,o);n.set(i)}),e.on("addStyleModifications",n=>{let i=MC(e,n.items,t,o);r.set(i),a.set(n.replace)});let i=()=>{let e=a.get()?[]:n.get(),t=r.get();return e.concat(t)};return{getData:i}},M_=e=>h(e)&&1===e.nodeType,MT=EV.trim,ME=e=>t=>!!M_(t)&&(t.contentEditable===e||t.getAttribute("data-mce-contenteditable")===e),MD=ME("true"),MA=ME("false"),MM=(e,t,o,n,r)=>({type:e,title:t,url:o,level:n,attach:r}),MB=e=>{let t=e;for(;t=t.parentNode;){let e=t.contentEditable;if(e&&"inherit"!==e)return MD(t)}return!1},MF=(e,t)=>eh(uX(tp.fromDom(t),e),e=>e.dom),MI=e=>e.innerText||e.textContent,MR=e=>e.id?e.id:i8("h"),MN=e=>e&&"A"===e.nodeName&&(e.id||e.name)!==void 0,MV=e=>MN(e)&&Mz(e),MH=e=>e&&/^(H[1-6])$/.test(e.nodeName),Mz=e=>MB(e)&&!MA(e),ML=e=>MH(e)&&Mz(e),MP=e=>MH(e)?parseInt(e.nodeName.substr(1),10):0,MU=e=>{var t;let o=MR(e),n=()=>{e.id=o};return MM("header",null!==(t=MI(e))&&void 0!==t?t:"","#"+o,MP(e),n)},MW=e=>{let t=e.id||e.name,o=MI(e);return MM("anchor",o||"#"+t,"#"+t,0,y)},Mj=e=>eh(ey(e,ML),MU),MG=e=>eh(ey(e,MV),MW),M$=e=>{let t=MF("h1,h2,h3,h4,h5,h6,a:not([href])",e);return t},Mq=e=>MT(e.title).length>0,MX=e=>{let t=M$(e);return ey(Mj(t).concat(MG(t)),Mq)},MK={find:MX},MY="tinymce-url-history",MJ=e=>l(e)&&/^https?/.test(e),MZ=e=>d(e)&&e.length<=5&&eT(e,MJ),MQ=e=>s(e)&&eX(e,e=>!MZ(e)).isNone(),M0=()=>{let e;let t=ky.getItem(MY);if(null===t)return{};try{e=JSON.parse(t)}catch(e){if(e instanceof SyntaxError)return console.log("Local storage "+MY+" was not valid JSON",e),{};throw e}return MQ(e)?e:(console.log("Local storage "+MY+" was not valid format",e),{})},M1=e=>{if(!MQ(e))throw Error("Bad format for history:\n"+JSON.stringify(e));ky.setItem(MY,JSON.stringify(e))},M2=e=>{let t=M0();return eY(t,e).getOr([])},M3=(e,t)=>{if(!MJ(e))return;let o=M0(),n=eY(o,t).getOr([]),r=ey(n,t=>t!==e);o[t]=[e].concat(r).slice(0,5),M1(o)},M5=e=>!!e,M9=e=>eP(EV.makeMap(e,/[, ]/),M5),M4=e=>ea.from(yF(e)),M6=e=>{let t=ea.from(yR(e)).filter(M5).map(M9);return M4(e).fold(A,e=>t.fold(M,e=>eH(e).length>0&&e))},M8=(e,t)=>{let o=M6(e);return m(o)?o?M4(e):ea.none():o[t]?M4(e):ea.none()},M7=(e,t)=>M8(e,t).map(o=>n=>CO.nu(r=>{let a=(e,t)=>{if(!l(e))throw Error("Expected value to be string");if(void 0!==t&&!s(t))throw Error("Expected meta to be a object");r({value:e,meta:t})},i={filetype:t,fieldname:n.fieldname,...ea.from(n.meta).getOr({})};o.call(e,a,n.value,i)})),Be=e=>ea.from(e).filter(l).getOrUndefined(),Bt=e=>yN(e)?ea.some({targets:MK.find(e.getBody()),anchorTop:Be(yV(e)),anchorBottom:Be(yH(e))}):ea.none(),Bo=e=>ea.from(yI(e)),Bn=e=>({getHistory:M2,addToHistory:M3,getLinkInformation:()=>Bt(e),getValidationHandler:()=>Bo(e),getUrlPicker:t=>M7(e,t)}),Br=(e,t,o)=>{let n=ay(!1),r=Mu(t),a={icons:()=>t.ui.registry.getAll().icons,menuItems:()=>t.ui.registry.getAll().menuItems,translate:vQ.translate,isDisabled:()=>t.mode.isReadOnly()||!t.ui.isEnabled(),getOption:t.options.get},i=Bn(t),l=MO(t),s=Ms(t),c=Md(t),d=()=>n.get(),u=e=>n.set(e),m={shared:{providers:a,anchors:Mn(t,o,r.isPositionedAtTop),header:r},urlinput:i,styles:l,colorinput:s,dialog:c,isContextMenuOpen:d,setContextMenuState:u},g={...m,shared:{...m.shared,interpreter:e=>AU(e,{},g),getSink:e.popup}},p={...m,shared:{...m.shared,interpreter:e=>AU(e,{},p),getSink:e.dialog}};return{popup:g,dialog:p}},Ba=(e,t,o)=>{let n=(e,n)=>{ef([t,...o],t=>{t.broadcastEvent(e,n)})},r=(e,n)=>{ef([t,...o],t=>{t.broadcastOn([e],n)})},a=e=>r(gn(),{target:e.target}),i=nM(),l=dA(i,"touchstart",a),s=dA(i,"touchmove",e=>n(im(),e)),c=dA(i,"touchend",e=>n(ig(),e)),d=dA(i,"mousedown",a),u=dA(i,"mouseup",e=>{0===e.raw.button&&r(ga(),{target:e.target})}),m=e=>r(gn(),{target:tp.fromDom(e.target)}),g=e=>{0===e.button&&r(ga(),{target:tp.fromDom(e.target)})},p=()=>{ef(e.editorManager.get(),t=>{e!==t&&t.dispatch("DismissPopups",{relatedTarget:e})})},h=e=>n(ip(),nm(e)),f=e=>{r(gr(),{}),n(ih(),nm(e))},b=()=>r(gr(),{}),v=t=>{t.state&&r(gn(),{target:tp.fromDom(e.getContainer())})},y=e=>{r(gn(),{target:tp.fromDom(e.relatedTarget.getContainer())})};e.on("PostRender",()=>{e.on("click",m),e.on("tap",m),e.on("mouseup",g),e.on("mousedown",p),e.on("ScrollWindow",h),e.on("ResizeWindow",f),e.on("ResizeEditor",b),e.on("AfterProgressState",v),e.on("DismissPopups",y)}),e.on("remove",()=>{e.off("click",m),e.off("tap",m),e.off("mouseup",g),e.off("mousedown",p),e.off("ScrollWindow",h),e.off("ResizeWindow",f),e.off("ResizeEditor",b),e.off("AfterProgressState",v),e.off("DismissPopups",y),d.unbind(),l.unbind(),s.unbind(),c.unbind(),u.unbind()}),e.on("detach",()=>{ef([t,...o],m$),ef([t,...o],e=>e.destroy())})},Bi=k([ad("shell",!1),r1("makeItem"),ad("setupItem",y),gL.field("listBehaviours",[bR])]),Bl=()=>({behaviours:cY([bR.config({})])}),Bs=pl({name:"items",overrides:Bl}),Bc=k([Bs]),Bd=k("CustomList"),Bu=(e,t,o,n)=>{let r=(t,o)=>{i(t).fold(()=>{throw console.error("Custom List was defined to not be a shell, but no item container was specified in components"),Error("Custom List was defined to not be a shell, but no item container was specified in components")},n=>{let r=bR.contents(n),a=o.length,i=a-r.length,l=i>0?eg(i,()=>e.makeItem()):[],s=r.slice(a);ef(s,e=>bR.remove(n,e)),ef(l,e=>bR.append(n,e));let c=bR.contents(n);ef(c,(n,r)=>{e.setupItem(t,n,o[r],r)})})},a=e.shell?{behaviours:[bR.config({})],components:[]}:{behaviours:[],components:t},i=t=>e.shell?ea.some(t):px(t,e,"items");return{uid:e.uid,dom:e.dom,components:a.components,behaviours:gz(e.listBehaviours,a.behaviours),apis:{setItems:r}}},Bm=pz({name:Bd(),configFields:Bi(),partFields:Bc(),factory:Bu,apis:{setItems:(e,t,o)=>{e.setItems(t,o)}}}),Bg=k([r1("dom"),ad("shell",!0),gV("toolbarBehaviours",[bR])]),Bp=()=>({behaviours:cY([bR.config({})])}),Bh=k([pl({name:"groups",overrides:Bp})]),Bf=(e,t,o,n)=>{let r=(e,t)=>{a(e).fold(()=>{throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),Error("Toolbar was defined to not be a shell, but no groups container was specified in components")},e=>{bR.set(e,t)})},a=t=>e.shell?ea.some(t):px(t,e,"groups"),i=e.shell?{behaviours:[bR.config({})],components:[]}:{behaviours:[],components:t};return{uid:e.uid,dom:e.dom,components:i.components,behaviours:gz(e.toolbarBehaviours,i.behaviours),apis:{setGroups:r},domModification:{attributes:{role:"group"}}}},Bb=pz({name:"Toolbar",configFields:Bg(),partFields:Bh(),factory:Bf,apis:{setGroups:(e,t,o)=>{e.setGroups(t,o)}}}),Bv=k([]);var By=Object.freeze({__proto__:null,setup:y,isDocked:A,getBehaviours:Bv});let Bx=e=>{let t=eQ(oh(e,"position"),"fixed"),o=t?ea.none():tj(e);return o.orThunk(()=>{let t=tp.fromTag("span");return tU(e).bind(e=>{nw(e,t);let o=tj(t);return nO(t),o})})},Bw=e=>Bx(e).map(oE).getOrThunk(()=>oO(0,0)),BS=aw.generate([{static:[]},{absolute:["positionCss"]},{fixed:["positionCss"]}]),Bk=(e,t)=>{let o=e.element;lQ(o,t.transitionClass),l1(o,t.fadeOutClass),lQ(o,t.fadeInClass),t.onShow(e)},BC=(e,t)=>{let o=e.element;lQ(o,t.transitionClass),l1(o,t.fadeInClass),lQ(o,t.fadeOutClass),t.onHide(e)},BO=(e,t)=>e.y<t.bottom&&e.bottom>t.y,B_=(e,t)=>e.y>=t.y,BT=(e,t)=>e.bottom<=t.bottom,BE=(e,t,o)=>eT(e,e=>{switch(e){case"bottom":return BT(t,o);case"top":return B_(t,o)}}),BD=(e,t)=>t.getInitialPos().map(t=>nL(t.bounds.x,t.bounds.y,oB(e),oS(e))),BA=(e,t,o)=>{o.setInitialPos({style:of(e),position:og(e,"position")||"static",bounds:t})},BM=(e,t,o)=>o.getInitialPos().bind(n=>{switch(o.clearInitialPos(),n.position){case"static":return ea.some(BS.static());case"absolute":let r=Bx(e).map(nP).getOrThunk(()=>nP(t8()));return ea.some(BS.absolute(dt("absolute",eY(n.style,"left").map(e=>t.x-r.x),eY(n.style,"top").map(e=>t.y-r.y),eY(n.style,"right").map(e=>r.right-t.right),eY(n.style,"bottom").map(e=>r.bottom-t.bottom))));default:return ea.none()}}),BB=(e,t,o)=>BD(e,o).filter(e=>BE(o.getModes(),e,t)).bind(t=>BM(e,t,o)),BF=(e,t,o)=>{let n=nP(e);if(BE(o.getModes(),n,t))return ea.none();{BA(e,n,o);let r=nW(),a=n.x-r.x,i=t.y-r.y,l=r.bottom-t.bottom,s=n.y<=t.y;return ea.some(BS.fixed(dt("fixed",ea.some(a),s?ea.some(i):ea.none(),ea.none(),s?ea.none():ea.some(l))))}},BI=(e,t,o)=>{let n=e.element,r=eQ(oh(n,"position"),"fixed");return r?BB(n,t,o):BF(n,t,o)},BR=(e,t)=>{let o=e.element;return BD(o,t).bind(e=>BM(o,e,t))},BN=(e,t,o)=>{o.setDocked(!1),ef(["left","right","top","bottom","position"],t=>ov(e.element,t)),t.onUndocked(e)},BV=(e,t,o,n)=>{let r="fixed"===n.position;o.setDocked(r),dr(e.element,n);let a=r?t.onDocked:t.onUndocked;a(e)},BH=(e,t,o,n,r=!1)=>{t.contextual.each(t=>{t.lazyContext(e).each(a=>{let i=BO(a,n);i!==o.isVisible()&&(o.setVisible(i),r&&!i?(l3(e.element,[t.fadeOutClass]),t.onHide(e)):(i?Bk:BC)(e,t))})})},Bz=(e,t,o)=>{let n=t.lazyViewport(e),r=o.isDocked();r&&BH(e,t,o,n),BI(e,n,o).each(r=>{r.fold(()=>BN(e,t,o),n=>BV(e,t,o,n),r=>{BH(e,t,o,n,!0),BV(e,t,o,r)})})},BL=(e,t,o)=>{let n=e.element;o.setDocked(!1),BR(e,o).each(n=>{n.fold(()=>BN(e,t,o),n=>BV(e,t,o,n),y)}),o.setVisible(!0),t.contextual.each(t=>{l5(n,[t.fadeInClass,t.fadeOutClass,t.transitionClass]),t.onShow(e)}),BP(e,t,o)},BP=(e,t,o)=>{e.getSystem().isConnected()&&Bz(e,t,o)},BU=(e,t,o)=>{o.isDocked()&&BL(e,t,o)},BW=(e,t,o)=>o.isDocked(),Bj=(e,t,o,n)=>o.setModes(n),BG=(e,t,o)=>o.getModes();var B$=Object.freeze({__proto__:null,refresh:BP,reset:BU,isDocked:BW,getModes:BG,setModes:Bj});let Bq=(e,t)=>iI([iG(a9(),(o,n)=>{e.contextual.each(e=>{if(l2(o.element,e.transitionClass)){l5(o.element,[e.transitionClass,e.fadeInClass]);let n=t.isVisible()?e.onShown:e.onHidden;n(o)}n.stop()})}),iV(ip(),(o,n)=>{BP(o,e,t)}),iV(ih(),(o,n)=>{BU(o,e,t)})]);var BX=Object.freeze({__proto__:null,events:Bq}),BK=[as("contextual",[r5("fadeInClass"),r5("fadeOutClass"),r5("transitionClass"),r4("lazyContext"),s1("onShow"),s1("onShown"),s1("onHide"),s1("onHidden")]),af("lazyViewport",nW),ab("modes",["top","bottom"],rz),s1("onDocked"),s1("onUndocked")];let BY=e=>{let t=ay(!1),o=ay(!0),n=dD(),r=ay(e.modes),a=()=>`docked:  ${t.get()}, visible: ${o.get()}, modes: ${r.get().join(",")}`;return ly({isDocked:t.get,setDocked:t.set,getInitialPos:n.get,setInitialPos:n.set,clearInitialPos:n.clear,isVisible:o.get,setVisible:o.set,getModes:r.get,setModes:r.set,readState:a})};var BJ=Object.freeze({__proto__:null,init:BY});let BZ=cZ({fields:BK,name:"docking",active:BX,apis:B$,state:BJ}),BQ=k(i8("toolbar-height-change")),B0={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},B1="tox-tinymce--toolbar-sticky-on",B2="tox-tinymce--toolbar-sticky-off",B3=(e,t)=>{let o=tH(t),n=tP(t),r=n.dom.innerHeight,a=n_(o),i=tp.fromDom(e.elm),l=nU(i),s=oS(i),c=l.y,d=oE(t),u=oS(t),m=d.top,g=m+u,p=2>Math.abs(m-a.top),h=2>Math.abs(g-(a.top+r));p&&c<g?nT(a.left,c-u,o):h&&c+s>m&&nT(a.left,c-r+s+u,o)},B5=(e,t)=>eu(BZ.getModes(e),t),B9=e=>{let t=e=>ok(e)+(parseInt(og(e,"margin-top"),10)||0)+(parseInt(og(e,"margin-bottom"),10)||0),o=e.element;tW(o).each(n=>{let r="padding-"+BZ.getModes(e)[0];if(BZ.isDocked(e)){let e=oB(n);od(o,"width",e+"px"),od(n,r,t(o)+"px")}else ov(o,"width"),ov(n,r)})},B4=(e,t)=>{t?(l1(e,B0.fadeOutClass),l3(e,[B0.transitionClass,B0.fadeInClass])):(l1(e,B0.fadeInClass),l3(e,[B0.fadeOutClass,B0.transitionClass]))},B6=(e,t)=>{let o=tp.fromDom(e.getContainer());t?(lQ(o,B1),l1(o,B2)):(lQ(o,B2),l1(o,B1))},B8=(e,t)=>{let o=tH(t);c8(o).filter(e=>!tN(t,e)).filter(t=>tN(t,tp.fromDom(o.dom.body))||tV(e,t)).each(()=>c9(t))},B7=(e,t)=>c7(e).orThunk(()=>t().toOptional().bind(e=>c7(e.element))),Fe=(e,t,o)=>{e.inline||(t.header.isPositionedAtTop()||e.on("ResizeEditor",()=>{o().each(BZ.reset)}),e.on("ResizeWindow ResizeEditor",()=>{o().each(B9)}),e.on("SkinLoaded",()=>{o().each(e=>{BZ.isDocked(e)?BZ.reset(e):BZ.refresh(e)})}),e.on("FullscreenStateChanged",()=>{o().each(BZ.reset)})),e.on("AfterScrollIntoView",e=>{o().each(t=>{BZ.refresh(t);let o=t.element;h7(o)&&B3(e,o)})}),e.on("PostRender",()=>{B6(e,!1)})},Ft=e=>e().map(BZ.isDocked).getOr(!1),Fo=()=>[c2.config({channels:{[BQ()]:{onReceive:B9}}})],Fn=(e,t)=>{let o=dD(),n=t.getSink,r=e=>{n().each(t=>e(t.element))},a=t=>{e.inline||B9(t),B6(e,BZ.isDocked(t)),t.getSystem().broadcastOn([gr()],{}),n().each(e=>e.getSystem().broadcastOn([gr()],{}))},i=e.inline?[]:Fo();return[b$.config({}),BZ.config({contextual:{lazyContext:t=>{let o=ok(t.element),n=e.inline?e.getContentAreaContainer():e.getContainer(),r=nP(tp.fromDom(n)),a=r.height-o,i=r.y+(B5(t,"top")?0:o);return ea.some(nL(r.x,i,r.width,a))},onShow:()=>{r(e=>B4(e,!0))},onShown:e=>{r(e=>l5(e,[B0.transitionClass,B0.fadeInClass])),o.get().each(t=>{B8(e.element,t),o.clear()})},onHide:e=>{B7(e.element,n).fold(o.clear,o.set),r(e=>B4(e,!1))},onHidden:()=>{r(e=>l5(e,[B0.transitionClass]))},...B0},lazyViewport:t=>{let o=nW(),n=yA(e),r=o.y+(B5(t,"top")?n:0),a=o.height-(B5(t,"bottom")?n:0);return nL(o.x,r,o.width,a)},modes:[t.header.getDockingMode()],onDocked:a,onUndocked:a}),...i]};var Fr=Object.freeze({__proto__:null,setup:Fe,isDocked:Ft,getBehaviours:Fn});let Fa=e=>{let t=e.editor,o=e.sticky?Fn:Bv;return{uid:e.uid,dom:e.dom,components:e.components,behaviours:cY(o(t,e.sharedBackstage))}},Fi=rM([xJ,r2("items",rF([rR([xZ,ae("items",rz)]),rz]))].concat(wx)),Fl=e=>rK("GroupToolbarButton",Fi,e),Fs=[ar("text"),ar("tooltip"),ar("icon"),au("search",!1,rF([rL,rM([ar("placeholder")])],e=>m(e)?e?ea.some({placeholder:ea.none()}):ea.none():ea.some(e))),r4("fetch"),af("onSetup",()=>y)],Fc=rM([xJ,...Fs]),Fd=e=>rK("menubutton",Fc,e),Fu=rM([xJ,wo,wt,we,wa,x5,x8,ap("presets","normal",["normal","color","listpreview"]),wd(1),x4,x6]),Fm=e=>rK("SplitButton",Fu,e),Fg=(e,t)=>{let o=(e,o)=>{let n=eh(o,e=>{let o={type:"menubutton",text:e.text,fetch:t=>{t(e.getItems())}},n=Fd(o).mapError(e=>rZ(e)).getOrDie();return Ar(n,"tox-mbtn",t.backstage,ea.some("menuitem"))});bR.set(e,n)},n={focus:bw.focusIn,setMenus:o};return{uid:e.uid,dom:e.dom,components:[],behaviours:cY([bR.config({}),bV("menubar-events",[i$(t=>{e.onSetup(t)}),iV(aY(),(e,t)=>{sF(e.element,".tox-mbtn--active").each(o=>{sI(t.event.target,".tox-mbtn").each(t=>{tN(o,t)||e.getSystem().getByDom(o).each(o=>{e.getSystem().getByDom(t).each(e=>{CW.expand(e),CW.close(o),b$.focus(e)})})})})}),iV(iw(),(e,t)=>{t.event.prevFocus.bind(t=>e.getSystem().getByDom(t).toOptional()).each(o=>{t.event.newFocus.bind(t=>e.getSystem().getByDom(t).toOptional()).each(e=>{CW.isOpen(o)&&(CW.expand(e),CW.close(o))})})})]),bw.config({mode:"flow",selector:".tox-mbtn",onEscape:t=>(e.onEscape(t),ea.some(!0))}),OD.config({})]),apis:n,domModification:{attributes:{role:"menubar"}}}};var Fp=pH({factory:Fg,name:"silver.Menubar",configFields:[r1("dom"),r1("uid"),r1("onEscape"),r1("backstage"),ad("onSetup",y)],apis:{focus:(e,t)=>{e.focus(t)},setMenus:(e,t,o)=>{e.setMenus(t,o)}}});let Fh=e=>({uid:e.uid,dom:e.dom,components:[{dom:{tag:"a",attributes:{href:"https://www.tiny.cloud/tinymce-self-hosted-premium-features/?utm_source=TinyMCE&utm_medium=SPAP&utm_campaign=SPAP&utm_id=editorreferral",rel:"noopener",target:"_blank","aria-hidden":"true"},classes:["tox-promotion-link"],innerHtml:"Upgrade"}}]}),Ff=(e,t)=>t.getAnimationRoot.fold(()=>e.element,t=>t(e)),Fb=e=>e.dimension.property,Fv=(e,t)=>e.dimension.getDimension(t),Fy=(e,t)=>{let o=Ff(e,t);l5(o,[t.shrinkingClass,t.growingClass])},Fx=(e,t)=>{l1(e.element,t.openClass),lQ(e.element,t.closedClass),od(e.element,Fb(t),"0px"),oy(e.element)},Fw=(e,t)=>{l1(e.element,t.closedClass),lQ(e.element,t.openClass),ov(e.element,Fb(t))},FS=(e,t,o,n)=>{o.setCollapsed(),od(e.element,Fb(t),Fv(t,e.element)),Fy(e,t),Fx(e,t),t.onStartShrink(e),t.onShrunk(e)},Fk=(e,t,o,n)=>{let r=n.getOrThunk(()=>Fv(t,e.element));o.setCollapsed(),od(e.element,Fb(t),r),oy(e.element);let a=Ff(e,t);l1(a,t.growingClass),lQ(a,t.shrinkingClass),Fx(e,t),t.onStartShrink(e)},FC=(e,t,o)=>{let n=Fv(t,e.element);("0px"===n?FS:Fk)(e,t,o,ea.some(n))},FO=(e,t,o)=>{let n=Ff(e,t),r=l2(n,t.shrinkingClass),a=Fv(t,e.element);Fw(e,t);let i=Fv(t,e.element),l=()=>{od(e.element,Fb(t),a),oy(e.element)},s=()=>{Fx(e,t)};(r?l:s)(),l1(n,t.shrinkingClass),lQ(n,t.growingClass),Fw(e,t),od(e.element,Fb(t),i),o.setExpanded(),t.onStartGrow(e)},F_=(e,t,o)=>{if(o.isExpanded()){ov(e.element,Fb(t));let o=Fv(t,e.element);od(e.element,Fb(t),o)}},FT=(e,t,o)=>{o.isExpanded()||FO(e,t,o)},FE=(e,t,o)=>{o.isExpanded()&&FC(e,t,o)},FD=(e,t,o)=>{o.isExpanded()&&FS(e,t,o)},FA=(e,t,o)=>o.isExpanded(),FM=(e,t,o)=>o.isCollapsed(),FB=(e,t,o)=>{let n=Ff(e,t);return!0===l2(n,t.growingClass)},FF=(e,t,o)=>{let n=Ff(e,t);return!0===l2(n,t.shrinkingClass)},FI=(e,t,o)=>FB(e,t)||FF(e,t),FR=(e,t,o)=>{let n=o.isExpanded()?FC:FO;n(e,t,o)},FN=(e,t,o)=>{o.isExpanded()||(Fw(e,t),od(e.element,Fb(t),Fv(t,e.element)),Fy(e,t),o.setExpanded(),t.onStartGrow(e),t.onGrown(e))};var FV=Object.freeze({__proto__:null,refresh:F_,grow:FT,shrink:FE,immediateShrink:FD,hasGrown:FA,hasShrunk:FM,isGrowing:FB,isShrinking:FF,isTransitioning:FI,toggleGrow:FR,disableTransitions:Fy,immediateGrow:FN});let FH=(e,t,o)=>{let n=t.expanded;return n?lC({classes:[t.openClass],styles:{}}):lC({classes:[t.closedClass],styles:aT(t.dimension.property,"0px")})},Fz=(e,t)=>iI([iG(a9(),(o,n)=>{let r=n.event.raw;if(r.propertyName===e.dimension.property){Fy(o,e),t.isExpanded()&&ov(o.element,e.dimension.property);let n=t.isExpanded()?e.onGrown:e.onShrunk;n(o)}})]);var FL=Object.freeze({__proto__:null,exhibit:FH,events:Fz}),FP=[r1("closedClass"),r1("openClass"),r1("shrinkingClass"),r1("growingClass"),at("getAnimationRoot"),s1("onShrunk"),s1("onStartShrink"),s1("onGrown"),s1("onStartGrow"),ad("expanded",!1),r2("dimension",rQ("property",{width:[s9("property","width"),s9("getDimension",e=>oB(e)+"px")],height:[s9("property","height"),s9("getDimension",e=>oS(e)+"px")]}))];let FU=e=>{let t=ay(e.expanded),o=()=>"expanded: "+t.get();return ly({isExpanded:()=>!0===t.get(),isCollapsed:()=>!1===t.get(),setCollapsed:_(t.set,!1),setExpanded:_(t.set,!0),readState:o})};var FW=Object.freeze({__proto__:null,init:FU});let Fj=cZ({fields:FP,name:"sliding",active:FL,apis:FV,state:FW}),FG="container",F$=[gV("slotBehaviours",[])],Fq=e=>"<alloy.field."+e+">",FX=e=>{let t=(()=>{let e=[],t=(t,o)=>(e.push(t),ph(FG,Fq(t),o));return{slot:t,record:k(e)}})(),o=e(t),n=t.record(),r=eh(n,e=>pa({name:e,pname:Fq(e)}));return pB(FG,F$,r,FK,o)},FK=(e,t)=>{let o=t=>pC(e),n=(t,o)=>px(t,e,o),r=(t,o)=>(n,r)=>px(n,e,r).map(e=>t(e,r)).getOr(o),a=(e,t)=>"true"!==on(e.element,"aria-hidden"),i=(e,t)=>{if(!a(e)){let o=e.element;ov(o,"display"),oi(o,"aria-hidden"),iE(e,iS(),{name:t,visible:!0})}},l=(e,t)=>{if(a(e)){let o=e.element;od(o,"display","none"),ot(o,"aria-hidden","true"),iE(e,iS(),{name:t,visible:!1})}},s=r(a,!1),c=r(l),d=(e,t)=>{ef(t,t=>c(e,t))},u=e=>d(e,o()),m=r(i);return{uid:e.uid,dom:e.dom,components:t,behaviours:gH(e.slotBehaviours),apis:{getSlotNames:o,getSlot:n,isShowing:s,hideSlot:c,hideAllSlots:u,showSlot:m}}},FY=eP({getSlotNames:(e,t)=>e.getSlotNames(t),getSlot:(e,t,o)=>e.getSlot(t,o),isShowing:(e,t,o)=>e.isShowing(t,o),hideSlot:(e,t,o)=>e.hideSlot(t,o),hideAllSlots:(e,t)=>e.hideAllSlots(t),showSlot:(e,t,o)=>e.showSlot(t,o)},e=>lb(e)),FJ={...FY,sketch:FX},FZ=rM([wt,wo,af("onShow",y),af("onHide",y),x8]),FQ=e=>rK("sidebar",FZ,e),F0=e=>{let{sidebars:t}=e.ui.registry.getAll();ef(eH(t),o=>{let n=t[o],r=()=>eQ(ea.from(e.queryCommandValue("ToggleSidebar")),o);e.ui.registry.addToggleButton(o,{icon:n.icon,tooltip:n.tooltip,onAction:t=>{e.execCommand("ToggleSidebar",!1,o),t.setActive(r())},onSetup:t=>{t.setActive(r());let o=()=>t.setActive(r());return e.on("ToggleSidebar",o),()=>{e.off("ToggleSidebar",o)}}})})},F1=e=>({element:()=>e.element.dom}),F2=(e,t)=>{let o=eh(eH(t),e=>{let o=t[e],n=rY(FQ(o));return{name:e,getApi:F1,onSetup:n.onSetup,onShow:n.onShow,onHide:n.onHide}});return eh(o,t=>{let n=ay(y);return e.slot(t.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:w6.unnamedEvents([SS(t,n),Sk(t,n),iV(iS(),(e,t)=>{let n=t.event,r=ek(o,e=>e.name===n.name);r.each(t=>{let o=n.visible?t.onShow:t.onHide;o(t.getApi(e))})})])})})},F3=e=>FJ.sketch(t=>({dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:F2(t,e),slotBehaviours:w6.unnamedEvents([i$(e=>FJ.hideAllSlots(e))])})),F5=(e,t,o)=>{let n=pj.getCurrent(e);n.each(e=>{bR.set(e,[F3(t)]);let n=null==o?void 0:o.toLowerCase();l(n)&&eJ(t,n)&&pj.getCurrent(e).each(t=>{FJ.showSlot(t,n),Fj.immediateGrow(e),ov(e.element,"width")})})},F9=(e,t)=>{let o=pj.getCurrent(e);o.each(e=>{let o=pj.getCurrent(e);o.each(o=>{Fj.hasGrown(e)?FJ.isShowing(o,t)?Fj.shrink(e):(FJ.hideAllSlots(o),FJ.showSlot(o,t)):(FJ.hideAllSlots(o),FJ.showSlot(o,t),Fj.grow(e))})})},F4=e=>{let t=pj.getCurrent(e);return t.bind(e=>{let t=Fj.isGrowing(e)||Fj.hasGrown(e);if(!t)return ea.none();{let t=pj.getCurrent(e);return t.bind(e=>ek(FJ.getSlotNames(e),t=>FJ.isShowing(e,t)))}})},F6=i8("FixSizeEvent"),F8=i8("AutoSizeEvent"),F7=e=>({uid:e.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"complementary"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:cY([OD.config({}),b$.config({}),Fj.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:e=>{let t=pj.getCurrent(e);t.each(FJ.hideAllSlots),iT(e,F8)},onGrown:e=>{iT(e,F8)},onStartGrow:e=>{iE(e,F6,{width:oh(e.element,"width").getOr("")})},onStartShrink:e=>{iE(e,F6,{width:oB(e.element)+"px"})}}),bR.config({}),pj.config({find:e=>{let t=bR.contents(e);return eI(t)}})])}],behaviours:cY([ES.childAt(0),bV("sidebar-sliding-events",[iV(F6,(e,t)=>{od(e.element,"width",t.event.width)}),iV(F8,(e,t)=>{ov(e.element,"width")})])])}),Ie=(e,t,o,n)=>{ot(e.element,"aria-busy",!0);let r=t.getRoot(e).getOr(e),a=cY([bw.config({mode:"special",onTab:()=>ea.some(!0),onShiftTab:()=>ea.some(!0)}),b$.config({})]),i=n(r,a),l=r.getSystem().build(i);bR.append(r,lp(l)),l.hasConfigured(bw)&&t.focus&&bw.focusIn(l),o.isBlocked()||t.onBlock(e),o.blockWith(()=>bR.remove(r,l))},It=(e,t,o)=>{oi(e.element,"aria-busy"),o.isBlocked()&&t.onUnblock(e),o.clear()};var Io=Object.freeze({__proto__:null,block:Ie,unblock:It}),In=[af("getRoot",ea.none),ah("focus",!0),s1("onBlock"),s1("onUnblock")];let Ir=()=>{let e=dT(),t=t=>{e.set({destroy:t})};return ly({readState:e.isSet,blockWith:t,clear:e.clear,isBlocked:e.isSet})};var Ia=Object.freeze({__proto__:null,init:Ir});let Ii=cZ({fields:In,name:"blocking",apis:Io,state:Ia}),Il=e=>{let t=void 0!==e.dom.attributes?e.dom.attributes:[];return ew(t,(e,t)=>"class"===t.name?e:{...e,[t.name]:t.value},{})},Is=e=>Array.prototype.slice.call(e.dom.classList,0),Ic=e=>{let t=tp.fromHtml(e),o=t$(t),n=Il(t),r=Is(t),a=0===o.length?{}:{innerHtml:iJ(t)};return{tag:tk(t),classes:r,attributes:n,...a}},Id=e=>(t,o)=>({dom:{tag:"div",attributes:{"aria-label":e.translate("Loading..."),tabindex:"0"},classes:["tox-throbber__busy-spinner"]},components:[{dom:Ic('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}),Iu=e=>pj.getCurrent(e).each(e=>c9(e.element)),Im=(e,t)=>{let o="tabindex",n=`data-mce-${o}`;ea.from(e.iframeElement).map(tp.fromDom).each(e=>{t?(or(e,o).each(t=>ot(e,n,t)),ot(e,o,-1)):(oi(e,o),or(e,n).each(t=>{ot(e,o,t),oi(e,n)}))})},Ig=(e,t,o,n)=>{let r=t.element;if(Im(e,o),o)Ii.block(t,Id(n)),ov(r,"display"),oi(r,"aria-hidden"),e.hasFocus()&&Iu(t);else{let o=pj.getCurrent(t).exists(e=>c6(e.element));Ii.unblock(t),od(r,"display","none"),ot(r,"aria-hidden","true"),o&&e.focus()}},Ip=e=>({uid:e.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:cY([bR.config({}),Ii.config({focus:!1}),pj.config({find:e=>eI(e.components())})]),components:[]}),Ih=e=>"focusin"===e.type,If=e=>{if(!Ih(e))return!1;{let t=e.composed?eI(e.composedPath()):ea.from(e.target);return t.map(tp.fromDom).filter(tT).exists(e=>l2(e,"mce-pastebin"))}},Ib=(e,t,o)=>{let n=ay(!1),r=dD(),a=o=>{n.get()&&!If(o)&&(o.preventDefault(),Iu(t()),e.editorManager.setActive(e))};e.inline||e.on("PreInit",()=>{e.dom.bind(e.getWin(),"focusin",a),e.on("BeforeExecCommand",e=>{"mcefocus"===e.command.toLowerCase()&&!0!==e.value&&a(e)})});let i=r=>{r!==n.get()&&(n.set(r),Ig(e,t(),r,o.providers),kf(e,r))};e.on("ProgressState",t=>{if(r.on(clearTimeout),b(t.time)){let o=vK.setEditorTimeout(e,()=>i(t.state),t.time);r.set(o)}else i(t.state),r.clear()})},Iv=(e,t)=>{let o=ew(e,(e,o)=>{let n=t(o,e.len);return n.fold(k(e),t=>({len:t.finish,list:e.list.concat([t])}))},{len:0,list:[]});return o.list},Iy=(e,t,o)=>({within:e,extra:t,withinWidth:o}),Ix=(e,t,o)=>{let n=Iv(e,(e,t)=>{let n=o(e);return ea.some({element:e,start:t,finish:t+n,width:n})}),r=ey(n,e=>e.finish<=t),a=ex(r,(e,t)=>e+t.width,0),i=n.slice(r.length);return{within:r,extra:i,withinWidth:a}},Iw=e=>eh(e,e=>e.element),IS=(e,t,o)=>{let n=Iw(e.concat(t));return Iy(n,[],o)},Ik=(e,t,o,n)=>{let r=Iw(e).concat([o]);return Iy(r,Iw(t),n)},IC=(e,t,o)=>Iy(Iw(e),[],o),IO=(e,t,o)=>{let n=Ix(t,e,o);return 0===n.extra.length?ea.some(n):ea.none()},I_=(e,t,o,n)=>{let r=IO(e,t,o).getOrThunk(()=>Ix(t,e-o(n),o)),a=r.within,i=r.extra,l=r.withinWidth;return 1===i.length&&i[0].width<=o(n)?IS(a,i,l):i.length>=1?Ik(a,i,n,l):IC(a,i,l)},IT=(e,t)=>{let o=eh(t,e=>lp(e));Bb.setGroups(e,o)},IE=e=>eV(e,e=>c7(e.element).bind(t=>e.getSystem().getByDom(t).toOptional())),ID=(e,t,o)=>{let n=t.builtGroups.get();if(0===n.length)return;let r=pw(e,t,"primary"),a=Cb.getCoupled(e,"overflowGroup");od(r.element,"visibility","hidden");let i=n.concat([a]),l=IE(i);o([]),IT(r,i);let s=oB(r.element),c=I_(s,t.builtGroups.get(),e=>oB(e.element),a);0===c.extra.length?(bR.remove(r,a),o([])):(IT(r,c.within),o(c.extra)),ov(r.element,"visibility"),oy(r.element),l.each(b$.focus)},IA=k([gV("splitToolbarBehaviours",[Cb]),n4("builtGroups",()=>ay([]))]),IM=k([sQ(["overflowToggledClass"]),ai("getOverflowBounds"),r1("lazySink"),n4("overflowGroups",()=>ay([])),s1("onOpened"),s1("onClosed")].concat(IA())),IB=k([pa({factory:Bb,schema:Bg(),name:"primary"}),pi({schema:Bg(),name:"overflow"}),pi({name:"overflow-button"}),pi({name:"overflow-group"})]),IF=k((e,t)=>{oI(e,Math.floor(t))}),II=k([sQ(["toggledClass"]),r1("lazySink"),r4("fetch"),ai("getBounds"),as("fireDismissalEventInstead",[ad("event",iy())]),d6(),s1("onToggled")]),IR=k([pi({name:"button",overrides:e=>({dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:cY([ve.config({toggleClass:e.markers.toggledClass,aria:{mode:"expanded"},toggleOnExecute:!1,onToggled:e.onToggled})])})}),pi({factory:Bb,schema:Bg(),name:"toolbar",overrides:e=>({toolbarBehaviours:cY([bw.config({mode:"cyclic",onEscape:t=>(px(t,e,"button").each(b$.focus),ea.none())})])})})]),IN=(e,t)=>{let o=Cb.getCoupled(e,"toolbarSandbox");go.isOpen(o)?go.close(o):go.open(o,t.toolbar())},IV=(e,t,o,n)=>{let r=o.getBounds.map(e=>e()),a=o.lazySink(e).getOrDie();mE.positionWithinBounds(a,t,{anchor:{type:"hotspot",hotspot:e,layouts:n,overrides:{maxWidthFunction:IF()}}},r)},IH=(e,t,o,n,r)=>{Bb.setGroups(t,r),IV(e,t,o,n),ve.on(e)},Iz=(e,t,o)=>{let n=sV(),r=(r,a)=>{o.fetch().get(r=>{IH(e,a,o,t.layouts,r),n.link(e.element),bw.focusIn(a)})},a=()=>{ve.off(e),b$.focus(e),n.unlink(e.element)};return{dom:{tag:"div",attributes:{id:n.id}},behaviours:cY([bw.config({mode:"special",onEscape:e=>(go.close(e),ea.some(!0))}),go.config({onOpen:r,onClose:a,isPartOf:(t,o,n)=>sz(o,n)||sz(e,n),getAttachPoint:()=>o.lazySink(e).getOrDie()}),c2.config({channels:{...gl({isExtraPart:A,...o.fireDismissalEventInstead.map(e=>({fireEventInstead:{event:e.event}})).getOr({})}),...gc({doReposition:()=>{go.getState(Cb.getCoupled(e,"toolbarSandbox")).each(n=>{IV(e,n,o,t.layouts)})}})}})])}},IL=(e,t,o,n)=>({...vJ.sketch({...n.button(),action:e=>{IN(e,n)},buttonBehaviours:gL.augment({dump:n.button().buttonBehaviours},[Cb.config({others:{toolbarSandbox:t=>Iz(t,o,e)}})])}),apis:{setGroups:(t,n)=>{go.getState(Cb.getCoupled(t,"toolbarSandbox")).each(r=>{IH(t,r,e,o.layouts,n)})},reposition:t=>{go.getState(Cb.getCoupled(t,"toolbarSandbox")).each(n=>{IV(t,n,e,o.layouts)})},toggle:e=>{IN(e,n)},getToolbar:e=>go.getState(Cb.getCoupled(e,"toolbarSandbox")),isOpen:e=>go.isOpen(Cb.getCoupled(e,"toolbarSandbox"))}}),IP=pz({name:"FloatingToolbarButton",factory:IL,configFields:II(),partFields:IR(),apis:{setGroups:(e,t,o)=>{e.setGroups(t,o)},reposition:(e,t)=>{e.reposition(t)},toggle:(e,t)=>{e.toggle(t)},getToolbar:(e,t)=>e.getToolbar(t),isOpen:(e,t)=>e.isOpen(t)}}),IU=k([r1("items"),sQ(["itemSelector"]),gV("tgroupBehaviours",[bw])]),IW=k([ps({name:"items",unit:"item"})]),Ij=(e,t,o,n)=>({uid:e.uid,dom:e.dom,components:t,behaviours:gz(e.tgroupBehaviours,[bw.config({mode:"flow",selector:e.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}),IG=pz({name:"ToolbarGroup",configFields:IU(),partFields:IW(),factory:Ij}),I$=e=>eh(e,e=>lp(e)),Iq=(e,t,o)=>{ID(e,o,n=>{o.overflowGroups.set(n),t.getOpt(e).each(e=>{IP.setGroups(e,I$(n))})})},IX=(e,t,o,n)=>{let r=vZ(IP.sketch({fetch:()=>CO.nu(t=>{t(I$(e.overflowGroups.get()))}),layouts:{onLtr:()=>[c_,cO],onRtl:()=>[cO,c_],onBottomLtr:()=>[cE,cT],onBottomRtl:()=>[cT,cE]},getBounds:o.getOverflowBounds,lazySink:e.lazySink,fireDismissalEventInstead:{},markers:{toggledClass:e.markers.overflowToggledClass},parts:{button:n["overflow-button"](),toolbar:n.overflow()},onToggled:(t,o)=>e[o?"onOpened":"onClosed"](t)}));return{uid:e.uid,dom:e.dom,components:t,behaviours:gz(e.splitToolbarBehaviours,[Cb.config({others:{overflowGroup:()=>IG.sketch({...n["overflow-group"](),items:[r.asSpec()]})}})]),apis:{setGroups:(t,o)=>{e.builtGroups.set(eh(o,t.getSystem().build)),Iq(t,r,e)},refresh:t=>Iq(t,r,e),toggle:e=>{r.getOpt(e).each(e=>{IP.toggle(e)})},isOpen:e=>r.getOpt(e).map(IP.isOpen).getOr(!1),reposition:e=>{r.getOpt(e).each(e=>{IP.reposition(e)})},getOverflow:e=>r.getOpt(e).bind(IP.getToolbar)},domModification:{attributes:{role:"group"}}}},IK=pz({name:"SplitFloatingToolbar",configFields:IM(),partFields:IB(),factory:IX,apis:{setGroups:(e,t,o)=>{e.setGroups(t,o)},refresh:(e,t)=>{e.refresh(t)},reposition:(e,t)=>{e.reposition(t)},toggle:(e,t)=>{e.toggle(t)},isOpen:(e,t)=>e.isOpen(t),getOverflow:(e,t)=>e.getOverflow(t)}}),IY=k([sQ(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),s1("onOpened"),s1("onClosed")].concat(IA())),IJ=k([pa({factory:Bb,schema:Bg(),name:"primary"}),pa({factory:Bb,schema:Bg(),name:"overflow",overrides:e=>({toolbarBehaviours:cY([Fj.config({dimension:{property:"height"},closedClass:e.markers.closedClass,openClass:e.markers.openClass,shrinkingClass:e.markers.shrinkingClass,growingClass:e.markers.growingClass,onShrunk:t=>{px(t,e,"overflow-button").each(e=>{ve.off(e),b$.focus(e)}),e.onClosed(t)},onGrown:t=>{bw.focusIn(t),e.onOpened(t)},onStartGrow:t=>{px(t,e,"overflow-button").each(ve.on)}}),bw.config({mode:"acyclic",onEscape:t=>(px(t,e,"overflow-button").each(b$.focus),ea.some(!0))})])})}),pi({name:"overflow-button",overrides:e=>({buttonBehaviours:cY([ve.config({toggleClass:e.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])})}),pi({name:"overflow-group"})]),IZ=(e,t)=>px(e,t,"overflow").map(Fj.hasGrown).getOr(!1),IQ=(e,t)=>{px(e,t,"overflow-button").bind(()=>px(e,t,"overflow")).each(o=>{I0(e,t),Fj.toggleGrow(o)})},I0=(e,t)=>{px(e,t,"overflow").each(o=>{ID(e,t,e=>{let t=eh(e,e=>lp(e));Bb.setGroups(o,t)}),px(e,t,"overflow-button").each(e=>{Fj.hasGrown(o)&&ve.on(e)}),Fj.refresh(o)})},I1=(e,t,o,n)=>{let r="alloy.toolbar.toggle",a=(t,o)=>{let n=eh(o,t.getSystem().build);e.builtGroups.set(n)};return{uid:e.uid,dom:e.dom,components:t,behaviours:gz(e.splitToolbarBehaviours,[Cb.config({others:{overflowGroup:e=>IG.sketch({...n["overflow-group"](),items:[vJ.sketch({...n["overflow-button"](),action:t=>{iT(e,r)}})]})}}),bV("toolbar-toggle-events",[iV(r,t=>{IQ(t,e)})])]),apis:{setGroups:(t,o)=>{a(t,o),I0(t,e)},refresh:t=>I0(t,e),toggle:t=>IQ(t,e),isOpen:t=>IZ(t,e)},domModification:{attributes:{role:"group"}}}},I2=pz({name:"SplitSlidingToolbar",configFields:IY(),partFields:IJ(),factory:I1,apis:{setGroups:(e,t,o)=>{e.setGroups(t,o)},refresh:(e,t)=>{e.refresh(t)},toggle:(e,t)=>{e.toggle(t)},isOpen:(e,t)=>e.isOpen(t)}}),I3=e=>{let t=e.title.fold(()=>({}),e=>({attributes:{title:e}}));return{dom:{tag:"div",classes:["tox-toolbar__group"],...t},components:[IG.parts.items({})],items:e.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled])"},tgroupBehaviours:cY([OD.config({}),b$.config({})])}},I5=e=>IG.sketch(I3(e)),I9=(e,t)=>{let o=i$(t=>{let o=eh(e.initGroups,I5);Bb.setGroups(t,o)});return cY([Sx.toolbarButton(e.providers.isDisabled),Sh(),bw.config({mode:t,onEscape:e.onEscape,selector:".tox-toolbar__group"}),bV("toolbar-events",[o])])},I4=e=>{let t=e.cyclicKeying?"cyclic":"acyclic";return{uid:e.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":I3({title:ea.none(),items:[]}),"overflow-button":Al({name:"more",icon:ea.some("more-drawer"),enabled:!0,tooltip:ea.some("More..."),primary:!1,buttonType:ea.none(),borderless:!1},ea.none(),e.providers)},splitToolbarBehaviours:I9(e,t)}},I6=e=>{let t=I4(e),o=IK.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}});return IK.sketch({...t,lazySink:e.getSink,getOverflowBounds:()=>{let t=e.moreDrawerData.lazyHeader().element,o=nU(t),n=tL(t),r=nU(n),a=Math.max(n.dom.scrollHeight,r.height);return nL(o.x+4,r.y,o.width-8,a)},parts:{...t.parts,overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:e.attributes}}},components:[o],markers:{overflowToggledClass:"tox-tbtn--enabled"},onOpened:t=>e.onToggled(t,!0),onClosed:t=>e.onToggled(t,!1)})},I8=e=>{let t=I2.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),o=I2.parts.overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),n=I4(e);return I2.sketch({...n,components:[t,o],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:t=>{t.getSystem().broadcastOn([BQ()],{type:"opened"}),e.onToggled(t,!0)},onClosed:t=>{t.getSystem().broadcastOn([BQ()],{type:"closed"}),e.onToggled(t,!1)}})},I7=e=>{let t=e.cyclicKeying?"cyclic":"acyclic";return Bb.sketch({uid:e.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(e.type===Z.scrolling?["tox-toolbar--scrolling"]:[])},components:[Bb.parts.groups({})],toolbarBehaviours:I9(e,t)})},Re=[r9("type",["button"]),x0,ap("buttonType","secondary",["primary","secondary"]),r4("onAction")],Rt=rQ("type",{button:Re}),Ro=rM([ab("buttons",[],Rt),r4("onShow"),r4("onHide")]),Rn=e=>rK("view",Ro,e),Rr=(e,t)=>Ad({text:e.text,enabled:!0,primary:!1,name:"name",icon:ea.none(),borderless:!1,buttonType:ea.some(e.buttonType)},t=>{e.onAction()},t),Ra=e=>{let t=eh(e.buttons,t=>Rr(t,e.providers));return{uid:e.uid,dom:{tag:"div",classes:["tox-view__header"]},components:[Oy.sketch({dom:{tag:"div",classes:["tox-view__header-start"]},components:[]}),Oy.sketch({dom:{tag:"div",classes:["tox-view__header-end"]},components:t})]}},Ri=e=>({uid:e.uid,dom:{tag:"div",classes:["tox-view__pane"]}}),Rl=(e,t,o,n)=>({uid:e.uid,dom:e.dom,components:t,apis:{getPane:t=>pE.getPart(t,e,"pane"),getOnShow:t=>e.viewConfig.onShow,getOnHide:t=>e.viewConfig.onHide}});var Rs=pz({name:"silver.View",configFields:[r1("viewConfig")],partFields:[pl({factory:{sketch:Ra},schema:[r1("buttons"),r1("providers")],name:"header"}),pl({factory:{sketch:Ri},schema:[],name:"pane"})],factory:Rl,apis:{getPane:(e,t)=>e.getPane(t),getOnShow:(e,t)=>e.getOnShow(t),getOnHide:(e,t)=>e.getOnHide(t)}});let Rc=(e,t,o)=>eq(t,(t,n)=>{let r=rY(Rn(t));return e.slot(n,Rs.sketch({dom:{tag:"div",classes:["tox-view"]},viewConfig:r,components:[...r.buttons.length>0?[Rs.parts.header({buttons:r.buttons,providers:o})]:[],Rs.parts.pane({})]}))}),Rd=(e,t)=>FJ.sketch(o=>({dom:{tag:"div",classes:["tox-view-wrap__slot-container"]},components:Rc(o,e,t),slotBehaviours:w6.unnamedEvents([i$(e=>FJ.hideAllSlots(e))])})),Ru=e=>ek(FJ.getSlotNames(e),t=>FJ.isShowing(e,t)),Rm=e=>{let t=e.element;od(t,"display","none"),ot(t,"aria-hidden","true")},Rg=e=>{let t=e.element;ov(t,"display"),oi(t,"aria-hidden")},Rp=e=>({getContainer:k(e)}),Rh=(e,t,o)=>{FJ.getSlot(e,t).each(e=>{Rs.getPane(e).each(t=>{let n=o(e);n(Rp(t.element.dom))})})},Rf=(e,t)=>Rh(e,t,Rs.getOnShow),Rb=(e,t)=>Rh(e,t,Rs.getOnHide),Rv=(e,t)=>{let o=(e,o)=>{bR.set(e,[Rd(o,t.backstage.shared.providers)])},n=e=>pj.getCurrent(e).bind(Ru),r=(e,t,o,n)=>pj.getCurrent(e).exists(r=>{let a=Ru(r),i=a.exists(e=>n===e),l=FJ.getSlot(r,n).isSome();return l&&(FJ.hideAllSlots(r),i?(Rm(e),t()):(o(),Rg(e),FJ.showSlot(r,n),Rf(r,n)),a.each(e=>Rb(r,e))),l});return{uid:e.uid,dom:{tag:"div",classes:["tox-view-wrap"],attributes:{"aria-hidden":"true"},styles:{display:"none"}},components:[],behaviours:cY([bR.config({}),pj.config({find:e=>{let t=bR.contents(e);return eI(t)}})]),apis:{setViews:o,whichView:n,toggleView:r}}};var Ry=pH({factory:Rv,name:"silver.ViewWrapper",configFields:[r1("backstage")],apis:{setViews:(e,t,o)=>e.setViews(t,o),toggleView:(e,t,o,n,r)=>e.toggleView(t,o,n,r),whichView:(e,t)=>e.whichView(t)}});let Rx=(e,t,o)=>{let n=!1,r={getSocket:t=>pE.getPart(t,e,"socket"),setSidebar:(t,o,n)=>{pE.getPart(t,e,"sidebar").each(e=>F5(e,o,n))},toggleSidebar:(t,o)=>{pE.getPart(t,e,"sidebar").each(e=>F9(e,o))},whichSidebar:t=>pE.getPart(t,e,"sidebar").bind(F4).getOrNull(),getHeader:t=>pE.getPart(t,e,"header"),getToolbar:t=>pE.getPart(t,e,"toolbar"),setToolbar:(t,o)=>{pE.getPart(t,e,"toolbar").each(e=>{let t=eh(o,I5);e.getApis().setGroups(e,t)})},setToolbars:(t,o)=>{pE.getPart(t,e,"multiple-toolbar").each(e=>{let t=eh(o,e=>eh(e,I5));Bm.setItems(e,t)})},refreshToolbar:t=>{let o=pE.getPart(t,e,"toolbar");o.each(e=>e.getApis().refresh(e))},toggleToolbarDrawer:t=>{pE.getPart(t,e,"toolbar").each(e=>{e9(e.getApis().toggle,t=>t(e))})},isToolbarDrawerToggled:t=>pE.getPart(t,e,"toolbar").bind(e=>ea.from(e.getApis().isOpen).map(t=>t(e))).getOr(!1),getThrobber:t=>pE.getPart(t,e,"throbber"),focusToolbar:t=>{let o=pE.getPart(t,e,"toolbar").orThunk(()=>pE.getPart(t,e,"multiple-toolbar"));o.each(e=>{bw.focusIn(e)})},setMenubar:(t,o)=>{pE.getPart(t,e,"menubar").each(e=>{Fp.setMenus(e,o)})},focusMenubar:t=>{pE.getPart(t,e,"menubar").each(e=>{Fp.focus(e)})},setViews:(t,o)=>{pE.getPart(t,e,"viewWrapper").each(e=>{Ry.setViews(e,o)})},toggleView:(t,o)=>pE.getPart(t,e,"viewWrapper").exists(e=>Ry.toggleView(e,()=>r.showMainView(t),()=>r.hideMainView(t),o)),whichView:t=>pE.getPart(t,e,"viewWrapper").bind(Ry.whichView).getOrNull(),hideMainView:t=>{(n=r.isToolbarDrawerToggled(t))&&r.toggleToolbarDrawer(t),pE.getPart(t,e,"editorContainer").each(e=>{let t=e.element;od(t,"display","none"),ot(t,"aria-hidden","true")})},showMainView:t=>{n&&r.toggleToolbarDrawer(t),pE.getPart(t,e,"editorContainer").each(e=>{let t=e.element;ov(t,"display"),oi(t,"aria-hidden")})}};return{uid:e.uid,dom:e.dom,components:t,apis:r,behaviours:e.behaviours}},Rw=pd.optional({factory:Fp,name:"menubar",schema:[r1("backstage")]}),RS=e=>e.type===Z.sliding?I8:e.type===Z.floating?I6:I7,Rk=pd.optional({factory:{sketch:e=>Bm.sketch({uid:e.uid,dom:e.dom,listBehaviours:cY([bw.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:()=>I7({type:e.type,uid:i8("multiple-toolbar-item"),cyclicKeying:!1,initGroups:[],providers:e.providers,onEscape:()=>(e.onEscape(),ea.some(!0))}),setupItem:(e,t,o,n)=>{Bb.setGroups(t,o)},shell:!0})},name:"multiple-toolbar",schema:[r1("dom"),r1("onEscape")]}),RC=pd.optional({factory:{sketch:e=>{let t=RS(e),o={type:e.type,uid:e.uid,onEscape:()=>(e.onEscape(),ea.some(!0)),onToggled:(t,o)=>e.onToolbarToggled(o),cyclicKeying:!1,initGroups:[],getSink:e.getSink,providers:e.providers,moreDrawerData:{lazyToolbar:e.lazyToolbar,lazyMoreButton:e.lazyMoreButton,lazyHeader:e.lazyHeader},attributes:e.attributes};return t(o)}},name:"toolbar",schema:[r1("dom"),r1("onEscape"),r1("getSink")]}),RO=pd.optional({factory:{sketch:Fa},name:"header",schema:[r1("dom")]}),R_=pd.optional({factory:{sketch:Fh},name:"promotion",schema:[r1("dom")]}),RT=pd.optional({name:"socket",schema:[r1("dom")]}),RE=pd.optional({factory:{sketch:F7},name:"sidebar",schema:[r1("dom")]}),RD=pd.optional({factory:{sketch:Ip},name:"throbber",schema:[r1("dom")]}),RA=pd.optional({factory:Ry,name:"viewWrapper",schema:[r1("backstage")]}),RM=e=>({uid:e.uid,dom:{tag:"div",classes:["tox-editor-container"]},components:e.components}),RB=pd.optional({factory:{sketch:RM},name:"editorContainer",schema:[]});var RF=pz({name:"OuterContainer",factory:Rx,configFields:[r1("dom"),r1("behaviours")],partFields:[RO,Rw,RC,Rk,RT,RE,R_,RD,RA,RB],apis:{getSocket:(e,t)=>e.getSocket(t),setSidebar:(e,t,o,n)=>{e.setSidebar(t,o,n)},toggleSidebar:(e,t,o)=>{e.toggleSidebar(t,o)},whichSidebar:(e,t)=>e.whichSidebar(t),getHeader:(e,t)=>e.getHeader(t),getToolbar:(e,t)=>e.getToolbar(t),setToolbar:(e,t,o)=>{e.setToolbar(t,o)},setToolbars:(e,t,o)=>{e.setToolbars(t,o)},refreshToolbar:(e,t)=>e.refreshToolbar(t),toggleToolbarDrawer:(e,t)=>{e.toggleToolbarDrawer(t)},isToolbarDrawerToggled:(e,t)=>e.isToolbarDrawerToggled(t),getThrobber:(e,t)=>e.getThrobber(t),setMenubar:(e,t,o)=>{e.setMenubar(t,o)},focusMenubar:(e,t)=>{e.focusMenubar(t)},focusToolbar:(e,t)=>{e.focusToolbar(t)},setViews:(e,t,o)=>{e.setViews(t,o)},toggleView:(e,t,o)=>e.toggleView(t,o),whichView:(e,t)=>e.whichView(t)}});let RI={file:{title:"File",items:"newdocument restoredraft | preview | export print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor tableofcontents footnotes | mergetags | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | styles blocks fontfamily fontsize align lineheight | forecolor backcolor | language | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | autocorrect capitalization | a11ycheck code wordcount"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},RR=(e,t,o)=>{let n=yk(o).split(/[ ,]/);return{text:e.title,getItems:()=>e_(e.items,e=>{let o=e.toLowerCase();return 0===o.trim().length||em(n,e=>e===o)?[]:"separator"===o||"|"===o?[{type:"separator"}]:t.menuItems[o]?[t.menuItems[o]]:[]})}},RN=e=>e.split(" "),RV=(e,t)=>{let o={...RI,...t.menus},n=eH(t.menus).length>0,r=void 0===t.menubar||!0===t.menubar?RN("file edit view insert format tools table help"):RN(!1===t.menubar?"":t.menubar),a=ey(r,e=>{let o=eJ(RI,e);return n?o||eY(t.menus,e).exists(e=>eJ(e,"items")):o}),i=eh(a,n=>{let r=o[n];return RR({title:r.title,items:RN(r.items)},t,e)});return ey(i,e=>{let t=e=>l(e)||"separator"!==e.type;return e.getItems().length>0&&em(e.getItems(),t)})},RH=e=>{let t=()=>{e._skinLoaded=!0,kd(e)};return()=>{e.initialized?t():e.on("init",t)}},Rz=(e,t)=>()=>ku(e,{message:t}),RL=(e,t,o)=>(e.on("remove",()=>o.unload(t)),o.load(t)),RP=(e,t)=>RL(e,t+"/skin.min.css",e.ui.styleSheetLoader),RU=(e,t)=>{let o=t2(tp.fromDom(e.getElement()));return o?RL(e,t+"/skin.shadowdom.min.css",yi.DOM.styleSheetLoader):Promise.resolve()},RW=(e,t)=>{let o=yK(t);o&&t.contentCSS.push(o+(e?"/content.inline":"/content")+".min.css"),!yq(t)&&l(o)?Promise.all([RP(t,o),RU(t,o)]).then(RH(t),Rz(t,"Skin could not be loaded")):RH(t)()},Rj=_(RW,!1),RG=_(RW,!0),R$=(e,t)=>o=>{let n=dE(),r=()=>{o.setActive(e.formatter.match(t));let r=e.formatter.formatChanged(t,o.setActive);n.set(r)};return e.initialized?r():e.once("init",r),()=>{e.off("init",r),n.clear()}},Rq=(e,t,o)=>n=>{let r=()=>o(n),a=()=>{o(n),e.on(t,r)};return e.initialized?a():e.once("init",a),()=>{e.off("init",a),e.off(t,r)}},RX=e=>t=>()=>{e.undoManager.transact(()=>{e.focus(),e.execCommand("mceToggleFormat",!1,t.format)})},RK=(e,t)=>()=>e.execCommand(t),RY=(e,t,o)=>{let n=(e,n,a,i)=>{let l=t.shared.providers.translate(e.title);if("separator"===e.type)return ea.some({type:"separator",text:l});if("submenu"!==e.type)return ea.some({type:"togglemenuitem",text:l,icon:e.icon,active:e.isSelected(i),enabled:!a,onAction:o.onAction(e),...e.getStylePreview().fold(()=>({}),e=>({meta:{style:e}}))});{let t=e_(e.getStyleItems(),e=>r(e,n,i));return 0===n&&t.length<=0?ea.none():ea.some({type:"nestedmenuitem",text:l,enabled:t.length>0,getSubmenuItems:()=>e_(e.getStyleItems(),e=>r(e,n,i))})}},r=(e,t,r)=>{let a="formatter"===e.type&&o.isInvalid(e);return 0===t?a?[]:n(e,t,!1,r).toArray():n(e,t,a,r).toArray()},a=e=>{let t=o.getCurrentValue(),n=o.shouldHide?0:1;return e_(e,e=>r(e,n,t))},i=(e,t)=>(o,n)=>{let r=t(),i=a(r),l=Du(i,xn.CLOSE_ON_EXECUTE,e,{isHorizontalMenu:!1,search:ea.none()});n(l)};return{validateItems:a,getFetch:i}},RJ=(e,t,o)=>{let n=o.dataset,r="basic"===n.type?()=>eh(n.data,e=>Mk(e,o.isSelectedFor,o.getPreviewFor)):n.getData;return{items:RY(e,t,o),getStyleItems:r}},RZ=(e,t,o)=>{let{items:n,getStyleItems:r}=RJ(e,t,o),a=e=>({getComponent:k(e)}),i=Rq(e,"NodeChange",e=>{let t=e.getComponent();o.updateText(t)});return De({text:o.icon.isSome()?ea.none():o.text,icon:o.icon,tooltip:ea.from(o.tooltip),role:ea.none(),fetch:n.getFetch(t,r),onSetup:i,getApi:a,columns:1,presets:"normal",classes:o.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",t.shared)},RQ=e=>eh(e,e=>{let t=e,o=e,n=e.split("=");return n.length>1&&(t=n[0],o=n[1]),{title:t,format:o}}),R0=e=>({type:"basic",data:e});(G=eo||(eo={}))[G.SemiColon=0]="SemiColon",G[G.Space=1]="Space";let R1=(e,t)=>t===eo.SemiColon?e.replace(/;$/,"").split(";"):e.split(" "),R2=(e,t,o)=>{let n=e.options.get(t),r=RQ(R1(n,o));return{type:"basic",data:r}},R3=[{title:"Left",icon:"align-left",format:"alignleft",command:"JustifyLeft"},{title:"Center",icon:"align-center",format:"aligncenter",command:"JustifyCenter"},{title:"Right",icon:"align-right",format:"alignright",command:"JustifyRight"},{title:"Justify",icon:"align-justify",format:"alignjustify",command:"JustifyFull"}],R5=e=>{let t=()=>ek(R3,t=>e.formatter.match(t.format)),o=t=>()=>e.formatter.match(t),n=e=>{let o=t(),n=o.fold(k("left"),e=>e.title.toLowerCase());iE(e,E7,{icon:`align-${n}`})},r=R0(R3),a=t=>()=>ek(R3,e=>e.format===t.format).each(t=>e.execCommand(t.command));return{tooltip:"Align",text:ea.none(),icon:ea.some("align-left"),isSelectedFor:o,getCurrentValue:ea.none,getPreviewFor:e=>ea.none,onAction:a,updateText:n,dataset:r,shouldHide:!1,isInvalid:t=>!e.formatter.canApply(t.format)}},R9=(e,t)=>RZ(e,t,R5(e)),R4=(e,t)=>{let o=RJ(e,t,R5(e));e.ui.registry.addNestedMenuItem("align",{text:t.shared.providers.translate("Align"),getSubmenuItems:()=>o.items.validateItems(o.getStyleItems())})},R6=(e,t)=>{let o=t(),n=eh(o,e=>e.format);return ea.from(e.formatter.closest(n)).bind(e=>ek(o,t=>t.format===e)).orThunk(()=>e4(e.formatter.match("p"),{title:"Paragraph",format:"p"}))},R8=e=>{let t="Paragraph",o=t=>()=>e.formatter.match(t),n=t=>()=>{let o=e.formatter.get(t);return o?ea.some({tag:o.length>0&&(o[0].inline||o[0].block)||"div",styles:e.dom.parseStyle(e.formatter.getCssText(t))}):ea.none()},r=o=>{let n=R6(e,()=>a.data),r=n.fold(k(t),e=>e.title);iE(o,E8,{text:r})},a=R2(e,"block_formats",eo.SemiColon);return{tooltip:"Blocks",text:ea.some(t),icon:ea.none(),isSelectedFor:o,getCurrentValue:ea.none,getPreviewFor:n,onAction:RX(e),updateText:r,dataset:a,shouldHide:!1,isInvalid:t=>!e.formatter.canApply(t.format)}},R7=(e,t)=>RZ(e,t,R8(e)),Ne=(e,t)=>{let o=RJ(e,t,R8(e));e.ui.registry.addNestedMenuItem("blocks",{text:"Blocks",getSubmenuItems:()=>o.items.validateItems(o.getStyleItems())})},Nt=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],No=e=>{let t=e.split(/\s*,\s*/);return eh(t,e=>e.replace(/^['"]+|['"]+$/g,""))},Nn=e=>0===e.indexOf("-apple-system")&&(()=>{let t=No(e.toLowerCase());return eT(Nt,e=>t.indexOf(e.toLowerCase())>-1)})(),Nr=e=>{let t="System Font",o=()=>{let o=e=>e?No(e)[0]:"",n=e.queryCommandValue("FontName"),r=s.data,a=n?n.toLowerCase():"",i=ek(r,e=>{let t=e.format;return t.toLowerCase()===a||o(t).toLowerCase()===o(a).toLowerCase()}).orThunk(()=>e4(Nn(a),{title:t,format:a}));return{matchOpt:i,font:n}},n=e=>t=>t.exists(t=>t.format===e),r=()=>{let{matchOpt:e}=o();return e},a=e=>()=>ea.some({tag:"div",styles:-1===e.indexOf("dings")?{"font-family":e}:{}}),i=t=>()=>{e.undoManager.transact(()=>{e.focus(),e.execCommand("FontName",!1,t.format)})},l=e=>{let{matchOpt:t,font:n}=o(),r=t.fold(k(n),e=>e.title);iE(e,E8,{text:r})},s=R2(e,"font_family_formats",eo.SemiColon);return{tooltip:"Fonts",text:ea.some(t),icon:ea.none(),isSelectedFor:n,getCurrentValue:r,getPreviewFor:a,onAction:i,updateText:l,dataset:s,shouldHide:!1,isInvalid:A}},Na=(e,t)=>RZ(e,t,Nr(e)),Ni=(e,t)=>{let o=RJ(e,t,Nr(e));e.ui.registry.addNestedMenuItem("fontfamily",{text:t.shared.providers.translate("Fonts"),getSubmenuItems:()=>o.items.validateItems(o.getStyleItems())})},Nl={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},Ns={"xx-small":"7pt","x-small":"8pt",small:"10pt",medium:"12pt",large:"14pt","x-large":"18pt","xx-large":"24pt"},Nc=(e,t)=>{let o=Math.pow(10,t);return Math.round(e*o)/o},Nd=(e,t)=>/[0-9.]+px$/.test(e)?Nc(72*parseInt(e,10)/96,t||0)+"pt":eY(Ns,e).getOr(e),Nu=e=>eY(Nl,e).getOr(""),Nm=e=>{let t=()=>{let t=ea.none(),o=l.data,n=e.queryCommandValue("FontSize");if(n)for(let e=3;t.isNone()&&e>=0;e--){let r=Nd(n,e),a=Nu(r);t=ek(o,e=>e.format===n||e.format===r||e.format===a)}return{matchOpt:t,size:n}},o=e=>t=>t.exists(t=>t.format===e),n=()=>{let{matchOpt:e}=t();return e},r=k(ea.none),a=t=>()=>{e.undoManager.transact(()=>{e.focus(),e.execCommand("FontSize",!1,t.format)})},i=e=>{let{matchOpt:o,size:n}=t(),r=o.fold(k(n),e=>e.title);iE(e,E8,{text:r})},l=R2(e,"font_size_formats",eo.Space);return{tooltip:"Font sizes",text:ea.some("12pt"),icon:ea.none(),isSelectedFor:o,getPreviewFor:r,getCurrentValue:n,onAction:a,updateText:i,dataset:l,shouldHide:!1,isInvalid:A}},Ng=(e,t)=>RZ(e,t,Nm(e)),Np=(e,t)=>{let o=RJ(e,t,Nm(e));e.ui.registry.addNestedMenuItem("fontsize",{text:"Font sizes",getSubmenuItems:()=>o.items.validateItems(o.getStyleItems())})},Nh=(e,t)=>{let o="Paragraph",n=t=>()=>e.formatter.match(t),r=t=>()=>{let o=e.formatter.get(t);return void 0!==o?ea.some({tag:o.length>0&&(o[0].inline||o[0].block)||"div",styles:e.dom.parseStyle(e.formatter.getCssText(t))}):ea.none()},a=t=>{let n=e=>Mm(e)?e_(e.items,n):Mg(e)?[{title:e.title,format:e.format}]:[],r=e_(Mw(e),n),a=R6(e,k(r)),i=a.fold(k(o),e=>e.title);iE(t,E8,{text:i})};return{tooltip:"Formats",text:ea.some(o),icon:ea.none(),isSelectedFor:n,getCurrentValue:ea.none,getPreviewFor:r,onAction:RX(e),updateText:a,shouldHide:yw(e),isInvalid:t=>!e.formatter.canApply(t.format),dataset:t}},Nf=(e,t)=>{let o={type:"advanced",...t.styles};return RZ(e,t,Nh(e,o))},Nb=(e,t)=>{let o={type:"advanced",...t.styles},n=RJ(e,t,Nh(e,o));e.ui.registry.addNestedMenuItem("styles",{text:"Formats",getSubmenuItems:()=>n.items.validateItems(n.getStyleItems())})},Nv=(e,t)=>{let o=(o,n)=>{e.updateState.each(e=>{let r=e(o,n);t.set(r)}),e.renderComponents.each(r=>{let a=r(n,t.get()),i=e.reuseDom?bk:bS;i(o,a)})};return iI([iV(ir(),(t,n)=>{if(!n.universal){let r=e.channel;eu(n.channels,r)&&o(t,n.data)}}),i$((t,n)=>{e.initialData.each(e=>{o(t,e)})})])};var Ny=Object.freeze({__proto__:null,events:Nv}),Nx=Object.freeze({__proto__:null,getState:(e,t,o)=>o}),Nw=[r1("channel"),at("renderComponents"),at("updateState"),at("initialData"),ah("reuseDom",!0)];let NS=()=>{let e=ay(ea.none()),t=()=>e.set(ea.none()),o=()=>e.get().getOr("none");return{readState:o,get:e.get,set:e.set,clear:t}};var Nk=Object.freeze({__proto__:null,init:NS});let NC=cZ({fields:Nw,name:"reflecting",active:Ny,apis:Nx,state:Nk}),NO=k([r1("toggleClass"),r1("fetch"),s3("onExecute"),ad("getHotspot",ea.some),ad("getAnchorOverrides",k({})),d6(),s3("onItemExecute"),at("lazySink"),r1("dom"),s1("onOpen"),gV("splitDropdownBehaviours",[Cb,bw,b$]),ad("matchWidth",!1),ad("useMinWidth",!1),ad("eventOrder",{}),at("role")].concat(Cz())),N_=pa({factory:vJ,schema:[r1("dom")],name:"arrow",defaults:()=>({buttonBehaviours:cY([b$.revoke()])}),overrides:e=>({dom:{tag:"span",attributes:{role:"presentation"}},action:t=>{t.getSystem().getByUid(e.uid).each(iD)},buttonBehaviours:cY([ve.config({toggleOnExecute:!1,toggleClass:e.toggleClass})])})}),NT=pa({factory:vJ,schema:[r1("dom")],name:"button",defaults:()=>({buttonBehaviours:cY([b$.revoke()])}),overrides:e=>({dom:{tag:"span",attributes:{role:"presentation"}},action:t=>{t.getSystem().getByUid(e.uid).each(o=>{e.onExecute(o,t)})}})}),NE=k([N_,NT,pl({factory:{sketch:e=>({uid:e.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:e.text}})},schema:[r1("text")],name:"aria-descriptor"}),pi({schema:[sZ()],name:"menu",defaults:e=>({onExecute:(t,o)=>{t.getSystem().getByUid(e.uid).each(n=>{e.onItemExecute(n,t,o)})}})}),CT()]),ND=(e,t,o,n)=>{let r=e=>{pj.getCurrent(e).each(e=>{hy.highlightFirst(e),bw.focusIn(e)})},a=t=>{CF(e,C,t,n,r,J.HighlightMenuAndItem).get(y)},i=e=>(a(e),ea.some(!0)),l=t=>{let o=pw(t,e,"button");return iD(o),ea.some(!0)},s={...iI([i$((t,o)=>{let n=px(t,e,"aria-descriptor");n.each(e=>{let o=i8("aria");ot(e.element,"id",o),ot(t.element,"aria-describedby",o)})})]),...vo(ea.some(a))};return{uid:e.uid,dom:e.dom,components:t,apis:{repositionMenus:e=>{ve.isOn(e)&&CH(e)}},eventOrder:{...e.eventOrder,[ia()]:["disabling","toggling","alloy.base.behaviour"]},events:s,behaviours:gz(e.splitDropdownBehaviours,[Cb.config({others:{sandbox:t=>{let o=pw(t,e,"arrow");return CV(e,t,{onOpen:()=>{ve.on(o),ve.on(t)},onClose:()=>{ve.off(o),ve.off(t)}})}}}),bw.config({mode:"special",onSpace:l,onEnter:l,onDown:i}),b$.config({}),ve.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:e.role.getOr("button"),"aria-haspopup":!0}}}},NA=pz({name:"SplitDropdown",configFields:NO(),partFields:NE(),factory:ND,apis:{repositionMenus:(e,t)=>e.repositionMenus(t)}}),NM=e=>({isEnabled:()=>!p7.isDisabled(e),setEnabled:t=>p7.set(e,!t)}),NB=e=>({setActive:t=>{ve.set(e,t)},isActive:()=>ve.isOn(e),isEnabled:()=>!p7.isDisabled(e),setEnabled:t=>p7.set(e,!t)}),NF=(e,t)=>e.map(e=>({"aria-label":t.translate(e),title:t.translate(e)})).getOr({}),NI=i8("focus-button"),NR=(e,t,o,n,r,a)=>({dom:{tag:"button",classes:["tox-tbtn"].concat(t.isSome()?["tox-tbtn--select"]:[]),attributes:NF(o,a)},components:e1([e.map(e=>E9(e,a.icons)),t.map(e=>E6(e,"tox-tbtn",a))]),eventOrder:{[a$()]:["focusing","alloy.base.behaviour","common-button-display-events"]},buttonBehaviours:cY([Sx.toolbarButton(a.isDisabled),Sh(),bV("common-button-display-events",[iV(a$(),(e,t)=>{t.event.prevent(),iT(e,NI)})])].concat(n.map(o=>NC.config({channel:o,initialData:{icon:e,text:t},renderComponents:(e,t)=>e1([e.icon.map(e=>E9(e,a.icons)),e.text.map(e=>E6(e,"tox-tbtn",a))])})).toArray()).concat(r.getOr([])))}),NN=(e,t,o,n)=>{let r=t.shared;return IP.sketch({lazySink:r.getSink,fetch:()=>CO.nu(t=>{t(eh(o(e.items),I5))}),markers:{toggledClass:"tox-tbtn--enabled"},parts:{button:NR(e.icon,e.text,e.tooltip,ea.none(),ea.none(),r.providers),toolbar:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:n}}}})},NV=(e,t,o)=>{let n=ay(y),r=NR(e.icon,e.text,e.tooltip,ea.none(),ea.none(),o);return vJ.sketch({dom:r.dom,components:r.components,eventOrder:E3,buttonBehaviours:cY([bV("toolbar-button-events",[E2({onAction:e.onAction,getApi:t.getApi}),SS(t,n),Sk(t,n)]),Sx.toolbarButton(()=>!e.enabled||o.isDisabled()),Sh()].concat(t.toolbarButtonBehaviours))})},NH=(e,t)=>Nz(e,t,[]),Nz=(e,t,o)=>NV(e,{toolbarButtonBehaviours:o.length>0?[bV("toolbarButtonWith",o)]:[],getApi:NM,onSetup:e.onSetup},t),NL=(e,t)=>NP(e,t,[]),NP=(e,t,o)=>NV(e,{toolbarButtonBehaviours:[bR.config({}),ve.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(o.length>0?[bV("toolbarToggleButtonWith",o)]:[]),getApi:NB,onSetup:e.onSetup},t),NU=(e,t,o)=>n=>CO.nu(e=>t.fetch(e)).map(r=>ea.from(C2(re(k1(i8("menu-value"),r,o=>{t.onItemAction(e(n),o)},t.columns,t.presets,xn.CLOSE_ON_EXECUTE,t.select.getOr(A),o),{movement:k3(t.columns,t.presets),menuBehaviours:w6.unnamedEvents("auto"!==t.columns?[]:[i$((e,o)=>{w5(e,4,xh(t.presets)).each(({numRows:t,numColumns:o})=>{bw.setGridSize(e,t,o)})})])})))),NW=(e,t)=>{let o=i8("channel-update-split-dropdown-display"),n=e=>({isEnabled:()=>!p7.isDisabled(e),setEnabled:t=>p7.set(e,!t),setIconFill:(t,o)=>{sF(e.element,'svg path[id="'+t+'"], rect[id="'+t+'"]').each(e=>{ot(e,"fill",o)})},setActive:t=>{ot(e.element,"aria-pressed",t),sF(e.element,"span").each(o=>{e.getSystem().getByDom(o).each(e=>ve.set(e,t))})},isActive:()=>sF(e.element,"span").exists(t=>e.getSystem().getByDom(t).exists(ve.isOn))}),r=ay(y),a={getApi:n,onSetup:e.onSetup};return NA.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:{"aria-pressed":!1,...NF(e.tooltip,t.providers)}},onExecute:t=>{e.onAction(n(t))},onItemExecute:(e,t,o)=>{},splitDropdownBehaviours:cY([Sx.splitButton(t.providers.isDisabled),Sh(),bV("split-dropdown-events",[iV(NI,b$.focus),SS(a,r),Sk(a,r)]),O8.config({})]),eventOrder:{[ib()]:["alloy.base.behaviour","split-dropdown-events"]},toggleClass:"tox-tbtn--enabled",lazySink:t.getSink,fetch:NU(n,e,t.providers),parts:{menu:xw(!1,e.columns,e.presets)},components:[NA.parts.button(NR(e.icon,e.text,ea.none(),ea.some(o),ea.some([ve.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),t.providers)),NA.parts.arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:v9("chevron-down",t.providers.icons)},buttonBehaviours:cY([Sx.splitButton(t.providers.isDisabled),Sh(),v8()])}),NA.parts["aria-descriptor"]({text:t.providers.translate("To open the popup, press Shift+Enter")})]})},Nj=[{name:"history",items:["undo","redo"]},{name:"styles",items:["styles"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],NG=(e,t)=>(o,n,r)=>{let a=e(o).mapError(e=>rZ(e)).getOrDie();return t(a,n,r)},N$={button:NG(wS,(e,t)=>NH(e,t.shared.providers)),togglebutton:NG(wO,(e,t)=>NL(e,t.shared.providers)),menubutton:NG(Fd,(e,t)=>Ar(e,"tox-tbtn",t,ea.none())),splitbutton:NG(Fm,(e,t)=>NW(e,t.shared)),grouptoolbarbutton:NG(Fl,(e,t,o)=>{let n=o.ui.registry.getAll().buttons,r=e=>N0(o,{buttons:n,toolbar:e,allowToolbarGroups:!1},t,ea.none()),a={[d9]:t.shared.header.isPositionedAtTop()?K.TopToBottom:K.BottomToTop};if(yC(o)===Z.floating)return NN(e,t,r,a);throw Error("Toolbar groups are only supported when using floating toolbar mode")})},Nq=(e,t,o)=>eY(N$,e.type).fold(()=>(console.error("skipping button defined by",e),ea.none()),n=>ea.some(n(e,t,o))),NX={styles:Nf,fontsize:Ng,fontfamily:Na,blocks:R7,align:R9},NK=e=>{let t=eh(Nj,t=>{let o=ey(t.items,t=>eJ(e,t)||eJ(NX,t));return{name:t.name,items:o}});return ey(t,e=>e.items.length>0)},NY=e=>{let t=e.split("|");return eh(t,e=>({items:e.trim().split(" ")}))},NJ=e=>v(e,e=>eJ(e,"name")&&eJ(e,"items")),NZ=e=>{let t=e.toolbar,o=e.buttons;return!1===t?[]:void 0===t||!0===t?NK(o):l(t)?NY(t):NJ(t)?t:(console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[])},NQ=(e,t,o,n,r,a)=>eY(t,o.toLowerCase()).orThunk(()=>a.bind(e=>eV(e,e=>eY(t,e+o.toLowerCase())))).fold(()=>eY(NX,o.toLowerCase()).map(t=>t(e,r)),t=>"grouptoolbarbutton"!==t.type||n?Nq(t,r,e):(console.warn(`Ignoring the '${o}' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested.`),ea.none())),N0=(e,t,o,n)=>{let r=NZ(t),a=eh(r,r=>{let a=e_(r.items,r=>0===r.trim().length?[]:NQ(e,t.buttons,r,t.allowToolbarGroups,o,n).toArray());return{title:ea.from(e.translate(r.name)),items:a}});return ey(a,e=>e.items.length>0)},N1=(e,t,o,n)=>{let r=t.mainUi.outerContainer,a=o.toolbar,i=o.buttons;if(v(a,l)){let t=a.map(t=>{let r={toolbar:t,buttons:i,allowToolbarGroups:o.allowToolbarGroups};return N0(e,r,n,ea.none())});RF.setToolbars(r,t)}else RF.setToolbar(r,N0(e,o,n,ea.none()))},N2=nd(),N3=N2.os.isiOS()&&N2.os.version.major<=12,N5=(e,t)=>{let{uiMotherships:o}=t,n=e.dom,r=e.getWin(),a=e.getDoc().documentElement,i=ay(oO(r.innerWidth,r.innerHeight)),l=ay(oO(a.offsetWidth,a.offsetHeight)),s=()=>{let t=i.get();(t.left!==r.innerWidth||t.top!==r.innerHeight)&&(i.set(oO(r.innerWidth,r.innerHeight)),kg(e))},c=()=>{let t=e.getDoc().documentElement,o=l.get();(o.left!==t.offsetWidth||o.top!==t.offsetHeight)&&(l.set(oO(t.offsetWidth,t.offsetHeight)),kg(e))},d=t=>{kp(e,t)};n.bind(r,"resize",s),n.bind(r,"scroll",d);let u=dM(tp.fromDom(e.getBody()),"load",c);e.on("hide",()=>{ef(o,e=>{od(e.element,"display","none")})}),e.on("show",()=>{ef(o,e=>{ov(e.element,"display")})}),e.on("NodeChange",c),e.on("remove",()=>{u.unbind(),n.unbind(r,"resize",s),n.unbind(r,"scroll",d),r=null})},N9=(e,t)=>{mW(e,t.dialogUi.mothership)},N4=(e,t,o,n,r)=>{let{mainUi:a,uiMotherships:i}=t,l=ay(0),s=a.outerContainer;Rj(e);let c=tp.fromDom(r.targetNode),d=t1(t0(c));mj(c,a.mothership),N9(d,t),e.on("PostRender",()=>{RF.setSidebar(s,o.sidebar,yG(e)),N1(e,t,o,n),l.set(e.getWin().innerWidth),RF.setMenubar(s,RV(e,o)),RF.setViews(s,o.views),N5(e,t)});let m=RF.getSocket(s).getOrDie("Could not find expected socket element");if(N3){ou(m.element,{overflow:"scroll","-webkit-overflow-scrolling":"touch"});let t=DP(()=>{e.dispatch("ScrollContent")},20),o=dA(m.element,"scroll",t.throttle);e.on("remove",o.unbind)}Sp(e,t),e.addCommand("ToggleSidebar",(t,o)=>{RF.toggleSidebar(s,o),e.dispatch("ToggleSidebar")}),e.addQueryValueHandler("ToggleSidebar",()=>{var e;return null!==(e=RF.whichSidebar(s))&&void 0!==e?e:""}),e.addCommand("ToggleView",(t,o)=>{if(RF.toggleView(s,o)){let t=s.element;a.mothership.broadcastOn([gn()],{target:t}),ef(i,e=>{e.broadcastOn([gn()],{target:t})}),u(RF.whichView(s))&&(e.focus(),e.nodeChanged())}}),e.addQueryValueHandler("ToggleView",()=>{var e;return null!==(e=RF.whichView(s))&&void 0!==e?e:""});let g=yC(e),p=()=>{RF.refreshToolbar(t.mainUi.outerContainer)};return(g===Z.sliding||g===Z.floating)&&e.on("ResizeWindow ResizeEditor ResizeContent",()=>{let t=e.getWin().innerWidth;t!==l.get()&&(p(),l.set(t))}),{iframeContainer:m.element.dom,editorContainer:s.element.dom,api:{setEnabled:e=>{Sg(t,!e)},isEnabled:()=>!p7.isDisabled(s)}}};var N6=Object.freeze({__proto__:null,render:N4});let N8=e=>/^[0-9\.]+(|px)$/i.test(""+e)?ea.some(parseInt(""+e,10)):ea.none(),N7=e=>b(e)?e+"px":e,Ve=(e,t,o)=>{let n=t.filter(t=>e<t),r=o.filter(t=>e>t);return n.or(r).getOr(e)},Vt=e=>{let t=yg(e),o=yf(e),n=yv(e);return N8(t).map(e=>Ve(e,o,n))},Vo=e=>{let t=Vt(e);return t.getOr(yg(e))},Vn=e=>{let t=yp(e),o=yh(e),n=yb(e);return N8(t).map(e=>Ve(e,o,n))},Vr=e=>{let t=Vn(e);return t.getOr(yp(e))},{ToolbarLocation:Va,ToolbarMode:Vi}=y6,Vl=(e,t,o,n,r)=>{let{mainUi:a,uiMotherships:i}=o,l=yi.DOM,s=y2(e),c=y9(e),d=yb(e).or(Vn(e)),u=n.shared.header,m=u.isPositionedAtTop,g=yC(e),p=g===Vi.sliding||g===Vi.floating,h=ay(!1),f=()=>h.get()&&!e.removed,b=e=>p?e.fold(k(0),e=>e.components().length>1?oS(e.components()[1].element):0):0,v=o=>{switch(y_(e)){case Va.auto:let n=RF.getToolbar(a.outerContainer),r=b(n),i=oS(o.element)-r,l=nP(t),s=l.y>i;if(s)return"top";{let e=tL(t),o=Math.max(e.dom.scrollHeight,oS(e)),n=l.bottom<o-i;if(n)return"bottom";{let e=nW(),t=e.bottom<l.bottom-i;return t?"bottom":"top"}}case Va.bottom:return"bottom";case Va.top:default:return"top"}},y=e=>{r.on(t=>{BZ.setModes(t,[e]),u.setDockingMode(e);let o=m()?K.TopToBottom:K.BottomToTop;ot(t.element,d9,o)})},x=()=>{r.on(e=>{let o=d.getOrThunk(()=>{let e=N8(og(t8(),"margin-left")).getOr(0);return oB(t8())-oE(t).left+e});od(e.element,"max-width",o+"px")})},w=()=>{r.on(e=>{let o=RF.getToolbar(a.outerContainer),n=b(o),r=nP(t),i=m()?Math.max(r.y-oS(e.element)+n,0):r.bottom;ou(a.outerContainer.element,{position:"absolute",top:Math.round(i)+"px",left:Math.round(r.x)+"px"})})},S=()=>{ef(i,e=>{e.broadcastOn([gr()],{})})},C=(e=!1)=>{if(f()){if(s||x(),p&&RF.refreshToolbar(a.outerContainer),s||w(),c){let t=e?BZ.reset:BZ.refresh;r.on(t)}S()}},O=(e=!0)=>{!s&&c&&f()&&r.on(t=>{let o=u.getDockingMode(),n=v(t);n!==o&&(y(n),e&&C(!0))})},_=()=>{h.set(!0),od(a.outerContainer.element,"display","flex"),l.addClass(e.getBody(),"mce-edit-focus"),ef(i,e=>{ov(e.element,"display")}),O(!1),C()},T=()=>{h.set(!1),od(a.outerContainer.element,"display","none"),l.removeClass(e.getBody(),"mce-edit-focus"),ef(i,e=>{od(e.element,"display","none")})};return{isVisible:f,isPositionedAtTop:m,show:_,hide:T,update:C,updateMode:O,repositionPopups:S}},Vs=(e,t)=>{let o=nP(e);return{pos:t?o.y:o.bottom,bounds:o}},Vc=(e,t,o,n)=>{let r=ay(Vs(t,o.isPositionedAtTop())),a=n=>{let{pos:a,bounds:i}=Vs(t,o.isPositionedAtTop()),{pos:l,bounds:s}=r.get(),c=i.height!==s.height||i.width!==s.width;r.set({pos:a,bounds:i}),c&&kg(e,n),o.isVisible()&&(l!==a?o.update(!0):c&&(o.updateMode(),o.repositionPopups()))};n||(e.on("activate",o.show),e.on("deactivate",o.hide)),e.on("SkinLoaded ResizeWindow",()=>o.update(!0)),e.on("NodeChange keydown",e=>{requestAnimationFrame(()=>a(e))}),e.on("ScrollWindow",()=>o.updateMode());let i=dE();i.set(dM(tp.fromDom(e.getBody()),"load",e=>a(e.raw))),e.on("remove",()=>{i.clear()})},Vd=(e,t)=>{mW(e,t.dialogUi.mothership)},Vu=(e,t,o,n,r)=>{let{mainUi:a}=t,i=dD(),l=tp.fromDom(r.targetNode),s=Vl(e,l,t,n,i),c=yD(e);RG(e);let d=()=>{if(i.isSet()){s.show();return}i.set(RF.getHeader(a.outerContainer).getOrDie());let r=y3(e);mW(r,a.mothership),Vd(r,t),N1(e,t,o,n),RF.setMenubar(a.outerContainer,RV(e,o)),s.show(),Vc(e,l,s,c),e.nodeChanged()};e.on("show",d),e.on("hide",s.hide),c||(e.on("focus",d),e.on("blur",s.hide)),e.on("init",()=>{(e.hasFocus()||c)&&d()}),Sp(e,t);let u={show:d,hide:s.hide,setEnabled:e=>{Sg(t,!e)},isEnabled:()=>!p7.isDisabled(a.outerContainer)};return{editorContainer:a.outerContainer.element.dom,api:u}};var Vm=Object.freeze({__proto__:null,render:Vu});let Vg=()=>{let e=dD(),t=dD(),o=dD(),n=t=>{e.set(t)},r=(e,t)=>()=>o.get().bind(e=>t(e.outerContainer)).getOrDie(`Could not find ${e} element in OuterContainer`);return{dialogUi:e,popupUi:t,mainUi:o,getUiMotherships:()=>[...e.get().map(e=>e.mothership).toArray()],setupDialogUi:n,lazyGetInOuterOrDie:r}},Vp="contexttoolbar-hide",Vh=e=>({hide:()=>iT(e,ic()),getValue:()=>gN.getValue(e)}),Vf=(e,t)=>iV(E1,(o,n)=>{let r=e.get(o),a=Vh(r);t.onAction(a,n.event.buttonApi)}),Vb=(e,t,o)=>{let{primary:n,...r}=t.original,a=rY(wS({...r,type:"button",onAction:y}));return Nz(a,o,[Vf(e,t)])},Vv=(e,t,o)=>{let{primary:n,...r}=t.original,a=rY(wO({...r,type:"togglebutton",onAction:y}));return NP(a,o,[Vf(e,t)])},Vy=e=>"contextformtogglebutton"===e.type,Vx=(e,t,o)=>Vy(t)?Vv(e,t,o):Vb(e,t,o),Vw=(e,t,o)=>{let n=eh(t,t=>vZ(Vx(e,t,o))),r=()=>eh(n,e=>e.asSpec()),a=e=>eV(t,(t,o)=>t.primary?ea.from(n[o]).bind(t=>t.getOpt(e)).filter(T(p7.isDisabled)):ea.none());return{asSpecs:r,findPrimary:a}},VS=(e,t)=>{let o=e.label.fold(()=>({}),e=>({"aria-label":e})),n=vZ(xT.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:e.initValue(),inputAttributes:o,selectOnFocus:!0,inputBehaviours:cY([bw.config({mode:"special",onEnter:e=>r.findPrimary(e).map(e=>(iD(e),!0)),onLeft:(e,t)=>(t.cut(),ea.none()),onRight:(e,t)=>(t.cut(),ea.none())})])})),r=Vw(n,e.commands,t);return[{title:ea.none(),items:[n.asSpec()]},{title:ea.none(),items:r.asSpecs()}]},Vk=(e,t,o)=>I7({type:e,uid:i8("context-toolbar"),initGroups:VS(t,o),onEscape:ea.none,cyclicKeying:!0,providers:o}),VC={renderContextForm:Vk,buildInitGroups:VS},VO=(e,t,o)=>t.bottom-e.y>=o&&e.bottom-t.y>=o,V_=e=>{let t=e.getBoundingClientRect();if(!(t.height<=0)||!(t.width<=0))return t;{let o=tY(tp.fromDom(e.startContainer),e.startOffset).element,n=tE(o)?tU(o):ea.some(o);return n.filter(tT).map(e=>e.dom.getBoundingClientRect()).getOr(t)}},VT=e=>{let t=e.selection.getRng(),o=V_(t);if(e.inline){let e=n_();return nL(e.left+o.left,e.top+o.top,o.width,o.height)}{let t=nU(tp.fromDom(e.getBody()));return nL(t.x+o.left,t.y+o.top,o.width,o.height)}},VE=(e,t)=>t.filter(e=>t6(e)&&t_(e)).map(nU).getOrThunk(()=>VT(e)),VD=(e,t,o)=>{let n=Math.max(e.x+o,t.x),r=Math.min(e.right-o,t.right);return{x:n,width:r-n}},VA=(e,t,o,n,r,a)=>{let i=tp.fromDom(e.getContainer()),l=sF(i,".tox-editor-header").getOr(i),s=nP(l),c=s.y>=t.bottom,d=n&&!c;if(e.inline&&d)return{y:Math.max(s.bottom+a,o.y),bottom:o.bottom};if(e.inline&&!d)return{y:o.y,bottom:Math.min(s.y-a,o.bottom)};let u="line"===r?nP(i):t;return d?{y:Math.max(s.bottom+a,o.y),bottom:Math.min(u.bottom-a,o.bottom)}:{y:Math.max(u.y+a,o.y),bottom:Math.min(s.y-a,o.bottom)}},VM=(e,t,o,n=0)=>{let r=nA(window),a=nP(tp.fromDom(e.getContentAreaContainer())),i=yX(e)||yJ(e)||yQ(e),{x:l,width:s}=VD(a,r,n);if(e.inline&&!i)return nL(l,r.y,s,r.height);{let i=t.header.isPositionedAtTop(),{y:c,bottom:d}=VA(e,a,r,i,o,n);return nL(l,c,s,d-c)}},VB={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"],inset:["tox-pop--inset"]},VF={maxHeightFunction:dY(),maxWidthFunction:IF()},VI=(e,t)=>{let o=e.selection.getRng(),n=tY(tp.fromDom(o.startContainer),o.startOffset);return o.startContainer===o.endContainer&&o.startOffset===o.endOffset-1&&tN(n.element,t)},VR=(e,t,o)=>{let n=oh(e,"position");od(e,"position",t);let r=o(e);return n.each(t=>od(e,"position",t)),r},VN=e=>"node"===e,VV=(e,t,o,n,r)=>{let a=VT(e),i=n.lastElement().exists(e=>tN(o,e));if(VI(e,o))return i?A9:A0;if(i)return VR(t,n.getMode(),()=>{let e=VO(a,nP(t),-20);return e&&!n.isReposition()?A6:A9});{let e="fixed"===n.getMode()?r.y+n_().top:r.y,o=oS(t)+12;return e+o<=a.y?A0:A1}},VH=(e,t,o,n)=>{let r=t=>(n,r,a,i,l)=>{let s=VV(e,i,t,o,l),c={...n,y:l.y,height:l.height};return{...s(c,r,a,i,l),alwaysFit:!0}},a=e=>VN(n)?[r(e)]:[];return t?{onLtr:e=>[cA,cO,c_,cT,cE,cD].concat(a(e)),onRtl:e=>[cA,c_,cO,cE,cT,cD].concat(a(e))}:{onLtr:e=>[cD,cA,cT,cO,cE,c_].concat(a(e)),onRtl:e=>[cD,cA,cE,c_,cT,cO].concat(a(e))}},Vz=(e,t,o,n)=>"line"===t?{bubble:d1(12,0,VB),layouts:{onLtr:()=>[cM],onRtl:()=>[cB]},overrides:VF}:{bubble:d1(0,12,VB,.08333333333333333),layouts:VH(e,o,n,t),overrides:VF},VL=(e,t)=>{let o=ey(t,t=>t.predicate(e.dom)),{pass:n,fail:r}=ev(o,e=>"contexttoolbar"===e.type);return{contextToolbars:n,contextForms:r}},VP=e=>{if(e.length<=1)return e;{let t=t=>em(e,e=>e.position===t),o=t=>ey(e,e=>e.position===t),n=t("selection"),r=t("node");if(!n&&!r)return o("line");if(!r||!n)return o(n?"selection":"node");{let e=o("node"),t=eh(o("selection"),e=>({...e,position:"node"}));return e.concat(t)}}},VU=e=>{if(e.length<=1)return e;{let t=t=>ek(e,e=>e.position===t),o=t("selection").orThunk(()=>t("node")).orThunk(()=>t("line")).map(e=>e.position);return o.fold(()=>[],t=>ey(e,e=>e.position===t))}},VW=(e,t,o)=>{let n=VL(e,t);if(n.contextForms.length>0)return ea.some({elem:e,toolbars:[n.contextForms[0]]});{let t=VL(e,o);if(t.contextForms.length>0)return ea.some({elem:e,toolbars:[t.contextForms[0]]});if(!(n.contextToolbars.length>0)&&!(t.contextToolbars.length>0))return ea.none();{let o=VP(n.contextToolbars.concat(t.contextToolbars));return ea.some({elem:e,toolbars:o})}}},Vj=(e,t,o)=>e(t)?ea.none():aF(t,e=>{if(!tT(e))return ea.none();{let{contextToolbars:t,contextForms:n}=VL(e,o.inNodeScope),r=n.length>0?n:VU(t);return r.length>0?ea.some({elem:e,toolbars:r}):ea.none()}},e),VG=(e,t)=>{let o=tp.fromDom(t.getBody()),n=e=>tN(e,o),r=tp.fromDom(t.selection.getNode());return n(r)||tV(o,r)?VW(r,e.inNodeScope,e.inEditorScope).orThunk(()=>Vj(n,r,e)):ea.none()},V$=(e,t)=>{let o={},n=[],r=[],a={},i={},l=(e,l)=>{let s=rY(wF(l));o[e]=s,s.launch.map(o=>{a["form:"+e]={...l.launch,type:"contextformtogglebutton"===o.type?"togglebutton":"button",onAction:()=>{t(s)}}}),"editor"===s.scope?r.push(s):n.push(s),i[e]=s},s=(e,t)=>{wR(t).each(o=>{"editor"===t.scope?r.push(o):n.push(o),i[e]=o})},c=eH(e);return ef(c,t=>{let o=e[t];"contextform"===o.type?l(t,o):"contexttoolbar"===o.type&&s(t,o)}),{forms:o,inNodeScope:n,inEditorScope:r,lookupTable:i,formNavigators:a}},Vq=i8("forward-slide"),VX=i8("backward-slide"),VK=i8("change-slide-event"),VY="tox-pop--resizing",VJ=e=>{let t=ay([]);return vX.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:e=>{t.set([]),vX.getContent(e).each(e=>{ov(e.element,"visibility")}),l1(e.element,VY),ov(e.element,"width")},inlineBehaviours:cY([bV("context-toolbar-events",[iG(a9(),(e,t)=>{"width"===t.event.raw.propertyName&&(l1(e.element,VY),ov(e.element,"width"))}),iV(VK,(e,t)=>{let o=e.element;ov(o,"width");let n=oB(o);vX.setContent(e,t.event.contents),lQ(o,VY);let r=oB(o);od(o,"width",n+"px"),vX.getContent(e).each(e=>{t.event.focus.bind(e=>(c9(e),c7(o))).orThunk(()=>(bw.focusIn(e),c8(t0(o))))}),setTimeout(()=>{od(e.element,"width",r+"px")},0)}),iV(Vq,(e,o)=>{vX.getContent(e).each(o=>{t.set(t.get().concat([{bar:o,focus:c8(t0(e.element))}]))}),iE(e,VK,{contents:o.event.forwardContents,focus:ea.none()})}),iV(VX,(e,o)=>{eR(t.get()).each(o=>{t.set(t.get().slice(0,t.get().length-1)),iE(e,VK,{contents:lp(o.bar),focus:o.focus})})})]),bw.config({mode:"special",onEscape:o=>eR(t.get()).fold(()=>e.onEscape(),e=>(iT(o,VX),ea.some(!0)))})]),lazySink:()=>nq.value(e.sink)})},VZ="tox-pop--transition",VQ=(e,t,o,n)=>{let r=n.backstage,a=r.shared,i=nd().deviceType.isTouch,l=dD(),s=dD(),c=dD(),d=sC(VJ({sink:o,onEscape:()=>(e.focus(),ea.some(!0))})),u=()=>{let t=c.get().getOr("node"),o=VN(t)?1:0;return VM(e,a,t,o)},m=()=>!e.removed&&!(i()&&r.isContextMenuOpen()),g=e=>eQ(e3(e,l.get(),tN),!0),p=()=>{if(!m())return!0;{let t=u(),o=eQ(c.get(),"node")?VE(e,l.get()):VT(e);return t.height<=0||!VO(o,t,.01)}},h=()=>{l.clear(),s.clear(),c.clear(),vX.hide(d)},f=()=>{if(vX.isOpen(d)){let e=d.element;ov(e,"display"),p()?od(e,"display","none"):(s.set(0),vX.reposition(d))}},b=t=>({dom:{tag:"div",classes:["tox-pop__dialog"]},components:[t],behaviours:cY([bw.config({mode:"acyclic"}),bV("pop-dialog-wrap-events",[i$(t=>{e.shortcuts.add("ctrl+F9","focus statusbar",()=>bw.focusIn(t))}),iq(t=>{e.shortcuts.remove("ctrl+F9")})])])}),v=oR(()=>V$(t,e=>{let t=S([e]);iE(d,Vq,{forwardContents:b(t)})})),x=(t,o)=>N0(e,{buttons:t,toolbar:o.items,allowToolbarGroups:!1},n.backstage,ea.some(["form:"])),w=(e,t)=>VC.buildInitGroups(e,t),S=t=>{let{buttons:o}=e.ui.registry.getAll(),n=v(),r={...o,...n.formNavigators},i=yC(e)===Z.scrolling?Z.scrolling:Z.default,l=eO(eh(t,e=>"contexttoolbar"===e.type?x(r,e):w(e,a.providers)));return I7({type:i,uid:i8("context-toolbar"),initGroups:l,onEscape:ea.none,cyclicKeying:!0,providers:a.providers})},k=(t,n)=>{let r="node"===t?a.anchors.node(n):a.anchors.cursor(),c=Vz(e,t,i(),{lastElement:l.get,isReposition:()=>eQ(s.get(),0),getMode:()=>mE.getMode(o)});return re(r,c)},C=(e,t)=>{if(O.cancel(),!m())return;let n=S(e),r=e[0].position,a=k(r,t);c.set(r),s.set(1);let i=d.element;ov(i,"display"),g(t)||(l1(i,VZ),mE.reset(o,d)),vX.showWithinBounds(d,b(n),{anchor:a,transition:{classes:[VZ],mode:"placement"}},()=>ea.some(u())),t.fold(l.clear,l.set),p()&&od(i,"display","none")},O=DU(()=>{if(e.hasFocus()&&!e.removed){if(l2(d.element,VZ))O.throttle();else{let t=v();VG(t,e).fold(h,e=>{C(e.toolbars,ea.some(e.elem))})}}},17);e.on("init",()=>{e.on("remove",h),e.on("ScrollContent ScrollWindow ObjectResized ResizeEditor longpress",f),e.on("click keyup focus SetContent",O.throttle),e.on(Vp,h),e.on("contexttoolbar-show",t=>{let o=v();eY(o.lookupTable,t.toolbarKey).each(o=>{C([o],e4(t.target!==e,t.target)),vX.getContent(d).each(bw.focusIn)})}),e.on("focusout",t=>{vK.setEditorTimeout(e,()=>{c7(o.element).isNone()&&c7(d.element).isNone()&&h()},0)}),e.on("SwitchMode",()=>{e.mode.isReadOnly()&&h()}),e.on("AfterProgressState",t=>{t.state?h():e.hasFocus()&&O.throttle()}),e.on("NodeChange",e=>{c7(d.element).fold(O.throttle,y)})})},V0=e=>{ef([{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}],t=>{e.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onAction:RK(e,t.cmd),onSetup:R$(e,t.name)})}),e.ui.registry.addButton("alignnone",{tooltip:"No alignment",icon:"align-none",onAction:RK(e,"JustifyNone")})},V1={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},V2=(()=>{let e="[0-9]+",t="[eE][+-]?"+e,o=e=>`(?:${e})?`,n=["Infinity",e+"\\."+o(e)+o(t),"\\."+e+o(t),e+o(t)].join("|"),r=`[+-]?(?:${n})`;return RegExp(`^(${r})(.*)$`)})(),V3=(e,t)=>em(t,t=>em(V1[t],t=>e===t)),V5=(e,t)=>{let o=ea.from(V2.exec(e));return o.bind(e=>{let o=Number(e[1]),n=e[2];return V3(n,t)?ea.some({value:o,unit:n}):ea.none()})},V9=(e,t)=>V5(e,t).map(({value:e,unit:t})=>e+t),V4=(e,t)=>{let o=()=>{let o=t.getOptions(e),n=t.getCurrent(e).map(t.hash),r=dD();return eh(o,o=>({type:"togglemenuitem",text:t.display(o),onSetup:a=>{let i=e=>{e&&(r.on(e=>e.setActive(!1)),r.set(a)),a.setActive(e)};i(eQ(n,t.hash(o)));let l=t.watcher(e,o,i);return()=>{r.clear(),l()}},onAction:()=>t.setCurrent(e,o)}))};e.ui.registry.addMenuButton(t.name,{tooltip:t.text,icon:t.icon,fetch:e=>e(o()),onSetup:t.onToolbarSetup}),e.ui.registry.addNestedMenuItem(t.name,{type:"nestedmenuitem",text:t.text,getSubmenuItems:o,onSetup:t.onMenuSetup})},V6={name:"lineheight",text:"Line height",icon:"line-height",getOptions:yY,hash:e=>V9(e,["fixed","relative","empty"]).getOr(e),display:C,watcher:(e,t,o)=>e.formatter.formatChanged("lineheight",o,!1,{value:t}).unbind,getCurrent:e=>ea.from(e.queryCommandValue("LineHeight")),setCurrent:(e,t)=>e.execCommand("LineHeight",!1,t)},V8=e=>{let t=ea.from(yS(e));return t.map(t=>({name:"language",text:"Language",icon:"language",getOptions:k(t),hash:e=>g(e.customCode)?e.code:`${e.code}/${e.customCode}`,display:e=>e.title,watcher:(e,t,o)=>{var n;return e.formatter.formatChanged("lang",o,!1,{value:t.code,customValue:null!==(n=t.customCode)&&void 0!==n?n:null}).unbind},getCurrent:e=>{let t=tp.fromDom(e.selection.getNode());return aI(t,e=>ea.some(e).filter(tT).bind(e=>{let t=or(e,"lang");return t.map(t=>{let o=or(e,"data-mce-lang").getOrUndefined();return{code:t,customCode:o,title:""}})}))},setCurrent:(e,t)=>e.execCommand("Lang",!1,t),onToolbarSetup:t=>{let o=dE();return t.setActive(e.formatter.match("lang",{},void 0,!0)),o.set(e.formatter.formatChanged("lang",t.setActive,!0)),o.clear}}))},V7=e=>{V4(e,V6),V8(e).each(t=>V4(e,t))},He=(e,t)=>{R4(e,t),Ni(e,t),Nb(e,t),Ne(e,t),Np(e,t)},Ht=e=>Rq(e,"NodeChange",t=>{t.setEnabled(e.queryCommandState("outdent"))}),Ho=e=>{e.ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:Ht(e),onAction:RK(e,"outdent")}),e.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onAction:RK(e,"indent")})},Hn=e=>{Ho(e)},Hr=(e,t)=>o=>{o.setActive(t.get());let n=e=>{t.set(e.state),o.setActive(e.state)};return e.on("PastePlainTextToggle",n),()=>e.off("PastePlainTextToggle",n)},Ha=e=>{let t=ay(yj(e)),o=()=>e.execCommand("mceTogglePlainTextPaste");e.ui.registry.addToggleButton("pastetext",{active:!1,icon:"paste-text",tooltip:"Paste as text",onAction:o,onSetup:Hr(e,t)}),e.ui.registry.addToggleMenuItem("pastetext",{text:"Paste as text",icon:"paste-text",onAction:o,onSetup:Hr(e,t)})},Hi=(e,t)=>()=>{e.execCommand("mceToggleFormat",!1,t)},Hl=e=>{EV.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],(t,o)=>{e.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onSetup:R$(e,t.name),onAction:Hi(e,t.name)})});for(let t=1;t<=6;t++){let o="h"+t;e.ui.registry.addToggleButton(o,{text:o.toUpperCase(),tooltip:"Heading "+t,onSetup:R$(e,o),onAction:Hi(e,o)})}},Hs=e=>{EV.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"},{name:"print",text:"Print",action:"mcePrint",icon:"print"},{name:"hr",text:"Horizontal line",action:"InsertHorizontalRule",icon:"horizontal-rule"}],t=>{e.ui.registry.addButton(t.name,{tooltip:t.text,icon:t.icon,onAction:RK(e,t.action)})})},Hc=e=>{EV.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],t=>{e.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onAction:RK(e,t.action),onSetup:R$(e,t.name)})})},Hd=e=>{Hl(e),Hs(e),Hc(e)},Hu=e=>{EV.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"},{name:"print",text:"Print...",action:"mcePrint",icon:"print",shortcut:"Meta+P"},{name:"hr",text:"Horizontal line",action:"InsertHorizontalRule",icon:"horizontal-rule"}],t=>{e.ui.registry.addMenuItem(t.name,{text:t.text,icon:t.icon,shortcut:t.shortcut,onAction:RK(e,t.action)})}),e.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onAction:Hi(e,"code")})},Hm=e=>{Hd(e),Hu(e)},Hg=(e,t)=>Rq(e,"Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",o=>{o.setEnabled(!e.mode.isReadOnly()&&e.undoManager[t]())}),Hp=e=>{e.ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:Hg(e,"hasUndo"),onAction:RK(e,"undo")}),e.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:Hg(e,"hasRedo"),onAction:RK(e,"redo")})},Hh=e=>{e.ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",enabled:!1,onSetup:Hg(e,"hasUndo"),onAction:RK(e,"undo")}),e.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",enabled:!1,onSetup:Hg(e,"hasRedo"),onAction:RK(e,"redo")})},Hf=e=>{Hp(e),Hh(e)},Hb=e=>Rq(e,"VisualAid",t=>{t.setActive(e.hasVisual)}),Hv=e=>{e.ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:Hb(e),onAction:RK(e,"mceToggleVisualAid")})},Hy=e=>{e.ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:RK(e,"mceToggleVisualAid")})},Hx=e=>{Hy(e),Hv(e)},Hw=(e,t)=>{V0(e),Hm(e),He(e,t),Hf(e),k0(e),Hx(e),Hn(e),V7(e),Ha(e)},HS=e=>l(e)?e.split(/[ ,]/):e,Hk=e=>t=>t.options.get(e),HC=e=>{let t=e.options.register;t("contextmenu_avoid_overlap",{processor:"string",default:""}),t("contextmenu_never_use_native",{processor:"boolean",default:!1}),t("contextmenu",{processor:e=>!1===e?{value:[],valid:!0}:l(e)||v(e,l)?{value:HS(e),valid:!0}:{valid:!1,message:"Must be false or a string."},default:"link linkchecker image editimage table spellchecker configurepermanentpen"})},HO=Hk("contextmenu_never_use_native"),H_=Hk("contextmenu_avoid_overlap"),HT=e=>0===HE(e).length,HE=e=>{let t=e.ui.registry.getAll().contextMenus,o=e.options.get("contextmenu");return e.options.isSet("contextmenu")?o:ey(o,e=>eJ(t,e))},HD=(e,t)=>({type:"makeshift",x:e,y:t}),HA=(e,t,o)=>HD(e.x+t,e.y+o),HM=e=>"longpress"===e.type||0===e.type.indexOf("touch"),HB=e=>{if(!HM(e))return HD(e.pageX,e.pageY);{let t=e.touches[0];return HD(t.pageX,t.pageY)}},HF=e=>{if(!HM(e))return HD(e.clientX,e.clientY);{let t=e.touches[0];return HD(t.clientX,t.clientY)}},HI=(e,t)=>{let o=yi.DOM.getPos(e);return HA(t,o.x,o.y)},HR=(e,t)=>"contextmenu"!==t.type&&"longpress"!==t.type?HN(e):e.inline?HB(t):HI(e.getContentAreaContainer(),HF(t)),HN=e=>({type:"selection",root:tp.fromDom(e.selection.getNode())}),HV=e=>({type:"node",node:ea.some(tp.fromDom(e.selection.getNode())),root:tp.fromDom(e.getBody())}),HH=(e,t,o)=>{switch(o){case"node":return HV(e);case"point":return HR(e,t);case"selection":return HN(e)}},Hz=(e,t,o,n,r,a)=>{let i=o(),l=HH(e,t,a);Du(i,xn.CLOSE_ON_EXECUTE,n,{isHorizontalMenu:!1,search:ea.none()}).map(e=>{t.preventDefault(),vX.showMenuAt(r,{anchor:l},{menu:{markers:xv("normal")},data:e})})},HL={onLtr:()=>[cA,cO,c_,cT,cE,cD,A0,A1,AQ,AJ,AZ,AY],onRtl:()=>[cA,c_,cO,cE,cT,cD,A0,A1,AZ,AY,AQ,AJ]},HP={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},HU=(e,t)=>{let o=e.selection;if(o.isCollapsed()||t.touches.length<1)return!1;{let n=t.touches[0],r=o.getRng(),a=u1(e.getWin(),uI.domRange(r));return a.exists(e=>e.left<=n.clientX&&e.right>=n.clientX&&e.top<=n.clientY&&e.bottom>=n.clientY)}},HW=e=>{let t=e.selection.getRng(),o=()=>{vK.setEditorTimeout(e,()=>{e.selection.setRng(t)},10),a()};e.once("touchend",o);let n=e=>{e.preventDefault(),e.stopImmediatePropagation()};e.on("mousedown",n,!0);let r=()=>a();e.once("longpresscancel",r);let a=()=>{e.off("touchend",o),e.off("longpresscancel",r),e.off("mousedown",n)}},Hj=(e,t,o)=>{let n=HH(e,t,o);return{bubble:d1(0,"point"===o?12:0,HP),layouts:HL,overrides:{maxWidthFunction:IF(),maxHeightFunction:dY()},...n}},HG=(e,t,o,n,r,a,i)=>{let l=Hj(e,t,a);Du(o,xn.CLOSE_ON_EXECUTE,n,{isHorizontalMenu:!0,search:ea.none()}).map(o=>{t.preventDefault();let s=i?J.HighlightMenuAndItem:J.HighlightNone;vX.showMenuWithinBounds(r,{anchor:l},{menu:{markers:xv("normal"),highlightOnOpen:s},data:o,type:"horizontal"},()=>ea.some(VM(e,n.shared,"node"===a?"node":"selection"))),e.dispatch(Vp)})},H$=(e,t,o,n,r,a)=>{let i=nd(),l=i.os.isiOS(),s=i.os.isMacOS(),c=i.os.isAndroid(),d=i.deviceType.isTouch(),u=()=>!(c||l||s&&d),m=()=>{let i=o();HG(e,t,i,n,r,a,u())};if((s||l)&&"node"!==a){let o=()=>{HW(e),m()};HU(e,t)?o():(e.once("selectionchange",o),e.once("touchend",()=>e.off("selectionchange",o)))}else m()},Hq=e=>l(e)?"|"===e:"separator"===e.type,HX={type:"separator"},HK=e=>{let t=e=>({text:e.text,icon:e.icon,enabled:e.enabled,shortcut:e.shortcut});if(l(e))return e;switch(e.type){case"separator":return HX;case"submenu":return{type:"nestedmenuitem",...t(e),getSubmenuItems:()=>{let t=e.getSubmenuItems();return l(t)?t:eh(t,HK)}};default:return{type:"menuitem",...t(e),onAction:x(e.onAction)}}},HY=(e,t)=>{if(0===t.length)return e;let o=eR(e).filter(e=>!Hq(e)),n=o.fold(()=>[],e=>[HX]);return e.concat(n).concat(t).concat([HX])},HJ=(e,t,o)=>{let n=ew(t,(t,n)=>eY(e,n.toLowerCase()).map(e=>{let n=e.update(o);if(l(n))return HY(t,n.split(" "));if(!(n.length>0))return t;{let e=eh(n,HK);return HY(t,e)}}).getOrThunk(()=>t.concat([n])),[]);return n.length>0&&Hq(n[n.length-1])&&n.pop(),n},HZ=(e,t)=>t.ctrlKey&&!HO(e),HQ=e=>"longpress"===e.type||eJ(e,"touches"),H0=(e,t)=>!HQ(t)&&(2!==t.button||t.target===e.getBody()&&""===t.pointerType),H1=(e,t)=>H0(e,t)?e.selection.getStart(!0):t.target,H2=(e,t)=>{let o=H_(e),n=H0(e,t)?"selection":"point";if(!ti(o))return n;{let r=H1(e,t),a=C6(tp.fromDom(r),o);return a?"node":n}},H3=(e,t,o)=>{let n=nd(),r=n.deviceType.isTouch,a=sC(vX.sketch({dom:{tag:"div"},lazySink:t,onEscape:()=>e.focus(),onShow:()=>o.setContextMenuState(!0),onHide:()=>o.setContextMenuState(!1),fireDismissalEventInstead:{},inlineBehaviours:cY([bV("dismissContextMenu",[iV(iy(),(t,o)=>{go.close(t),e.focus()})])])})),i=()=>vX.hide(a),l=t=>{if(HO(e)&&t.preventDefault(),HZ(e,t)||HT(e))return;let n=H2(e,t),i=()=>{let o=H1(e,t),n=e.ui.registry.getAll(),r=HE(e);return HJ(n.contextMenus,r,o)},l=r()?H$:Hz;l(e,t,i,o,a,n)};e.on("init",()=>{let t="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(r()?"":" ResizeWindow");e.on(t,i),e.on("longpress contextmenu",l)})},H5=aw.generate([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),H9=e=>t=>t.translate(-e.left,-e.top),H4=e=>t=>t.translate(e.left,e.top),H6=e=>(t,o)=>ew(e,(e,t)=>t(e),oO(t,o)),H8=(e,t,o)=>e.fold(H6([H4(o),H9(t)]),H6([H9(t)]),H6([])),H7=(e,t,o)=>e.fold(H6([H4(o)]),H6([]),H6([H4(t)])),ze=(e,t,o)=>e.fold(H6([]),H6([H9(o)]),H6([H4(t),H9(o)])),zt=(e,t,o,n,r,a)=>{let i=H7(e,r,a),l=H7(t,r,a);return Math.abs(i.left-l.left)<=o&&Math.abs(i.top-l.top)<=n},zo=(e,t,o,n,r,a)=>{let i=H7(e,r,a),l=H7(t,r,a),s=Math.abs(i.left-l.left),c=Math.abs(i.top-l.top);return oO(s,c)},zn=(e,t,o)=>{let n=e.fold((e,t)=>({position:ea.some("absolute"),left:ea.some(e+"px"),top:ea.some(t+"px")}),(e,t)=>({position:ea.some("absolute"),left:ea.some(e-o.left+"px"),top:ea.some(t-o.top+"px")}),(e,t)=>({position:ea.some("fixed"),left:ea.some(e+"px"),top:ea.some(t+"px")}));return{right:ea.none(),bottom:ea.none(),...n}},zr=(e,t,o)=>e.fold((e,n)=>zi(e+t,n+o),(e,n)=>zl(e+t,n+o),(e,n)=>zs(e+t,n+o)),za=(e,t,o,n)=>{let r=(e,r)=>(a,i)=>{let l=e(t,o,n);return r(a.getOr(l.left),i.getOr(l.top))};return e.fold(r(ze,zi),r(H7,zl),r(H8,zs))},zi=H5.offset,zl=H5.absolute,zs=H5.fixed,zc=(e,t)=>{let o=on(e,t);return g(o)?NaN:parseInt(o,10)},zd=(e,t)=>{let o=e.element,n=zc(o,t.leftAttr),r=zc(o,t.topAttr);return isNaN(n)||isNaN(r)?ea.none():ea.some(oO(n,r))},zu=(e,t,o)=>{let n=e.element;ot(n,t.leftAttr,o.left+"px"),ot(n,t.topAttr,o.top+"px")},zm=(e,t)=>{let o=e.element;oi(o,t.leftAttr),oi(o,t.topAttr)},zg=(e,t,o,n)=>zd(e,t).fold(()=>o,e=>zs(e.left+n.left,e.top+n.top)),zp=(e,t,o,n,r,a)=>{let i=zg(e,t,o,n),l=t.mustSnap?zb(e,t,i,r,a):zv(e,t,i,r,a),s=H8(i,r,a);return zu(e,t,s),l.fold(()=>({coord:zs(s.left,s.top),extra:ea.none()}),e=>({coord:e.output,extra:e.extra}))},zh=(e,t)=>{zm(e,t)},zf=(e,t,o,n)=>eV(e,e=>{let r=e.sensor,a=zt(t,r,e.range.left,e.range.top,o,n);return a?ea.some({output:za(e.output,t,o,n),extra:e.extra}):ea.none()}),zb=(e,t,o,n,r)=>{let a=t.getSnapPoints(e),i=zf(a,o,n,r);return i.orThunk(()=>{let e=ew(a,(e,t)=>{let a=t.sensor,i=zo(o,a,t.range.left,t.range.top,n,r);return e.deltas.fold(()=>({deltas:ea.some(i),snap:ea.some(t)}),o=>{let n=(i.left+i.top)/2,r=(o.left+o.top)/2;return n<=r?{deltas:ea.some(i),snap:ea.some(t)}:e})},{deltas:ea.none(),snap:ea.none()});return e.snap.map(e=>({output:za(e.output,o,n,r),extra:e.extra}))})},zv=(e,t,o,n,r)=>{let a=t.getSnapPoints(e);return zf(a,o,n,r)},zy=(e,t,o)=>({coord:za(e.output,e.output,t,o),extra:e.extra}),zx=(e,t,o,n)=>{let r=t.getTarget(e.element);if(t.repositionTarget){let t=tH(e.element),o=n_(t),a=Bw(r),i=zy(n,o,a),l=zn(i.coord,o,a);om(r,l)}};var zw=Object.freeze({__proto__:null,snapTo:zx});let zS="data-initial-z-index",zk=e=>{tU(e.element).filter(tT).each(e=>{or(e,zS).fold(()=>ov(e,"z-index"),t=>od(e,"z-index",t)),oi(e,zS)})},zC=e=>{tU(e.element).filter(tT).each(t=>{oh(t,"z-index").each(e=>{ot(t,zS,e)}),od(t,"z-index",og(e.element,"z-index"))})},zO=(e,t)=>{e.getSystem().addToGui(t),zC(t)},z_=e=>{zk(e),e.getSystem().removeFromGui(e)},zT=(e,t,o)=>e.getSystem().build(Oy.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[t]},events:o}));var zE=as("snaps",[r1("getSnapPoints"),s1("onSensor"),r1("leftAttr"),r1("topAttr"),ad("lazyViewport",nW),ad("mustSnap",!1)]);let zD=[ad("useFixed",A),r1("blockerClass"),ad("getTarget",C),ad("onDrag",y),ad("repositionTarget",!0),ad("onDrop",y),af("getBounds",nW),zE],zA=e=>e5(oh(e,"left"),oh(e,"top"),oh(e,"position"),(e,t,o)=>("fixed"===o?zs:zi)(parseInt(e,10),parseInt(t,10))).getOrThunk(()=>{let t=oE(e);return zl(t.left,t.top)}),zM=(e,t,o,n,r)=>{let a=r.bounds,i=H7(t,o,n),l=cm(i.left,a.x,a.x+a.width-r.width),s=cm(i.top,a.y,a.y+a.height-r.height),c=zl(l,s);return t.fold(()=>{let e=ze(c,o,n);return zi(e.left,e.top)},k(c),()=>{let e=H8(c,o,n);return zs(e.left,e.top)})},zB=(e,t,o,n,r,a,i)=>{let l=t.fold(()=>{let e=zr(o,a.left,a.top),t=H8(e,n,r);return zs(t.left,t.top)},t=>{let i=zp(e,t,o,a,n,r);return i.extra.each(o=>{t.onSensor(e,o)}),i.coord});return zM(e,l,n,r,i)},zF=(e,t,o,n)=>{let r=t.getTarget(e.element);if(t.repositionTarget){let a=tH(e.element),i=n_(a),l=Bw(r),s=zA(r),c=zB(e,t.snaps,s,i,l,n,o),d=zn(c,i,l);om(r,d)}t.onDrag(e,r,n)},zI=(e,t)=>({bounds:e.getBounds(),height:ok(t.element),width:oF(t.element)}),zR=(e,t,o,n,r)=>{let a=o.update(n,r),i=o.getStartData().getOrThunk(()=>zI(t,e));a.each(o=>{zF(e,t,i,o)})},zN=(e,t,o,n)=>{t.each(z_),o.snaps.each(t=>{zh(e,t)});let r=o.getTarget(e.element);n.reset(),o.onDrop(e,r)},zV=e=>(t,o)=>{let n=e=>{o.setStartData(zI(t,e))};return iI([iV(ip(),e=>{o.getStartData().each(()=>n(e))}),...e(t,o,n)])},zH=e=>iI([iV(a$(),e.forceDrop),iV(aK(),e.drop),iV(aq(),(t,o)=>{e.move(o.event)}),iV(aX(),e.delayDrop)]),zz=e=>ea.from(oO(e.x,e.y)),zL=(e,t)=>oO(t.left-e.left,t.top-e.top);var zP=Object.freeze({__proto__:null,getData:zz,getDelta:zL});let zU=(e,t,o)=>[iV(a$(),(n,r)=>{let a=r.event.raw;if(0!==a.button)return;r.stop();let i=()=>zN(n,ea.some(c),e,t),l=C8(i,200),s={drop:i,delayDrop:l.schedule,forceDrop:i,move:o=>{l.cancel(),zR(n,e,t,zP,o)}},c=zT(n,e.blockerClass,zH(s));o(n),zO(n,c)})],zW=[...zD,s9("dragger",{handlers:zV(zU)})],zj=e=>iI([iV(aU(),e.forceDrop),iV(aj(),e.drop),iV(aG(),e.drop),iV(aW(),(t,o)=>{e.move(o.event)})]),zG=e=>{let t=e[0];return ea.some(oO(t.clientX,t.clientY))},z$=e=>{let t=e.raw,o=t.touches;return 1===o.length?zG(o):ea.none()},zq=(e,t)=>oO(t.left-e.left,t.top-e.top);var zX=Object.freeze({__proto__:null,getData:z$,getDelta:zq});let zK=(e,t,o)=>{let n=dD(),r=o=>{zN(o,n.get(),e,t),n.clear()};return[iV(aU(),(a,i)=>{i.stop();let l=()=>r(a),s=zT(a,e.blockerClass,zj({drop:l,delayDrop:y,forceDrop:l,move:o=>{zR(a,e,t,zX,o)}}));n.set(s),o(a),zO(a,s)}),iV(aW(),(o,n)=>{n.stop(),zR(o,e,t,zX,n.event)}),iV(aj(),(e,t)=>{t.stop(),r(e)}),iV(aG(),r)]},zY=[...zD,s9("dragger",{handlers:zV(zK)})],zJ=(e,t,o)=>[...zU(e,t,o),...zK(e,t,o)],zZ=[...zD,s9("dragger",{handlers:zV(zJ)})];var zQ=Object.freeze({__proto__:null,mouse:zW,touch:zY,mouseOrTouch:zZ});let z0=()=>{let e=ea.none(),t=ea.none(),o=()=>{e=ea.none(),t=ea.none()},n=(t,o)=>{let n=e.map(e=>t.getDelta(e,o));return e=ea.some(o),n},r=(e,t)=>e.getData(t).bind(t=>n(e,t)),a=e=>{t=ea.some(e)},i=k({});return ly({readState:i,reset:o,update:r,getStartData:()=>t,setStartData:a})};var z1=Object.freeze({__proto__:null,init:z0});let z2=c0({branchKey:"mode",branches:zQ,name:"dragging",active:{events:(e,t)=>{let o=e.dragger;return o.handlers(e,t)}},extra:{snap:e=>({sensor:e.sensor,range:e.range,output:e.output,extra:ea.from(e.extra)})},state:z1,apis:zw}),z3=(e,t,o,n,r,a)=>e.fold(()=>z2.snap({sensor:zl(o-20,n-20),range:oO(r,a),output:zl(ea.some(o),ea.some(n)),extra:{td:t}}),e=>{let r=e.element.dom.getBoundingClientRect();return z2.snap({sensor:zl(o-20,n-20),range:oO(40,40),output:zl(ea.some(o-r.width/2),ea.some(n-r.height/2)),extra:{td:t}})}),z5=(e,t,o)=>{let n=(e,t)=>e.exists(e=>tN(e,t));return{getSnapPoints:e,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:(e,r)=>{let a=r.td;n(t.get(),a)||(t.set(a),o(a))},mustSnap:!0}},z9=e=>vZ(vJ.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:cY([z2.config({mode:"mouseOrTouch",blockerClass:"blocker",snaps:e}),O8.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}})),z4=(e,t)=>{let o=ay([]),n=ay([]),r=ay(!1),a=dD(),i=dD(),l=e=>{let o=nU(e);return z3(g.getOpt(t),e,o.x,o.y,o.width,o.height)},s=()=>eh(o.get(),e=>l(e)),c=e=>{let o=nU(e);return z3(p.getOpt(t),e,o.right,o.bottom,o.width,o.height)},d=()=>eh(n.get(),e=>c(e)),u=z5(s,a,t=>{i.get().each(o=>{e.dispatch("TableSelectorChange",{start:t,finish:o})})}),m=z5(d,i,t=>{a.get().each(o=>{e.dispatch("TableSelectorChange",{start:o,finish:t})})}),g=z9(u),p=z9(m),h=sC(g.asSpec()),f=sC(p.asSpec()),b=(t,o,n,r)=>{let a=o.dom.getBoundingClientRect();ov(t.element,"display");let i=tP(tp.fromDom(e.getBody())).dom.innerHeight,l=n(a),s=r(a,i);(l||s)&&od(t.element,"display","none")},v=(e,t,o,n)=>{let r=o(t);z2.snapTo(e,r);let a=e=>e[n]<0,i=(e,t)=>e[n]>t;b(e,t,a,i)},y=e=>v(h,e,l,"top"),x=()=>a.get().each(y),w=e=>v(f,e,c,"bottom"),S=()=>i.get().each(w);nd().deviceType.isTouch()&&(e.on("TableSelectionChange",e=>{r.get()||(mH(t,h),mH(t,f),r.set(!0)),a.set(e.start),i.set(e.finish),e.otherCells.each(t=>{o.set(t.upOrLeftCells),n.set(t.downOrRightCells),y(e.start),w(e.finish)})}),e.on("ResizeEditor ResizeWindow ScrollContent",()=>{x(),S()}),e.on("TableSelectionClear",()=>{r.get()&&(mP(h),mP(f),r.set(!1)),a.clear(),i.clear()}))},z6=e=>"BR"===e.nodeName||!!e.getAttribute("data-mce-bogus")||"bookmark"===e.getAttribute("data-mce-type"),z8=(e,t,o)=>{var n;let r=null!==(n=t.delimiter)&&void 0!==n?n:"",a=(t,n,r)=>vJ.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{"data-index":r,"aria-level":r+1}},components:[sx(t)],action:t=>{e.focus(),e.selection.select(n),e.nodeChanged()},buttonBehaviours:cY([Sx.button(o.isDisabled),Sh()])}),i=()=>({dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0}},components:[sx(` ${r} `)]}),l=e=>ew(e,(e,t,o)=>{let n=a(t.name,t.element,o);return 0===o?e.concat([n]):e.concat([i(),n])},[]),s=t=>{let o=[],n=t.length;for(;n-- >0;){let r=t[n];if(1===r.nodeType&&!z6(r)){let t=kb(e,r);if(t.isDefaultPrevented()||o.push({name:t.name,element:r}),t.isPropagationStopped())break}}return o};return{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:cY([bw.config({mode:"flow",selector:"div[role=button]"}),p7.config({disabled:o.isDisabled}),Sh(),OD.config({}),bR.config({}),bV("elementPathEvents",[i$((t,o)=>{e.shortcuts.add("alt+F11","focus statusbar elementpath",()=>bw.focusIn(t)),e.on("NodeChange",e=>{let o=s(e.parents),n=o.length>0?l(o):[];bR.set(t,n)})})])]),components:[]}};($=en||(en={}))[$.None=0]="None",$[$.Both=1]="Both",$[$.Vertical=2]="Vertical";let z7=(e,t,o,n,r)=>{let a={height:Ve(n+t.top,yf(e),yv(e))};return o===en.Both&&(a.width=Ve(r+t.left,yh(e),yb(e))),a},Le=(e,t,o)=>{let n=tp.fromDom(e.getContainer()),r=z7(e,t,o,oS(n),oB(n));eL(r,(e,t)=>{b(e)&&od(n,t,N7(e))}),km(e)},Lt=e=>{let t=yW(e);return!1===t?en.None:"both"===t?en.Both:en.Vertical},Lo=(e,t,o,n)=>{let r=oO(20*o,20*n);return Le(e,r,t),ea.some(!0)},Ln=(e,t)=>{let o=Lt(e);return o===en.None?ea.none():ea.some(ye("resize-handle",{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:t.translate("Resize")},behaviours:[z2.config({mode:"mouse",repositionTarget:!1,onDrag:(t,n,r)=>Le(e,r,o),blockerClass:"tox-blocker"}),bw.config({mode:"special",onLeft:()=>Lo(e,o,-1,0),onRight:()=>Lo(e,o,1,0),onUp:()=>Lo(e,o,0,-1),onDown:()=>Lo(e,o,0,1)}),OD.config({}),b$.config({})]},t.icons))},Lr=(e,t)=>{let o=(e,o,n)=>bR.set(e,[sx(t.translate(["{0} "+n,o[n]]))]);return vJ.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:cY([Sx.button(t.isDisabled),Sh(),OD.config({}),bR.config({}),gN.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),bV("wordcount-events",[iK(e=>{let t=gN.getValue(e),n="words"===t.mode?"characters":"words";gN.setValue(e,{mode:n,count:t.count}),o(e,t.count,n)}),i$(t=>{e.on("wordCountUpdate",e=>{let{mode:n}=gN.getValue(t);gN.setValue(t,{mode:n,count:e.wordCount}),o(t,e.wordCount,n)})})])]),eventOrder:{[ia()]:["disabling","alloy.base.behaviour","wordcount-events"]}})},La=(e,t)=>{let o=()=>({dom:{tag:"span",classes:["tox-statusbar__branding"]},components:[{dom:{tag:"a",attributes:{href:"https://www.tiny.cloud/powered-by-tiny?utm_campaign=editor_referral&utm_medium=poweredby&utm_source=tinymce&utm_content=v6",rel:"noopener",target:"_blank","aria-label":vQ.translate(["Powered by {0}","Tiny"])},innerHtml:'<svg width="50px" height="16px" viewBox="0 0 50 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M10.143 0c2.608.015 5.186 2.178 5.186 5.331 0 0 .077 3.812-.084 4.87-.361 2.41-2.164 4.074-4.65 4.496-1.453.284-2.523.49-3.212.623-.373.071-.634.122-.785.152-.184.038-.997.145-1.35.145-2.732 0-5.21-2.04-5.248-5.33 0 0 0-3.514.03-4.442.093-2.4 1.758-4.342 4.926-4.963 0 0 3.875-.752 4.036-.782.368-.07.775-.1 1.15-.1Zm1.826 2.8L5.83 3.989v2.393l-2.455.475v5.968l6.137-1.189V9.243l2.456-.476V2.8ZM5.83 6.382l3.682-.713v3.574l-3.682.713V6.382Zm27.173-1.64-.084-1.066h-2.226v9.132h2.456V7.743c-.008-1.151.998-2.064 2.149-2.072 1.15-.008 1.987.92 1.995 2.072v5.065h2.455V7.359c-.015-2.18-1.657-3.929-3.837-3.913a3.993 3.993 0 0 0-2.908 1.296Zm-6.3-4.266L29.16 0v2.387l-2.456.475V.476Zm0 3.2v9.132h2.456V3.676h-2.456Zm18.179 11.787L49.11 3.676H46.58l-1.612 4.527-.46 1.382-.384-1.382-1.611-4.527H39.98l3.3 9.132L42.15 16l2.732-.537ZM22.867 9.738c0 .752.568 1.075.921 1.075.353 0 .668-.047.998-.154l.537 1.765c-.23.154-.92.537-2.225.537-1.305 0-2.655-.997-2.686-2.686a136.877 136.877 0 0 1 0-4.374H18.8V3.676h1.612v-1.98l2.455-.476v2.456h2.302V5.9h-2.302v3.837Z"/>\n</svg>\n'.trim()},behaviours:cY([b$.config({})])}]}),n=()=>{let n=[];return(yP(e)&&n.push(z8(e,{},t)),e.hasPlugin("wordcount")&&n.push(Lr(e,t)),yU(e)&&n.push(o()),n.length>0)?[{dom:{tag:"div",classes:["tox-statusbar__text-container"]},components:n}]:[]};return{dom:{tag:"div",classes:["tox-statusbar"]},components:(()=>{let o=n(),r=Ln(e,t);return o.concat(r.toArray())})()}},Li=(e,t)=>t.get().getOrDie(`UI for ${e} has not been rendered`),Ll=e=>{let t=e.inline,o=t?Vm:N6,n=y9(e)?Fr:By,r=Vg(),a=dD(),i=dD(),l=nd(),s=l.deviceType.isTouch(),c=s?["tox-platform-touch"]:[],d=y0(e),u=yC(e),m=vZ({dom:{tag:"div",classes:["tox-anchorbar"]}}),g=()=>r.mainUi.get().map(e=>e.outerContainer).bind(RF.getHeader),p=()=>nq.fromOption(r.dialogUi.get().map(e=>e.sink),"UI has not been rendered"),h=()=>nq.fromOption(r.popupUi.get().map(e=>e.sink),"(popup) UI has not been rendered"),f=r.lazyGetInOuterOrDie("anchor bar",m.getOpt),b=r.lazyGetInOuterOrDie("toolbar",RF.getToolbar),v=r.lazyGetInOuterOrDie("throbber",RF.getThrobber),y=Br({popup:h,dialog:p},e,f),x=()=>{let t={attributes:{[d9]:d?K.BottomToTop:K.TopToBottom}},o=RF.parts.menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:y.popup,onEscape:()=>{e.focus()}}),n=RF.parts.toolbar({dom:{tag:"div",classes:["tox-toolbar"]},getSink:y.popup.shared.getSink,providers:y.popup.shared.providers,onEscape:()=>{e.focus()},onToolbarToggled:t=>{kv(e,t)},type:u,lazyToolbar:b,lazyHeader:()=>g().getOrDie("Could not find header element"),...t}),r=RF.parts["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},providers:y.popup.shared.providers,onEscape:()=>{e.focus()},type:u}),a=yQ(e),i=yJ(e),l=yX(e),s=y$(e),c=w();return RF.parts.header({dom:{tag:"div",classes:["tox-editor-header"].concat(a||i||l?[]:["tox-editor-header--empty"]),...t},components:eO([l?s?[c,o]:[o]:[],a?[r]:i?[n]:[],y2(e)?[]:[m.asSpec()]]),sticky:y9(e),editor:e,sharedBackstage:y.popup.shared})},w=()=>RF.parts.promotion({dom:{tag:"div",classes:["tox-promotion"]}}),S=()=>{let e=RF.parts.socket({dom:{tag:"div",classes:["tox-edit-area"]}}),t=RF.parts.sidebar({dom:{tag:"div",classes:["tox-sidebar"]}});return{dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[e,t]}},k=()=>{let t=y3(e),o=tN(t8(),t)&&"grid"===og(t,"display"),r={dom:{tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(c),attributes:{...vQ.isRtl()?{dir:"rtl"}:{}}},behaviours:cY([mE.config({useFixed:()=>n.isDocked(g)})])},a={dom:{styles:{width:document.body.clientWidth+"px"}},events:iI([iV(ih(),e=>{od(e.element,"width",document.body.clientWidth+"px")})])},l=sC(re(r,o?a:{})),s=Ox(l);return i.set(s),{sink:l,mothership:s}},O=()=>{let o=x(),n=S(),r=RF.parts.throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:y.popup}),i=RF.parts.viewWrapper({backstage:y.popup}),l=yL(e)&&!t?ea.some(La(e,y.popup.shared.providers)):ea.none(),s=eO([d?[]:[o],t?[]:[n],d?[o]:[]]),u=RF.parts.editorContainer({components:eO([s,t?[]:l.toArray()])}),m=y5(e),g={role:"application",...vQ.isRtl()?{dir:"rtl"}:{},...m?{"aria-hidden":"true"}:{}},p=sC(RF.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(t?["tox-tinymce-inline"]:[]).concat(d?["tox-tinymce--toolbar-bottom"]:[]).concat(c),styles:{visibility:"hidden",...m?{opacity:"0",border:"0"}:{}},attributes:g},components:[u,...t?[]:[i],r],behaviours:cY([Sh(),p7.config({disableClass:"tox-tinymce--disabled"}),bw.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a, .tox-statusbar__resize-handle"})])})),h=Ox(p);return a.set(h),{mothership:h,outerContainer:p}},_=t=>{let o=N7(Vo(e)),n=N7(Vr(e));return e.inline||(ob("div","width",n)&&od(t.element,"width",n),ob("div","height",o)?od(t.element,"height",o):od(t.element,"height","400px")),o},T=t=>{e.addShortcut("alt+F9","focus menubar",()=>{RF.focusMenubar(t)}),e.addShortcut("alt+F10","focus toolbar",()=>{RF.focusToolbar(t)}),e.addCommand("ToggleToolbarDrawer",()=>{RF.toggleToolbarDrawer(t)}),e.addQueryStateHandler("ToggleToolbarDrawer",()=>RF.isToolbarDrawerToggled(t))},E=t=>{let{mainUi:r,popupUi:a,uiMotherships:i}=t;eP(yO(e),(t,o)=>{e.ui.registry.addGroupToolbarButton(o,t)});let{buttons:l,menuItems:s,contextToolbars:c,sidebars:d,views:m}=e.ui.registry.getAll(),p=yZ(e),h={menuItems:s,menus:y4(e),menubar:yM(e),toolbar:p.getOrThunk(()=>yB(e)),allowToolbarGroups:u===Z.floating,buttons:l,sidebar:d,views:m};T(r.outerContainer),Ba(e,r.mothership,i),n.setup(e,y.popup.shared,g),Hw(e,y.popup),H3(e,y.popup.shared.getSink,y.popup),F0(e),Ib(e,v,y.popup.shared),VQ(e,c,a.sink,{backstage:y.popup}),z4(e,a.sink);let f=e.getElement(),b=_(r.outerContainer);return o.render(e,t,h,y.popup,{targetNode:f,height:b})},D=()=>{let e=O(),t=k(),o=C(t);r.dialogUi.set(t),r.popupUi.set(o),r.mainUi.set(e);let n={popupUi:o,dialogUi:t,mainUi:e,uiMotherships:r.getUiMotherships()};return E(n)};return{popups:{backstage:y.popup,getMothership:()=>Li("popups",i)},dialogs:{backstage:y.dialog,getMothership:()=>Li("dialogs",i)},renderUI:D}},Ls=(e,t)=>{let o=ea.from(on(e,"id")).fold(()=>{let e=i8("dialog-describe");return ot(t,"id",e),e},C);ot(e,"aria-describedby",o)},Lc=(e,t)=>{let o=or(e,"id").fold(()=>{let e=i8("dialog-label");return ot(t,"id",e),e},C);ot(e,"aria-labelledby",o)},Ld=k([r1("lazySink"),at("dragBlockClass"),af("getBounds",nW),ad("useTabstopAt",M),ad("eventOrder",{}),gV("modalBehaviours",[bw]),s2("onExecute"),s5("onEscape")]),Lu={sketch:C},Lm=k([pl({name:"draghandle",overrides:(e,t)=>({behaviours:cY([z2.config({mode:"mouse",getTarget:e=>sM(e,'[role="dialog"]').getOr(e),blockerClass:e.dragBlockClass.getOrDie(Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+JSON.stringify(t,null,2)).message),getBounds:e.getDragBounds})])})}),pa({schema:[r1("dom")],name:"title"}),pa({factory:Lu,schema:[r1("dom")],name:"close"}),pa({factory:Lu,schema:[r1("dom")],name:"body"}),pl({factory:Lu,schema:[r1("dom")],name:"footer"}),pi({factory:{sketch:(e,t)=>({...e,dom:t.dom,components:t.components})},schema:[ad("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),ad("components",[])],name:"blocker"})]),Lg=(e,t,o,n)=>{let r=dD(),a=t=>{r.set(t);let o=e.lazySink(t).getOrDie(),a=n.blocker(),i=o.getSystem().build({...a,components:a.components.concat([lp(t)]),behaviours:cY([b$.config({}),bV("dialog-blocker-events",[iG(aJ(),()=>{bw.focusIn(t)})])])});mH(o,i),bw.focusIn(t)},i=e=>{r.clear(),tU(e.element).each(t=>{e.getSystem().getByDom(t).each(e=>{mP(e)})})},l=t=>pw(t,e,"body"),s=t=>pw(t,e,"footer"),c=(e,t)=>{Ii.block(e,t)},d=e=>{Ii.unblock(e)},u=i8("modal-events"),m={...e.eventOrder,[ib()]:[u].concat(e.eventOrder["alloy.system.attached"]||[])};return{uid:e.uid,dom:e.dom,components:t,apis:{show:a,hide:i,getBody:l,getFooter:s,setIdle:d,setBusy:c},eventOrder:m,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:gz(e.modalBehaviours,[bR.config({}),bw.config({mode:"cyclic",onEnter:e.onExecute,onEscape:e.onEscape,useTabstopAt:e.useTabstopAt}),Ii.config({getRoot:r.get}),bV(u,[i$(t=>{Lc(t.element,pw(t,e,"title").element),Ls(t.element,pw(t,e,"body").element)})])])}},Lp=pz({name:"ModalDialog",configFields:Ld(),partFields:Lm(),factory:Lg,apis:{show:(e,t)=>{e.show(t)},hide:(e,t)=>{e.hide(t)},getBody:(e,t)=>e.getBody(t),getFooter:(e,t)=>e.getFooter(t),setBusy:(e,t,o)=>{e.setBusy(t,o)},setIdle:(e,t)=>{e.setIdle(t)}}}),Lh=rM([xJ,xZ].concat(wU)),Lf=[wp("button"),wt,ap("align","end",["start","end"]),wc,ws,aa("buttonType",["primary","secondary"])],Lb=[...Lf,x0],Lv=[r9("type",["submit","cancel","custom"]),...Lb],Ly=[r9("type",["menu"]),we,wo,wt,ae("items",Lh),...Lf],Lx=rQ("type",{submit:Lv,cancel:Lv,custom:Lv,menu:Ly}),Lw=[xJ,x0,r9("level",["info","warn","error","success"]),x2,ad("url","")],LS=rM(Lw),Lk=e=>[xJ,e],LC=[xJ,x0,ws,wp("button"),wt,wl,aa("buttonType",["primary","secondary","toolbar"]),wc],LO=rM(LC),L_=[xJ,xZ],LT=L_.concat([wn]),LE=L_.concat([xQ,ws]),LD=rM(LE),LA=LT.concat([wd("auto")]),LM=rM(LA),LB=rR([x3,x0,x2]),LF=LT.concat([ag("storageKey","default")]),LI=rM(LF),LR=rM(LT),LN=L_.concat([ag("tag","textarea"),r5("scriptId"),r5("scriptUrl"),au("settings",void 0,rW)]),LV=L_.concat([ag("tag","textarea"),r4("init")]),LH=r$(e=>rK("customeditor.old",rA(LV),e).orThunk(()=>rK("customeditor.new",rA(LN),e))),Lz=rM(LT),LL=rB(rw),LP=e=>[xJ,r3("columns"),e],LU=[xJ,r5("html"),ap("presets","presentation",["presentation","document"])],LW=rM(LU),Lj=LT.concat([ah("sandboxed",!0),ah("transparent",!0)]),LG=rM(Lj),L$=rM(L_.concat([ar("height")])),Lq=rM([r5("url"),an("zoom"),an("cachedWidth"),an("cachedHeight")]),LX=LT.concat([ar("inputMode"),ar("placeholder"),ah("maximized",!1),ws]),LK=rM(LX),LY=e=>[xJ,xQ,e],LJ=[x0,ae("items",((e,t)=>{let o=oR(t),n=(e,t)=>o().extract(e,t),r=()=>o().toString();return{extract:n,toString:r}})(0,()=>LZ))],LZ=rF([rM([x0,x3]),rM(LJ)]),LQ=LT.concat([ae("items",LZ),ws]),L0=rM(LQ),L1=LT.concat([r7("items",[x0,x3]),am("size",1),ws]),L2=rM(L1),L3=LT.concat([ah("constrain",!0),ws]),L5=rM(L3),L9=rM([r5("width"),r5("height")]),L4=L_.concat([xQ,am("min",0),am("max",0)]),L6=rM(L4),L8=[xJ,ae("header",rz),ae("cells",rB(rz))],L7=rM(L8),Pe=LT.concat([ar("placeholder"),ah("maximized",!1),ws]),Pt=rM(Pe),Po=LT.concat([ap("filetype","file",["image","media","file"]),ws]),Pn=rM(Po),Pr=rM([x3,wu]),Pa=e=>n9("items","items",ro(),rB(r$(t=>rK(`Checking item of ${e}`,Pi,t).fold(e=>nq.error(rZ(e)),e=>nq.value(e))))),Pi=rE(()=>rG("type",{alertbanner:LS,bar:rM(Lk(Pa("bar"))),button:LO,checkbox:LD,colorinput:LI,colorpicker:LR,dropzone:Lz,grid:rM(LP(Pa("grid"))),iframe:LG,input:LK,listbox:L0,selectbox:L2,sizeinput:L5,slider:L6,textarea:Pt,urlinput:Pn,customeditor:LH,htmlpanel:LW,imagepreview:L$,collection:LM,label:rM(LY(Pa("label"))),table:L7,panel:Ps})),Pl=[xJ,ad("classes",[]),ae("items",Pi)],Ps=rM(Pl),Pc=[wp("tab"),x1,ae("items",Pi)],Pd=[xJ,r7("tabs",Pc)],Pu=rM(Pd),Pm=rM([r5("title"),r2("body",rG("type",{panel:Ps,tabpanel:Pu})),ag("size","normal"),ae("buttons",Lx),ad("initialData",{}),af("onAction",y),af("onChange",y),af("onSubmit",y),af("onClose",y),af("onCancel",y),af("onTabChange",y)]),Pg=e=>rK("dialog",Pm,e),Pp=rM([r9("type",["cancel","custom"]),...Lb]),Ph=rM([r5("title"),r5("url"),an("height"),an("width"),al("buttons",Pp),af("onAction",y),af("onCancel",y),af("onClose",y),af("onMessage",y)]),Pf=e=>rK("dialog",Ph,e),Pb=e=>s(e)?[e].concat(e_(eK(e),Pb)):d(e)?e_(e,Pb):[],Pv=e=>l(e.type)&&l(e.name),Py={checkbox:rL,colorinput:rz,colorpicker:rz,dropzone:LL,input:rz,iframe:rz,imagepreview:Lq,selectbox:rz,sizeinput:L9,slider:rH,listbox:rz,size:L9,textarea:rz,urlinput:Pr,customeditor:rz,collection:LB,togglemenuitem:rL},Px=e=>ea.from(Py[e.type]),Pw=e=>ey(Pb(e),Pv),PS=e=>{let t=Pw(e),o=e_(t,e=>Px(e).fold(()=>[],t=>[r2(e.name,t)]));return rM(o)},Pk=e=>{var t;let o=rY(Pg(e)),n=PS(e),r=null!==(t=e.initialData)&&void 0!==t?t:{};return{internalDialog:o,dataValidator:n,initialData:r}},PC={open:(e,t)=>{let o=Pk(t);return e(o.internalDialog,o.initialData,o.dataValidator)},openUrl:(e,t)=>{let o=rY(Pf(t));return e(o)},redial:e=>Pk(e)},PO=e=>{let t=[],o={};return eL(e,(e,n)=>{e.fold(()=>{t.push(n)},e=>{o[n]=e})}),t.length>0?nq.error(t):nq.value(o)},P_=(e,t,o)=>{let n=vZ(Eu.sketch(n=>({dom:{tag:"div",classes:["tox-form"].concat(e.classes)},components:eh(e.items,e=>AL(n,e,t,o))})));return{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[n.asSpec()]}],behaviours:cY([bw.config({mode:"acyclic",useTabstopAt:T(Eq)}),ES.memento(n),EA.memento(n,{postprocess:e=>PO(e).fold(e=>(console.error(e),{}),C)})])}},PT=(e,t)=>({uid:e.uid,dom:e.dom,components:e.components,events:vo(e.action),behaviours:gz(e.tabButtonBehaviours,[b$.config({}),bw.config({mode:"execution",useSpace:!0,useEnter:!0}),gN.config({store:{mode:"memory",initialValue:e.value}})]),domModification:e.domModification}),PE=pH({name:"TabButton",configFields:[ad("uid",void 0),r1("value"),n9("dom","dom",ri(()=>({attributes:{role:"tab",id:i8("aria"),"aria-selected":"false"}})),rN()),at("action"),ad("domModification",{}),gV("tabButtonBehaviours",[b$,bw,gN]),r1("view")],factory:PT}),PD=k([r1("tabs"),r1("dom"),ad("clickToDismiss",!1),gV("tabbarBehaviours",[hy,bw]),sQ(["tabClass","selectedClass"])]),PA=ps({factory:PE,name:"tabs",unit:"tab",overrides:e=>{let t=(e,t)=>{hy.dehighlight(e,t),iE(e,iC(),{tabbar:e,button:t})},o=(e,t)=>{hy.highlight(e,t),iE(e,ik(),{tabbar:e,button:t})};return{action:n=>{let r=n.getSystem().getByUid(e.uid).getOrDie(),a=hy.isHighlighted(r,n),i=a&&e.clickToDismiss?t:a?y:o;i(r,n)},domModification:{classes:[e.markers.tabClass]}}}}),PM=k([PA]),PB=(e,t,o,n)=>({uid:e.uid,dom:e.dom,components:t,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:gz(e.tabbarBehaviours,[hy.config({highlightClass:e.markers.selectedClass,itemClass:e.markers.tabClass,onHighlight:(e,t)=>{ot(t.element,"aria-selected","true")},onDehighlight:(e,t)=>{ot(t.element,"aria-selected","false")}}),bw.config({mode:"flow",getInitial:e=>hy.getHighlighted(e).map(e=>e.element),selector:"."+e.markers.tabClass,executeOnMove:!0})])}),PF=pz({name:"Tabbar",configFields:PD(),partFields:PM(),factory:PB}),PI=(e,t)=>({uid:e.uid,dom:e.dom,behaviours:gz(e.tabviewBehaviours,[bR.config({})]),domModification:{attributes:{role:"tabpanel"}}}),PR=pH({name:"Tabview",configFields:[gV("tabviewBehaviours",[bR])],factory:PI}),PN=k([ad("selectFirst",!0),s1("onChangeTab"),s1("onDismissTab"),ad("tabs",[]),gV("tabSectionBehaviours",[])]),PV=pa({factory:PF,schema:[r1("dom"),r8("markers",[r1("tabClass"),r1("selectedClass")])],name:"tabbar",defaults:e=>({tabs:e.tabs})}),PH=pa({factory:PR,name:"tabview"}),Pz=k([PV,PH]),PL=(e,t,o,n)=>{let r=t=>{let o=gN.getValue(t);px(t,e,"tabview").each(n=>{let r=ek(e.tabs,e=>e.value===o);r.each(o=>{let r=o.view();or(t.element,"id").each(e=>{ot(n.element,"aria-labelledby",e)}),bR.set(n,r),e.onChangeTab(n,t,r)})})},a=(t,o)=>{px(t,e,"tabbar").each(e=>{o(e).each(iD)})};return{uid:e.uid,dom:e.dom,components:t,behaviours:gH(e.tabSectionBehaviours),events:iI(eO([e.selectFirst?[i$((e,t)=>{a(e,hy.getFirst)})]:[],[iV(ik(),(e,t)=>{let o=t.event.button;r(o)}),iV(iC(),(t,o)=>{let n=o.event.button;e.onDismissTab(t,n)})]])),apis:{getViewItems:t=>px(t,e,"tabview").map(e=>bR.contents(e)).getOr([]),showTab:(e,t)=>{let o=e=>{let o=hy.getCandidates(e),n=ek(o,e=>gN.getValue(e)===t);return n.filter(t=>!hy.isHighlighted(e,t))};a(e,o)}}}},PP=pz({name:"TabSection",configFields:PN(),partFields:Pz(),factory:PL,apis:{getViewItems:(e,t)=>e.getViewItems(t),showTab:(e,t,o)=>{e.showTab(t,o)}}}),PU=(e,t,o)=>eh(e,(n,r)=>{bR.set(o,e[r].view());let a=t.dom.getBoundingClientRect();return bR.set(o,[]),a.height}),PW=e=>eI(eB(e,(e,t)=>e>t?-1:e<t?1:0)),Pj=(e,t,o)=>{let n;let r=tL(e).dom,a=sM(e,".tox-dialog-wrap").getOr(e),i="fixed"===og(a,"position");n=i?Math.max(r.clientHeight,window.innerHeight):Math.max(r.offsetHeight,r.scrollHeight);let l=oS(t),s=t.dom.offsetLeft>=o.dom.offsetLeft+oB(o),c=s?Math.max(oS(o),l):l,d=parseInt(og(e,"margin-top"),10)||0,u=parseInt(og(e,"margin-bottom"),10)||0,m=oS(e)+d+u;return n-(m-c)},PG=(e,t)=>{eI(e).each(e=>PP.showTab(t,e.value))},P$=(e,t)=>{od(e,"height",t+"px"),od(e,"flex-basis",t+"px")},Pq=(e,t,o)=>{sM(e,'[role="dialog"]').each(e=>{sF(e,'[role="tablist"]').each(n=>{o.get().map(o=>(od(t,"height","0"),od(t,"flex-basis","0"),Math.min(o,Pj(e,t,n)))).each(e=>{P$(t,e)})})})},PX=e=>sF(e,'[role="tabpanel"]'),PK=e=>{let t=dD(),o=[i$(o=>{let n=o.element;PX(n).each(r=>{od(r,"visibility","hidden"),o.getSystem().getByDom(r).toOptional().each(o=>{let n=PU(e,r,o),a=PW(n);a.fold(t.clear,t.set)}),Pq(n,r,t),ov(r,"visibility"),PG(e,o),requestAnimationFrame(()=>{Pq(n,r,t)})})}),iV(ih(),e=>{let o=e.element;PX(o).each(e=>{Pq(o,e,t)})}),iV(OG,(e,o)=>{let n=e.element;PX(n).each(e=>{let o=c8(t0(e));od(e,"visibility","hidden");let r=oh(e,"height").map(e=>parseInt(e,10));ov(e,"height"),ov(e,"flex-basis");let a=e.dom.getBoundingClientRect().height,i=r.forall(e=>a>e);i?(t.set(a),Pq(n,e,t)):r.each(t=>{P$(e,t)}),ov(e,"visibility"),o.each(c9)})})];return{extraEvents:o,selectFirst:!1}},PY="send-data-to-section",PJ="send-data-to-view",PZ=(e,t,o)=>{let n=ay({}),r=e=>{let t=gN.getValue(e),o=PO(t).getOr({}),r=n.get(),a=re(r,o);n.set(a)},a=e=>{let t=n.get();gN.setValue(e,t)},i=ay(null),l=eh(e.tabs,e=>({value:e.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"]},components:[sx(o.shared.providers.translate(e.title))],view:()=>[Eu.sketch(n=>({dom:{tag:"div",classes:["tox-form"]},components:eh(e.items,e=>AL(n,e,t,o)),formBehaviours:cY([bw.config({mode:"acyclic",useTabstopAt:T(Eq)}),bV("TabView.form.events",[i$(a),iq(r)]),c2.config({channels:aE([{key:PY,value:{onReceive:r}},{key:PJ,value:{onReceive:a}}])})])}))]})),s=PK(l);return PP.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:(e,t,o)=>{let n=gN.getValue(t);iE(e,Oj,{name:n,oldName:i.get()}),i.set(n)},tabs:l,components:[PP.parts.tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[PF.parts.tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:cY([OD.config({})])}),PP.parts.tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:s.selectFirst,tabSectionBehaviours:cY([bV("tabpanel",s.extraEvents),bw.config({mode:"acyclic"}),pj.config({find:e=>eI(PP.getViewItems(e))}),EA.withComp(ea.none(),e=>(e.getSystem().broadcastOn([PY],{}),n.get()),(e,t)=>{n.set(t),e.getSystem().broadcastOn([PJ],{})})])})},PQ=i8("update-dialog"),P0=i8("update-title"),P1=i8("update-body"),P2=i8("update-footer"),P3=i8("body-send-message"),P5=(e,t,o,n,r)=>{let a=e=>{let t=e.body;return"tabpanel"===t.type?[PZ(t,e.initialData,n)]:[P_(t,e.initialData,n)]},i=(e,t)=>ea.some({isTabPanel:()=>"tabpanel"===t.body.type});return{dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:{...o.map(e=>({id:e})).getOr({}),...r?{"aria-live":"polite"}:{}}},components:[],behaviours:cY([ES.childAt(0),NC.config({channel:`${P1}-${t}`,updateState:i,renderComponents:a,initialData:e})])}},P9=(e,t,o,n,r)=>P5(e,t,ea.some(o),n,r),P4=(e,t,o)=>{let n=P5(e,t,ea.none(),o,!1);return Lp.parts.body(n)},P6=e=>{let t={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[Ej({dom:{tag:"iframe",attributes:{src:e.url}},behaviours:cY([OD.config({}),b$.config({})])})]}],behaviours:cY([bw.config({mode:"acyclic",useTabstopAt:T(Eq)})])};return Lp.parts.body(t)};function P8(e){return(P8="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function P7(e,t){return(P7=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ue(e,t,o){return(Ue=!function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}()?function(e,t,o){var n=[null];n.push.apply(n,t);var r=new(Function.bind.apply(e,n));return o&&P7(r,o.prototype),r}:Reflect.construct).apply(null,arguments)}function Ut(e){return function(e){if(Array.isArray(e))return Uo(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Uo(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);if("Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o)return Array.from(e);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return Uo(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Uo(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=Array(t);o<t;o++)n[o]=e[o];return n}var Un=Object.hasOwnProperty,Ur=Object.setPrototypeOf,Ua=Object.isFrozen,Ui=Object.getPrototypeOf,Ul=Object.getOwnPropertyDescriptor,Us=Object.freeze,Uc=Object.seal,Ud=Object.create,Uu="undefined"!=typeof Reflect&&Reflect,Um=Uu.apply,Ug=Uu.construct;Um||(Um=function(e,t,o){return e.apply(t,o)}),Us||(Us=function(e){return e}),Uc||(Uc=function(e){return e}),Ug||(Ug=function(e,t){return Ue(e,Ut(t))});var Up=UC(Array.prototype.forEach),Uh=UC(Array.prototype.pop),Uf=UC(Array.prototype.push),Ub=UC(String.prototype.toLowerCase),Uv=UC(String.prototype.match),Uy=UC(String.prototype.replace),Ux=UC(String.prototype.indexOf),Uw=UC(String.prototype.trim),US=UC(RegExp.prototype.test),Uk=(B=TypeError,function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return Ug(B,t)});function UC(e){return function(t){for(var o=arguments.length,n=Array(o>1?o-1:0),r=1;r<o;r++)n[r-1]=arguments[r];return Um(e,t,n)}}function UO(e,t){Ur&&Ur(e,null);for(var o=t.length;o--;){var n=t[o];if("string"==typeof n){var r=Ub(n);r!==n&&(Ua(t)||(t[o]=r),n=r)}e[n]=!0}return e}function U_(e){var t,o=Ud(null);for(t in e)Um(Un,e,[t])&&(o[t]=e[t]);return o}function UT(e,t){for(;null!==e;){var o=Ul(e,t);if(o){if(o.get)return UC(o.get);if("function"==typeof o.value)return UC(o.value)}e=Ui(e)}return function(e){return console.warn("fallback value for",e),null}}var UE=Us(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),UD=Us(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),UA=Us(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),UM=Us(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),UB=Us(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),UF=Us(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),UI=Us(["#text"]),UR=Us(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),UN=Us(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),UV=Us(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),UH=Us(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Uz=Uc(/\{\{[\w\W]*|[\w\W]*\}\}/gm),UL=Uc(/<%[\w\W]*|[\w\W]*%>/gm),UP=Uc(/^data-[\-\w.\u00B7-\uFFFF]/),UU=Uc(/^aria-[\-\w]+$/),UW=Uc(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Uj=Uc(/^(?:\w+script|data):/i),UG=Uc(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),U$=Uc(/^html$/i),Uq=function(e,t){if("object"!==P8(e)||"function"!=typeof e.createPolicy)return null;var o=null,n="data-tt-policy-suffix";t.currentScript&&t.currentScript.hasAttribute(n)&&(o=t.currentScript.getAttribute(n));var r="dompurify"+(o?"#"+o:"");try{return e.createPolicy(r,{createHTML:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+r+" could not be created."),null}},UX=function e(){var t,o,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof window?null:window,r=function(t){return e(t)};if(r.version="2.3.8",r.removed=[],!n||!n.document||9!==n.document.nodeType)return r.isSupported=!1,r;var a=n.document,i=n.document,l=n.DocumentFragment,s=n.HTMLTemplateElement,c=n.Node,d=n.Element,u=n.NodeFilter,m=n.NamedNodeMap,g=void 0===m?n.NamedNodeMap||n.MozNamedAttrMap:m,p=n.HTMLFormElement,h=n.DOMParser,f=n.trustedTypes,b=d.prototype,v=UT(b,"cloneNode"),y=UT(b,"nextSibling"),x=UT(b,"childNodes"),w=UT(b,"parentNode");if("function"==typeof s){var S=i.createElement("template");S.content&&S.content.ownerDocument&&(i=S.content.ownerDocument)}var k=Uq(f,a),C=k?k.createHTML(""):"",O=i,_=O.implementation,T=O.createNodeIterator,E=O.createDocumentFragment,D=O.getElementsByTagName,A=a.importNode,M={};try{M=U_(i).documentMode?i.documentMode:{}}catch(e){}var B={};r.isSupported="function"==typeof w&&_&&void 0!==_.createHTMLDocument&&9!==M;var F=UW,I=null,R=UO({},[].concat(Ut(UE),Ut(UD),Ut(UA),Ut(UB),Ut(UI))),N=null,V=UO({},[].concat(Ut(UR),Ut(UN),Ut(UV),Ut(UH))),H=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),z=null,L=null,P=!0,U=!0,W=!1,j=!1,G=!1,$=!1,q=!1,X=!1,K=!1,Y=!1,J=!0,Z=!0,Q=!1,ee={},et=null,eo=UO({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),en=null,er=UO({},["audio","video","img","source","image","track"]),ea=null,ei=UO({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),el="http://www.w3.org/1998/Math/MathML",es="http://www.w3.org/2000/svg",ec="http://www.w3.org/1999/xhtml",ed=ec,eu=!1,em=["application/xhtml+xml","text/html"],eg=null,ep=i.createElement("form"),eh=function(e){return e instanceof RegExp||e instanceof Function},ef=function(e){eg&&eg===e||(e&&"object"===P8(e)||(e={}),I="ALLOWED_TAGS"in(e=U_(e))?UO({},e.ALLOWED_TAGS):R,N="ALLOWED_ATTR"in e?UO({},e.ALLOWED_ATTR):V,ea="ADD_URI_SAFE_ATTR"in e?UO(U_(ei),e.ADD_URI_SAFE_ATTR):ei,en="ADD_DATA_URI_TAGS"in e?UO(U_(er),e.ADD_DATA_URI_TAGS):er,et="FORBID_CONTENTS"in e?UO({},e.FORBID_CONTENTS):eo,z="FORBID_TAGS"in e?UO({},e.FORBID_TAGS):{},L="FORBID_ATTR"in e?UO({},e.FORBID_ATTR):{},ee="USE_PROFILES"in e&&e.USE_PROFILES,P=!1!==e.ALLOW_ARIA_ATTR,U=!1!==e.ALLOW_DATA_ATTR,W=e.ALLOW_UNKNOWN_PROTOCOLS||!1,j=e.SAFE_FOR_TEMPLATES||!1,G=e.WHOLE_DOCUMENT||!1,X=e.RETURN_DOM||!1,K=e.RETURN_DOM_FRAGMENT||!1,Y=e.RETURN_TRUSTED_TYPE||!1,q=e.FORCE_BODY||!1,J=!1!==e.SANITIZE_DOM,Z=!1!==e.KEEP_CONTENT,Q=e.IN_PLACE||!1,F=e.ALLOWED_URI_REGEXP||F,ed=e.NAMESPACE||ec,e.CUSTOM_ELEMENT_HANDLING&&eh(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(H.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&eh(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(H.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(H.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),o="application/xhtml+xml"===(t=t=-1===em.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE)?function(e){return e}:Ub,j&&(U=!1),K&&(X=!0),ee&&(I=UO({},Ut(UI)),N=[],!0===ee.html&&(UO(I,UE),UO(N,UR)),!0===ee.svg&&(UO(I,UD),UO(N,UN),UO(N,UH)),!0===ee.svgFilters&&(UO(I,UA),UO(N,UN),UO(N,UH)),!0===ee.mathMl&&(UO(I,UB),UO(N,UV),UO(N,UH))),e.ADD_TAGS&&(I===R&&(I=U_(I)),UO(I,e.ADD_TAGS)),e.ADD_ATTR&&(N===V&&(N=U_(N)),UO(N,e.ADD_ATTR)),e.ADD_URI_SAFE_ATTR&&UO(ea,e.ADD_URI_SAFE_ATTR),e.FORBID_CONTENTS&&(et===eo&&(et=U_(et)),UO(et,e.FORBID_CONTENTS)),Z&&(I["#text"]=!0),G&&UO(I,["html","head","body"]),I.table&&(UO(I,["tbody"]),delete z.tbody),Us&&Us(e),eg=e)},eb=UO({},["mi","mo","mn","ms","mtext"]),ev=UO({},["foreignobject","desc","title","annotation-xml"]),ey=UO({},["title","style","font","a","script"]),ex=UO({},UD);UO(ex,UA),UO(ex,UM);var ew=UO({},UB);UO(ew,UF);var eS=function(e){var t=w(e);t&&t.tagName||(t={namespaceURI:ec,tagName:"template"});var o=Ub(e.tagName),n=Ub(t.tagName);return e.namespaceURI===es?t.namespaceURI===ec?"svg"===o:t.namespaceURI===el?"svg"===o&&("annotation-xml"===n||eb[n]):Boolean(ex[o]):e.namespaceURI===el?t.namespaceURI===ec?"math"===o:t.namespaceURI===es?"math"===o&&ev[n]:Boolean(ew[o]):e.namespaceURI===ec&&(t.namespaceURI!==es||!!ev[n])&&(t.namespaceURI!==el||!!eb[n])&&!ew[o]&&(ey[o]||!ex[o])},ek=function(e){Uf(r.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){try{e.outerHTML=C}catch(t){e.remove()}}},eC=function(e,t){try{Uf(r.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){Uf(r.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!N[e]){if(X||K)try{ek(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}}},eO=function(e){if(q)e="<remove></remove>"+e;else{var o,n,r=Uv(e,/^[\r\n\t ]+/);n=r&&r[0]}"application/xhtml+xml"===t&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");var a=k?k.createHTML(e):e;if(ed===ec)try{o=new h().parseFromString(a,t)}catch(e){}if(!o||!o.documentElement){o=_.createDocument(ed,"template",null);try{o.documentElement.innerHTML=eu?"":a}catch(e){}}var l=o.body||o.documentElement;return(e&&n&&l.insertBefore(i.createTextNode(n),l.childNodes[0]||null),ed===ec)?D.call(o,G?"html":"body")[0]:G?o.documentElement:l},e_=function(e){return T.call(e.ownerDocument||e,e,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT,null,!1)},eT=function(e){return"object"===P8(c)?e instanceof c:e&&"object"===P8(e)&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},eE=function(e,t,o){B[e]&&Up(B[e],function(e){e.call(r,t,o,eg)})},eD=function(e){if(eE("beforeSanitizeElements",e,null),e instanceof p&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof g)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore)||US(/[\u0080-\uFFFF]/,e.nodeName))return ek(e),!0;var t,n=o(e.nodeName);if(eE("uponSanitizeElement",e,{tagName:n,allowedTags:I}),e.hasChildNodes()&&!eT(e.firstElementChild)&&(!eT(e.content)||!eT(e.content.firstElementChild))&&US(/<[/\w]/g,e.innerHTML)&&US(/<[/\w]/g,e.textContent)||"select"===n&&US(/<template/i,e.innerHTML))return ek(e),!0;if(!I[n]||z[n]){if(!z[n]&&eM(n)&&(H.tagNameCheck instanceof RegExp&&US(H.tagNameCheck,n)||H.tagNameCheck instanceof Function&&H.tagNameCheck(n)))return!1;if(Z&&!et[n]){var a=w(e)||e.parentNode,i=x(e)||e.childNodes;if(i&&a)for(var l=i.length,s=l-1;s>=0;--s)a.insertBefore(v(i[s],!0),y(e))}return ek(e),!0}return e instanceof d&&!eS(e)||("noscript"===n||"noembed"===n)&&US(/<\/no(script|embed)/i,e.innerHTML)?(ek(e),!0):(j&&3===e.nodeType&&(t=Uy(t=e.textContent,Uz," "),t=Uy(t,UL," "),e.textContent!==t&&(Uf(r.removed,{element:e.cloneNode()}),e.textContent=t)),eE("afterSanitizeElements",e,null),!1)},eA=function(e,t,o){if(J&&("id"===t||"name"===t)&&(o in i||o in ep))return!1;if(U&&!L[t]&&US(UP,t));else if(P&&US(UU,t));else if(!N[t]||L[t]){if(!(eM(e)&&(H.tagNameCheck instanceof RegExp&&US(H.tagNameCheck,e)||H.tagNameCheck instanceof Function&&H.tagNameCheck(e))&&(H.attributeNameCheck instanceof RegExp&&US(H.attributeNameCheck,t)||H.attributeNameCheck instanceof Function&&H.attributeNameCheck(t))||"is"===t&&H.allowCustomizedBuiltInElements&&(H.tagNameCheck instanceof RegExp&&US(H.tagNameCheck,o)||H.tagNameCheck instanceof Function&&H.tagNameCheck(o))))return!1}else if(ea[t]);else if(US(F,Uy(o,UG,"")));else if(("src"===t||"xlink:href"===t||"href"===t)&&"script"!==e&&0===Ux(o,"data:")&&en[e]);else if(W&&!US(Uj,Uy(o,UG,"")));else if(o)return!1;return!0},eM=function(e){return e.indexOf("-")>0},eB=function(e){eE("beforeSanitizeAttributes",e,null);var t,n,r,a,i=e.attributes;if(i){var l={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:N};for(a=i.length;a--;){var s=(t=i[a]).name,c=t.namespaceURI;n="value"===s?t.value:Uw(t.value),r=o(s);var d=n;if(l.attrName=r,l.attrValue=n,l.keepAttr=!0,l.forceKeepAttr=void 0,eE("uponSanitizeAttribute",e,l),n=l.attrValue,!l.forceKeepAttr){if(!l.keepAttr||US(/\/>/i,n)||(j&&(n=Uy(n,Uz," "),n=Uy(n,UL," ")),!eA(o(e.nodeName),r,n))){eC(s,e);continue}if(n!==d)try{c?e.setAttributeNS(c,s,n):e.setAttribute(s,n)}catch(t){eC(s,e)}}}eE("afterSanitizeAttributes",e,null)}},eF=function e(t){var o,n=e_(t);for(eE("beforeSanitizeShadowDOM",t,null);o=n.nextNode();)eE("uponSanitizeShadowNode",o,null),eD(o)||(o.content instanceof l&&e(o.content),eB(o));eE("afterSanitizeShadowDOM",t,null)};return r.sanitize=function(e,t){if((eu=!e)&&(e="<!-->"),"string"!=typeof e&&!eT(e)){if("function"!=typeof e.toString)throw Uk("toString is not a function");if("string"!=typeof(e=e.toString()))throw Uk("dirty is not a string, aborting")}if(!r.isSupported){if("object"===P8(n.toStaticHTML)||"function"==typeof n.toStaticHTML){if("string"==typeof e)return n.toStaticHTML(e);if(eT(e))return n.toStaticHTML(e.outerHTML)}return e}if($||ef(t),r.removed=[],"string"==typeof e&&(Q=!1),Q){if(e.nodeName){var i,s,d,u,m,g=o(e.nodeName);if(!I[g]||z[g])throw Uk("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof c)1===(s=(i=eO("<!---->")).ownerDocument.importNode(e,!0)).nodeType&&"BODY"===s.nodeName?i=s:"HTML"===s.nodeName?i=s:i.appendChild(s);else{if(!X&&!j&&!G&&-1===e.indexOf("<"))return k&&Y?k.createHTML(e):e;if(!(i=eO(e)))return X?null:Y?C:""}i&&q&&ek(i.firstChild);for(var p=e_(Q?e:i);d=p.nextNode();)3===d.nodeType&&d===u||eD(d)||(d.content instanceof l&&eF(d.content),eB(d),u=d);if(u=null,Q)return e;if(X){if(K)for(m=E.call(i.ownerDocument);i.firstChild;)m.appendChild(i.firstChild);else m=i;return N.shadowroot&&(m=A.call(a,m,!0)),m}var h=G?i.outerHTML:i.innerHTML;return G&&I["!doctype"]&&i.ownerDocument&&i.ownerDocument.doctype&&i.ownerDocument.doctype.name&&US(U$,i.ownerDocument.doctype.name)&&(h="<!DOCTYPE "+i.ownerDocument.doctype.name+">\n"+h),j&&(h=Uy(h,Uz," "),h=Uy(h,UL," ")),k&&Y?k.createHTML(h):h},r.setConfig=function(e){ef(e),$=!0},r.clearConfig=function(){eg=null,$=!1},r.isValidAttribute=function(e,t,n){return eg||ef({}),eA(o(e),o(t),n)},r.addHook=function(e,t){"function"==typeof t&&(B[e]=B[e]||[],Uf(B[e],t))},r.removeHook=function(e){if(B[e])return Uh(B[e])},r.removeHooks=function(e){B[e]&&(B[e]=[])},r.removeAllHooks=function(){B={}},r}();let UK=e=>UX().sanitize(e),UY=ys.deviceType.isTouch(),UJ=(e,t)=>({dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[e,t]}),UZ=(e,t)=>Lp.parts.close(vJ.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close")}},action:e,buttonBehaviours:cY([OD.config({})])})),UQ=()=>Lp.parts.title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}}),U0=(e,t)=>Lp.parts.body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:Ic(`<p>${UK(t.translate(e))}</p>`)}]}]}),U1=e=>Lp.parts.footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:e}),U2=(e,t)=>[Oy.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:e}),Oy.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:t})],U3=e=>{let t="tox-dialog",o=t+"-wrap",n=o+"__backdrop",r=t+"__disable-scroll";return Lp.sketch({lazySink:e.lazySink,onEscape:t=>(e.onEscape(t),ea.some(!0)),useTabstopAt:e=>!Eq(e),dom:{tag:"div",classes:[t].concat(e.extraClasses),styles:{position:"relative",...e.extraStyles}},components:[e.header,e.body,...e.footer.toArray()],parts:{blocker:{dom:Ic(`<div class="${o}"></div>`),components:[{dom:{tag:"div",classes:UY?[n,n+"--opaque"]:[n]}}]}},dragBlockClass:o,modalBehaviours:cY([b$.config({}),bV("dialog-events",e.dialogEvents.concat([iG(aJ(),(e,t)=>{bw.focusIn(e)})])),bV("scroll-lock",[i$(()=>{lQ(t8(),r)}),iq(()=>{l1(t8(),r)})]),...e.extraBehaviours]),eventOrder:{[ia()]:["dialog-events"],[ib()]:["scroll-lock","dialog-events","alloy.base.behaviour"],[iv()]:["alloy.base.behaviour","dialog-events","scroll-lock"],...e.eventOrder}})},U5=e=>vJ.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":e.translate("Close"),title:e.translate("Close")}},components:[ye("close",{tag:"div",classes:["tox-icon"]},e.icons)],action:e=>{iT(e,Oz)}}),U9=(e,t,o,n)=>{let r=e=>[sx(n.translate(e.title))];return{dom:{tag:"div",classes:["tox-dialog__title"],attributes:{...o.map(e=>({id:e})).getOr({})}},components:[],behaviours:cY([NC.config({channel:`${P0}-${t}`,initialData:e,renderComponents:r})])}},U4=()=>({dom:Ic('<div class="tox-dialog__draghandle"></div>')}),U6=(e,t,o,n)=>Oy.sketch({dom:Ic('<div class="tox-dialog__header"></div>'),components:[U9(e,t,ea.some(o),n),U4(),U5(n)],containerBehaviours:cY([z2.config({mode:"mouse",blockerClass:"blocker",getTarget:e=>sI(e,'[role="dialog"]').getOrDie(),snaps:{getSnapPoints:()=>[],leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])}),U8=(e,t,o)=>{let n=Lp.parts.title(U9(e,t,ea.none(),o)),r=Lp.parts.draghandle(U4()),a=Lp.parts.close(U5(o)),i=[n].concat(e.draggable?[r]:[]).concat([a]);return Oy.sketch({dom:Ic('<div class="tox-dialog__header"></div>'),components:i})},U7=(e,t,o)=>U8({title:o.shared.providers.translate(e),draggable:o.dialog.isDraggableModal()},t,o.shared.providers),We=(e,t,o)=>({dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":o.translate(e)},styles:{left:"0px",right:"0px",bottom:"0px",top:"0px",position:"absolute"}},behaviours:t,components:[{dom:Ic('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}),Wt=(e,t,o)=>({onClose:()=>o.closeWindow(),onBlock:o=>{Lp.setBusy(e(),(e,n)=>We(o.message,n,t))},onUnblock:()=>{Lp.setIdle(e())}}),Wo=(e,t,o,n)=>{let r=(e,t)=>ea.some(t);return sC(U3({...e,lazySink:n.shared.getSink,extraBehaviours:[NC.config({channel:`${PQ}-${e.id}`,updateState:r,initialData:t}),EA.memory({}),...e.extraBehaviours],onEscape:e=>{iT(e,Oz)},dialogEvents:o,eventOrder:{[ir()]:[NC.name(),c2.name()],[ib()]:["scroll-lock",NC.name(),"messages","dialog-events","alloy.base.behaviour"],[iv()]:["alloy.base.behaviour","dialog-events","messages",NC.name(),"scroll-lock"]}}))},Wn=e=>{let t=e=>{let t=eh(e.items,e=>{let t=ay(!1);return{...e,storage:t}});return{...e,items:t}};return eh(e,e=>"menu"===e.type?t(e):e)},Wr=e=>ew(e,(e,t)=>"menu"===t.type?ew(t.items,(e,t)=>(e[t.name]=t.storage,e),e):e,{}),Wa=(e,t)=>[iU(aJ(),E$),e(OH,(e,o)=>{t.onClose(),o.onClose()}),e(Oz,(e,t,o,n)=>{t.onCancel(e),iT(n,OH)}),iV(OW,(e,o)=>t.onUnblock()),iV(OU,(e,o)=>t.onBlock(o.event))],Wi=(e,t)=>{let o=(t,o)=>iV(t,(t,r)=>{n(t,(n,a)=>{o(e(),n,r.event,t)})}),n=(e,t)=>{NC.getState(e).get().each(o=>{t(o,e)})};return[...Wa(o,t),o(OL,(e,t,o)=>{t.onAction(e,{name:o.name})})]},Wl=(e,t,o)=>{let n=(t,o)=>iV(t,(t,n)=>{r(t,(r,a)=>{o(e(),r,n.event,t)})}),r=(e,t)=>{NC.getState(e).get().each(o=>{t(o.internalDialog,e)})};return[...Wa(n,t),n(OP,(e,t)=>t.onSubmit(e)),n(OV,(e,t,o)=>{t.onChange(e,{name:o.name})}),n(OL,(e,t,n,r)=>{let a=()=>bw.focusIn(r),i=e=>oa(e,"disabled")||or(e,"aria-disabled").exists(e=>"true"===e),l=t0(r.element),s=c8(l);t.onAction(e,{name:n.name,value:n.value}),c8(l).fold(a,e=>{i(e)?a():s.exists(t=>tV(e,t)&&i(t))?a():o().toOptional().filter(t=>!tV(t.element,e)).each(a)})}),n(Oj,(e,t,o)=>{t.onTabChange(e,{newTabName:o.name,oldTabName:o.oldName})}),iq(t=>{let o=e();gN.setValue(t,o.getData())})]},Ws={initUrlDialog:Wi,initDialog:Wl},Wc=(e,t)=>Ap(e,e.type,t),Wd=(e,t,o)=>ek(t,e=>e.name===o).bind(t=>t.memento.getOpt(e)),Wu=(e,t)=>{let o=t.map(e=>e.footerButtons).getOr([]),n=ev(o,e=>"start"===e.align),r=(e,t)=>Oy.sketch({dom:{tag:"div",classes:[`tox-dialog__footer-${e}`]},components:eh(t,e=>e.memento.asSpec())}),a=r("start",n.pass),i=r("end",n.fail);return[a,i]},Wm=(e,t,o)=>{let n=(e,t)=>{let n=eh(t.buttons,e=>{let t=vZ(Wc(e,o));return{name:e.name,align:e.align,memento:t}}),r=t=>Wd(e,n,t);return ea.some({lookupByName:r,footerButtons:n})};return{dom:Ic('<div class="tox-dialog__footer"></div>'),components:[],behaviours:cY([NC.config({channel:`${P2}-${t}`,initialData:e,updateState:n,renderComponents:Wu})])}},Wg=(e,t,o)=>Wm(e,t,o),Wp=(e,t,o)=>Lp.parts.footer(Wm(e,t,o)),Wh=(e,t)=>{let o=e.getRoot();if(!o.getSystem().isConnected())return ea.none();{let o=pj.getCurrent(e.getFormWrapper()).getOr(e.getFormWrapper());return Eu.getField(o,t).orThunk(()=>{let o=e.getFooter(),n=NC.getState(o).get();return n.bind(e=>e.lookupByName(t))})}},Wf=(e,t)=>{let o=e.getRoot();return NC.getState(o).get().map(e=>rY(rK("data",e.dataValidator,t))).getOr(t)},Wb=(e,t,o)=>{let n=t=>{let o=e.getRoot();o.getSystem().isConnected()&&t(o)},r=()=>{let t=e.getRoot(),n=t.getSystem().isConnected()?e.getFormWrapper():t,r=gN.getValue(n),a=eP(o,e=>e.get());return{...r,...a}},a=t=>{n(n=>{let r=p.getData(),a=re(r,t),i=Wf(e,a),l=e.getFormWrapper();gN.setValue(l,i),eL(o,(e,t)=>{eJ(a,t)&&e.set(a[t])})})},i=(t,o)=>{Wh(e,t).each(o?p7.enable:p7.disable)},s=t=>{Wh(e,t).each(b$.focus)},c=e=>{if(!l(e))throw Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");n(t=>{iE(t,OU,{message:e})})},d=()=>{n(e=>{iT(e,OW)})},u=t=>{n(o=>{let n=e.getBody(),r=NC.getState(n);r.get().exists(e=>e.isTabPanel())&&pj.getCurrent(n).each(e=>{PP.showTab(e,t)})})},m=o=>{n(n=>{let r=e.getId(),a=t(o);n.getSystem().broadcastOn([`${PQ}-${r}`],a),n.getSystem().broadcastOn([`${P0}-${r}`],a.internalDialog),n.getSystem().broadcastOn([`${P1}-${r}`],a.internalDialog),n.getSystem().broadcastOn([`${P2}-${r}`],a.internalDialog),p.setData(a.initialData)})},g=()=>{n(e=>{iT(e,OH)})},p={getData:r,setData:a,setEnabled:i,focus:s,block:c,unblock:d,showTab:u,redial:m,close:g};return p},Wv=e=>{switch(e){case"large":return["tox-dialog--width-lg"];case"medium":return["tox-dialog--width-md"];default:return[]}},Wy=(e,t,o)=>{let n=i8("dialog"),r=e.internalDialog,a=U7(r.title,n,o),i=P4({body:r.body,initialData:r.initialData},n,o),l=Wn(r.buttons),s=Wr(l),c=Wp({buttons:l},n,o),d=Ws.initDialog(()=>h,Wt(()=>g,o.shared.providers,t),o.shared.getSink),u=Wv(r.size),m={id:n,header:a,body:i,footer:ea.some(c),extraClasses:u,extraBehaviours:[],extraStyles:{}},g=Wo(m,e,d,o),p=(()=>{let e=()=>{let e=Lp.getBody(g);return pj.getCurrent(e).getOr(e)};return{getId:k(n),getRoot:k(g),getBody:()=>Lp.getBody(g),getFooter:()=>Lp.getFooter(g),getFormWrapper:e}})(),h=Wb(p,t.redial,s);return{dialog:g,instanceApi:h}},Wx=(e,t,o,n)=>{let r=i8("dialog"),a=i8("dialog-label"),i=i8("dialog-content"),l=e.internalDialog,s=(e,t)=>ea.some(t),c=vZ(U6({title:l.title,draggable:!0},r,a,o.shared.providers)),d=vZ(P9({body:l.body,initialData:l.initialData},r,i,o,n)),u=Wn(l.buttons),m=Wr(u),g=vZ(Wg({buttons:u},r,o)),p=Ws.initDialog(()=>f,{onBlock:e=>{Ii.block(h,(t,n)=>We(e.message,n,o.shared.providers))},onUnblock:()=>{Ii.unblock(h)},onClose:()=>t.closeWindow()},o.shared.getSink),h=sC({dom:{tag:"div",classes:["tox-dialog","tox-dialog-inline"],attributes:{role:"dialog","aria-labelledby":a,"aria-describedby":i}},eventOrder:{[ir()]:[NC.name(),c2.name()],[ia()]:["execute-on-form"],[ib()]:["reflecting","execute-on-form"]},behaviours:cY([bw.config({mode:"cyclic",onEscape:e=>(iT(e,OH),ea.some(!0)),useTabstopAt:e=>!Eq(e)&&("button"!==tk(e)||"disabled"!==on(e,"disabled"))}),NC.config({channel:`${PQ}-${r}`,updateState:s,initialData:e}),b$.config({}),bV("execute-on-form",p.concat([iG(aJ(),(e,t)=>{bw.focusIn(e)})])),Ii.config({getRoot:()=>ea.some(h)}),bR.config({}),EA.memory({})]),components:[c.asSpec(),d.asSpec(),g.asSpec()]}),f=Wb({getId:k(r),getRoot:k(h),getFooter:()=>g.get(h),getBody:()=>d.get(h),getFormWrapper:()=>{let e=d.get(h);return pj.getCurrent(e).getOr(e)}},t.redial,m);return{dialog:h,instanceApi:f}};var Ww=tinymce.util.Tools.resolve("tinymce.util.URI");let WS=e=>{let t=t=>{e.getSystem().isConnected()&&t(e)},o=e=>{if(!l(e))throw Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");t(t=>{iE(t,OU,{message:e})})},n=()=>{t(e=>{iT(e,OW)})},r=()=>{t(e=>{iT(e,OH)})},a=e=>{t(t=>{t.getSystem().broadcastOn([P3],e)})};return{block:o,unblock:n,close:r,sendMessage:a}},Wk=["insertContent","setContent","execCommand","close","block","unblock"],WC=e=>s(e)&&-1!==Wk.indexOf(e.mceAction),WO=e=>!WC(e)&&s(e)&&eJ(e,"mceAction"),W_=(e,t,o)=>{switch(o.mceAction){case"insertContent":e.insertContent(o.content);break;case"setContent":e.setContent(o.content);break;case"execCommand":let n=!!m(o.ui)&&o.ui;e.execCommand(o.cmd,n,o.value);break;case"close":t.close();break;case"block":t.block(o.message);break;case"unblock":t.unblock()}},WT=(e,t,o,n)=>{let r=i8("dialog"),a=U7(e.title,r,n),i=P6(e),l=e.buttons.bind(e=>0===e.length?ea.none():ea.some(Wp({buttons:e},r,n))),s=Ws.initUrlDialog(()=>b,Wt(()=>f,n.shared.providers,t)),c={...e.height.fold(()=>({}),e=>({height:e+"px","max-height":e+"px"})),...e.width.fold(()=>({}),e=>({width:e+"px","max-width":e+"px"}))},d=e.width.isNone()&&e.height.isNone()?["tox-dialog--width-lg"]:[],u=new Ww(e.url,{base_uri:new Ww(window.location.href)}),m=`${u.protocol}://${u.host}${u.port?":"+u.port:""}`,g=dE(),p=[bV("messages",[i$(()=>{let t=dA(tp.fromDom(window),"message",t=>{if(u.isSameOrigin(new Ww(t.raw.origin))){let n=t.raw.data;WC(n)?W_(o,b,n):WO(n)&&e.onMessage(b,n)}});g.set(t)}),iq(g.clear)]),c2.config({channels:{[P3]:{onReceive:(e,t)=>{sF(e.element,"iframe").each(e=>{let o=e.dom.contentWindow;h(o)&&o.postMessage(t,m)})}}}})],f=Wo({id:r,header:a,body:i,footer:l,extraClasses:d,extraBehaviours:p,extraStyles:c},e,s,n),b=WS(f);return{dialog:f,instanceApi:b}},WE=e=>{let t=e.shared,o=(o,n)=>{let r=()=>{Lp.hide(s),n()},a=vZ(Ap({name:"close-alert",text:"OK",primary:!0,buttonType:ea.some("primary"),align:"end",enabled:!0,icon:ea.none()},"cancel",e)),i=UQ(),l=UZ(r,t.providers),s=sC(U3({lazySink:()=>t.getSink(),header:UJ(i,l),body:U0(o,t.providers),footer:ea.some(U1(U2([],[a.asSpec()]))),onEscape:r,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[iV(Oz,r)],eventOrder:{}}));Lp.show(s);let c=a.get(s);b$.focus(c)};return{open:o}},WD=e=>{let t=e.shared,o=(o,n)=>{let r=e=>{Lp.hide(c),n(e)},a=vZ(Ap({name:"yes",text:"Yes",primary:!0,buttonType:ea.some("primary"),align:"end",enabled:!0,icon:ea.none()},"submit",e)),i=Ap({name:"no",text:"No",primary:!1,buttonType:ea.some("secondary"),align:"end",enabled:!0,icon:ea.none()},"cancel",e),l=UQ(),s=UZ(()=>r(!1),t.providers),c=sC(U3({lazySink:()=>t.getSink(),header:UJ(l,s),body:U0(o,t.providers),footer:ea.some(U1(U2([],[i,a.asSpec()]))),onEscape:()=>r(!1),extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[iV(Oz,()=>r(!1)),iV(OP,()=>r(!0))],eventOrder:{}}));Lp.show(c);let d=a.get(c);b$.focus(d)};return{open:o}},WA=(e,t)=>rY(rK("data",t,e)),WM=e=>C6(e,".tox-alert-dialog")||C6(e,".tox-confirm-dialog"),WB=(e,t,o)=>t&&o?[]:[BZ.config({contextual:{lazyContext:()=>ea.some(nP(tp.fromDom(e.getContentAreaContainer()))),fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top"]})],WF=e=>{let t=e.editor,o=y9(t),n=WE(e.backstages.dialog),r=WD(e.backstages.dialog),a=(t,o,n)=>void 0!==o&&"toolbar"===o.inline?c(t,e.backstages.popup.shared.anchors.inlineDialog(),n,o.ariaAttrs):void 0!==o&&"cursor"===o.inline?c(t,e.backstages.popup.shared.anchors.cursor(),n,o.ariaAttrs):s(t,n),i=(e,t)=>l(e,t),l=(o,n)=>{let r=o=>{let r=WT(o,{closeWindow:()=>{Lp.hide(r.dialog),n(r.instanceApi)}},t,e.backstages.dialog);return Lp.show(r.dialog),r.instanceApi};return PC.openUrl(r,o)},s=(t,o)=>{let n=(t,n,r)=>{let a=Wy({dataValidator:r,initialData:n,internalDialog:t},{redial:PC.redial,closeWindow:()=>{Lp.hide(a.dialog),o(a.instanceApi)}},e.backstages.dialog);return Lp.show(a.dialog),a.instanceApi.setData(n),a.instanceApi};return PC.open(n,t)},c=(n,r,a,i=!1)=>{let l=(n,l,s)=>{let c=WA(l,s),d=dD(),u=e.backstages.popup.shared.header.isPositionedAtTop(),m=()=>d.on(e=>{vX.reposition(e),BZ.refresh(e)}),g=Wx({dataValidator:s,initialData:c,internalDialog:n},{redial:PC.redial,closeWindow:()=>{d.on(vX.hide),t.off("ResizeEditor",m),d.clear(),a(g.instanceApi)}},e.backstages.popup,i),p=sC(vX.sketch({lazySink:e.backstages.popup.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:{},...u?{}:{fireRepositionEventInstead:{}},inlineBehaviours:cY([bV("window-manager-inline-events",[iV(iy(),(e,t)=>{iT(g.dialog,Oz)})]),...WB(t,o,u)]),isExtraPart:(e,t)=>WM(t)}));return d.set(p),vX.showWithin(p,lp(g.dialog),{anchor:r},ea.some(t8())),o&&u||(BZ.refresh(p),t.on("ResizeEditor",m)),g.instanceApi.setData(c),bw.focusIn(g.dialog),g.instanceApi};return PC.open(l,n)},d=(e,t)=>{r.open(e,t)},u=(e,t)=>{n.open(e,t)},m=e=>{e.close()};return{open:a,openUrl:i,alert:u,close:m,confirm:d}},WI=e=>{yu(e),kN(e),HC(e)};er.add("silver",e=>{WI(e);let{dialogs:t,popups:o,renderUI:n}=Ll(e);C4.register(e,o.backstage.shared);let r=WF({editor:e,backstages:{popup:o.backstage,dialog:t.backstage}}),a=()=>ya(e,{backstage:o.backstage},o.getMothership());return{renderUI:n,getWindowManagerImpl:k(r),getNotificationManagerImpl:a}})}();